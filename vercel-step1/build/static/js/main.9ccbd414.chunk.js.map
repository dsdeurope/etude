{"version":3,"sources":["RubriquesInline.js","BibleConcordancePage.js","VersetParVersetPage.js","NotesPage.js","ApiControlPanel.js","RubriquePage.js","App.js","index.js"],"names":["RubriquesInline","_ref","items","activeId","onSelect","rubriquesStatus","length","_jsx","children","getLEDColor","itemId","status","className","map","item","_jsxs","concat","id","onClick","title","style","width","height","borderRadius","backgroundColor","border","boxShadow","marginLeft","flexShrink","BibleConcordancePage","onGoBack","searchTerm","setSearchTerm","useState","results","setResults","isLoading","setIsLoading","characterSearchTerm","setCharacterSearchTerm","characterResults","setCharacterResults","isCharacterLoading","setIsCharacterLoading","selectedCharacter","setSelectedCharacter","characterHistory","setCharacterHistory","activeTab","setActiveTab","biblicalCharacters","sort","generateMockCharacterHistory","character","searchBibleConcordance","async","trim","Promise","resolve","setTimeout","mockResults","term","mockVerses","book","chapter","verse","text","termLower","toLowerCase","matchingEntries","key","verses","Object","entries","includes","push","filter","index","arr","findIndex","v","slice","generateConcordanceResults","error","console","highlightSearchTerm","regex","RegExp","replace","minHeight","background","fontFamily","padding","textAlign","color","cursor","marginBottom","fontSize","fontWeight","margin","opacity","display","justifyContent","gap","marginTop","transition","alignItems","_Fragment","maxWidth","onSubmit","e","preventDefault","type","value","onChange","target","placeholder","flex","disabled","minWidth","enrichedResults","log","alert","WebkitBackgroundClip","WebkitTextFillColor","backgroundClip","gridTemplateColumns","theme","onMouseOver","transform","onMouseOut","flexWrap","suggestion","openYouVersionConcordance","searchUrl","encodeURIComponent","window","open","enrichedHistory","borderTop","animation","maxHeight","overflowY","lineHeight","dangerouslySetInnerHTML","__html","boxSizing","mockHistory","generateCharacterHistory","c","borderLeft","jsx","BACKEND_URL","getBackendUrl","process","REACT_APP_BACKEND_URL","hostname","location","API_BASE","VersetParVersetPage","content","bookInfo","currentBatch","setCurrentBatch","isLoadingMore","setIsLoadingMore","allVersetsBatches","setAllVersetsBatches","totalVersetsExpected","setTotalVersetsExpected","enrichingVersets","setEnrichingVersets","useEffect","prev","_objectSpread","getCurrentBatchContent","handleEnrichirVerset","versetNumber","currentContent","versetRegex","match","versetText","currentExplication","enrichKey","apiUrl","prompt","response","fetch","method","headers","body","JSON","stringify","passage","version","tokens","use_gemini","enriched","custom_prompt","ok","Error","data","json","currentBatchContent","versetPattern","enrichedExplication","enrichedContent","enrichirExplicationGemini","cleanMarkdownFormatting","position","top","zIndex","overflow","left","right","bottom","pointerEvents","backdropFilter","textShadow","sections","exec","parseInt","parts","split","versetTitle","texteContent","explicationContent","i","part","_parts","_parts2","number","texte","explication","parseContentWithGeminiButtons","section","whiteSpace","line","lineIndex","React","Fragment","goToPreviousBatch","nextBatch","startVerse","endVerse","bookChapter","requestPassage","NotesPage","notes","setNotes","lastSaved","setLastSaved","isSaving","setIsSaving","saveCount","setSaveCount","textareaRef","useRef","autoSaveIntervalRef","STORAGE_KEYS","saveNotesToStorage","notesContent","timestamp","Date","toISOString","metadata","contentLength","localStorage","setItem","loadedNotes","loadNotesFromStorage","savedNotes","getItem","parsed","parse","current","clearInterval","setInterval","handleBeforeUnload","handleVisibilityChange","document","hidden","addEventListener","removeEventListener","ref","outline","resize","formatLastSaved","date","diffMs","diffMinutes","Math","floor","diffHours","toLocaleDateString","toLocaleTimeString","handleManualSave","success","borderColor","paddingLeft","ApiControlPanel","backendUrl","isOpen","setIsOpen","apiStatus","setApiStatus","lastUpdate","setLastUpdate","apiHistory","setApiHistory","showHistory","setShowHistory","showTooltip","setShowTooltip","fetchApiStatus","healthData","adaptedStatus","apis","gemini_1","name","gemini_2","gemini_3","gemini_4","bible_api","bible_api_configured","call_history","active_api","current_key","fetchApiHistory","adaptedHistory","total_calls","history","interval","getLedColor","apiInfo","textTransform","letterSpacing","values","every","api","flexDirection","_ref2","marginRight","_ref3","borderBottom","paddingBottom","_ref4","success_count","error_count","last_used","reverse","call","api_name","content_length","paddingTop","RubriquePage","rubriqueNumber","rubriqueTitle","onNavigateToRubrique","selectedBook","selectedChapter","selectedVerse","selectedLength","setCurrentPage","setContent","setRubriquesStatus","BASE_RUBRIQUES","isApiModalOpen","setIsApiModalOpen","getStatusIcon","rubriqueColor","colors","start","end","default","getRubriqueColor","p","enrichedLength","min","rubrique_context","err","message","warn","handleChatGPTAction","handleNotesAction","handleBibleAction","code","url","origin","formatRubriqueContent","keys","fallback_active","getButtonStyle","gradientColors","shadowColor","isHovered","arguments","undefined","buttonColors","shadow","postProcessMarkdown","t","x","_unused","String","asString","BOOKS","BOOK_CHAPTERS","getRubTitle","SelectPill","label","options","o","App","setSelectedBook","setSelectedChapter","setSelectedVerse","selectedVersion","setSelectedVersion","setSelectedLength","activeRubrique","setActiveRubrique","generatedRubriques","setGeneratedRubriques","currentTheme","setCurrentTheme","lastStudy","setLastStudy","progressPercent","setProgressPercent","searchQuery","setSearchQuery","isProgressiveLoading","setIsProgressiveLoading","currentBatchVerse","setCurrentBatchVerse","progressiveStats","setProgressiveStats","isVersetsProgContent","setIsVersetsProgContent","currentVerseCount","setCurrentVerseCount","canContinueVerses","setCanContinueVerses","currentPage","versetPageContent","setVersetPageContent","currentBookInfo","setCurrentBookInfo","currentRubriqueNumber","setCurrentRubriqueNumber","currentRubriqueContent","setCurrentRubriqueContent","colorThemes","primary","secondary","accent","headerBg","availableChapters","useMemo","max","Array","from","_","saved","beforeUnload","saveCurrentStudy","documentElement","setProperty","hexToRgba","hex","alpha","r","g","b","changePalette","currentStudy","displayTitle","rubriquesItems","generateRubriqueContent","rubriqueNum","targetLength","getRubriqueLength","generatePrayerContent","generateStructureContent","generatePreviousChapterContent","generateDoctrinalThemeContent","generateTheologicalFoundationsContent","generateHistoricalContextContent","generateCulturalContextContent","generateGeographicalContextContent","generateLexicalAnalysisContent","generateBiblicalParallelsContent","generateProphecyContent","generateCharactersContent","generateRhetoricalStructureContent","generateTrinityTheologyContent","generateChristCenteredContent","generateGospelGraceContent","generatePersonalApplicationContent","generateCommunityApplicationContent","generateResponsePrayerContent","generateStudyQuestionsContent","generateVigilancePointsContent","generateObjectionsResponsesContent","generateMissionalPerspectiveContent","generateChristianEthicsContent","generateWorshipLiturgyContent","generateGuidedMeditationContent","generateMemoryVersesContent","generateActionPlanContent","generateDefaultContent","baseContent","navigateToVersets","navigateToNotes","navigateToRubrique","navigateToMain","handleRubriqueSelect","contentKey","generatedContent","generateSingleRubrique","nextTheme","app","querySelector","header","progressPill","contentHeader","btnReset","btnPalette","btnLastStudy","btnGemini","btnVersets","btnGenerate","btnValidate","contentEnCours","formatContent","rubriqueContent","selected_rubriques","rubriques","fullContent","substring","parseRubriquesContent","forEach","apiError","contentFinal","formattedContent","context","formattedText","join","htmlTags","tempText","processedRefs","Set","verse1","verse2","cleanMatch","has","add","youVersionUrl","tag","transformBibleReferences","newRubriqueNumber","speed","current_batch","processed","total","q","query","normalized","patterns","pat","m","bookName","found","find","parseSearchQuery","Number","openYouVersion","handleNotesClick","navigateToConcordance","handleReset","restoreLastStudy","rubric_type","finalContent","sourceInfo","source","fromCache","from_cache","cost","rubrique1Content","batch","endIndex","j","all","progress","generateRemainingRubriques","then","catch","newContent","formattedNewContent","createRoot","getElementById","render","innerHTML"],"mappings":"sPAuDeA,MArDf,SAAwBC,GAAkD,IAAjD,MAAEC,EAAK,SAAEC,EAAQ,SAAEC,EAAQ,gBAAEC,GAAiBJ,EACrE,IAAKC,GAA0B,IAAjBA,EAAMI,OAClB,OAAOC,cAAA,OAAAC,SAAK,+BAGd,MAAMC,EAAeC,IACnB,MAAMC,EAASN,EAAgBK,GAC/B,MAAe,cAAXC,EAA+B,UACpB,gBAAXA,EAAiC,UACtB,aAAXA,EAA8B,UACnB,UAAXA,EAA2B,UACxB,WAGT,OACEJ,cAAA,OAAKK,UAAU,iBAAgBJ,SAC5BN,EAAMW,IAAKC,GACVC,eAAA,OAEEH,UAAS,iBAAAI,OAAmBb,IAAaW,EAAKG,GAAK,SAAW,GAAE,KAAAD,OACjC,cAA7BX,EAAgBS,EAAKG,IAAsB,YAAc,IAE3DC,QAASA,IAAMd,GAAYA,EAASU,EAAKG,IAAIT,SAAA,CAE7CD,cAAA,QAAMK,UAAU,kBAAiBJ,SAAEM,EAAKG,KACxCV,cAAA,QAAMK,UAAU,iBAAgBJ,SAAEM,EAAKK,QAGvCZ,cAAA,OACEK,UAAU,eACVQ,MAAO,CACLC,MAAO,OACPC,OAAQ,OACRC,aAAc,MACdC,gBAAiBf,EAAYK,EAAKG,IAClCQ,OAAQ,iBACRC,UAAU,WAADV,OAAaP,EAAYK,EAAKG,KACvCU,WAAY,OACZC,WAAY,GAEdT,MAC+B,cAA7Bd,EAAgBS,EAAKG,IAAsB,aACd,gBAA7BZ,EAAgBS,EAAKG,IAAwB,WAChB,aAA7BZ,EAAgBS,EAAKG,IAAqB,kBACb,UAA7BZ,EAAgBS,EAAKG,IAAkB,SAAW,sBA1BjDH,EAAKG,MAiCpB,ECq8BeY,MAx/Bc5B,IAAmB,IAAlB,SAAE6B,GAAU7B,EACxC,MAAO8B,EAAYC,GAAiBC,mBAAS,KACtCC,EAASC,GAAcF,mBAAS,KAChCG,EAAWC,GAAgBJ,oBAAS,IAGpCK,EAAqBC,GAA0BN,mBAAS,KACxDO,EAAkBC,GAAuBR,mBAAS,KAClDS,EAAoBC,GAAyBV,oBAAS,IACtDW,EAAmBC,GAAwBZ,mBAAS,OACpDa,EAAkBC,GAAuBd,mBAAS,KAClDe,EAAWC,GAAgBhB,mBAAS,eAGrCiB,EAAqB,CAEzB,UAAW,QAAS,QAAS,WAAS,QAAS,UAAW,SAAO,OAAQ,SACzE,UAAQ,OAAQ,WAAS,aAAc,SAAU,WAAY,OAAQ,UACrE,QAAS,WAAS,SAAU,UAAQ,WAAY,UAAW,OAAQ,QACnE,OAAQ,UAAQ,eAAU,gBAAW,cAAS,iBAAY,SAAU,QACpE,MAAO,SAAU,eAAa,OAAQ,gBAAW,SAAU,YAC3D,eAAU,SAAU,SAAU,aAAW,QAAS,YAAU,QAE5D,WAAS,QAAS,SAAU,gBAAiB,SAAU,OAAQ,OAC/D,UAAW,WAAS,WAAY,gBAAc,WAAY,SAC1D,2BAAyB,qBAAmB,OAAQ,kBACpD,kBAAmB,SAAU,SAAU,uBAAqB,cAC5D,YAAU,SAAU,YAAU,OAAQ,YAAU,WAAY,cAC5D,OAAQ,cAAY,QAAS,YAAa,SAAU,UAAW,SAC/DC,OAyCIC,EAAgCC,IAClB,CAChB,QAAU,u9IA6DV,MAAQ,gnKAyBOA,IAAU,cAAArC,OACpBqC,EAAS,4EAAArC,OAEWqC,EAAS,gdAyJhCC,EAAyBC,UAC7B,IAAKxB,GAAcA,EAAWyB,OAAOlD,OAAS,EAC5C6B,EAAW,QADb,CAKAE,GAAa,GAEb,UACQ,IAAIoB,QAAQC,GAAWC,WAAWD,EAAS,MACjD,MAAME,EArF0BC,KAClC,MAAMC,EAAa,CACjB,MAAS,CACP,CAAEC,KAAM,OAAQC,QAAS,EAAGC,MAAO,GAAIC,KAAM,+JAC7C,CAAEH,KAAM,gBAAiBC,QAAS,GAAIC,MAAO,EAAGC,KAAM,yIACtD,CAAEH,KAAM,SAAUC,QAAS,EAAGC,MAAO,EAAGC,KAAM,gEAC9C,CAAEH,KAAM,SAAUC,QAAS,EAAGC,MAAO,GAAIC,KAAM,qEAC/C,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,qTAChD,CAAEH,KAAM,gBAAiBC,QAAS,GAAIC,MAAO,GAAIC,KAAM,8IACvD,CAAEH,KAAM,kBAAaC,QAAS,EAAGC,MAAO,GAAIC,KAAM,kJAEpD,KAAQ,CACN,CAAEH,KAAM,OAAQC,QAAS,GAAIC,MAAO,GAAIC,KAAM,4JAC9C,CAAEH,KAAM,cAAeC,QAAS,EAAGC,MAAO,EAAGC,KAAM,qHACnD,CAAEH,KAAM,cAASC,QAAS,GAAIC,MAAO,EAAGC,KAAM,wGAC9C,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,EAAGC,KAAM,2GAC/C,CAAEH,KAAM,OAAQC,QAAS,GAAIC,MAAO,GAAIC,KAAM,wJAEhD,IAAO,CACL,CAAEH,KAAM,aAAWC,QAAS,GAAIC,MAAO,EAAGC,KAAM,qHAChD,CAAEH,KAAM,UAAWC,QAAS,GAAIC,MAAO,GAAIC,KAAM,2FACjD,CAAEH,KAAM,kBAAaC,QAAS,EAAGC,MAAO,EAAGC,KAAM,qIACjD,CAAEH,KAAM,OAAQC,QAAS,GAAIC,MAAO,GAAIC,KAAM,2DAC9C,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,EAAGC,KAAM,oGAC/C,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,gGAElD,KAAQ,CACN,CAAEH,KAAM,gBAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,wQAChD,CAAEH,KAAM,SAAUC,QAAS,GAAIC,MAAO,GAAIC,KAAM,yIAChD,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,8JAChD,CAAEH,KAAM,OAAQC,QAAS,GAAIC,MAAO,GAAIC,KAAM,8FAC9C,CAAEH,KAAM,WAAYC,QAAS,EAAGC,MAAO,EAAGC,KAAM,iIAElD,OAAU,CACR,CAAEH,KAAM,UAAWC,QAAS,GAAIC,MAAO,GAAIC,KAAM,sKACjD,CAAEH,KAAM,gBAAWC,QAAS,GAAIC,MAAO,GAAIC,KAAM,oKACjD,CAAEH,KAAM,WAAYC,QAAS,EAAGC,MAAO,EAAGC,KAAM,mOAChD,CAAEH,KAAM,aAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,6FAElD,QAAW,CACT,CAAEH,KAAM,YAAaC,QAAS,EAAGC,MAAO,EAAGC,KAAM,2HACjD,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,EAAGC,KAAM,yJAC/C,CAAEH,KAAM,YAAaC,QAAS,EAAGC,MAAO,GAAIC,KAAM,yFAClD,CAAEH,KAAM,iBAAeC,QAAS,EAAGC,MAAO,GAAIC,KAAM,8KAEtD,OAAU,CACR,CAAEH,KAAM,SAAUC,QAAS,EAAGC,MAAO,EAAGC,KAAM,uIAC9C,CAAEH,KAAM,WAAYC,QAAS,EAAGC,MAAO,GAAIC,KAAM,gGACjD,CAAEH,KAAM,aAAcC,QAAS,EAAGC,MAAO,GAAIC,KAAM,uLACnD,CAAEH,KAAM,kBAAaC,QAAS,EAAGC,MAAO,GAAIC,KAAM,qIAEpD,YAAU,CACR,CAAEH,KAAM,oBAAqBC,QAAS,EAAGC,MAAO,GAAIC,KAAM,qBAC1D,CAAEH,KAAM,cAAeC,QAAS,EAAGC,MAAO,EAAGC,KAAM,uKACnD,CAAEH,KAAM,WAAYC,QAAS,EAAGC,MAAO,EAAGC,KAAM,uGAChD,CAAEH,KAAM,UAAWC,QAAS,EAAGC,MAAO,GAAIC,KAAM,gLAI9CC,EAAYN,EAAKO,cACjBC,EAAkB,GAExB,IAAK,MAAOC,EAAKC,KAAWC,OAAOC,QAAQX,IACrCQ,EAAII,SAASP,IAAcA,EAAUO,SAASJ,KAChDD,EAAgBM,QAAQJ,GAQ5B,OAJsBF,EAAgBO,OAAO,CAACX,EAAOY,EAAOC,IAC1DA,EAAIC,UAAUC,GAAKA,EAAEjB,OAASE,EAAMF,MAAQiB,EAAEhB,UAAYC,EAAMD,SAAWgB,EAAEf,QAAUA,EAAMA,SAAWY,GAGrFI,MAAM,EAAG,KAaRC,CAA2BnD,EAAWyB,QAC1DrB,EAAWyB,EACb,CAAE,MAAOuB,GACPC,QAAQD,MAAM,uBAAwBA,GACtChD,EAAW,GACb,CAAC,QACCE,GAAa,EACf,CAbA,GAiCIgD,EAAsBA,CAACnB,EAAML,KACjC,IAAKA,EAAM,OAAOK,EAClB,MAAMoB,EAAQ,IAAIC,OAAO,IAADvE,OAAK6C,EAAI,KAAK,MACtC,OAAOK,EAAKsB,QAAQF,EAAO,uGAG7B,OACEvE,eAAA,OAAKK,MAAO,CACVqE,UAAW,QACXC,WAAY,sFACZC,WAAY,qBACZnF,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACVwE,QAAS,YACTC,UAAW,SACXC,MAAO,SACPtF,SAAA,CACAD,cAAA,UACEW,QAASY,EACTV,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,MACdwE,OAAQ,UACRC,aAAc,QACdxF,SACH,kCAIDD,cAAA,MAAIa,MAAO,CACT6E,SAAU,SACVC,WAAY,MACZC,OAAQ,cACR3F,SAAC,sCAIHD,cAAA,KAAGa,MAAO,CACR6E,SAAU,SACVG,QAAS,IACT5F,SAAC,wEAKHO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTC,eAAgB,SAChBC,IAAK,OACLC,UAAW,QACXhG,SAAA,CACAD,cAAA,UACEW,QAASA,IAAM+B,EAAa,eAC5B7B,MAAO,CACLsE,WAA0B,gBAAd1C,EAA8B,2BAA6B,2BACvEvB,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,MACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZO,WAAY,gBACZJ,QAAS,OACTK,WAAY,SACZH,IAAK,OACL/F,SACH,6BAGDD,cAAA,UACEW,QAASA,IAAM+B,EAAa,cAC5B7B,MAAO,CACLsE,WAA0B,eAAd1C,EAA6B,2BAA6B,2BACtEvB,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,MACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZO,WAAY,gBACZJ,QAAS,OACTK,WAAY,SACZH,IAAK,OACL/F,SACH,6CAOU,gBAAdwC,EAECzC,cAAAoG,WAAA,CAAAnG,SAEED,cAAA,OAAKa,MAAO,CACVwF,SAAU,QACVT,OAAQ,cACRP,QAAS,UACTpF,SACAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,OACTlE,UAAW,iCACXlB,SAAA,CACAD,cAAA,MAAIa,MAAO,CACT+E,OAAQ,aACRL,MAAO,OACPG,SAAU,OACVC,WAAY,QACZ1F,SAAC,4CAGHD,cAAA,QAAMsG,SAzIUC,IAC1BA,EAAEC,iBACFzD,EAAuBvB,IAuIsBvB,SACjCO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTE,IAAK,OACLP,aAAc,QACdxF,SAAA,CACAD,cAAA,SACEyG,KAAK,OACLC,MAAOlF,EACPmF,SAAWJ,GAAM9E,EAAc8E,EAAEK,OAAOF,OACxCG,YAAY,qCACZhG,MAAO,CACLiG,KAAM,EACNzB,QAAS,OACTnE,OAAQ,iBACRF,aAAc,MACd0E,SAAU,UAGd1F,cAAA,UACEyG,KAAK,SACLM,SAAUlF,EACVhB,MAAO,CACLsE,WAAY,oDACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,YACTrE,aAAc,MACdwE,OAAQ3D,EAAY,cAAgB,UACpCgE,QAAShE,EAAY,GAAM,EAC3BmF,SAAU,SACV/G,SAED4B,EAAY,eAAiB,eAIhC7B,cAAA,UACEyG,KAAK,SACL9F,QAhVcqC,UAC9B,GAAKxB,EAAWyB,OAAhB,CAKAnB,GAAa,GACb,UAEQ,IAAIoB,QAAQC,GAAWC,WAAWD,EAAS,MAGjD,MAAM8D,EAAkB,IACnBtF,EAEH,CAAE6B,KAAM,YAAaC,QAAS,EAAGC,MAAO,GAAIC,KAAK,yCAADlD,OAA2Ce,EAAU,gFACrG,CAAEgC,KAAM,SAAUC,QAAS,IAAKC,MAAO,IAAKC,KAAK,gDAADlD,OAA+Ce,EAAU,2DAG3GI,EAAWqF,GACXpC,QAAQqC,IAAI,6CAADzG,OAA8Ce,EAAU,KACrE,CAAE,MAAOoD,GACPC,QAAQD,MAAM,6BAA8BA,EAC9C,CAAC,QACC9C,GAAa,EACf,CArBA,MAFEqF,MAAM,qDA+UQJ,SAAUlF,IAAcL,EAAWyB,OACnCpC,MAAO,CACLsE,WAAY,4CACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,YACTrE,aAAc,MACdwE,OAAQ3D,IAAcL,EAAWyB,OAAS,cAAgB,UAC1D4C,QAAShE,IAAcL,EAAWyB,OAAS,GAAM,EACjD+D,SAAU,QACVtB,SAAU,OACVC,WAAY,MACZG,QAAS,OACTK,WAAY,SACZH,IAAK,OAEPpF,MAAM,yCAAwCX,SAC/C,6BAOLO,eAAA,OAAKK,MAAO,CAAE4E,aAAc,QAASxF,SAAA,CACnCD,cAAA,MAAIa,MAAO,CACTyE,UAAW,SACXC,MAAO,UACPG,SAAU,SACVC,WAAY,MACZF,aAAc,OACdN,WAAY,4CACZiC,qBAAsB,OACtBC,oBAAqB,cACrBC,eAAgB,QAChBrH,SAAC,2EAIHD,cAAA,OAAKa,MAAO,CACViF,QAAS,OACTyB,oBAAqB,uCACrBvB,IAAK,OACLK,SAAU,SACVT,OAAQ,UACR3F,SACC,CACC,QAAS,WAAS,MAAO,QAAS,OAAQ,OAC1C,eAAa,SAAU,gBAAc,gBACrC,iBAAkB,kBAAgB,mBAAiB,kBACnD,aAAc,aAAW,eAAgB,YACzC,UAAW,YAAa,gBAAc,cACtC,aAAc,iBAAe,eAAU,UACvC,UAAW,cAAY,aAAc,UACrCK,IAAKkH,GACLxH,cAAA,UAEEW,QAASA,KACPc,EAAc+F,GACdzE,EAAuByE,IAEzB3G,MAAO,CACLsE,WAAY,yEACZjE,OAAQ,oCACRqE,MAAO,UACPF,QAAS,YACTrE,aAAc,OACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZO,WAAY,gBACZ/E,UAAW,4BACXmE,UAAW,UAEbmC,YAAclB,IACZA,EAAEK,OAAO/F,MAAMsE,WAAa,4CAC5BoB,EAAEK,OAAO/F,MAAM0E,MAAQ,QACvBgB,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,sCAE7BwG,WAAapB,IACXA,EAAEK,OAAO/F,MAAMsE,WAAa,yEAC5BoB,EAAEK,OAAO/F,MAAM0E,MAAQ,UACvBgB,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,6BAC3BlB,SAEDuH,GA/BIA,SAsCbhH,eAAA,OAAKK,MAAO,CACViF,QAAS,OACT8B,SAAU,OACV5B,IAAK,OACLD,eAAgB,SAChBN,aAAc,QACdxF,SAAA,CACAD,cAAA,KAAGa,MAAO,CACRC,MAAO,OACPwE,UAAW,SACXC,MAAO,UACPG,SAAU,OACVC,WAAY,MACZC,OAAQ,cACR3F,SAAC,yBAGF,CAAC,UAAW,eAAa,SAAU,WAAY,oBAAe,cAAS,cAAY,YAAYK,IAAKuH,GACnG7H,cAAA,UAEEW,QAASA,IAAMc,EAAcoG,GAC7BhH,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,oCACRqE,MAAO,UACPF,QAAS,WACTrE,aAAc,OACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZO,WAAY,gBACZ/E,UAAW,6BACXlB,SAED4H,GAfIA,OAqBX7H,cAAA,OAAKa,MAAO,CACVyE,UAAW,UACXrF,SACAD,cAAA,UACEW,QAjTkBmH,KAChC,MAAMC,EAAYvG,EAAU,wCAAAf,OACgBuH,mBAAmBxG,IAC3D,yBACJyG,OAAOC,KAAKH,EAAW,WA8STlH,MAAO,CACLsE,WAAY,oDACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,YACTrE,aAAc,MACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,OACZ1F,SACH,gDASTD,cAAAoG,WAAA,CAAAnG,SAEED,cAAA,OAAKa,MAAO,CACVwF,SAAU,QACVT,OAAQ,cACRP,QAAS,UACTpF,SACAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,OACTlE,UAAW,iCACXlB,SAAA,CACAD,cAAA,MAAIa,MAAO,CACT+E,OAAQ,aACRL,MAAO,OACPG,SAAU,OACVC,WAAY,QACZ1F,SAAC,oDAIDoC,EA2FA7B,eAAA,OAAAP,SAAA,CACEO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZV,aAAc,QACdxF,SAAA,CACAO,eAAA,MAAIK,MAAO,CACT+E,OAAQ,EACRL,MAAO,OACPG,SAAU,OACVC,WAAY,QACZ1F,SAAA,CAAC,4BACeoC,KAElB7B,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTE,IAAK,OACLG,WAAY,UACZlG,SAAA,CAEAD,cAAA,UACEW,QAzlBQqC,UAC5B,GAAKX,EAAL,CAKAD,GAAsB,GACtB,UAEQ,IAAIc,QAAQC,GAAWC,WAAWD,EAAS,MAEjD,MAAMgF,EAAe,KAAA1H,OACzB8B,EAAgB,yIAAA9B,OAK6B4B,EAAiB,uPAAA5B,OAGW4B,EAAiB,qRAOtFG,EAAoB2F,GACpBtD,QAAQqC,IAAI,2CAADzG,OAA4C4B,GACzD,CAAE,MAAOuC,GACPC,QAAQD,MAAM,4BAA6BA,EAC7C,CAAC,QACCxC,GAAsB,EACxB,CA7BA,MAFE+E,MAAM,4DAwlBYJ,SAAU5E,EACVtB,MAAO,CACLsE,WAAY,4CACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,YACTrE,aAAc,MACdwE,OAAQrD,EAAqB,cAAgB,UAC7C0D,QAAS1D,EAAqB,GAAM,EACpCuD,SAAU,OACVC,WAAY,MACZG,QAAS,OACTK,WAAY,SACZH,IAAK,OAEPpF,MAAM,0BAAyBX,SAChC,wBAIDD,cAAA,UACEW,QAASA,KACP2B,EAAqB,MACrBE,EAAoB,IACpBR,EAAuB,KAEzBnB,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,qCACRqE,MAAO,UACPF,QAAS,WACTrE,aAAc,MACdwE,OAAQ,UACRE,SAAU,QACVzF,SACH,sCAMJkC,EACC3B,eAAA,OAAKK,MAAO,CACVyE,UAAW,SACXD,QAAS,aACTpF,SAAA,CACAD,cAAA,OAAKa,MAAO,CACVC,MAAO,OACPC,OAAQ,OACRG,OAAQ,oBACRkH,UAAW,oBACXpH,aAAc,MACdqH,UAAW,0BACXzC,OAAQ,iBAEVpF,eAAA,KAAGK,MAAO,CACR0E,MAAO,OACPG,SAAU,OACVE,OAAQ,GACR3F,SAAA,CAAC,iDACqCoC,EAAkB,SAE1DrC,cAAA,KAAGa,MAAO,CACR0E,MAAO,OACPG,SAAU,OACVE,OAAQ,WACR3F,SAAC,iDAKLD,cAAA,OAAKa,MAAO,CACVsE,WAAY,4CACZjE,OAAQ,oCACRF,aAAc,OACdqE,QAAS,OACTiD,UAAW,QACXC,UAAW,OACX7C,SAAU,OACV8C,WAAY,MACZrH,UAAW,+BACXlB,SACAD,cAAA,OAAKyI,wBAAyB,CAC5BC,OAAQnG,EACL0C,QAAQ,MAAO,QAEfA,QAAQ,YAAa,0PAErBA,QAAQ,uBAAwB,iJAEhCA,QAAQ,iBAAkB,iEAE1BA,QAAQ,aAAc,2DAEtBA,QAAQ,mNACP,+eAEDA,QAAQ,kBAAmB,gIAC3BA,QAAQ,IAAK,0HACbA,QAAQ,IAAK,gBApNxBzE,eAAA4F,WAAA,CAAAnG,SAAA,CACED,cAAA,OAAKa,MAAO,CACV4E,aAAc,QACdxF,SACAD,cAAA,SACEyG,KAAK,OACLC,MAAO3E,EACP4E,SAAWJ,GAAMvE,EAAuBuE,EAAEK,OAAOF,OACjDG,YAAY,2CACZhG,MAAO,CACLC,MAAO,OACPuE,QAAS,OACTnE,OAAQ,iBACRF,aAAc,MACd0E,SAAU,OACViD,UAAW,kBAMjBnI,eAAA,OAAKH,UAAU,2BAA2BQ,MAAO,CAC/CiF,QAAS,OACTyB,oBAAqB,uCACrBvB,IAAK,OACLsC,UAAW,QACXC,UAAW,OACXrH,OAAQ,iBACRF,aAAc,MACdqE,QAAS,OACTvE,MAAO,OACP6H,UAAW,cACX1I,SAAA,CACC0C,EACE0B,OAAOvB,GACkB,KAAxBf,GACAe,EAAUe,cAAcM,SAASpC,EAAoB8B,gBAEtDvD,IAAIwC,GACH9C,cAAA,UAEEW,QAASA,IA7rBAqC,WAC/BZ,GAAsB,GACtBE,EAAqBQ,GAErB,UAEQ,IAAII,QAAQC,GAAWC,WAAWD,EAAS,OAGrC,mDAAA1C,OAA6CqC,EAAS,4lBAAlE,MAiBM8F,EAAc/F,EAA6BC,GACjDN,EAAoBoG,EAEtB,CAAE,MAAOhE,GACPC,QAAQD,MAAM,oCAA+BA,GAC7CpC,EAAoB,kEACtB,CAAC,QACCJ,GAAsB,EACxB,GA2pBqCyG,CAAyB/F,GACxCzC,UAAU,yBACVQ,MAAO,CACLsE,WAAY,0BACZjE,OAAQ,oCACRqE,MAAO,UACPF,QAAS,WACTrE,aAAc,MACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZO,WAAY,gBACZZ,UAAW,SACXxE,MAAO,OACP6H,UAAW,aACXzD,UAAW,OACXY,QAAS,OACTK,WAAY,SACZJ,eAAgB,UAElB0B,YAAclB,IACZA,EAAEK,OAAO/F,MAAMsE,WAAa,0BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,oBAE7BC,WAAapB,IACXA,EAAEK,OAAO/F,MAAMsE,WAAa,0BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,iBAC3BzH,SAED6C,GA9BIA,IAgCN,QAGNf,GAEY,IAFWY,EAAmB0B,OAAOyE,GAChDA,EAAEjF,cAAcM,SAASpC,EAAoB8B,gBAC7C9D,QACAS,eAAA,OAAKK,MAAO,CACVyE,UAAW,SACXD,QAAS,OACTE,MAAO,OACPG,SAAU,QACVzF,SAAA,CAAC,oCAC8B8B,EAAoB,iBA4IpD,gBAAdU,GACCzC,cAAA,OAAKa,MAAO,CACVwF,SAAU,SACVT,OAAQ,cACRP,QAAS,UACTpF,SAEC4B,EACCrB,eAAA,OAAKK,MAAO,CAAEyE,UAAW,SAAUD,QAAS,QAASpF,SAAA,CACnDD,cAAA,OAAKa,MAAO,CACVC,MAAO,OACPC,OAAQ,OACRG,OAAQ,oBACRkH,UAAW,oBACXpH,aAAc,MACdqH,UAAW,0BACXzC,OAAQ,YAEV5F,cAAA,KAAGa,MAAO,CAAE0E,MAAO,QAASU,UAAW,QAAShG,SAAC,6BAIjD0B,EAAQ5B,OAAS,EACnBS,eAAA,OAAAP,SAAA,CACEO,eAAA,MAAIK,MAAO,CACTyE,UAAW,SACXC,MAAO,QACPG,SAAU,SACVD,aAAc,QACdxF,SAAA,CAAC,gBACG0B,EAAQ5B,OAAO,yBAAoByB,EAAW,OAEpDxB,cAAA,OAAKa,MAAO,CACViF,QAAS,OACTE,IAAK,QACL/F,SACC0B,EAAQrB,IAAI,CAACoD,EAAOY,IACnB9D,eAAA,OAEEK,MAAO,CACLsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,OACTlE,UAAW,gCACX4H,WAAY,qBACZ9I,SAAA,CAEFO,eAAA,OAAKK,MAAO,CACV0E,MAAO,UACPG,SAAU,OACVC,WAAY,OACZF,aAAc,QACdxF,SAAA,CACCyD,EAAMF,KAAK,IAAEE,EAAMD,QAAQ,IAAEC,EAAMA,SAEtC1D,cAAA,OACEa,MAAO,CACL0E,MAAO,UACPiD,WAAY,OAEdC,wBAAyB,CACvBC,OAAQ5D,EAAoBpB,EAAMC,KAAMnC,QAvBvC8C,SA8BX9C,EAAWzB,OAAS,EACtBS,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,OACTC,UAAW,UACXrF,SAAA,CACAO,eAAA,MAAIK,MAAO,CAAE0E,MAAO,WAAYtF,SAAA,CAAC,wCACNuB,EAAW,OAEtCxB,cAAA,KAAGa,MAAO,CAAE0E,MAAO,OAAQG,SAAU,OAAQO,UAAW,QAAShG,SAAC,kEAG9D,OASZD,cAAA,SAAOgJ,KAAG,EAAA/I,SAAA,iJC7+BhB,MASMgJ,EATgBC,MACpB,GAAIC,oIAAYC,sBACd,OAAOD,oIAAYC,sBAErB,MAAMC,EAAWpB,OAAOqB,SAASD,SACjC,MAAiB,cAAbA,GAAyC,cAAbA,EAAiC,wBAC1D,oDAGWH,GACdK,EAAQ,GAAA9I,OAAMwI,EAAYhE,QAAQ,QAAS,IAAG,QAmsBrCuE,MAjsBa9J,IAAsC,IAArC,SAAE6B,EAAQ,QAAEkI,EAAO,SAAEC,GAAUhK,EAC1D,MAAOiK,EAAcC,GAAmBlI,mBAAS,IAC1CmI,EAAeC,GAAoBpI,oBAAS,IAC5CqI,EAAmBC,GAAwBtI,mBAAS,CAAC,IACrDuI,EAAsBC,GAA2BxI,mBAAS,OAC1DyI,EAAkBC,GAAuB1I,mBAAS,CAAC,GAE1D2I,oBAAU,KAEJZ,IACFO,EAAqBM,GAAIC,wBAAA,GACpBD,GAAI,IACP,EAAGb,KAELG,EAAgB,KAEjB,CAACH,IAGJ,MAmJMe,EAAyBA,IACtBT,EAAkBJ,IAAiB,GAItCc,EAAuBzH,UAC3B6B,QAAQqC,IAAI,uCAADzG,OAAwCiK,IAGnD,MAAMC,EAAiBH,IACjBI,EAAc,IAAI5F,OAAO,UAADvE,OAAWiK,EAAY,gHAA6G,KAC5JG,EAAQF,EAAeE,MAAMD,GAEnC,GAAIC,EAAO,CACT,MAAMC,EAAaD,EAAM,GAAG5H,OACtB8H,EAAqBF,EAAM,GAAG5H,YAlKND,OAAO0H,EAAcK,EAAoBD,KACzE,MAAME,EAAS,GAAAvK,OAAMkJ,EAAY,KAAAlJ,OAAIiK,GAErC,IAAIP,EAAiBa,GAArB,CAEAZ,EAAoBE,GAAIC,wBAAA,GAASD,GAAI,IAAE,CAACU,IAAY,KAEpD,IACEnG,QAAQqC,IAAI,iDAADzG,OAAkDiK,EAAY,WAAAjK,OAAUkJ,IAEnF,MAAMsB,EAAM,GAAAxK,OAAM8I,EAAQ,4BAEpB2B,EAAM,kEAAAzK,OAEGqK,EAAU,+BAAArK,OACLsK,EAAkB,ubAehCI,QAAiBC,MAAMH,EAAQ,CACnCI,OAAQ,OACRC,QAAS,CAAC,eAAgB,oBAC1BC,KAAMC,KAAKC,UAAU,CACnBC,QAAQ,gCACRC,QAAS,MACTC,OAAQ,IACRC,YAAY,EACZC,UAAU,EACVC,cAAeb,MAInB,IAAKC,EAASa,GAAI,MAAM,IAAIC,MAAM,eAADxL,OAAgB0K,EAAS/K,SAE1D,MAAM8L,QAAaf,EAASgB,OAE5B,GAAID,EAAKzC,QAAS,CAEhB,MAAM2C,EAAsBrC,EAAkBJ,GACxC0C,EAAgB,IAAIrH,OAAO,WAADvE,OAAYiK,EAAY,4EAAyE,KAE3H4B,EAAsBJ,EAAKzC,QAAQxE,QAAQ,oCAAkC,IAAIhC,OACjFsJ,EAAkBH,EAAoBnH,QAAQoH,EAAc,OAAD5L,OAAS6L,EAAmB,OAG7FtC,EAAqBM,GAAIC,wBAAA,GACpBD,GAAI,IACP,CAACX,GAAe4C,KAGlB1H,QAAQqC,IAAI,kCAADzG,OAAmCiK,EAAY,2BAC5D,CAEF,CAAE,MAAO9F,GACPC,QAAQD,MAAM,yCAADnE,OAA0CiK,EAAY,KAAK9F,EAC1E,CAAC,QACCwF,EAAoBE,GAAIC,wBAAA,GAASD,GAAI,IAAE,CAACU,IAAY,IACtD,CAjEuC,GAiK/BwB,CAA0B9B,EAAcK,EAAoBD,EACpE,GAII2B,EAA2B9I,GAC1BA,EAEEA,EAEJsB,QAAQ,QAAS,IAEjBA,QAAQ,mBAAoB,IAE5BA,QAAQ,OAAQ,KAEhBA,QAAQ,gBAAiB,QACzBhC,OAXe,GAyEpB,OACEzC,eAAA,OAAKK,MAAO,CACVqE,UAAW,QACXC,WAAY,uHACZC,WAAY,wDACZnF,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,sFACZI,MAAO,QACPF,QAAS,YACTlE,UAAW,sCACXuL,SAAU,SACVC,IAAK,EACLC,OAAQ,IACRC,SAAU,UACV5M,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6L,SAAU,WACVC,IAAK,EACLG,KAAM,EACNC,MAAO,EACPC,OAAQ,EACR7H,WAAY,uGACZ8H,cAAe,UAGjBzM,eAAA,OAAKK,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACR8G,SAAU,WACVE,OAAQ,IACR3M,SAAA,CACAD,cAAA,UACEW,QAASY,EACTV,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,OACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZF,aAAc,OACdyH,eAAgB,aAChBhH,WAAY,iBAEduB,YAAclB,IACZA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,oBAE7BC,WAAapB,IACXA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,iBAC3BzH,SACH,kCAIDD,cAAA,MAAIa,MAAO,CACT6E,SAAU,6BACVC,WAAY,MACZC,OAAQ,YACRN,UAAW,SACX6H,WAAY,gCACZlN,SAAC,4CAIFyJ,GACClJ,eAAA,OAAKK,MAAO,CACV6E,SAAU,2BACVJ,UAAW,SACXO,QAAS,GACTF,WAAY,OACZ1F,SAAA,CACCyJ,EAAS,iBAAUC,EAAa,aAAgC,GAApBA,EAAe,GAAS,EAAE,IAAiB,EAAfA,EAAiB,aAOlG3J,cAAA,OAAKa,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACRP,QAAS,OAET,2BAA4B,CAC1BA,QAAS,SAEXpF,SACCuK,IACChK,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,yBACTlE,UAAW,iCACXD,OAAQ,qCACRsH,WAAY,MACZ9C,SAAU,yBACVD,aAAc,QACdxF,SAAA,CAjK6BwJ,KACrC,IAAKA,EAAS,MAAO,GAErB,MAAM2D,EAAW,GACXf,EAAgB,2DAEtB,IAAIxB,EACJ,KAAiD,QAAzCA,EAAQwB,EAAcgB,KAAK5D,KAAoB,CACrD,MAAMiB,EAAe4C,SAASzC,EAAM,IAI9B0C,EAHgB1C,EAAM,GAAG5H,OAGHuK,MAAM,wEAElC,IAAIC,EAAc,GACdC,EAAe,GACfC,EAAqB,GAEzB,IAAK,IAAIC,EAAI,EAAGA,EAAIL,EAAMxN,OAAQ6N,IAAK,CACrC,MAAMC,EAAON,EAAMK,GAAG3K,OAEtB,GAAI4K,EAAK1J,SAAS,YAChBsJ,EAAchB,EAAwBoB,QACjC,GAAIA,EAAKhD,MAAM,mBAAoB,CAAC,IAADiD,EACxCJ,EAAejB,GAAoC,QAAZqB,EAAAP,EAAMK,EAAI,UAAE,IAAAE,OAAA,EAAZA,EAAc7K,SAAU,IAC/D2K,GACF,MAAO,GAAIC,EAAKhD,MAAM,mCAAiC,CAAC,IAADkD,EACrDJ,EAAqBlB,GAAoC,QAAZsB,EAAAR,EAAMK,EAAI,UAAE,IAAAG,OAAA,EAAZA,EAAc9K,SAAU,IACrE2K,GACF,CACF,CAEAR,EAAShJ,KAAK,CACZ4J,OAAQtD,EACR9J,MAAO6M,EACPQ,MAAOP,EACPQ,YAAaP,GAEjB,CAEA,OAAOP,GA2HEe,CAA8B3D,KAA0BlK,IAAI,CAAC8N,EAAS9J,IACrE9D,eAAA,OAA0BK,MAAO,CAAE4E,aAAc,QAASxF,SAAA,CAExDD,cAAA,OAAKK,UAAU,gBAAeJ,SAC3BmO,EAAQxN,QAIVwN,EAAQH,OACPzN,eAAA4F,WAAA,CAAAnG,SAAA,CACED,cAAA,OAAKK,UAAU,uBAAsBJ,SAAC,qBACtCD,cAAA,OAAKa,MAAO,CACV4E,aAAc,OACdJ,QAAS,SACTE,MAAO,WACPtF,SACCmO,EAAQH,WAMdG,EAAQF,aACP1N,eAAA4F,WAAA,CAAAnG,SAAA,CACEO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,SACZJ,eAAgB,gBAChBC,IAAK,OACLP,aAAc,OACdmC,SAAU,QACV3H,SAAA,CACAD,cAAA,OAAKK,UAAU,oBAAoBQ,MAAO,CAAEiG,KAAM,IAAKE,SAAU,SAAU/G,SAAC,iCAK5ED,cAAA,UACEW,QAASA,IAAM8J,EAAqB2D,EAAQJ,QAC5CjH,SAAUoD,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,SACtDnN,MAAO,CACLsE,WAAYgF,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,SACpD,oDACA,oDACJzI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,+CACTrE,aAAc,MACd0E,SAAU,yBACVC,WAAY,MACZH,OAAQ2E,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,SAAY,cAAgB,UAChF9H,WAAY,gBACZ/E,UAAW,sCACXkN,WAAY,SACZhN,WAAY,EACZwE,QAASsE,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,SAAY,GAAM,GAEzEvG,YAAclB,IACP4D,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,WAC/CzH,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAG/BwG,WAAapB,IACN4D,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,WAC/CzH,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAE7BlB,SAEDkK,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,SACzC,mBACA,mCAMRhO,cAAA,OAAKa,MAAO,CACV0E,MAAO,UACPiD,WAAY,MACZ/C,aAAc,QACdxF,SACCmO,EAAQF,YAAYV,MAAM,MAAMlN,IAAI,CAACgO,EAAMC,IAC1C/N,eAACgO,IAAMC,SAAQ,CAAAxO,SAAA,CACZqO,EACAC,EAAYH,EAAQF,YAAYV,MAAM,MAAMzN,OAAS,GAAKC,cAAA,WAFxCuO,MAQxBpE,EAAiB,GAAD1J,OAAIkJ,EAAY,KAAAlJ,OAAI2N,EAAQJ,UAC3CxN,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,SACZH,IAAK,MACLC,UAAW,OACXV,MAAO,UACPG,SAAU,yBACVK,eAAgB,SAChBV,QAAS,OACTF,WAAY,2BACZnE,aAAc,OACdf,SAAA,CACAD,cAAA,OAAKa,MAAO,CACVC,MAAO,OACPC,OAAQ,OACRG,OAAQ,oBACRkH,UAAW,oBACXpH,aAAc,MACdqH,UAAW,6BACJ,iDA/GT+F,EAAQJ,SAyHpBxN,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTE,IAAK,OACLC,UAAW,OACXF,eAAgB,SAChB6B,SAAU,QACV3H,SAAA,CAEC0J,EAAe,GACd3J,cAAA,UACEW,QApVU+N,KACpB/E,EAAe,GACjBC,EAAgBD,EAAe,IAmVnB9I,MAAO,CACLsE,WAAY,oDACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,gDACTrE,aAAc,OACd0E,SAAU,2BACVC,WAAY,MACZH,OAAQ,UACRU,WAAY,gBACZ/E,UAAW,uCACX6F,SAAU,SAEZS,YAAclB,IACZA,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAE7BwG,WAAapB,IACXA,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAC3BlB,SACH,2BAMHD,cAAA,UACEW,QArbQqC,UACpB,GAAI6G,EAAe,OAEnB,MAAM8E,EAAYhF,EAAe,EAGjC,GAAII,EAAkB4E,GACpB/E,EAAgB+E,OADlB,CAKA7E,GAAiB,GAEjB,IAEE,MAAM8E,EAA+B,GAAjBD,EAAY,GAAS,EACnCE,EAAWD,EAAa,EAGxBE,GAAsB,OAARpF,QAAQ,IAARA,OAAQ,EAARA,EAAU8D,MAAM,KAAK,KAAM,cACzCuB,EAAc,GAAAtO,OAAMqO,EAAW,KAAArO,OAAImO,EAAU,KAAAnO,OAAIoO,GAEvDhK,QAAQqC,IAAI,iCAADzG,OAAkCkO,EAAS,MAAAlO,OAAKsO,IAG3D,MAAM9D,EAAM,GAAAxK,OAAM8I,EAAQ,4BAEpB4B,QAAiBC,MAAMH,EAAQ,CACnCI,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,QAASqD,EACTpD,QAAS,MACTC,OAAQ,IACRC,YAAY,EACZC,UAAU,MAId,IAAKX,EAASa,GACZ,MAAM,IAAIC,MAAM,eAADxL,OAAgB0K,EAAS/K,SAG1C,MAAM8L,QAAaf,EAASgB,OAE5B,IAAID,EAAKzC,QASP,MAAM,IAAIwC,MAAM,0BAPhBjC,EAAqBM,GAAIC,wBAAA,GACpBD,GAAI,IACP,CAACqE,GAAYzC,EAAKzC,WAEpBG,EAAgB+E,GAChB9J,QAAQqC,IAAI,sBAADzG,OAAuBkO,EAAS,6BAK/C,CAAE,MAAO/J,GACPC,QAAQD,MAAM,wCAADnE,OAAyCkO,EAAS,KAAK/J,EAEtE,CAAC,QACCkF,GAAiB,EACnB,CAvDA,GA6aY/C,SAAU8C,EACVhJ,MAAO,CACLsE,WAAY0E,EACR,oDACA,oDACJtE,MAAO,QACPrE,OAAQ,OACRmE,QAAS,gDACTrE,aAAc,OACd0E,SAAU,2BACVC,WAAY,MACZH,OAAQqE,EAAgB,cAAgB,UACxC3D,WAAY,gBACZ/E,UAAW,sCACX6F,SAAU,QACVnB,QAASgE,EAAgB,GAAM,GAEjCpC,YAAclB,IACPsD,IACHtD,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAG/BwG,WAAapB,IACNsD,IACHtD,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAE7BlB,SAED4J,EAAgB,uBAAoB,sBAKzCrJ,eAAA,OAAKK,MAAO,CACVyE,UAAW,SACXW,UAAW,OACXP,SAAU,yBACVH,MAAO,WACPtF,SAAA,CAAC,sBACS0J,EAAa,mBAAiC,GAApBA,EAAe,GAAS,EAAE,SAAmB,EAAfA,KAIpE3J,cAAA,SAAAC,SAAA,skHA8FFO,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,yBACTC,UAAW,SACXnE,UAAW,mCACXlB,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6E,SAAU,yBACVD,aAAc,QACdxF,SAAC,iBACHD,cAAA,MAAIa,MAAO,CACT6E,SAAU,2BACVH,MAAO,UACPE,aAAc,OACdE,WAAY,OACZ1F,SAAC,8CAGHO,eAAA,KAAGK,MAAO,CACR0E,MAAO,UACPG,SAAU,2BACVW,SAAU,QACVT,OAAQ,SACR4C,WAAY,OACZvI,SAAA,CAAC,6JAEDD,cAAA,SAAMA,cAAA,SACNA,cAAA,UAAAC,SAAQ,cAAkB,4DCtOzB+O,MA/dGtP,IAAmB,IAAlB,SAAE6B,GAAU7B,EAC7B,MAAOuP,EAAOC,GAAYxN,mBAAS,KAC5ByN,EAAWC,GAAgB1N,mBAAS,OACpC2N,EAAUC,GAAe5N,oBAAS,IAClC6N,EAAWC,GAAgB9N,mBAAS,GACrC+N,EAAcC,iBAAO,MACrBC,EAAsBD,iBAAO,MAG7BE,EACK,oBADLA,EAEK,6BAFLA,EAGK,6BAHLA,EAIM,yBAINC,EAAsBC,IAC1B,IACE,MAAMC,GAAY,IAAIC,MAAOC,cACvBC,EAAW,CACff,UAAWY,EACXR,UAAWA,EAAY,EACvBY,cAAeL,EAAa/P,QAqB9B,OAjBAqQ,aAAaC,QAAQT,EAAsBpE,KAAKC,UAAUqE,IAG1DM,aAAaC,QAAQT,EAAsBpE,KAAKC,UAAUqE,IAGtDP,EAAY,IAAM,GACpBa,aAAaC,QAAQT,EAAsBpE,KAAKC,UAAUqE,IAI5DM,aAAaC,QAAQT,EAAuBpE,KAAKC,UAAUyE,IAE3Dd,EAAaW,GACbP,EAAalF,GAAQA,EAAO,GAE5BzF,QAAQqC,IAAI,0CAADzG,OAAwC8O,EAAY,EAAC,cAAA9O,OAAaqP,EAAa/P,OAAM,YACzF,CACT,CAAE,MAAO6E,GAEP,OADAC,QAAQD,MAAM,6BAA8BA,IACrC,CACT,GA4CFyF,oBAAU,KACR,MAAMiG,EAzCqBC,MAC3B,IAEE,IAAIC,EAAaJ,aAAaK,QAAQb,GACtC,GAAIY,EAAY,CACd,MAAME,EAASlF,KAAKmF,MAAMH,GAE1B,OADA3L,QAAQqC,IAAI,iDACLwJ,CACT,CAIA,GADAF,EAAaJ,aAAaK,QAAQb,GAC9BY,EAAY,CACd,MAAME,EAASlF,KAAKmF,MAAMH,GAI1B,OAHA3L,QAAQqC,IAAI,sCAEZkJ,aAAaC,QAAQT,EAAsBY,GACpCE,CACT,CAIA,GADAF,EAAaJ,aAAaK,QAAQb,GAC9BY,EAAY,CACd,MAAME,EAASlF,KAAKmF,MAAMH,GAK1B,OAJA3L,QAAQqC,IAAI,sCAEZkJ,aAAaC,QAAQT,EAAsBY,GAC3CJ,aAAaC,QAAQT,EAAsBY,GACpCE,CACT,CAGA,OADA7L,QAAQqC,IAAI,wCACL,EACT,CAAE,MAAOtC,GAEP,OADAC,QAAQD,MAAM,6BAA8BA,GACrC,EACT,GAKoB2L,GACpBrB,EAASoB,GAGT,IACE,MAAMJ,EAAWE,aAAaK,QAAQb,GACtC,GAAIM,EAAU,CACZ,MAAMQ,EAASlF,KAAKmF,MAAMT,GAC1Bd,EAAasB,EAAOvB,WACpBK,EAAakB,EAAOnB,WAAa,EACnC,CACF,CAAE,MAAO3K,GACPC,QAAQD,MAAM,+CAA0CA,EAC1D,GACC,IAGHyF,oBAAU,KACJsF,EAAoBiB,SACtBC,cAAclB,EAAoBiB,SAGpCjB,EAAoBiB,QAAUE,YAAY,KACpC7B,EAAMhM,OAAOlD,OAAS,IACxBuP,GAAY,GACZO,EAAmBZ,GACnB7L,WAAW,IAAMkM,GAAY,GAAQ,OAEtC,KAEI,KACDK,EAAoBiB,SACtBC,cAAclB,EAAoBiB,WAGrC,CAAC3B,EAAOM,IAsBXlF,oBAAU,KACR,MAAM0G,EAAsBxK,IACtB0I,EAAMhM,OAAOlD,OAAS,GACxB8P,EAAmBZ,IAIjB+B,EAAyBA,KACzBC,SAASC,QAAUjC,EAAMhM,OAAOlD,OAAS,GAC3C8P,EAAmBZ,IAOvB,OAHAhH,OAAOkJ,iBAAiB,eAAgBJ,GACxCE,SAASE,iBAAiB,mBAAoBH,GAEvC,KACL/I,OAAOmJ,oBAAoB,eAAgBL,GAC3CE,SAASG,oBAAoB,mBAAoBJ,KAElD,CAAC/B,IAqBJ,OACEzO,eAAA,OAAKK,MAAO,CACVqE,UAAW,QACXC,WAAY,uHACZC,WAAY,wDACZnF,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,qFACZI,MAAO,QACPF,QAAS,YACTlE,UAAW,sCACXuL,SAAU,SACVC,IAAK,EACLC,OAAQ,IACRC,SAAU,UACV5M,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6L,SAAU,WACVC,IAAK,EACLG,KAAM,EACNC,MAAO,EACPC,OAAQ,EACR7H,WAAY,uGACZ8H,cAAe,UAGjBzM,eAAA,OAAKK,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACR8G,SAAU,WACVE,OAAQ,IACR3M,SAAA,CACAD,cAAA,UACEW,QAASY,EACTV,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,OACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZF,aAAc,OACdyH,eAAgB,aAChBhH,WAAY,iBAEduB,YAAclB,IACZA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,oBAE7BC,WAAapB,IACXA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,iBAC3BzH,SACH,kCAIDD,cAAA,MAAIa,MAAO,CACT6E,SAAU,6BACVC,WAAY,MACZC,OAAQ,YACRN,UAAW,SACX6H,WAAY,gCACZlN,SAAC,+CAIHO,eAAA,OAAKK,MAAO,CACV6E,SAAU,2BACVJ,UAAW,SACXO,QAAS,GACTF,WAAY,OACZ1F,SAAA,CAAC,qCAC6BgP,EAAMlP,OAAO,0BAMjDS,eAAA,OAAKK,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACRP,QAAS,QACTpF,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,yBACTlE,UAAW,iCACXD,OAAQ,qCACRuE,aAAc,OACdS,WAAY,0BACZjG,SAAA,CACAD,cAAA,YACEqR,IAAK5B,EACL/I,MAAOuI,EACPtI,SAAWJ,GAAM2I,EAAS3I,EAAEK,OAAOF,OACnCG,YAAW,wiBAYXhG,MAAO,CACLC,MAAO,OACPoE,UAAW,4BACXhE,OAAQ,OACRoQ,QAAS,OACTC,OAAQ,WACR7L,SAAU,yBACV8C,WAAY,MACZpD,WAAY,iBACZnE,gBAAiB,cACjBsE,MAAO,UACPW,WAAY,4BAKhB1F,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZF,UAAW,OACX2B,SAAU,OACV5B,IAAK,QACL/F,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,SACZH,IAAK,OACL4B,SAAU,QACV3H,SAAA,CACAD,cAAA,OAAKa,MAAO,CACViF,QAAS,OACTK,WAAY,SACZH,IAAK,MACLN,SAAU,yBACVH,MAAO,WACPtF,SACCoP,EACC7O,eAAA4F,WAAA,CAAAnG,SAAA,CACED,cAAA,OAAKa,MAAO,CACVC,MAAO,OACPC,OAAQ,OACRG,OAAQ,oBACRkH,UAAW,oBACXpH,aAAc,MACdqH,UAAW,+BACJ,mBAIX7H,eAAA4F,WAAA,CAAAnG,SAAA,CACED,cAAA,QAAMa,MAAO,CAAE0E,MAAO,WAAYtF,SAAC,WAxL7BuR,MACtB,IAAKrC,EAAW,MAAO,uBAEvB,MAAMsC,EAAO,IAAIzB,KAAKb,GAEhBuC,EADM,IAAI1B,KACKyB,EACfE,EAAcC,KAAKC,MAAMH,EAAS,KAExC,GAAIC,EAAc,EAAG,MAAO,+BAC5B,GAAoB,IAAhBA,EAAmB,MAAO,gCAC9B,GAAIA,EAAc,GAAI,MAAM,wBAANlR,OAA4BkR,EAAW,YAE7D,MAAMG,EAAYF,KAAKC,MAAMF,EAAc,IAC3C,OAAkB,IAAdG,EAAwB,+BACxBA,EAAY,GAAU,wBAANrR,OAA4BqR,EAAS,WAEnD,oBAANrR,OAAwBgR,EAAKM,qBAAoB,UAAAtR,OAAMgR,EAAKO,uBAyK3CR,QAKPhR,eAAA,OAAKK,MAAO,CACV6E,SAAU,yBACVH,MAAO,WACPtF,SAAA,CACCsP,EAAU,cAAYA,EAAY,EAAI,IAAM,SAKjDvP,cAAA,UACEW,QAjPasR,KACvB3C,GAAY,GACZ,MAAM4C,EAAUrC,EAAmBZ,GACnC7L,WAAW,IAAMkM,GAAY,GAAQ,KAEjC4C,GAEEzC,EAAYmB,UACdnB,EAAYmB,QAAQ/P,MAAMsR,YAAc,UACxC/O,WAAW,KACLqM,EAAYmB,UACdnB,EAAYmB,QAAQ/P,MAAMsR,YAAc,KAEzC,OAqOGpL,SAAUsI,EACVxO,MAAO,CACLsE,WAAYkK,EACR,oDACA,oDACJ9J,MAAO,QACPrE,OAAQ,OACRmE,QAAS,gDACTrE,aAAc,OACd0E,SAAU,2BACVC,WAAY,MACZH,OAAQ6J,EAAW,cAAgB,UACnCnJ,WAAY,gBACZ/E,UAAW,sCACX0E,QAASwJ,EAAW,GAAM,GAE5B5H,YAAclB,IACP8I,IACH9I,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAG/BwG,WAAapB,IACN8I,IACH9I,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAE7BlB,SACH,8CAOLD,cAAA,OAAKa,MAAO,CACVsE,WAAY,2BACZjE,OAAQ,oCACRF,aAAc,OACdqE,QAAS,OACTI,aAAc,QACdxF,SACAO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,aACZH,IAAK,QACL/F,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6E,SAAU,SACVsB,SAAU,OACV1B,UAAW,UACXrF,SAAC,iBACHO,eAAA,OAAAP,SAAA,CACED,cAAA,MAAIa,MAAO,CACT+E,OAAQ,YACRL,MAAO,UACPG,SAAU,2BACVC,WAAY,OACZ1F,SAAC,wCAGHO,eAAA,MAAIK,MAAO,CACT+E,OAAQ,EACRwM,YAAa,OACb7M,MAAO,UACPG,SAAU,2BACV8C,WAAY,OACZvI,SAAA,CACAO,eAAA,MAAAP,SAAA,CAAI,gBAAGD,cAAA,UAAAC,SAAQ,oBAAwB,4BACvCO,eAAA,MAAAP,SAAA,CAAI,gBAAGD,cAAA,UAAAC,SAAQ,sBAA0B,6BACzCO,eAAA,MAAAP,SAAA,CAAI,sBAAID,cAAA,UAAAC,SAAQ,+BAAmC,0BACnDO,eAAA,MAAAP,SAAA,CAAI,gBAAGD,cAAA,UAAAC,SAAQ,mCAAiC,4BAChDO,eAAA,MAAAP,SAAA,CAAI,gBAAGD,cAAA,UAAAC,SAAQ,yBAA6B,yDAQtDD,cAAA,SAAAC,SAAA,skBCiFSoS,MAthBS3S,IAAqB,IAApB,WAAE4S,GAAY5S,EACrC,MAAO6S,EAAQC,GAAa9Q,oBAAS,IAC9B+Q,EAAWC,GAAgBhR,mBAAS,OACpCiR,EAAYC,GAAiBlR,mBAAS,OACtCmR,EAAYC,GAAiBpR,mBAAS,OACtCqR,EAAaC,GAAkBtR,oBAAS,IACxCuR,EAAaC,GAAkBxR,oBAAS,GAGzCyR,EAAiBnQ,UACrB,IACE,MAAMmI,QAAiBC,MAAM,GAAD3K,OAAI6R,EAAU,gBAC1C,GAAInH,EAASa,GAAI,CACf,MAAMoH,QAAmBjI,EAASgB,OAG5BkH,EAAgB,CACpBtD,WAAW,IAAIC,MAAOC,cACtBqD,KAAM,CACJC,SAAU,CAAEhO,MAAO,QAASiO,KAAM,eAAgBpT,OAAQ,UAC1DqT,SAAU,CAAElO,MAAO,QAASiO,KAAM,eAAgBpT,OAAQ,UAC1DsT,SAAU,CAAEnO,MAAO,QAASiO,KAAM,eAAgBpT,OAAQ,UAC1DuT,SAAU,CAAEpO,MAAO,QAASiO,KAAM,eAAgBpT,OAAQ,UAC1DwT,UAAW,CAAErO,MAAO6N,EAAWS,qBAAuB,QAAU,MAAOL,KAAM,YAAapT,OAAQgT,EAAWS,qBAAuB,SAAW,aAEjJC,aAAc,GACdC,WAAYX,EAAWY,aAAe,YAGxCtB,EAAaW,GACbT,GAAc,IAAI5C,MAAOgC,sBACzBnN,QAAQqC,IAAI,+BAA6BmM,EAC3C,CACF,CAAE,MAAOzO,GACPC,QAAQD,MAAM,uBAAwBA,EACxC,GAIIqP,EAAkBjR,UACtB,IACE,MAAMmI,QAAiBC,MAAM,GAAD3K,OAAI6R,EAAU,gBAC1C,GAAInH,EAASa,GAAI,OACUb,EAASgB,OAAlC,MAGM+H,EAAiB,CACrBnE,WAAW,IAAIC,MAAOC,cACtBkE,YAAa,EACbC,QAAS,IAGXtB,EAAcoB,GACdrP,QAAQqC,IAAI,8CAAsCgN,EACpD,CACF,CAAE,MAAOtP,GACPC,QAAQD,MAAM,wBAAyBA,EACzC,GAIFyF,oBAAU,KAER8I,IACAc,IAGA,MAAMI,EAAWvD,YAAY,KAC3BqC,IACAc,KACC,KAEH,MAAO,IAAMpD,cAAcwD,IAC1B,CAAC/B,IAGJ,MAAMgC,EAAeC,GACO,WAAZ,OAAPA,QAAO,IAAPA,OAAO,EAAPA,EAAShP,OAAoB,UAAY,UAqBlD,OACE/E,eAAA,OAAKK,MAAO,CAAE6L,SAAU,WAAY5G,QAAS,gBAAiB7F,SAAA,CAE5DD,cAAA,SAAAC,SAAA,6lEAwEAO,eAAA,UACEG,QAASA,IAAM6R,GAAWD,GAC1B1R,MAAO,CAELsE,WAAY,4CACZjE,OAAQ,OACRF,aAAc,OACduE,MAAO,QACPF,QAAS,YACTK,SAAU,OACVC,WAAY,MACZH,OAAQ,UACRrE,UAAW,8BACX+E,WAAY,wCACZsO,cAAe,YACfC,cAAe,QACf3O,QAAS,OACTK,WAAY,SACZH,IAAK,MACL5E,WAAY,OACZ4F,SAAU,QACV1B,UAAW,SACX4H,eAAgB,aAChBR,SAAU,WACVG,SAAU,UAEZpF,YAAclB,IACZA,EAAEK,OAAO/F,MAAM6G,UAAY,+BAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,kCAC3B+R,GAAe,IAEjBvL,WAAapB,IACXA,EAAEK,OAAO/F,MAAM6G,UAAY,yBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,8BAC3B+R,GAAe,IACfjT,SAAA,CAEFO,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQK,WAAY,SAAUH,IAAK,OAAQ/F,SAAA,CAChED,cAAA,QAAAC,SAAM,qBAGLwS,GACCjS,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,SACZH,IAAK,MACLb,WAAY,wBACZE,QAAS,UACTrE,aAAc,OACdf,SAAA,CAEAD,cAAA,OAAKa,MAAO,CACVC,MAAO,MACPC,OAAQ,MACRC,aAAc,MACdC,gBAAiBgD,OAAOyQ,OAAOjC,EAAUa,MAAMqB,MAAMC,GAAqB,UAAdA,EAAIrP,OAAqB,UAAY,UACjGpE,UAAU,WAADV,OAAawD,OAAOyQ,OAAOjC,EAAUa,MAAMqB,MAAMC,GAAqB,UAAdA,EAAIrP,OAAqB,UAAY,WACtG8C,UAAWpE,OAAOyQ,OAAOjC,EAAUa,MAAMqB,MAAMC,GAAqB,UAAdA,EAAIrP,OAAqB,0BAA4B,2BAI7GvF,cAAA,OAAKK,UAAU,eAAcJ,SAC3BD,cAAA,OAAKa,MAAO,CACV6E,SAAU,MACVC,WAAY,OACZ0I,WAAY,SACZhG,UAAW,yBACXG,WAAY,OACZ1C,QAAS,OACT+O,cAAe,UACf5U,SACCgE,OAAOC,QAAQuO,EAAUa,MAAMhT,IAAIwU,IAAA,IAAE/Q,EAAK6Q,GAAIE,EAAA,OAC7CtU,eAAA,OAEEK,MAAO,CACLE,OAAQ,OACR+E,QAAS,OACTK,WAAY,SACZZ,MAAOxB,IAAQ0O,EAAUsB,WAAa,OAAS,yBAC/C9T,SAAA,CAEFD,cAAA,QAAMa,MAAO,CACX0E,MAAqB,UAAdqP,EAAIrP,MAAoB,UAAY,UAC3CwP,YAAa,OACb9U,UACC2U,EAAIrP,MAAoB,YAE1BqP,EAAIpB,KAAKvO,QAAQ,cAAe,KAAKA,QAAQ,aAAc,IAAIA,QAAQ,eAAgB,IAAIA,QAAQ,YAAa,SACjHjF,cAAA,QAAMa,MAAO,CAAEO,WAAY,MAAOsE,SAAU,OAAQzF,SACnC,UAAd2U,EAAIrP,MAAoB,KAAO,UAhB7BxB,SAwBb/D,cAAA,OAAKa,MAAO,CAAEiF,QAAS,OAAQE,IAAK,OAAQ/F,SACzCgE,OAAOC,QAAQuO,EAAUa,MAAMhT,IAAI0U,IAAA,IAAEjR,EAAK6Q,GAAII,EAAA,OAC7ChV,cAAA,OAEEa,MAAO,CACLC,MAAO,MACPC,OAAQ,MACRC,aAAc,MACdC,gBAAiBqT,EAAYM,GAC7BzT,UAAU,WAADV,OAAa6T,EAAYM,IAClCvM,UAAyB,UAAduM,EAAIrP,MAAoB,0BAA4B,yBAEjE3E,MAAK,GAAAH,OAAKmU,EAAIpB,KAAI,MAAA/S,OAAoB,cAAfmU,EAAIxU,OAAyB,aAAe,wBAT9D2D,aAkBjB/D,cAAA,OAAKa,MAAO,CACV4I,QAAS,GACTiD,SAAU,WACVC,IAAK,IACLG,KAAM,QACNhM,MAAO,OACPC,OAAQ,OACRoE,WAAY,0EACZkD,UAAW,oBACXuE,OAAQ,KAITqG,GAAeR,GACdzS,cAAA,OAAKK,UAAS,uBAAAI,OAAyBwS,EAAc,UAAY,IAAKhT,SACnEgE,OAAOyQ,OAAOjC,EAAUa,MAAMqB,MAAMC,GAAqB,UAAdA,EAAIrP,OAC5C,sDACA,uDAOTgN,GACC/R,eAAA,OAAKK,MAAO,CACV6L,SAAU,WACVC,IAAK,OACLI,MAAO,IACP9G,UAAW,OACXd,WAAY,4BACZ+H,eAAgB,aAChBhM,OAAQ,qCACRF,aAAc,OACdqE,QAAS,OACT2B,SAAU,QACV7F,UAAW,8BACXyL,OAAQ,KACR3M,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZV,aAAc,OACdwP,aAAc,4BACdC,cAAe,QACfjV,SAAA,CACAD,cAAA,MAAIa,MAAO,CACT+E,OAAQ,EACRL,MAAO,OACPG,SAAU,OACVC,WAAY,QACZ1F,SAAC,gCAGHD,cAAA,UACEW,QAASA,IAAM6R,GAAU,GACzB3R,MAAO,CACLsE,WAAY,OACZjE,OAAQ,OACRwE,SAAU,OACVF,OAAQ,UACRD,MAAO,QACPtF,SACH,cAMFwS,EACCzS,cAAA,OAAKa,MAAO,CAAE4E,aAAc,QAASxF,SAClCgE,OAAOC,QAAQuO,EAAUa,MAAMhT,IAAI6U,IAAA,IAAEpR,EAAK6Q,GAAIO,EAAA,OAC7C3U,eAAA,OAEEK,MAAO,CACLiF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZd,QAAS,OACTI,aAAc,MACdN,WAA0B,UAAdyP,EAAIrP,MAAoB,uBAAyB,uBAC7DrE,OAAO,aAADT,OAA6B,UAAdmU,EAAIrP,MAAoB,uBAAyB,wBACtEvE,aAAc,MACdkF,WAAY,iBACZjG,SAAA,CAEFO,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQ+O,cAAe,UAAW5U,SAAA,CACvDO,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQK,WAAY,UAAWlG,SAAA,CACpDD,cAAA,OAAKa,OAvSP0E,EAuSuB+O,EAAYM,GAvS9B,CACrB9T,MAAO,OACPC,OAAQ,OACRC,aAAc,MACdC,gBAAiBsE,EACjBpE,UAAU,YAADV,OAAc8E,EAAK,eAAA9E,OAAc8E,GAC1C8C,UAAqB,YAAV9C,EAAsB,0BAA4B,wBAC7DO,QAAS,eACTiP,YAAa,MACb7T,OAAQ,sCA+RUlB,cAAA,QAAMa,MAAO,CACX8E,WAAY,OACZJ,MAAO,OACPwP,YAAa,OACb9U,SACC2U,EAAIpB,OAENzP,IAAQ0O,EAAUsB,YACjB/T,cAAA,QAAMa,MAAO,CACXsE,WAAY,4CACZI,MAAO,QACPF,QAAS,UACTrE,aAAc,OACd0E,SAAU,OACVC,WAAY,QACZ1F,SAAC,cAKPO,eAAA,OAAKK,MAAO,CAAE6E,SAAU,OAAQH,MAAO,OAAQnE,WAAY,QAASnB,SAAA,CAAC,UAChE2U,EAAIQ,cAAc,uBAAaR,EAAIS,YAAY,aACjDT,EAAIU,WACH9U,eAAA,OAAAP,SAAA,CAAK,4BAAuB,IAAI+P,KAAK4E,EAAIU,WAAWtD,8BAI1DxR,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQK,WAAY,UAAWlG,SAAA,CACpDD,cAAA,QAAMa,MAAO,CACX6E,SAAU,OACVH,MAAqB,UAAdqP,EAAIrP,MAAoB,UAAY,UAC3CI,WAAY,OACZ6O,cAAe,aACfvU,SACgB,cAAf2U,EAAIxU,OAAyB,aAAe,wBAE/CJ,cAAA,QAAMa,MAAO,CAAE6E,SAAU,OAAQtE,WAAY,OAAQnB,UAjVhDsU,EAkVYK,EAjVP,WAAZ,OAAPL,QAAO,IAAPA,OAAO,EAAPA,EAAShP,OAAoB,SAAM,iBA4RvBxB,GA7REwQ,MAKLhP,MAoVRvF,cAAA,OAAKa,MAAO,CACVyE,UAAW,SACXD,QAAS,OACTE,MAAO,QACPtF,SAAC,yCAMLO,eAAA,UACEG,QAASA,IAAMqS,GAAgBD,GAC/BlS,MAAO,CACLC,MAAO,OACPuE,QAAS,MACTI,aAAc,OACdN,WAAY,4CACZI,MAAO,QACPrE,OAAQ,OACRF,aAAc,MACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,QACZ1F,SAAA,CACH,gBACK8S,EAAc,UAAY,WAAW,mBAI1CA,GAAeF,GACdrS,eAAA,OAAKK,MAAO,CACV4E,aAAc,OACd6C,UAAW,QACXC,UAAW,OACXrH,OAAQ,4BACRF,aAAc,MACdqE,QAAS,MACTF,WAAY,oBACZlF,SAAA,CACAO,eAAA,MAAIK,MAAO,CAAE+E,OAAQ,YAAaF,SAAU,OAAQH,MAAO,QAAStF,SAAA,CAAC,qCAC1C4S,EAAWsB,YAAY,aAEjDtB,EAAWuB,QAAQ1P,QAAQ6Q,UAAUjV,IAAI,CAACkV,EAAMlR,IAC/C9D,eAAA,OAEEK,MAAO,CACLiF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZd,QAAS,MACTI,aAAc,MACdN,WAAYqQ,EAAKtD,QAAU,wBAA0B,wBACrDhR,OAAO,aAADT,OAAe+U,EAAKtD,QAAU,uBAAyB,wBAC7DlR,aAAc,MACd0E,SAAU,QACVzF,SAAA,CAEFO,eAAA,OAAAP,SAAA,CACED,cAAA,UAAAC,SAASuV,EAAKC,WACdzV,cAAA,OAAKa,MAAO,CAAE0E,MAAO,QAAStF,SAC3B,IAAI+P,KAAKwF,EAAKzF,WAAWiC,0BAG9BxR,eAAA,OAAKK,MAAO,CAAEyE,UAAW,SAAUrF,SAAA,CACjCD,cAAA,OAAKa,MAAO,CAAE0E,MAAOiQ,EAAKtD,QAAU,UAAY,WAAYjS,SACzDuV,EAAKtD,QAAU,iBAAc,iBAEhClS,cAAA,OAAKa,MAAO,CAAE0E,MAAO,QAAStF,SAC3BuV,EAAKE,eAAiB,EAAC,GAAAjV,OAAM+U,EAAKE,eAAc,UAAWF,EAAK5Q,aAxBhEN,OAiCb9D,eAAA,OAAKK,MAAO,CACV6E,SAAU,OACVH,MAAO,OACPD,UAAW,SACX8C,UAAW,4BACXuN,WAAY,QACZ1V,SAAA,CAAC,yDAEA0S,GACCnS,eAAA,OAAAP,SAAA,CAAK,+BAAuB0S,QAKhCnS,eAAA,OAAKK,MAAO,CACV6E,SAAU,OACVH,MAAO,OACPU,UAAW,OACXH,QAAS,OACTC,eAAgB,iBAChB9F,SAAA,CACAD,cAAA,QAAAC,SAAM,4BACND,cAAA,QAAAC,SAAM,qCACND,cAAA,QAAAC,SAAM,0CC+OH2V,MA5vBMlW,IAmBd,IAnBe,SACpB6B,EAAQ,eACRsU,EAAc,cACdC,EAAa,QACbrM,EAAO,SACPC,EAAQ,qBACRqM,EAAoB,aAEpBC,EAAe,YAAQ,gBACvBC,EAAkB,IAAG,cACrBC,EAAgB,KAAI,eACpBC,EAAiB,IAAG,eACpBC,EAAc,SACd7M,EAAQ,WACR8M,EAAU,mBACVC,EAAkB,aAClBxU,EAAY,UACZD,GAAY,EAAK,eACjB0U,EAAiB,IAClB7W,EAGCmF,QAAQqC,IAAI,kCAADzG,OAAmCoV,EAAc,MAC5DhR,QAAQqC,IAAI,6CAA8CuC,GAC1D5E,QAAQqC,IAAI,wCAAyCuC,EAAUA,EAAQ1J,OAAS,GAChF8E,QAAQqC,IAAI,yCAA0CuC,EAAUA,EAAQ/E,MAAM,EAAG,KAAO,MAAQ,QAChGG,QAAQqC,IAAI,0CAA2CuC,GAGvD,MAAO+M,EAAgBC,GAAqBjI,IAAM9M,UAAS,IACpD+Q,EAAWC,GAAgBlE,IAAM9M,SAAS,OAC1CmR,EAAYC,GAAiBtE,IAAM9M,SAAS,MAG7CyR,EAAiBnQ,UACrB,GAAKuG,EACL,IACE,MAAM4B,QAAiBC,MAAM,GAAD3K,OAAI8I,EAAQ,gBACxC,GAAI4B,EAASa,GAAI,CACf,MAAM5L,QAAe+K,EAASgB,OAC9BuG,EAAatS,GACbyE,QAAQqC,IAAI,2CAAmC9G,EACjD,CACF,CAAE,MAAOwE,GACPC,QAAQD,MAAM,gCAAiCA,EACjD,GAGIqP,EAAkBjR,UACtB,GAAKuG,EACL,IACE,MAAM4B,QAAiBC,MAAM,GAAD3K,OAAI8I,EAAQ,iBACxC,GAAI4B,EAASa,GAAI,CACf,MAAMoI,QAAgBjJ,EAASgB,OAC/B2G,EAAcsB,GACdvP,QAAQqC,IAAI,+CAAuCkN,EACrD,CACF,CAAE,MAAOxP,GACPC,QAAQD,MAAM,oCAAqCA,EACrD,GAIF4J,IAAMnE,UAAU,KACVmM,IACFrD,IACAc,MAED,CAACuC,EAAgBjN,IAGpB,MAAM+K,EAAeM,GACE,UAAdA,EAAIrP,MAAoB,UAAY,UAavCmR,EAAiB9B,GACA,UAAdA,EAAIrP,MAAoB,SAAM,SA4IjCoR,EApBoB3I,KAExB,MAAM4I,EAAS,CACb,EAAG,CAAEC,MAAO,UAAWC,IAAK,UAAWtD,KAAM,UAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,QAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,QAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,UAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,SAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,UAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,QAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,QAC7C,EAAG,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,UAC7C,GAAI,CAAEqD,MAAO,UAAWC,IAAK,UAAWtD,KAAM,QAE9CuD,QAAS,CAAEF,MAAO,UAAWC,IAAK,UAAWtD,KAAM,SAGrD,OAAOoD,EAAO5I,IAAW4I,GAAS5I,EAAS,GAAK,GAAM,IAAM4I,EAAOG,SAG/CC,CAAiBnB,GAYvC,OACErV,eAAA,OAAKK,MAAO,CACVqE,UAAW,QACXC,WAAY,uHACZC,WAAY,wDACZnF,SAAA,CAEAO,eAAA,OAAKK,MAAO,CACVsE,WAAW,2BAAD1E,OAA6BkW,EAAcE,MAAK,SAAApW,OAAQkW,EAAcG,IAAG,UACnFvR,MAAO,QACPF,QAAS,YACTlE,UAAU,cAADV,OAAgBkW,EAAcE,MAAK,MAC5CnK,SAAU,SACVC,IAAK,EACLC,OAAQ,IACRC,SAAU,UACV5M,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6L,SAAU,WACVC,IAAK,EACLG,KAAM,EACNC,MAAO,EACPC,OAAQ,EACR7H,WAAY,uGACZ8H,cAAe,UAGjBzM,eAAA,OAAKK,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACR8G,SAAU,WACVE,OAAQ,IACR3M,SAAA,CACAD,cAAA,UACEW,QAASY,EACTV,MAAO,CACLsE,WAAY,2BACZjE,OAAQ,qCACRqE,MAAO,QACPF,QAAS,YACTrE,aAAc,OACdwE,OAAQ,UACRE,SAAU,OACVC,WAAY,MACZF,aAAc,OACdyH,eAAgB,aAChBhH,WAAY,iBAEduB,YAAclB,IACZA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,oBAE7BC,WAAapB,IACXA,EAAEK,OAAO/F,MAAMsE,WAAa,2BAC5BoB,EAAEK,OAAO/F,MAAM6G,UAAY,iBAC3BzH,SACH,kCAKDO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTK,WAAY,SACZJ,eAAgB,gBAChBC,IAAK,OACLP,aAAc,OACdmC,SAAU,QACV3H,SAAA,CACAO,eAAA,OAAKK,MAAO,CAAEiG,KAAM,EAAGE,SAAU,SAAU/G,SAAA,CACzCO,eAAA,MAAIK,MAAO,CACT6E,SAAU,6BACVC,WAAY,MACZC,OAAQ,YACRN,UAAW,SACX6H,WAAY,gCACZlN,SAAA,CAAC,yBACY4V,KAGf7V,cAAA,OAAKa,MAAO,CACV6E,SAAU,2BACVJ,UAAW,SACXO,QAAS,GACTF,WAAY,OACZ1F,SACC6V,OAKLtV,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTE,IAAK,MACL4B,SAAU,OACV7B,eAAgB,UAChB9F,SAAA,CAEAD,cAAA,UACEW,QArPaqC,UACzB,GAAKuG,GAAa8M,GAAeC,GAAuBxU,EAKxD,IACEA,GAAa,GACbuU,EAAW,uEACXC,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACpB,GAAiB,iBAEnD,MAAMnK,EAA6B,OAAlBwK,GAA4C,SAAlBA,EAAwB,GAAAzV,OAC5DuV,EAAY,KAAAvV,OAAIwV,GAAe,GAAAxV,OAC/BuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIyV,GAG1C,GAAIL,GAAkB,GAAKA,GAAkB,GAAI,CAC/C,MAAMC,EAAgBS,EAAeV,IAAe,YAAApV,OAAgBoV,GAG9DqB,EAAiBtF,KAAKuF,IAAI,IAAM7J,SAAS6I,GAAkB,KACjEtR,QAAQqC,IAAI,4CAADzG,OAA6CoV,EAAc,0BAAApV,OAAyByW,EAAc,mBAG7G,MAAM/L,QAAiBC,MAAM,GAAD3K,OAAI8I,EAAQ,4BAA4B,CAClE8B,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMC,KAAKC,UAAU,CACnBC,QAASA,EACTE,OAAQsL,EACRrL,YAAY,EACZC,UAAU,EACVsL,iBAAkBtB,MAItB,IAAI3K,EAASa,GAQX,MAAM,IAAIC,MAAM,eAADxL,OAAgB0K,EAAS/K,SARzB,CACf,MACMmM,SADapB,EAASgB,QACC1C,SAAW,iCAExC5E,QAAQqC,IAAI,4DAADzG,OAA0D8L,EAAgBxM,OAAM,mBAC3FsW,EAAW9J,GACX+J,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACpB,GAAiB,cACrD,CAGF,CACF,CAAE,MAAOwB,GACPxS,QAAQD,MAAM,gCAAiCyS,GAC/ChB,EAAW,2CAAD5V,OAA4C4W,EAAIC,UAC1DhB,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACpB,GAAiB,UACrD,CAAC,QACC/T,GAAa,EACf,MAnDE+C,QAAQ0S,KAAK,2CAoPHlX,UAAU,yBACV0G,SAAUlF,EACVjB,MAAM,4CAAwCX,SAC/C,wBAKDD,cAAA,UACEW,QAtMc6W,KAC1BvP,OAAOC,KAAK,uBAAwB,WAsMxB7H,UAAU,uBACVO,MAAM,uCAAsCX,SAC7C,yBAKDD,cAAA,UACEW,QA1MY8W,KACpBrB,EACFA,EAAe,SAEfvR,QAAQ0S,KAAK,4CAuMHlX,UAAU,wBACVO,MAAM,mCAAkCX,SACzC,uBAKDD,cAAA,UACEW,QApMY+W,KACxB,GAAqB,OAAjB1B,EAEF,YADA7O,MAAM,yDAIR,MAiBMwQ,EAjBY,CAChB,YAAS,MAAM,MAAQ,MAAM,eAAY,MAAM,QAAU,MAAM,iBAAc,MAC7E,WAAQ,MAAM,MAAQ,MAAM,KAAO,MAAM,WAAW,MAAM,WAAW,MACrE,SAAS,MAAM,SAAS,MAAM,eAAe,MAAM,eAAe,MAClE,OAAS,MAAM,gBAAU,MAAM,OAAS,MAAM,IAAM,MAAM,QAAU,MACpE,UAAY,MAAM,iBAAc,MAAM,yBAAyB,MAC/D,cAAQ,MAAM,gBAAU,MAAM,aAAe,MAAM,iBAAW,MAAM,OAAS,MAC7E,UAAO,MAAM,UAAO,MAAM,KAAO,MAAM,OAAS,MAAM,MAAQ,MAAM,YAAS,MAC7E,MAAQ,MAAM,QAAU,MAAM,SAAW,MAAM,WAAQ,MAAM,SAAW,MAAM,SAAW,MACzF,SAAW,MAAM,KAAO,MAAM,IAAM,MAAM,KAAO,MAAM,MAAQ,MAC/D,QAAU,MAAM,gBAAgB,MAAM,gBAAgB,MAAM,QAAU,MACtE,kBAAY,MAAM,YAAc,MAAM,WAAa,MAAM,oBAAoB,MAC7E,oBAAoB,MAAM,gBAAa,MAAM,gBAAa,MAAM,KAAO,MACvE,cAAW,MAAM,aAAU,MAAM,QAAU,MAAM,WAAW,MAAM,WAAW,MAC7E,SAAS,MAAM,SAAS,MAAM,SAAS,MAAM,KAAO,MAAM,WAAa,OAGlD3B,GACvB,IAAK2B,EAEH,YADAxQ,MAAM,qCAIR,IAAIyQ,EAAG,qCAAAnX,OAAwCkX,GACvB,OAApB1B,IACF2B,GAAG,IAAAnX,OAAQwV,GACW,OAAlBC,IAAwB0B,GAAG,IAAAnX,OAAQyV,KAEzCjO,OAAOC,KAAK0P,EAAK,WAmKLvX,UAAU,uBACVO,MAAM,mCAAkCX,SACzC,uBAKDD,cAACqS,EAAe,CAACC,WAAYnJ,oIAAYC,uBAAyBnB,OAAOqB,SAASuO,eAIrFnO,GACC1J,cAAA,OAAKa,MAAO,CACV6E,SAAU,2BACVJ,UAAW,SACXO,QAAS,GACTF,WAAY,OACZ1F,SACCyJ,UAOTlJ,eAAA,OAAKK,MAAO,CACVwF,SAAU,QACVT,OAAQ,SACRP,QAAS,QACTpF,SAAA,CACCwJ,GAAWA,EAAQxG,OAAOlD,OAAS,EAClCC,cAAA,OAAKa,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,yBACTlE,UAAW,iCACXD,OAAQ,qCACRsH,WAAY,MACZ9C,SAAU,yBACVD,aAAc,QACdxF,SACAD,cAAA,OACEyI,wBAAyB,CAAEC,OAAO,MAADjI,OApLdgJ,IACxBA,EAGEA,EACJxE,QAAQ,iBAAkB,uBAC1BA,QAAQ,QAAS,WACjBA,QAAQ,MAAO,SANG,GAmL8B6S,CAAsBrO,GAAQ,SACvE5I,MAAO,CAAE0E,MAAO,eAIpB/E,eAAA,OAAKK,MAAO,CACVsE,WAAY,QACZnE,aAAc,OACdqE,QAAS,yBACTC,UAAW,SACXnE,UAAW,mCACXlB,SAAA,CACAD,cAAA,OAAKa,MAAO,CACV6E,SAAU,yBACVD,aAAc,QACdxF,SAAC,WACHD,cAAA,MAAIa,MAAO,CACT6E,SAAU,2BACVH,MAAO,UACPE,aAAc,OACdE,WAAY,OACZ1F,SAAC,iCAGHO,eAAA,KAAGK,MAAO,CACR0E,MAAO,UACPG,SAAU,2BACVW,SAAU,QACVT,OAAQ,SACR4C,WAAY,OACZvI,SAAA,CAAC,6EACuD6V,EAAc,UAExE9V,cAAA,OAAKa,MAAO,CACVoF,UAAW,OACXP,SAAU,OACVH,MAAO,WACPtF,SAAC,+EAOPO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTE,IAAK,OACLC,UAAW,OACXF,eAAgB,SAChB6B,SAAU,QACV3H,SAAA,CAEC4V,EAAiB,GAChBrV,eAAA,UACEG,QAASA,IAAMoV,EAAqBF,EAAiB,GACrDhV,MAAO,CACLsE,WAAY,oDACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,gDACTrE,aAAc,OACd0E,SAAU,2BACVC,WAAY,MACZH,OAAQ,UACRU,WAAY,gBACZ/E,UAAW,uCACX6F,SAAU,SAEZS,YAAclB,IACZA,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAE7BwG,WAAapB,IACXA,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAY,wCAC3BlB,SAAA,CACH,mBACa4V,EAAiB,KAKhCA,EAAiB,IAChBrV,eAAA,UACEG,QAASA,IAAMoV,EAAqBF,EAAiB,GACrDhV,MAAO,CACLsE,WAAW,2BAAD1E,OAA6BkW,EAAcE,MAAK,SAAApW,OAAQkW,EAAcG,IAAG,UACnFvR,MAAO,QACPrE,OAAQ,OACRmE,QAAS,gDACTrE,aAAc,OACd0E,SAAU,2BACVC,WAAY,MACZH,OAAQ,UACRU,WAAY,gBACZ/E,UAAU,cAADV,OAAgBkW,EAAcE,MAAK,MAC5C7P,SAAU,SAEZS,YAAclB,IACZA,EAAEK,OAAO/F,MAAM6G,UAAY,mBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAS,cAAAV,OAAiBkW,EAAcE,MAAK,OAE9DlP,WAAapB,IACXA,EAAEK,OAAO/F,MAAM6G,UAAY,gBAC3BnB,EAAEK,OAAO/F,MAAMM,UAAS,cAAAV,OAAiBkW,EAAcE,MAAK,OAC5D5W,SAAA,CACH,YACW4V,EAAiB,EAAE,gBAMnCrV,eAAA,OAAKK,MAAO,CACVyE,UAAW,SACXW,UAAW,OACXP,SAAU,yBACVH,MAAO,WACPtF,SAAA,CAAC,yBACY4V,EAAe,yDAK/BW,GACCxW,cAAA,OAAKa,MAAO,CACV6L,SAAU,QACVC,IAAK,EACLG,KAAM,EACNC,MAAO,EACPC,OAAQ,EACR/L,gBAAiB,qBACjB2L,OAAQ,IACR9G,QAAS,OACTC,eAAgB,SAChBI,WAAY,SACZd,QAAS,QACTpF,SACAO,eAAA,OAAKK,MAAO,CACVsE,WAAY,4BACZ+H,eAAgB,aAChBhM,OAAQ,qCACRF,aAAc,OACdqE,QAAS,OACT2B,SAAU,QACVX,SAAU,QACViC,UAAW,OACXC,UAAW,OACXpH,UAAW,+BACXuL,SAAU,YACVzM,SAAA,CAEAD,cAAA,SAAAC,SAAA,idAkBAO,eAAA,OAAKK,MAAO,CACViF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZV,aAAc,OACdwP,aAAc,4BACdC,cAAe,QACfjV,SAAA,CACAO,eAAA,MAAIK,MAAO,CACT+E,OAAQ,EACRL,MAAO,OACPG,SAAU,OACVC,WAAY,OACZG,QAAS,OACTK,WAAY,SACZH,IAAK,OACL/F,SAAA,CAAC,sCACyB4V,KAE5B7V,cAAA,UACEW,QAASA,IAAM8V,GAAkB,GACjC5V,MAAO,CACLsE,WAAY,OACZjE,OAAQ,OACRwE,SAAU,OACVF,OAAQ,UACRD,MAAO,OACPF,QAAS,MACTrE,aAAc,MACdkF,WAAY,mBAEduB,YAAclB,GAAMA,EAAEK,OAAO/F,MAAM0E,MAAQ,OAC3CoC,WAAapB,GAAMA,EAAEK,OAAO/F,MAAM0E,MAAQ,OAAOtF,SAClD,cAMFwS,EACCjS,eAAA,OAAAP,SAAA,CAEEO,eAAA,OAAKK,MAAO,CAAE4E,aAAc,QAASxF,SAAA,CACnCO,eAAA,MAAIK,MAAO,CACT+E,OAAQ,aACRL,MAAO,OACPG,SAAU,OACVC,WAAY,MACZ6O,cAAe,YACfC,cAAe,SACfxU,SAAA,CAAC,qBACegE,OAAO8T,KAAKtF,EAAUa,MAAMvT,OAAO,2BAGpDkE,OAAOC,QAAQuO,EAAUa,MAAMhT,IAAIwU,IAAA,IAAE/Q,EAAK6Q,GAAIE,EAAA,OAC7CtU,eAAA,OAEEK,MAAO,CACLiF,QAAS,OACTC,eAAgB,gBAChBI,WAAY,SACZd,QAAS,OACTI,aAAc,MACdN,WAA0B,UAAdyP,EAAIrP,MAAoB,wBAA0B,wBAC9DrE,OAAO,aAADT,OAA6B,UAAdmU,EAAIrP,MAAoB,uBAAyB,wBACtEvE,aAAc,OACdkF,WAAY,gBACZ/E,UAAU,aAADV,OAA6B,UAAdmU,EAAIrP,MAAoB,uBAAyB,yBACzEtF,SAAA,CAEFO,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQ+O,cAAe,UAAW5U,SAAA,CACvDO,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQK,WAAY,SAAUV,aAAc,OAAQxF,SAAA,CACzED,cAAA,OAAKa,OA/jBX0E,EA+jB2B+O,EAAYM,GA/jBlC,CACrB9T,MAAO,OACPC,OAAQ,OACRC,aAAc,MACdC,gBAAiBsE,EACjBwP,YAAa,OACb5T,UAAU,WAADV,OAAa8E,GACtB8C,UAAW,wCAyjBWrI,cAAA,QAAMa,MAAO,CACX8E,WAAY,OACZJ,MAAO,OACPwP,YAAa,OACbrP,SAAU,QACVzF,SACC2U,EAAIpB,OAENzP,IAAQ0O,EAAUsB,YACjB/T,cAAA,QAAMa,MAAO,CACXsE,WAAY,4CACZI,MAAO,QACPF,QAAS,WACTrE,aAAc,OACd0E,SAAU,OACVC,WAAY,OACZ6O,cAAe,aACfvU,SAAC,cAKPO,eAAA,OAAKK,MAAO,CACV6E,SAAU,OACVH,MAAO,OACPnE,WAAY,OACZ0E,QAAS,OACTK,WAAY,SACZH,IAAK,QACL/F,SAAA,CACAO,eAAA,QAAAP,SAAA,CAAM,UAAG2U,EAAIQ,cAAc,gBAC3B5U,eAAA,QAAAP,SAAA,CAAM,UAAG2U,EAAIS,YAAY,gBACxBT,EAAIU,WACH9U,eAAA,QAAAP,SAAA,CAAM,gBAAI,IAAI+P,KAAK4E,EAAIU,WAAWtD,8BAIxCxR,eAAA,OAAKK,MAAO,CAAEiF,QAAS,OAAQK,WAAY,SAAUH,IAAK,OAAQ/F,SAAA,CAChED,cAAA,QAAMa,MAAO,CACX6E,SAAU,OACVH,MAAqB,UAAdqP,EAAIrP,MAAoB,UAAY,UAC3CI,WAAY,OACZ6O,cAAe,aACfvU,SACgB,cAAf2U,EAAIxU,OAAyB,aAAe,wBAE/CJ,cAAA,QAAMa,MAAO,CAAE6E,SAAU,QAASzF,SAC/ByW,EAAc9B,UAhEd7Q,GA/iBPwB,WAunBJ/E,eAAA,OAAKK,MAAO,CACVsE,WAAY,0BACZjE,OAAQ,mCACRF,aAAc,OACdqE,QAAS,OACTI,aAAc,QACdxF,SAAA,CACAD,cAAA,MAAIa,MAAO,CACT+E,OAAQ,YACRL,MAAO,UACPG,SAAU,OACVC,WAAY,QACZ1F,SAAC,uCAGHO,eAAA,OAAKK,MAAO,CAAE6E,SAAU,OAAQH,MAAO,OAAQO,QAAS,OAAQ8B,SAAU,OAAQ5B,IAAK,QAAS/F,SAAA,CAC9FO,eAAA,QAAAP,SAAA,CAAM,4BAAgBwS,EAAUsB,YAAc,YAC9CvT,eAAA,QAAAP,SAAA,CAAM,oBAAawS,EAAUuF,gBAAkB,YAAW,gBAC1DxX,eAAA,QAAAP,SAAA,CAAM,mCAAuB4V,EAAe,MAAIC,WAKpD9V,cAAA,OAAKa,MAAO,CAAEyE,UAAW,SAAUW,UAAW,QAAShG,SACrDD,cAAA,UACEW,QAASA,KACPwS,IACAc,KAEFpT,MAAO,CACLsE,WAAY,4CACZI,MAAO,QACPrE,OAAQ,OACRmE,QAAS,YACTrE,aAAc,MACd0E,SAAU,OACVC,WAAY,MACZH,OAAQ,UACRU,WAAY,iBACZjG,SACH,iCAMLO,eAAA,OAAKK,MAAO,CAAEyE,UAAW,SAAUD,QAAS,aAAcpF,SAAA,CACxDD,cAAA,OAAKa,MAAO,CAAE6E,SAAU,OAAQD,aAAc,QAASxF,SAAC,iBACxDD,cAAA,KAAGa,MAAO,CAAE0E,MAAO,OAAQK,OAAQ,GAAI3F,SAAC,iDCruBxD,MAYMgJ,EAZgBC,MAEpB,GAAIC,oIAAYC,sBACd,OAAOD,oIAAYC,sBAGrB,MAAMC,EAAWpB,OAAOqB,SAASD,SACjC,MAAiB,cAAbA,GAAyC,cAAbA,EAAiC,wBAE1D,oDAGWH,GACdK,EAAQ,GAAA9I,OAAMwI,EAAYhE,QAAQ,QAAS,IAAG,QAM9CgT,EAAiB,SAACC,EAAgBC,GAAW,IAAEC,EAASC,UAAAtY,OAAA,QAAAuY,IAAAD,UAAA,IAAAA,UAAA,GAAQ,MAAM,CAC1EvS,QAAS,OACT+O,cAAe,SACf1O,WAAY,SACZJ,eAAgB,SAChBV,QAAS,YACTrE,aAAc,OACdkE,UAAW,OACXQ,SAAU,OACVC,WAAY,MACZJ,MAAO,QACPrE,OAAQ,OACRsE,OAAQ,UACRL,WAAW,2BAAD1E,OAA6ByX,EAAerB,MAAK,SAAApW,OAAQyX,EAAepB,IAAG,UACrF3V,UAAWiX,EAAS,eAAA3X,OACD0X,EAAYlT,QAAQ,OAAQ,QAAO,kDAAAxE,OACpC0X,EAAW,mCAC7BjS,WAAY,wCACZwB,UAAW0Q,EAAY,+BAAiC,gBACzD,EAEKG,EACG,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,4BAD/CD,EAEM,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,4BAFlDD,EAGI,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,4BAHhDD,EAII,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,4BAJhDD,EAKK,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,2BALjDD,EAMM,CAAE1B,MAAO,UAAWC,IAAK,UAAW0B,OAAQ,4BASxD,SAASC,EAAoBC,GAE3B,OARF,SAAkBC,GAChB,QAAUL,IAANK,GAAyB,OAANA,EAAY,MAAO,GAC1C,GAAiB,kBAANA,EAAgB,OAAOA,EAClC,IAAM,OAAOnN,KAAKC,UAAUkN,EAAG,KAAM,EAAI,CAAE,MAAAC,GAAQ,OAAOC,OAAOF,EAAI,CACvE,CAGYG,CAASJ,GAEhBzT,QAAQ,gBAAiB,iBACzBA,QAAQ,sBAAuB,wBAC/BA,QAAQ,kCAAgC,oCACxCA,QAAQ,4BAA6B,gCACrCA,QAAQ,2BAAyB,+BACjCA,QAAQ,6BAA2B,gCACxC,CAMA,MAAM8T,EAAQ,CACZ,YAAU,QAAS,eAAa,UAAW,iBAC3C,WAAS,QAAS,OAAQ,WAAY,WAAY,SAAU,SAC5D,eAAgB,eAAgB,SAAU,gBAAW,SACrD,MAAO,UAAW,YAAa,iBAAe,yBAC9C,cAAS,gBAAW,eAAgB,iBAAY,SAChD,UAAQ,UAAQ,OAAQ,SAAU,QAAS,YAAU,QAAS,UAC9D,WAAY,WAAS,WAAY,WACjC,WAAY,OAAQ,MAAO,OAAQ,QACnC,UAAW,gBAAiB,gBAAiB,UAAW,kBACxD,cAAe,aAAc,oBAAqB,oBAClD,gBAAc,gBAAc,OAAQ,cAAY,aAChD,UAAW,WAAY,WAAY,SAAU,SAAU,SAAU,OACjE,cAGIC,EAAgB,CACpB,YAAU,GAAI,MAAS,GAAI,eAAa,GAAI,QAAW,GAAI,iBAAe,GAC1E,WAAS,GAAI,MAAS,GAAI,KAAQ,EAAG,WAAY,GAAI,WAAY,GACjE,SAAU,GAAI,SAAU,GAAI,eAAgB,GAAI,eAAgB,GAChE,OAAU,GAAI,gBAAW,GAAI,OAAU,GAAI,IAAO,GAAI,QAAW,IACjE,UAAa,GAAI,iBAAe,GAAI,yBAA0B,EAC9D,cAAS,GAAI,gBAAW,GAAI,aAAgB,EAAG,iBAAY,GAAI,OAAU,GACzE,UAAQ,GAAI,UAAQ,EAAG,KAAQ,EAAG,OAAU,EAAG,MAAS,EAAG,YAAU,EACrE,MAAS,EAAG,QAAW,EAAG,SAAY,EAAG,WAAS,EAAG,SAAY,GAAI,SAAY,EACjF,SAAY,GAAI,KAAQ,GAAI,IAAO,GAAI,KAAQ,GAAI,MAAS,GAC5D,QAAW,GAAI,gBAAiB,GAAI,gBAAiB,GAAI,QAAW,EACpE,kBAAa,EAAG,YAAe,EAAG,WAAc,EAAG,oBAAqB,EACxE,oBAAqB,EAAG,gBAAc,EAAG,gBAAc,EAAG,KAAQ,EAClE,cAAY,EAAG,aAAW,GAAI,QAAW,EAAG,WAAY,EAAG,WAAY,EACvE,SAAU,EAAG,SAAU,EAAG,SAAU,EAAG,KAAQ,EAAG,WAAc,IAG5DzC,EAAiB,CACrB,6BACA,wBACA,0BACA,wCACA,qBACA,6BACA,sBACA,oBACA,2BACA,mBACA,0BACA,kCACA,cACA,0BACA,0BACA,mBACA,0BACA,0BACA,4BACA,0BACA,uBACA,sBACA,4BACA,2BACA,2BACA,qBACA,0BACA,+BACA,iBA01DF,SAAS0C,EAAY3U,GACnB,OAAOiS,EAAejS,IAAM,YAAA7D,OAAgB6D,EAC9C,CAEA,SAAS4U,EAAUxZ,GAAuC,IAAtC,MAAEyZ,EAAK,MAAEzS,EAAK,QAAE0S,EAAO,SAAEzS,GAAUjH,EACrD,OACEc,eAAA,OAAKH,UAAU,cAAaJ,SAAA,CAC1BD,cAAA,SAAAC,SAAQkZ,IACRnZ,cAAA,UAAQ0G,MAAOA,EAAOC,SAAUA,EAAS1G,SACtCmZ,EAAQ9Y,IAAK+Y,GAAMrZ,cAAA,UAAgB0G,MAAO2S,EAAEpZ,SAAEoZ,GAAdA,QAIzC,CAwCeC,MA90Df,WAEE,MAAOtD,EAAcuD,GAAmB7X,mBAAS,cAC1CuU,EAAiBuD,GAAsB9X,mBAAS,MAChDwU,EAAeuD,GAAoB/X,mBAAS,OAC5CgY,EAAiBC,GAAsBjY,mBAAS,QAChDyU,EAAgByD,GAAqBlY,mBAAS,MAC9CmY,EAAgBC,GAAqBpY,mBAAS,IAC9C+H,EAAS4M,GAAc3U,mBAAS,KAChCG,EAAWC,GAAgBJ,oBAAS,IACpCqY,EAAoBC,GAAyBtY,mBAAS,CAAC,IACvD5B,EAAiBwW,GAAsB5U,mBAAS,CAAC,IACjDuY,EAAcC,GAAmBxY,mBAAS,IAC1CyY,EAAWC,GAAgB1Y,mBAAS,OACpC2Y,EAAiBC,GAAsB5Y,mBAAS,IAChD6Y,EAAaC,GAAkB9Y,mBAAS,KAGxC+Y,EAAsBC,GAA2BhZ,oBAAS,IAC1DiZ,EAAmBC,IAAwBlZ,mBAAS,IACpDmZ,GAAkBC,IAAuBpZ,mBAAS,OAClDqZ,GAAsBC,IAA2BtZ,oBAAS,IAC1DuZ,GAAmBC,IAAwBxZ,mBAAS,IACpDyZ,GAAmBC,IAAwB1Z,oBAAS,IAOpD2Z,GAAajF,IAAkB1U,mBAAS,SACxC4Z,GAAmBC,IAAwB7Z,mBAAS,KACpD8Z,GAAiBC,IAAsB/Z,mBAAS,KAChDga,GAAuBC,IAA4Bja,mBAAS,IAC5Dka,GAAwBC,IAA6Bna,mBAAS,IAG/Doa,GAAc,CAClB,CAAEtI,KAAM,kBAAmBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UAC3E9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,mBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,mBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,eAAgBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACxE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,gBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,eAAgBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACxE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,gBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,eAAgBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACxE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,aAAcuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACtE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,eAAgBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACxE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,gBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,iEACZ,CAAE1I,KAAM,gBAAiBuI,QAAS,UAAWC,UAAW,UAAWC,OAAQ,UACzE9W,WAAY,oDACZ+W,SAAU,kEAIRC,GAAoBC,kBAAQ,KAChC,GAAqB,OAAjBpG,IAA0BgD,EAAchD,GAAe,MAAO,CAAC,MACnE,MAAMqG,EAAMrD,EAAchD,IAAiB,EAC3C,MAAO,CAAC,QAASsG,MAAMC,KAAK,CAAExc,OAAQsc,GAAO,CAACG,EAAG5O,IAAMA,EAAI,KAC1D,CAACoI,IAGJ3L,oBAAU,KACR,MAAMoS,EAAQrM,aAAaK,QAAQ,kBACnC,GAAIgM,EAAS,IAAMrC,EAAa5O,KAAKmF,MAAM8L,GAAS,CAAE,MAAMlW,GAAI1B,QAAQD,MAAM2B,EAAG,CACjF,MAAMmW,EAAeA,IAAMC,KAC3B1U,OAAOkJ,iBAAiB,eAAgBuL,GAGxC,MAAMlV,EAAQsU,GAAY7B,GAC1BhJ,SAAS2L,gBAAgB/b,MAAMgc,YAAY,kBAAkB,2BAADpc,OAA6B+G,EAAMuU,QAAO,MAAAtb,OAAK+G,EAAMwU,UAAS,MAC1H/K,SAAS2L,gBAAgB/b,MAAMgc,YAAY,oBAAoB,2BAADpc,OAA6B+G,EAAMwU,UAAS,MAAAvb,OAAK+G,EAAMuU,QAAO,MAC5H9K,SAAS2L,gBAAgB/b,MAAMgc,YAAY,iBAAiB,2BAADpc,OAA6B+G,EAAMyU,OAAM,MAAAxb,OAAK+G,EAAMwU,UAAS,MAExH,MAAMc,EAAYA,CAACC,EAAKC,KACtB,MAAMC,EAAI3P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IAC9BwY,EAAI5P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IAC9ByY,EAAI7P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IACpC,MAAM,QAANjE,OAAewc,EAAC,MAAAxc,OAAKyc,EAAC,MAAAzc,OAAK0c,EAAC,MAAA1c,OAAKuc,EAAK,MAMxC,OAHA/L,SAAS2L,gBAAgB/b,MAAMgc,YAAY,wBAAyBC,EAAUtV,EAAMyU,OAAQ,KAC5FhL,SAAS2L,gBAAgB/b,MAAMgc,YAAY,8BAA+BC,EAAUtV,EAAMyU,OAAQ,KAE3F,IAAMhU,OAAOmJ,oBAAoB,eAAgBsL,IACvD,CAACzC,IAGJ5P,oBAAU,KACRjH,WAAW,KAAQga,KAAiBlD,EAAgB,IAAO,MAC1D,IAEH7P,oBAAU,KACa,OAAjB2L,GAA6C,OAApBC,IAC3BpR,QAAQqC,IAAI,wDAAgD8O,EAAcC,GAC1E0G,OAED,CAAC3G,EAAcC,IAElB,MAAM0G,GAAmBA,KAQvB,GAPA9X,QAAQqC,IAAI,2CAA4C,CACtD8O,eACAC,kBACAC,gBACAR,eAAgBjM,EAAUA,EAAQ1J,OAAS,IAGxB,OAAjBiW,GAA6C,OAApBC,EAA0B,CACrD,MAAMoH,EAAe,CACnB7Z,KAAMwS,EAAcvS,QAASwS,EAAiBvS,MAAOwS,EACrDvK,QAAS+N,EAAiB3Z,OAAQoW,EAAgB0D,iBAClDpQ,UAAS3J,kBAAiBiQ,WAAW,IAAIC,MAAOC,cAChDqN,aAAa,GAAD7c,OAAKuV,EAAY,KAAAvV,OAAIwV,GAAexV,OAAqB,OAAlByV,EAAyB,IAAMA,EAAgB,KAEpG9F,aAAaC,QAAQ,iBAAkB7E,KAAKC,UAAU4R,IACtDjD,EAAaiD,GACbxY,QAAQqC,IAAI,gDAA2CmW,EAAaC,aACtE,MACEzY,QAAQqC,IAAI,yEAgBVqW,GAAiBhH,EAAejW,IAAI,CAACM,EAAO0D,KAAK,CAAQ5D,GAAI4D,EAAO1D,WAqLpE4c,GAA0B,SAACC,EAAa3H,EAAepK,EAASlI,EAAMC,GAE1E,MAAMia,GAF+FrF,UAAAtY,OAAA,QAAAuY,IAAAD,UAAA,GAAAA,UAAA,GAAG,OAnC/EoF,KACJ,CACnB,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,KAEcA,IAAgB,KAMOE,CAAkBF,GAiC7D,MA/B2B,CACzB,EAAGG,GAAsBlS,EAASgS,GAClC,EAAGG,GAAyBnS,EAASlI,EAAMC,EAASia,GACpD,EAAGI,GAA+BpS,EAASlI,EAAMC,EAASia,GAC1D,EAAGK,GAA8BrS,EAASlI,EAAMC,EAASia,GACzD,EAAGM,GAAsCtS,EAASlI,EAAMC,EAASia,GACjE,EAAGO,GAAiCvS,EAASlI,EAAMC,EAASia,GAC5D,EAAGQ,GAA+BxS,EAASlI,EAAMC,EAASia,GAC1D,EAAGS,GAAmCzS,EAASlI,EAAMC,EAASia,GAC9D,EAAGU,GAA+B1S,EAASlI,EAAMC,EAASia,GAC1D,GAAIW,GAAiC3S,EAASlI,EAAMC,EAASia,GAC7D,GAAIY,GAAwB5S,EAASlI,EAAMC,EAASia,GACpD,GAAIa,GAA0B7S,EAASlI,EAAMC,EAASia,GACtD,GAAIc,GAAmC9S,EAASlI,EAAMC,EAASia,GAC/D,GAAIe,GAA+B/S,EAASlI,EAAMC,EAASia,GAC3D,GAAIgB,GAA8BhT,EAASlI,EAAMC,EAASia,GAC1D,GAAIiB,GAA2BjT,EAASlI,EAAMC,EAASia,GACvD,GAAIkB,GAAmClT,EAASlI,EAAMC,EAASia,GAC/D,GAAImB,GAAoCnT,EAASlI,EAAMC,EAASia,GAChE,GAAIoB,GAA8BpT,EAASlI,EAAMC,EAASia,GAC1D,GAAIqB,GAA8BrT,EAASlI,EAAMC,EAASia,GAC1D,GAAIsB,GAA+BtT,EAASlI,EAAMC,EAASia,GAC3D,GAAIuB,GAAmCvT,EAASlI,EAAMC,EAASia,GAC/D,GAAIwB,GAAoCxT,EAASlI,EAAMC,EAASia,GAChE,GAAIyB,GAA+BzT,EAASlI,EAAMC,EAASia,GAC3D,GAAI0B,GAA8B1T,EAASlI,EAAMC,EAASia,GAC1D,GAAI2B,GAAgC3T,EAASlI,EAAMC,EAASia,GAC5D,GAAI4B,GAA4B5T,EAASlI,EAAMC,EAASia,GACxD,GAAI6B,GAA0B7T,EAASlI,EAAMC,EAASia,IAG9BD,IACxB+B,GAAuB1J,EAAepK,EAASlI,EAAMC,EAASia,EAClE,EAGME,GAAwBA,CAAClS,EAASgS,KACtC,MAAM+B,EAAW,wHAAAhf,OAAqHiL,EAAO,8LAAAjL,OAE/CiL,EAAO,yGAAAjL,OAE5CiL,EAAO,KAEhE,OAAIgS,GAAgB,IACX+B,EAAW,2KAAAhf,OAEgHiL,EAAO,2HAGvIgS,GAAgB,IACX+B,EAAW,2KAAAhf,OAEgHiL,EAAO,sxBAOvIgS,GAAgB,IACX+B,EAAW,2KAAAhf,OAEgHiL,EAAO,gqDAAAjL,OAUtGiL,EAAO,uRAGrC+T,GAIH5B,GAA2BA,CAACnS,EAASlI,EAAMC,EAASia,IAClD,mCAANjd,OAAuCiL,EAAO,2hBAI1CoS,GAAiCA,CAACpS,EAASlI,EAAMC,EAASia,IAC9C,MAAZja,EACI,GAANhD,OAAUiL,EAAO,+fAEb,iBAANjL,OAAqBiL,EAAO,mNAIxBqS,GAAgCA,CAACrS,EAASlI,EAAMC,EAASia,IACvD,oCAANjd,OAAwCiL,EAAO,shBAI3CsS,GAAwCA,CAACtS,EAASlI,EAAMC,EAASia,KACrE,MAAM+B,EAAW,mBAAAhf,OAAsBiL,EAAO,yLAE9C,OAAIgS,GAAgB,IACX+B,EAAW,8NAGhB/B,GAAgB,IACX+B,EAAW,+hCAOhB/B,GAAgB,IACX+B,EAAW,siEASbA,GAIHxB,GAAmCA,CAACvS,EAASlI,EAAMC,EAASia,IAC1D,wCAANjd,OAA4CiL,EAAO,6qDAY/C8T,GAAyBA,CAAC1J,EAAepK,EAASlI,EAAMC,EAASia,KACrE,MAAM+B,EAAW,KAAAhf,OAAQqV,EAAa,2BAAArV,OAA0BiL,EAAO,+BAAAjL,OAElDiL,EAAO,uBAAAjL,OAAqBqV,EAAa,sKAAArV,OAEpCiL,EAAO,4MAIjC,OAAIgS,GAAgB,KACX+B,EAAW,0bAAAhf,OAIiBiL,EAAO,0VAKrC+T,GAIHf,GAAgCA,CAAChT,EAASlI,EAAMC,EAASia,IACvD,kCAANjd,OAAyCiL,EAAO,s1DAc5CiT,GAA6BA,CAACjT,EAASlI,EAAMC,EAASia,IACpD,2BAANjd,OAAkCiL,EAAO,k/DAgBrCwS,GAAiCA,CAACxS,EAASlI,EAAMC,EAASia,IACvD8B,GAAuB,oBAAqB9T,EAASlI,EAAMC,EAASia,GAGvES,GAAqCA,CAACzS,EAASlI,EAAMC,EAASia,IAC3D8B,GAAuB,2BAAyB9T,EAASlI,EAAMC,EAASia,GAG3EU,GAAiCA,CAAC1S,EAASlI,EAAMC,EAASia,IACvD8B,GAAuB,mBAAoB9T,EAASlI,EAAMC,EAASia,GAGtEW,GAAmCA,CAAC3S,EAASlI,EAAMC,EAASia,IACzD8B,GAAuB,0BAAwB9T,EAASlI,EAAMC,EAASia,GAG1EY,GAA0BA,CAAC5S,EAASlI,EAAMC,EAASia,IAChD8B,GAAuB,kCAAgC9T,EAASlI,EAAMC,EAASia,GAGlFa,GAA4BA,CAAC7S,EAASlI,EAAMC,EAASia,IAClD8B,GAAuB,cAAe9T,EAASlI,EAAMC,EAASia,GAGjEc,GAAqCA,CAAC9S,EAASlI,EAAMC,EAASia,IAC3D8B,GAAuB,0BAAwB9T,EAASlI,EAAMC,EAASia,GAG1Ee,GAAiCA,CAAC/S,EAASlI,EAAMC,EAASia,IACvD8B,GAAuB,0BAAwB9T,EAASlI,EAAMC,EAASia,GAG1EkB,GAAqCA,CAAClT,EAASlI,EAAMC,EAASia,IAC3D8B,GAAuB,0BAA2B9T,EAASlI,EAAMC,EAASia,GAG7EmB,GAAsCA,CAACnT,EAASlI,EAAMC,EAASia,IAC5D8B,GAAuB,4BAA6B9T,EAASlI,EAAMC,EAASia,GAG/EoB,GAAgCA,CAACpT,EAASlI,EAAMC,EAASia,IACtD8B,GAAuB,0BAAqB9T,EAASlI,EAAMC,EAASia,GAGvEqB,GAAgCA,CAACrT,EAASlI,EAAMC,EAASia,IACtD8B,GAAuB,uBAAqB9T,EAASlI,EAAMC,EAASia,GAGvEsB,GAAiCA,CAACtT,EAASlI,EAAMC,EAASia,IACvD8B,GAAuB,sBAAuB9T,EAASlI,EAAMC,EAASia,GAGzEuB,GAAqCA,CAACvT,EAASlI,EAAMC,EAASia,IAC3D8B,GAAuB,4BAA0B9T,EAASlI,EAAMC,EAASia,GAG5EwB,GAAsCA,CAACxT,EAASlI,EAAMC,EAASia,IAC5D8B,GAAuB,2BAA4B9T,EAASlI,EAAMC,EAASia,GAG9EyB,GAAiCA,CAACzT,EAASlI,EAAMC,EAASia,IACvD8B,GAAuB,2BAAsB9T,EAASlI,EAAMC,EAASia,GAGxE0B,GAAgCA,CAAC1T,EAASlI,EAAMC,EAASia,IACtD8B,GAAuB,qBAAsB9T,EAASlI,EAAMC,EAASia,GAGxE2B,GAAkCA,CAAC3T,EAASlI,EAAMC,EAASia,IACxD8B,GAAuB,0BAAqB9T,EAASlI,EAAMC,EAASia,GAGvE4B,GAA8BA,CAAC5T,EAASlI,EAAMC,EAASia,IACpD8B,GAAuB,+BAA0B9T,EAASlI,EAAMC,EAASia,GAG5E6B,GAA4BA,CAAC7T,EAASlI,EAAMC,EAASia,IAClD8B,GAAuB,gBAAiB9T,EAASlI,EAAMC,EAASia,GA2JnEgC,GAAoBA,CAACjW,EAASC,KAClC6R,GAAqB9R,GACrBgS,GAAmB/R,GACnB0M,GAAe,YAGXuJ,GAAkBA,KACtBvJ,GAAe,UAGXwJ,GAAqB,SAAC/J,GAAkC,IAAlBpM,EAAO4O,UAAAtY,OAAA,QAAAuY,IAAAD,UAAA,GAAAA,UAAA,GAAG,GACpDxT,QAAQqC,IAAI,sCAADzG,OAAuCoV,EAAc,MAChEhR,QAAQqC,IAAI,6CAA2CuC,EAAUA,EAAQ1J,OAAS,EAAG,iBACrF8E,QAAQqC,IAAI,6CAA8CuC,EAAUA,EAAQ/E,MAAM,EAAG,KAAO,MAAQ,QAEpGiX,GAAyB9F,GACzBgG,GAA0BpS,GAC1B,MAAMC,EAAQ,GAAAjJ,OAAMuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,KAAGxV,OAAqB,OAAlByV,EAAyB,IAAMA,EAAgB,IACxHuF,GAAmB/R,GACnB0M,GAAe,WACjB,EAEMyJ,GAAiBA,KACrBzJ,GAAe,SA8DX0J,GAAuB9c,UAC3B8W,EAAkBpZ,GAGlB,MAAMqf,EAAU,GAAAtf,OAAMuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIC,GAGzD,GAA4B,cAAxBZ,EAAgBY,IAAuBqZ,EAAmBgG,GAI5D,GAHAlb,QAAQqC,IAAI,uBAADzG,OAAwBC,EAAE,kDAAAD,OAA2CsZ,EAAmBgG,GAAYhgB,SAGpG,IAAPW,IAAaqZ,EAAmBgG,GAAY5b,SAAS,WAAa4V,EAAmBgG,GAAY5b,SAAS,qBAAsB,CAClI,MAAMuF,EAAQ,GAAAjJ,OAAMuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,KAAGxV,OAAqB,OAAlByV,EAAyB,IAAMA,EAAgB,IACxHwJ,GAAkB3F,EAAmBgG,GAAarW,EACpD,MAEShJ,GAAM,GAAKA,GAAM,IACxBmE,QAAQqC,IAAI,wBAADzG,OAAyBC,EAAE,4BACtCkf,GAAmBlf,EAAIqZ,EAAmBgG,KAG1C1J,EAAW0D,EAAmBgG,SAE3B,GAAIrf,GAAM,GAAKA,GAAM,GAAI,CAE9BmE,QAAQqC,IAAI,uCAADzG,OAAkCC,EAAE,kCAC/C,MAAMgL,EAA6B,OAAlBwK,GAA4C,SAAlBA,EAAwB,GAAAzV,OAC5DuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,KAAG,GAAAxV,OAClDuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,IAAG,KAAAxV,OAAIyV,GACvD8J,QAAyBC,GAAuBvf,EAAI6V,EAAe7V,GAAKgL,GAG9EkU,GAAmBlf,EAAIsf,GAAoB,GAC7C,MAEE3J,EAAW,KA0DT+G,GAAgBA,KACpB,MAAM8C,GAAajG,EAAe,GAAK6B,GAAY/b,OACnDma,EAAgBgG,GAChB,MAAM1Y,EAAQsU,GAAYoE,GAEpBC,EAAMlP,SAASmP,cAAc,QAC/BD,IAAKA,EAAItf,MAAMsE,WAAaqC,EAAMrC,YAEtC,MAAMkb,EAASpP,SAASmP,cAAc,kBAClCC,IAAQA,EAAOxf,MAAMsE,WAAaqC,EAAM0U,UAE5CjL,SAAS2L,gBAAgB/b,MAAMgc,YAAY,kBAAkB,2BAADpc,OAA6B+G,EAAMuU,QAAO,MAAAtb,OAAK+G,EAAMwU,UAAS,MAC1H/K,SAAS2L,gBAAgB/b,MAAMgc,YAAY,oBAAoB,2BAADpc,OAA6B+G,EAAMwU,UAAS,MAAAvb,OAAK+G,EAAMuU,QAAO,MAC5H9K,SAAS2L,gBAAgB/b,MAAMgc,YAAY,iBAAiB,2BAADpc,OAA6B+G,EAAMyU,OAAM,MAAAxb,OAAK+G,EAAMwU,UAAS,MAGxH,MAAMc,EAAYA,CAACC,EAAKC,KACtB,MAAMC,EAAI3P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IAC9BwY,EAAI5P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IAC9ByY,EAAI7P,SAASyP,EAAIrY,MAAM,EAAG,GAAI,IACpC,MAAM,QAANjE,OAAewc,EAAC,MAAAxc,OAAKyc,EAAC,MAAAzc,OAAK0c,EAAC,MAAA1c,OAAKuc,EAAK,MAGxC/L,SAAS2L,gBAAgB/b,MAAMgc,YAAY,wBAAyBC,EAAUtV,EAAMyU,OAAQ,KAC5FhL,SAAS2L,gBAAgB/b,MAAMgc,YAAY,8BAA+BC,EAAUtV,EAAMyU,OAAQ,KAElG,MAAMqE,EAAerP,SAASmP,cAAc,kBACxCE,IAAcA,EAAazf,MAAMsE,WAAaqC,EAAMuU,SAExD,MAAMwE,EAAgBtP,SAASmP,cAAc,mBACzCG,IACFA,EAAc1f,MAAMsE,WAAU,2BAAA1E,OAA8B+G,EAAMuU,QAAO,MAAAtb,OAAK+G,EAAMwU,UAAS,MAE/F,MAAMwE,EAAWvP,SAASmP,cAAc,cACpCI,IAAYA,EAAS3f,MAAMsE,WAAaqC,EAAMwU,UAAWwE,EAAS3f,MAAM0E,MAAQ,QAASib,EAAS3f,MAAMK,OAAS,QAErH,MAAMuf,EAAaxP,SAASmP,cAAc,gBACtCK,IAAcA,EAAW5f,MAAMsE,WAAaqC,EAAMuU,QAAS0E,EAAW5f,MAAM0E,MAAQ,QAASkb,EAAW5f,MAAMK,OAAS,QAE3H,MAAMwf,EAAezP,SAASmP,cAAc,mBACxCM,IACFA,EAAa7f,MAAMsE,WAAU,2BAAA1E,OAA8B+G,EAAMuU,QAAO,MAAAtb,OAAK+G,EAAMwU,UAAS,KAC5F0E,EAAa7f,MAAM0E,MAAQ,QAASmb,EAAa7f,MAAMK,OAAS,QAGlE,MAAMyf,EAAY1P,SAASmP,cAAc,eACrCO,IAAaA,EAAU9f,MAAMsE,WAAU,0BAAA1E,OAA6B+G,EAAMwU,UAAS,MAAAvb,OAAK+G,EAAMyU,OAAM,KAAK0E,EAAU9f,MAAM0E,MAAQ,QAASob,EAAU9f,MAAMK,OAAS,QAEvK,MAAM0f,EAAa3P,SAASmP,cAAc,qBACtCQ,IAAcA,EAAW/f,MAAMsE,WAAaqC,EAAMyU,OAAQ2E,EAAW/f,MAAM0E,MAAQ,QAASqb,EAAW/f,MAAMK,OAAS,QAE1H,MAAM2f,EAAc5P,SAASmP,cAAc,iBACvCS,IAAeA,EAAYhgB,MAAMsE,WAAU,0BAAA1E,OAA6B+G,EAAMuU,QAAO,MAAAtb,OAAK+G,EAAMwU,UAAS,KAAK6E,EAAYhgB,MAAM0E,MAAQ,QAASsb,EAAYhgB,MAAMK,OAAS,QAEhL,MAAM4f,EAAc7P,SAASmP,cAAc,iBACvCU,IAAeA,EAAYjgB,MAAMsE,WAAaqC,EAAMuU,QAAS+E,EAAYjgB,MAAM0E,MAAQ,QAASub,EAAYjgB,MAAMK,OAAS,SA6Z3H+e,GAAyBjd,MAAOya,EAAa3H,EAAepK,KAChE,IACE7G,QAAQqC,IAAI,8BAADzG,OAAyBgd,EAAW,oBAAAhd,OAAgBqV,EAAa,WAAArV,OAAUiL,IACtF7G,QAAQqC,IAAI,8BAADzG,OAA+Bgd,EAAW,qBAAAhd,OAAoBqV,EAAa,gBAAArV,OAAeiL,EAAO,MAG5G4K,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACwG,GAAc,iBAChDnD,EAAmB,IAGnB,MAAMyG,EAAc,gBAAAtgB,OAAgBiL,EAAO,WAAAjL,OAAUgd,EAAW,MAAAhd,OAAKqV,EAAa,8DAClFO,EAAW2K,GAAcD,IAGzB,MAAM9V,EAAM,GAAAxK,OAAM8I,EAAQ,mBAE1B,IAAI0X,EAEJ,IACE3G,EAAmB,IAEnB,MAAMnP,QAAiBC,MAAMH,EAAQ,CACnCI,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,QAASA,EACTC,QAAS+N,GAAmB,MAC5B9N,OAAQuK,GAAkB,IAC1B+K,mBAAoB,CAACzD,GACrB5R,YAAY,MAIhB,IAAKV,EAASa,GACZ,MAAM,IAAIC,MAAM,cAADxL,OAAe0K,EAAS/K,SAGzC,MAAM8L,QAAaf,EAASgB,OAC5BtH,QAAQqC,IAAI,yBAADzG,OAA0Bgd,EAAW,KAAKvR,EAAKzC,QAAUyC,EAAKzC,QAAQ1J,OAAS,EAAG,iBAC7F8E,QAAQqC,IAAI,0BAA2BgF,EAAKzC,SAG5C,MAAM0X,EAxqCmBC,KAC7B,MAAMD,EAAY,CAAC,EAEnBtc,QAAQqC,IAAI,mCAAiCka,EAAYrhB,OAAQ,iBACjE8E,QAAQqC,IAAI,uCAAqCka,EAAYC,UAAU,EAAG,MAG1E,MAAMjU,EAAWgU,EAAY5T,MAAM,8BAEnC3I,QAAQqC,IAAI,wCAAsCkG,EAASrN,QAE3D,IAAK,IAAI6N,EAAI,EAAGA,EAAIR,EAASrN,OAAQ6N,GAAK,EAAG,CAC3C,MAAMiI,EAAiBvI,SAASF,EAASQ,IACzC,IAAIqT,EAAkB7T,EAASQ,EAAI,GAAKR,EAASQ,EAAI,GAAG3K,OAAS,GAEjE4B,QAAQqC,IAAI,4BAADzG,OAA6BoV,EAAc,KAAKoL,EAAgBlhB,OAAQ,iBAG/EkhB,IAEFA,EAAkBA,EAAgBzT,MAAM,eAAe,GAAGvK,OAG1Dge,EAAkBA,EAAgBhc,QAAQ,UAAW,QAAQhC,OAEzDge,EAAgBlhB,OAAS,IAC3BohB,EAAUtL,GAAkBoL,EAC5Bpc,QAAQqC,IAAI,8BAADzG,OAA+BoV,EAAc,eAAYoL,EAAgBI,UAAU,EAAG,KAAO,QAG9G,CAGA,OADAxc,QAAQqC,IAAI,wCAAsCjD,OAAO8T,KAAKoJ,GAAWphB,QAClEohB,GAuoCeG,CAAsBpV,EAAKzC,SAAW,IACxD5E,QAAQqC,IAAI,iCAAkCjD,OAAO8T,KAAKoJ,GAAWphB,OAAQ,yBAC7E8E,QAAQqC,IAAI,iCAA+BjD,OAAO8T,KAAKoJ,IACvDF,EAAkBE,EAAU1D,GAC5B5Y,QAAQqC,IAAI,8BAADzG,OAA+Bgd,EAAW,KAAKwD,EAAkBA,EAAgBvc,MAAM,EAAG,KAAO,MAAQ,QAGpHG,QAAQqC,IAAI,gDACZjD,OAAO8T,KAAKoJ,GAAWI,QAAQxd,IAC7Bc,QAAQqC,IAAI,cAADzG,OAAesD,EAAG,MAAAtD,OAAK0gB,EAAUpd,GAAOod,EAAUpd,GAAKW,MAAM,EAAG,IAAM,MAAQ,YAItFuc,GAAmB/U,EAAKzC,UAC3B5E,QAAQqC,IAAI,mEAADzG,OAAoEgd,IAC/EwD,EAAkB/U,EAAKzC,QAG3B,CAAE,MAAO+X,GACP3c,QAAQD,MAAM,0BAADnE,OAAwBgd,EAAW,MAAAhd,OAAK+gB,EAASlK,SAAWkK,GACzE3c,QAAQ0S,KAAK,gEAAD9W,OAAiEgd,IAE7EwD,EAAkBzD,GAAwBC,EAAa3H,EAAepK,EAASsK,EAAcC,EAAiB3I,SAAS6I,GACzH,CAEAmE,EAAmB,MAGd2G,GAAmBA,EAAgBlhB,OAAS,MAC/CkhB,EAAkBzD,GAAwBC,EAAa3H,EAAepK,EAASsK,EAAcC,EAAiB3I,SAAS6I,KAIzH,MAAMsL,EAAY,gBAAAhhB,OAAgBiL,EAAO,WAAAjL,OAAUgd,EAAW,MAAAhd,OAAKqV,EAAa,QAAArV,OAAOwgB,GACjFS,EAAmBV,GAAcS,GACvCpL,EAAWqL,GAGX,MAAM3B,EAAU,GAAAtf,OAAMuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIgd,GAiBzD,OAhBAzD,EAAsB1P,GAAIC,wBAAA,GACrBD,GAAI,IACP,CAACyV,GAAa2B,KAIhBpL,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACwG,GAAc,eAChDnD,EAAmB,KAEnBzV,QAAQqC,IAAI,aAADzG,OAAcgd,EAAW,kBAAAhd,OAAcwgB,EAAgBlhB,OAAM,oCAGxE8E,QAAQqC,IAAI,oCAADzG,OAAqCgd,EAAW,mBAAmBiE,EAAmBA,EAAiB3hB,OAAS,EAAG,iBAC9H8E,QAAQqC,IAAI,2CAA4Cwa,EAAmBA,EAAiBhd,MAAM,EAAG,KAAO,MAAQ,QAG7Ggd,CAET,CAAE,MAAO9c,GAGP,MAFAC,QAAQD,MAAM,oBAADnE,OAAqBgd,EAAW,KAAK7Y,GAClD0R,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAACwG,GAAc,WAC1C7Y,CACR,GAOIoc,GAAgB,SAACrd,GAA+B,IAAzBge,EAAOtJ,UAAAtY,OAAA,QAAAuY,IAAAD,UAAA,GAAAA,UAAA,GAAG,UACrC,IAAK1U,EAAM,MAAO,GAGlB,IAAIie,EAAgBje,EAEjBsB,QAAQ,4BAA6B,yDACrCA,QAAQ,sBAAuB,yDAC/BA,QAAQ,sBAAuB,yDAC/BA,QAAQ,kCAAmC,uEAC3CA,QAAQ,2BAA4B,uEACpCA,QAAQ,8CAA4C,gFACpDA,QAAQ,uCAAqC,gFAE7CA,QAAQ,iBAAkB,uBAC1BA,QAAQ,eAAgB,eACxBA,QAAQ,gBAAiB,eACzBA,QAAQ,iBAAkB,eAC1BuI,MAAM,QACNlN,IAAI2W,GAAMA,EAAEhU,OAAM,MAAAxC,OAASwW,EAAEhS,QAAQ,MAAO,QAAO,QAAS,IAC5D4c,KAAK,IAMR,OAHAD,EAlzCgCje,KAChC,IAAKA,EAAM,OAAOA,EAGlB,MAAMme,EAAW,GACjB,IAAIC,EAAWpe,EAAKsB,QAAQ,WAAa4F,IACvC,MAAMhE,EAAW,cAAApG,OAAiBqhB,EAAS/hB,OAAM,MAEjD,OADA+hB,EAAS1d,KAAKyG,GACPhE,IAIT,MAAMmb,EAAgB,IAAIC,IA4B1B,OAtBAF,EAAWA,EAAS9c,QAHE,gIAGqB,CAAC4F,EAAOrH,EAAMC,EAASye,EAAQC,KACxE,MAAMC,EAAavX,EAAM5H,OAGzB,GAAI+e,EAAcK,IAAID,GACpB,OAAOA,EAGTJ,EAAcM,IAAIF,GAGlB,MAAMG,EAAa,wCAAA9hB,OAA2CuH,mBAAmBoa,IAGjF,MAAM,YAAN3hB,OAAmB8hB,EAAa,qDAAA9hB,OAAoD2hB,EAAU,MAAA3hB,OAAK2hB,EAAU,UAI/GN,EAASP,QAAQ,CAACiB,EAAKle,KACrByd,EAAWA,EAAS9c,QAAQ,cAADxE,OAAe6D,EAAK,MAAMke,KAGhDT,GA0wCSU,CAAyBb,GAGzB,iBAAZD,EACI,qCAANlhB,OAA4CmhB,EAAa,UAGpDA,CACT,EAoDA,OACE5hB,cAAA,OAAKK,UAAU,MAAKJ,SACD,gBAAhBob,GACCrb,cAACsB,EAAoB,CAACC,SAAUse,KACd,YAAhBxE,GACFrb,cAACwJ,EAAmB,CAClBjI,SAAUse,GACVpW,QAAS6R,GACT5R,SAAU8R,KAEM,UAAhBH,GACFrb,cAACgP,EAAS,CAACzN,SAAUse,KACH,aAAhBxE,GACFrb,cAAC4V,EAAY,CACXrU,SAAUse,GACVhK,eAAgB6F,GAChB5F,cAAemD,EAAYyC,IAC3BjS,QAASmS,GACTlS,SAAU8R,GACVzF,qBAAuB2M,IAErB,MAAM3C,EAAU,GAAAtf,OAAMuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIiiB,GACnDjZ,EAAUsQ,EAAmBgG,IAAe,GAClDH,GAAmB8C,EAAmBjZ,IAGxCuM,aAAcA,EACdC,gBAAiBA,EACjBC,cAAeA,EACfC,eAAgBA,EAChBC,eAAgBA,GAChB7M,SAAUA,EACV8M,WAAYA,EACZC,mBAAoBA,EACpBxU,aAAcA,EACdD,UAAWA,EACX0U,eAAgBA,IAGlB/V,eAAA4F,WAAA,CAAAnG,SAAA,CAEED,cAAA,UAAQK,UAAU,gBAAeJ,SAC/BD,cAAA,OAAKK,UAAU,cAAaJ,SAAC,gMAM/BD,cAAA,OAAKK,UAAU,qBAAoBJ,SACjCO,eAAA,OAAKH,UAAU,gBAAeJ,SAAA,CAC3Boa,EAAgB,IAChBI,GAAwBI,IACvBra,eAAA,QAAMH,UAAU,wBAAuBJ,SAAA,CAAC,UACnC4a,GAAiB8H,MAAM,MAAI9H,GAAiB+H,cAAc,KAAG/H,GAAiBgI,UAAU,IAAEhI,GAAiBiI,MAAM,YAO5HtiB,eAAA,OAAKH,UAAU,iBAAgBJ,SAAA,CAE7BO,eAAA,OAAKH,UAAU,iBAAgBJ,SAAA,CAC7BD,cAAA,OAAKK,UAAU,eAAcJ,SAC3BD,cAAA,SACEyG,KAAK,OACLI,YAAY,wDACZxG,UAAU,eACVqG,MAAO6T,EACP5T,SAl8CYJ,IAC1B,MAAMwc,EAAIxc,EAAEK,OAAOF,MACnB8T,EAAeuI,GACf,MAAMrS,EAxBkBsS,KACxB,IAAKA,EAAM/f,OAAQ,OAAO,KAC1B,MAAMggB,EAAaD,EAAM/f,OACnBigB,EAAW,CAAC,wBAAyB,kBAAmB,UAC9D,IAAK,MAAMC,KAAOD,EAAU,CAC1B,MAAME,EAAIH,EAAWpY,MAAMsY,GAC3B,GAAIC,EAAG,CACL,MAAMC,EAAWD,EAAE,GAAGngB,OAChBQ,EAAU2f,EAAE,GAAK9V,SAAS8V,EAAE,IAAM,KAClC1f,EAAQ0f,EAAE,GAAK9V,SAAS8V,EAAE,IAAM,KAChCE,EAAQvK,EAAMwK,KAAKpG,GACvBA,EAAEtZ,gBAAkBwf,EAASxf,eAC7BsZ,EAAEtZ,cAAcM,SAASkf,EAASxf,gBAClCwf,EAASxf,cAAcM,SAASgZ,EAAEtZ,gBAEpC,GAAIyf,EAAO,MAAO,CAAE9f,KAAM8f,EAAO7f,QAASA,GAAW,EAAGC,MAAOA,GAAS,KAC1E,CACF,CACA,OAAO,MAMQ8f,CAAiBT,GAC5BrS,IACFiM,KACApD,EAAgB7I,EAAOlN,MACvBgW,EAAmB9I,EAAOjN,SAC1BgW,EAAiB/I,EAAOhN,aA87ChBlD,eAAA,OAAKH,UAAU,eAAcJ,SAAA,CAC3BD,cAACkZ,EAAU,CAACC,MAAM,QAAQzS,MAAOsP,EAAcoD,QAAS,CAAC,QAASL,GAAQpS,SAh/C9DJ,IACxBoW,KACA,MAAMnZ,EAAO+C,EAAEK,OAAOF,MACtB6S,EAAgB/V,GAChBgW,EAA4B,OAAThW,EAAgB,KAAO,GAC1CiW,EAAiB,SA4+CLzZ,cAACkZ,EAAU,CAACC,MAAM,WAAWzS,MAAOuP,EAAiBmD,QAAS+C,GAAmBxV,SAz+ClEJ,IAC3BoW,KACA,MAAMlZ,EAAU8C,EAAEK,OAAOF,MACzB8S,EAA+B,OAAZ/V,EAAmB,KAAOggB,OAAOhgB,IACpDgW,EAAiB,SAs+CLzZ,cAACkZ,EAAU,CAACC,MAAM,SAASzS,MAAOwP,EAAekD,QAAS,CAAC,QAASkD,MAAMC,KAAK,CAAExc,OAAQ,IAAM,CAACyc,EAAG5O,IAAMA,EAAI,IAAKjH,SAn+CrGJ,GAAMkT,EAAiBlT,EAAEK,OAAOF,SAo+C7C1G,cAACkZ,EAAU,CAACC,MAAM,UAAUzS,MAAOgT,EAAiBN,QAAS,CAAC,MAAO,QAAS,OAAQzS,SAn+CvEJ,GAAMoT,EAAmBpT,EAAEK,OAAOF,SAo+CjD1G,cAAA,UAAQK,UAAU,eAAe0G,SAAUlF,EAAU5B,SAAC,YACtDD,cAACkZ,EAAU,CAACC,MAAM,WAAWzS,MAAOyP,EAAgBiD,QAAS,CAAC,IAAK,IAAK,IAAM,KAAOzS,SAp+CvEJ,GAAMqT,EAAkB6J,OAAOld,EAAEK,OAAOF,UAq+CtD1G,cAAA,UAAQK,UAAU,WAAWM,QAz7BpB+iB,KACrB,GAAqB,OAAjB1N,EAAuB,OAAO7O,MAAM,yDACxC,MACMwQ,EADY,CAAC,YAAS,MAAM,MAAQ,MAAM,eAAY,MAAM,QAAU,MAAM,iBAAc,MAAM,WAAQ,MAAM,MAAQ,MAAM,KAAO,MAAM,WAAW,MAAM,WAAW,MAAM,SAAS,MAAM,SAAS,MAAM,eAAe,MAAM,eAAe,MAAM,OAAS,MAAM,gBAAU,MAAM,OAAS,MAAM,IAAM,MAAM,QAAU,MAAM,UAAY,MAAM,iBAAc,MAAM,yBAAyB,MAAM,cAAQ,MAAM,gBAAU,MAAM,aAAe,MAAM,iBAAW,MAAM,OAAS,MAAM,UAAO,MAAM,UAAO,MAAM,KAAO,MAAM,OAAS,MAAM,MAAQ,MAAM,YAAS,MAAM,MAAQ,MAAM,QAAU,MAAM,SAAW,MAAM,WAAQ,MAAM,SAAW,MAAM,SAAW,MAAM,SAAW,MAAM,KAAO,MAAM,IAAM,MAAM,KAAO,MAAM,MAAQ,MAAM,QAAU,MAAM,gBAAgB,MAAM,gBAAgB,MAAM,QAAU,MAAM,kBAAY,MAAM,YAAc,MAAM,WAAa,MAAM,oBAAoB,MAAM,oBAAoB,MAAM,gBAAa,MAAM,gBAAa,MAAM,KAAO,MAAM,cAAW,MAAM,aAAU,MAAM,QAAU,MAAM,WAAW,MAAM,WAAW,MAAM,SAAS,MAAM,SAAS,MAAM,SAAS,MAAM,KAAO,MAAM,WAAa,OACjkC3B,GAAe,IAAK2B,EAAM,OAAOxQ,MAAM,qCAC9D,IAAIyQ,EAAG,qCAAAnX,OAAwCkX,GACvB,OAApB1B,IAA4B2B,GAAG,IAAAnX,OAAQwV,GAAyC,OAAlBC,IAAwB0B,GAAG,IAAAnX,OAAQyV,KACrGjO,OAAOC,KAAK0P,EAAK,WAm7BgD3X,SAAC,kBACtDD,cAAA,UAAQK,UAAU,WAAWM,QAASA,IAAMsH,OAAOC,KAAK,uBAAwB,UAAUjI,SAAC,YAC3FD,cAAA,UAAQK,UAAU,YAAYM,QAx6BnBgjB,KACvBhE,MAu6BoE1f,SAAC,+BACzDD,cAAA,UAAQK,UAAU,kBAAkBM,QAh6BpBijB,KAC5BxN,GAAe,gBA+5BgEnW,SAAC,yCAItEO,eAAA,OAAKH,UAAU,8BAA6BJ,SAAA,CAC1CO,eAAA,OAAKH,UAAU,wBAAwBQ,MAAO,CAC5CiF,QAAS,OACTyB,oBAAqB,iBACrBvB,IAAK,OACLP,aAAc,OACdJ,QAAS,SACTvE,MAAO,OACP6H,UAAW,cACX1I,SAAA,CACAO,eAAA,UAAQH,UAAU,cAAcQ,MAAOoX,EAAeM,EAAoBA,EAAmBC,QAAS7X,QAj8BlGkjB,KAClBlH,KACApD,EAAgB,MAAOC,EAAmB,MAAOC,EAAiB,MAClEE,EAAmB,OAAQC,EAAkB,KAAME,EAAkB,GACrEzD,EAAW,IAAKC,EAAmB,CAAC,GACpCwE,GAAoB,OA47BqH7a,SAAA,CACzHD,cAAA,QAAMK,UAAU,eAAcJ,SAAC,iBAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAC,aAGlCO,eAAA,UAAQH,UAAU,cAAcQ,MAAOoX,EAAeM,EAAuBA,EAAsBC,QAAS7X,QAASyc,GAAcnd,SAAA,CACjID,cAAA,QAAMK,UAAU,eAAcJ,SAAC,iBAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAE6b,GAAY7B,GAAczG,UAG7DhT,eAAA,UAAQH,UAAU,cAAcQ,MAAOoX,EAAeM,EAAqBA,EAAoBC,QAAS7X,QAniD/FmjB,KAClB3J,IACLZ,EAAgBY,EAAU3W,MAC1BgW,EAAmBW,EAAU1W,SAC7BgW,EAAiBU,EAAUzW,OAAS,MACpCiW,EAAmBQ,EAAUxO,SAAW,OACxCiO,EAAkBO,EAAUpa,QAAU,KACtC+Z,EAAkBK,EAAUN,gBAAkB,GAC9CxD,EAAW8D,EAAU1Q,SAAW,IAChC6M,EAAmB6D,EAAUra,iBAAmB,CAAC,KA0hDgGiH,UAAWoT,EAAUla,SAAA,CACtJD,cAAA,QAAMK,UAAU,eAAcJ,SAAC,iBAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAEka,EAAS,GAAA1Z,OAAM0Z,EAAU3W,KAAI,KAAA/C,OAAI0Z,EAAU1W,SAAY,mBAG1FjD,eAAA,UAAQH,UAAS,eAAAI,OAAiBoB,EAAY,UAAY,IAAMhB,MAAOoX,EAAeM,EAAqBA,EAAoBC,QAAS7X,QA7lB7HqC,UACzB,IACElB,GAAa,GACbuU,EAAW,uEACXC,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAAC4C,GAAiB,iBAEnD,MAAMnO,EAA6B,OAAlBwK,GAA4C,SAAlBA,EAAwB,GAAAzV,OAC5DuV,EAAY,KAAAvV,OAAIwV,GAAe,GAAAxV,OAC/BuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIyV,GAG1C,GAAI2D,GAAkB,GAAKA,GAAkB,GAAI,CAC/C,MAAM/D,EAAgBS,EAAesD,GAG/B3C,EAAiBtF,KAAKuF,IAAI,IAAM7J,SAAS6I,GAAkB,KACjEtR,QAAQqC,IAAI,4CAADzG,OAA6CoZ,EAAc,0BAAApZ,OAAyByW,EAAc,mBAG7G,MAAM/L,QAAiBC,MAAM,GAAD3K,OAAI8I,EAAQ,4BAA4B,CAClE8B,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,QAASA,EACTC,QAAS+N,GAAmB,MAC5B9N,OAAQsL,EACRrL,YAAY,EACZC,UAAU,EACViY,YAAajO,MAIjB,IAAK3K,EAASa,GACZ,MAAM,IAAIC,MAAM,eAADxL,OAAgB0K,EAAS/K,SAG1C,MAAM8L,QAAaf,EAASgB,OAG5B,GAFAtH,QAAQqC,IAAI,2CAAyCgF,EAAKzC,QAAUyC,EAAKzC,QAAQ1J,OAAS,EAAG,kBAEzFmM,EAAKzC,QAkBP,MAAM,IAAIwC,MAAM,kDAlBA,CAEhB,MAAM+X,EAAY,6CAAAvjB,OAA6CiL,EAAO,WAAAjL,OAAUoZ,EAAc,MAAApZ,OAAKqV,EAAa,QAAArV,OAAOyL,EAAKzC,SAC5H4M,EAAW2K,GAAcgD,IAGzB,MAAMjE,EAAU,GAAAtf,OAAMuV,EAAY,KAAAvV,OAAIwV,EAAe,KAAAxV,OAAIoZ,GACzDG,EAAsB1P,GAAIC,wBAAA,GACrBD,GAAI,IACP,CAACyV,GAAaiB,GAAcgD,MAG9Bnf,QAAQqC,IAAI,mEAGZyV,KACA9X,QAAQqC,IAAI,uDACd,CAIF,MAEEmP,EAF4B,IAAnBwD,EAEE,kHAEA,wEAGbvD,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAAC4C,GAAiB,cACrD,CAAE,MAAOxC,GACPxS,QAAQD,MAAM,wCAAyCyS,GACvDhB,EAAW,oDAAD5V,OAAqD4W,EAAIC,UACnEhB,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,CAAC4C,GAAiB,UACrD,CAAC,QACC/X,GAAa,EACf,GAihBmLiF,SAAUlF,EAAU5B,SAAA,CACvLD,cAAA,QAAMK,UAAU,eAAcJ,SAAC,iBAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAC,mBAC/B4B,GAAa7B,cAAA,OAAKK,UAAU,uBAG/BG,eAAA,UAAQH,UAAU,cAAcQ,MAAOoX,EAAeM,EAAsBA,EAAqBC,QAAS7X,QA/sBlFqC,UACtC6B,QAAQqC,IAAI,4DAEZ,IACEpF,GAAa,GAAO4Y,GAAwB,GAC5CrE,EAAW,IAAKiE,EAAmB,GACnCU,IAAwB,GACxB1E,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,EAAG,iBAGpC,MACMxT,EAAUwS,GAAmB,IAC7BvK,EAAO,GAAAjL,OAFAuV,GAAgB,YAEN,KAAAvV,OAAIgD,GAC3BoB,QAAQqC,IAAI,oDAA+CwE,GAG3D7G,QAAQqC,IAAI,2EAGZ,MAAM+D,EAAM,GAAAxK,OAAM8I,EAAQ,4BAC1B1E,QAAQqC,IAAI,0CAAwC+D,GAEpD,MAAME,QAAiBC,MAAMH,EAAQ,CACnCI,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,QAASA,EACTC,QAAS+N,GAAmB,MAC5B9N,OAAQ0B,SAAS6I,IAAmB,IACpCtK,YAAY,EACZC,UAAU,MAId,IAAKX,EAASa,GAEZ,MADAnH,QAAQD,MAAM,sCAADnE,OAAuC0K,EAAS/K,SACvD,IAAI6L,MAAM,qBAADxL,OAAsB0K,EAAS/K,SAGhD,MAAM8L,QAAaf,EAASgB,OAC5BtH,QAAQqC,IAAI,oCAAkCgF,EAAKzC,QAAUyC,EAAKzC,QAAQ1J,OAAS,EAAG,iBAGtF,MAAMkkB,EAAa/X,EAAKgY,QAAU,MAC5BC,EAAYjY,EAAKkY,aAAc,EAC/BC,EAAOnY,EAAKmY,MAAQ,aAc1B,GAZAxf,QAAQqC,IAAI,YAADzG,OAAawjB,EAAU,KAAAxjB,OAAI0jB,EAAY,UAAY,YAAW,OAAA1jB,OAAM4jB,IAG3EF,EACFtf,QAAQqC,IAAI,+EACH+c,EAAW9f,SAAS,aAAe8f,EAAW9f,SAAS,kBAChEU,QAAQqC,IAAI,yFACH+c,EAAW9f,SAAS,WAC7BU,QAAQqC,IAAI,kFAITgF,EAAKzC,QACR,MAAM,IAAIwC,MAAM,kCAGlB,MAAMmV,EAAclV,EAAKzC,QAGzByR,GAAqB,GACrBE,IAAqB,GAGrB,MAAM4I,EAAevL,EAAoB2I,GACzC/K,EAAW2K,GAAcgD,EAAc,iBACvC1J,EAAmB,KACnBhE,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,EAAG,eACpC+D,IAAwB,GACxBnW,QAAQqC,IAAI,0DAGZyV,KACA9X,QAAQqC,IAAI,0DAGZ,MAAM6Y,EAAU,GAAAtf,OAAMuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,IAAG,MACxE+D,EAAsB1P,GAAIC,wBAAA,GACrBD,GAAI,IACP,CAACyV,GAAaqB,KAIhB,MAAM1X,EAAQ,GAAAjJ,OAAMuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,KAAGxV,OAAqB,OAAlByV,EAAyB,IAAMA,EAAgB,IACxHrR,QAAQqC,IAAI,sEAAoEwC,GAChFtG,WAAW,KACTyB,QAAQqC,IAAI,uEACZwY,GAAkB0B,EAAa1X,IAC9B,IAEL,CAAE,MAAO2N,GACPxS,QAAQD,MAAM,wCAAmCyS,GACjDhB,EAAW,mDAAD5V,OAA8C4W,EAAIC,UAC5DhB,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,EAAG,UACtC,CAAC,QACCnV,GAAa,GAAQ4Y,GAAwB,GAC7CJ,EAAmB,IACrB,GAsmBiKra,SAAA,CACjJD,cAAA,QAAMK,UAAU,eAAcJ,SAAC,WAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAC,oBAGlCO,eAAA,UAAQH,UAAS,2BAAAI,OAA6BoB,EAAY,UAAY,IAAMhB,MAAOoX,EAAeM,EAAuBA,EAAsBC,QAAS7X,QAzb/IqC,UACvB,IACElB,GAAa,GACbkZ,IAAwB,GAGxB1E,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,EAAG,cACpCZ,EAAW,IAEXxR,QAAQqC,IAAI,gFAEZ,MAAMwE,EAA6B,OAAlBwK,GAA4C,SAAlBA,EAAwB,GAAAzV,OAC5DuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,KAAG,GAAAxV,OAClDuV,GAAgB,YAAQ,KAAAvV,OAAIwV,GAAmB,IAAG,KAAAxV,OAAIyV,GAG7DrR,QAAQqC,IAAI,sHAGZrC,QAAQqC,IAAI,iGAEZ,IAEE,MAAMiE,QAAiBC,MAAM,GAAD3K,OAAI0I,oIAAYC,sBAAqB,uBAAuB,CACtFiC,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMC,KAAKC,UAAU,CACnBC,QAASA,EACTC,QAAS+N,GAAmB,MAC5B9N,OAAQ,IACRsV,mBAAoB,CAAC,GACrBrV,YAAY,MAIhB,IAAIV,EAASa,GAkBX,MADAnH,QAAQD,MAAM,0DACR,IAAIqH,MAAM,mBAlBD,CACf,MACMqY,SADanZ,EAASgB,QACE1C,SAAW,GAEzC5E,QAAQqC,IAAI,0DAADzG,OAA+C6jB,EAAiBvkB,OAAM,mBACjF8E,QAAQqC,IAAI,oBAAqBod,EAAiB5f,MAAM,EAAG,KAAO,OAGlE,MAAMqb,EAAU,GAAAtf,OAAMuV,EAAY,KAAAvV,OAAIwV,EAAe,MACrD+D,EAAsB1P,GAAIC,wBAAA,GAAUD,GAAI,IAAE,CAACyV,GAAauE,KACxDhO,EAAmBW,GAAC1M,wBAAA,GAAU0M,GAAC,IAAE,EAAG,eAGpC2I,GAAmB,EAAG0E,GACtBhK,EAAmB,EAErB,CAKF,CAAE,MAAO1V,GACPC,QAAQD,MAAM,mBAAoBA,GAElC,MAAM0f,QAAyBrE,GAAuB,EAAG1J,EAAe,GAAI7K,GACxE4Y,IACF1E,GAAmB,EAAG0E,GACtBhK,EAAmB,GAEvB,CAGAzV,QAAQqC,IAAI,yEAGuBlE,WAEjC,IAAK,IAAI4K,EAAI,EAAGA,GAAK,GAAIA,GADP,EACuB,CACvC,MAAM2W,EAAQ,GACRC,EAAW5S,KAAKuF,IAAIvJ,EAHV,EAG0B,EAAG,IAE7C/I,QAAQqC,IAAI,gDAADzG,OAAwCmN,EAAC,UAAAnN,OAAM+jB,IAE1D,IAAK,IAAIC,EAAI7W,EAAG6W,GAAKD,EAAUC,IAC7B,GAAIA,GAAKlO,EAAexW,OAAS,EAAG,CAClC,MAAM+V,EAAgBS,EAAekO,GACrCF,EAAMngB,KAAK6b,GAAuBwE,EAAG3O,EAAepK,GACtD,OAGIxI,QAAQwhB,IAAIH,GAGlB,MAAMI,EAAW/S,KAAKC,MAAO2S,EAAW,GAAM,KAC9ClK,EAAmBqK,GACnB9f,QAAQqC,IAAI,qBAADzG,OAAmB+jB,EAAQ,qCAAA/jB,OAA2BkkB,EAAQ,OAGrEH,EAAW,UACP,IAAIthB,QAAQC,GAAWC,WAAWD,EAAS,KAErD,GAIFyhB,GAA6BC,KAAK,KAChChgB,QAAQqC,IAAI,wDACZoT,EAAmB,OAClBwK,MAAOlgB,IACRC,QAAQD,MAAM,4BAA0BA,KAG1CC,QAAQqC,IAAI,6EAGZyV,KACA9X,QAAQqC,IAAI,oEAEd,CAAE,MAAOtC,GACPC,QAAQD,MAAM,4BAAuBA,GACrCyR,EAAW2K,GAAc,qEAADvgB,OAAgEmE,EAAM0S,UAChG,CAAC,QACCxV,GAAa,GACbwY,EAAmB,IACrB,GAkUiMvT,SAAUlF,EAAU5B,SAAA,CACrMD,cAAA,QAAMK,UAAU,eAAcJ,SAAC,WAC/BD,cAAA,QAAMK,UAAU,gBAAeJ,SAAC,kBAC/B4B,GAAa7B,cAAA,OAAKK,UAAU,0BAKjCL,cAAA,OAAKK,UAAU,eAAcJ,SAC3BD,cAACqS,EAAe,CAACC,WAAYnJ,oIAAYC,uBAAyB,6DAMxE5I,eAAA,OAAKH,UAAU,sBAAqBJ,SAAA,CAElCO,eAAA,OAAKH,UAAU,cAAaJ,SAAA,CAC1BD,cAAA,MAAAC,SAAI,mBACJD,cAACP,EAAe,CAACE,MAAO4d,GAAgB3d,SAAUia,EAAgBha,SAAUigB,GAAsBhgB,gBAAiBA,OAIrHU,eAAA,OAAKH,UAAU,gBAAeJ,SAAA,CAC5BO,eAAA,OAAKH,UAAU,iBAAgBJ,SAAA,CAC7BD,cAAA,MAAAC,SAAA,GAAAQ,OAAQoZ,EAAc,MAAApZ,OAAKwY,EAAYY,MACvCrZ,eAAA,OAAKH,UAAU,cAAaJ,SAAA,CAC1BD,cAAA,UAAQW,QAASA,IAAMmf,GAAqBlO,KAAKyK,IAAI,EAAGxC,EAAiB,IAAK9S,SAA6B,IAAnB8S,EAAqB5Z,SAAC,2BAC9GD,cAAA,UAAQW,QAASA,IAAMmf,GAAqBlO,KAAKuF,IAAIZ,EAAexW,OAAS,EAAG8Z,EAAiB,IAAK9S,SAAU8S,IAAmBtD,EAAexW,OAAS,EAAEE,SAAC,yBAIlKD,cAAA,OAAKK,UAAU,eAAcJ,SAC1B4B,EACCrB,eAAA,OAAKH,UAAU,oBAAmBJ,SAAA,CAChCD,cAAA,OAAKK,UAAU,oBACfL,cAAA,KAAAC,SAAG,iCACF4a,IACCra,eAAA,OAAKH,UAAU,oBAAmBJ,SAAA,CAChCO,eAAA,KAAAP,SAAA,CAAG,oCAAqB4a,GAAiBgI,UAAU,IAAEhI,GAAiBiI,SACtEtiB,eAAA,KAAAP,SAAA,CAAG,8BAAkB4a,GAAiB+H,iBACtCpiB,eAAA,KAAAP,SAAA,CAAG,gBAAS4a,GAAiB8H,eAIjClZ,EACFjJ,eAAA,OAAAP,SAAA,CACED,cAAA,OAAKK,UAAU,eAAeoI,wBAAyB,CAAEC,OAAQsY,GAAcvX,EAASsR,GAAuB,eAAiB,eAC9HA,IAAwBtR,EAAQtF,SAAS,YAAcgX,IACvD3a,eAAA,OAAKH,UAAU,0BAAyBJ,SAAA,CACtCO,eAAA,UACEH,UAAU,sBACVM,QA99BHqC,UACrB,IACElB,GAAa,GAEb,MACM2B,EAAUwS,GAAmB,IAC7BvK,EAAO,GAAAjL,OAFAuV,GAAgB,YAEN,KAAAvV,OAAIgD,GACrBmL,EAAaqM,GAAoB,EACjCpM,EAAWoM,GAAoB,EAErCpW,QAAQqC,IAAI,+CAADzG,OAA0CmO,EAAU,UAAAnO,OAAMoO,EAAQ,UAAApO,OAASiL,IAEtF,MAAMT,EAAM,GAAAxK,OAAM8I,EAAQ,4BAEpB4B,QAAiBC,MAAMH,EAAQ,CACnCI,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,QAAQ,GAADjL,OAAKiL,EAAO,KAAAjL,OAAImO,EAAU,KAAAnO,OAAIoO,GACrClD,QAAS+N,GAAmB,MAC5B9N,OAAQ0B,SAAS6I,IAAmB,IACpCtK,YAAY,EACZC,UAAU,MAId,IAAKX,EAASa,GACZ,MAAM,IAAIC,MAAM,eAADxL,OAAgB0K,EAAS/K,SAG1C,MAAM8L,QAAaf,EAASgB,OAE5B,GAAID,EAAKzC,QAAS,CAChB,MAAMkB,EAAiBlB,EACjBsb,EAAatM,EAAoBvM,EAAKzC,SACtCub,EAAsBhE,GAAc+D,EAAY,gBAGtD1O,EAAW1L,EAAiB,OAASqa,GACrC9J,GAAqBrM,GAGjBA,GAAY,IACduM,IAAqB,GAGvBvW,QAAQqC,IAAI,qBAADzG,OAAsBmO,EAAU,KAAAnO,OAAIoO,EAAQ,8BACzD,CAEF,CAAE,MAAOjK,GACPC,QAAQD,MAAM,uCAAwCA,GACtDyR,EAAW/L,GAAQA,EAAO,qEAC5B,CAEAxI,GAAa,IAu6BWiF,SAAUlF,EACVjB,MAAK,6BAAAH,OAAyBwa,GAAoB,EAAC,UAAAxa,OAAMwa,GAAoB,GAAIhb,SAAA,CAClF,uCAC4Bgb,GAAoB,EAAE,IAAEA,GAAoB,EAAE,OAE3Eza,eAAA,KAAGH,UAAU,uBAAsBJ,SAAA,CAAC,uBACbgb,GAAkB,qDAM/Cjb,cAAA,OAAKK,UAAU,wBAAuBJ,SACpCD,cAAA,KAAAC,SAAG,yEAczB,ECl+DA,IACeglB,qBAAWhU,SAASiU,eAAe,SAC3CC,OAAOnlB,cAACsZ,EAAG,IAClB,CAAE,MAAO1U,GACPC,QAAQD,MAAM,yBAA0BA,GAExCqM,SAASiU,eAAe,QAAQE,UAAS,6KAAA3kB,OAIJmE,EAAM0S,QAAO,uBAGpD,C","file":"static/js/main.9ccbd414.chunk.js","sourcesContent":["import React from \"react\";\n\nfunction RubriquesInline({ items, activeId, onSelect, rubriquesStatus }) {\n  if (!items || items.length === 0) {\n    return <div>Aucune rubrique disponible</div>;\n  }\n\n  const getLEDColor = (itemId) => {\n    const status = rubriquesStatus[itemId];\n    if (status === 'completed') return '#10b981'; // Vert\n    if (status === 'in-progress') return '#f59e0b'; // Jaune\n    if (status === 'inactive') return '#6b7280'; // Gris fonc (dsactiv)\n    if (status === 'error') return '#ef4444'; // Rouge (erreur)\n    return '#9ca3af'; // Gris par dfaut\n  };\n\n  return (\n    <div className=\"rubriques-list\">\n      {items.map((item) => (\n        <div\n          key={item.id}\n          className={`rubrique-item ${activeId === item.id ? 'active' : ''} ${\n            rubriquesStatus[item.id] === 'completed' ? 'completed' : ''\n          }`}\n          onClick={() => onSelect && onSelect(item.id)}\n        >\n          <span className=\"rubrique-number\">{item.id}</span>\n          <span className=\"rubrique-title\">{item.title}</span>\n          \n          {/* LED physique avec 3 tats */}\n          <div \n            className=\"rubrique-led\"\n            style={{\n              width: '10px',\n              height: '10px',\n              borderRadius: '50%',\n              backgroundColor: getLEDColor(item.id),\n              border: '2px solid #fff',\n              boxShadow: `0 0 4px ${getLEDColor(item.id)}`,\n              marginLeft: 'auto',\n              flexShrink: 0\n            }}\n            title={\n              rubriquesStatus[item.id] === 'completed' ? 'Termin' :\n              rubriquesStatus[item.id] === 'in-progress' ? 'En cours' :\n              rubriquesStatus[item.id] === 'inactive' ? 'Dsactiv' :\n              rubriquesStatus[item.id] === 'error' ? 'Erreur' : 'Non commenc'\n            }\n          />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default RubriquesInline;","import React, { useState, useEffect } from 'react';\n\nconst BibleConcordancePage = ({ onGoBack }) => {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [results, setResults] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  \n  // Nouvel tat pour la recherche de personnages\n  const [characterSearchTerm, setCharacterSearchTerm] = useState(\"\");\n  const [characterResults, setCharacterResults] = useState([]);\n  const [isCharacterLoading, setIsCharacterLoading] = useState(false);\n  const [selectedCharacter, setSelectedCharacter] = useState(null);\n  const [characterHistory, setCharacterHistory] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"concordance\"); // \"concordance\" ou \"characters\"\n\n  // Liste des personnages bibliques principaux\n  const biblicalCharacters = [\n    // Ancien Testament\n    \"Abraham\", \"Isaac\", \"Jacob\", \"Mose\", \"David\", \"Salomon\", \"No\", \"Adam\", \"ve\", \n    \"Can\", \"Abel\", \"noch\", \"Mathusalem\", \"Joseph\", \"Benjamin\", \"Juda\", \"Lvi\",\n    \"Aaron\", \"Josu\", \"Samuel\", \"Sal\", \"Jonathan\", \"Goliath\", \"Ruth\", \"Naomi\",\n    \"Booz\", \"lie\", \"lise\", \"Jrmie\", \"sae\", \"zchiel\", \"Daniel\", \"Jonas\",\n    \"Job\", \"Esther\", \"Mardoche\", \"Aman\", \"Nhmie\", \"Esdras\", \"Zorobabel\",\n    \"Gdon\", \"Samson\", \"Dalila\", \"Dborah\", \"Barak\", \"Jepht\", \"Rahab\",\n    // Nouveau Testament\n    \"Jsus\", \"Marie\", \"Joseph\", \"Jean-Baptiste\", \"Pierre\", \"Paul\", \"Jean\",\n    \"Jacques\", \"Andr\", \"Philippe\", \"Barthlemy\", \"Matthieu\", \"Thomas\",\n    \"Jacques fils d'Alphe\", \"Simon le Zlote\", \"Jude\", \"Judas Iscariote\",\n    \"Marie Madeleine\", \"Marthe\", \"Lazare\", \"Marie de Bthanie\", \"Nicodme\",\n    \"Zache\", \"Pilate\", \"Hrode\", \"Anne\", \"Caphe\", \"Barnabas\", \"Timothe\",\n    \"Tite\", \"Philmon\", \"Lydie\", \"Priscille\", \"Aquila\", \"Apollos\", \"Silas\"\n  ].sort();\n\n  // Fonction pour gnrer l'histoire dtaille d'un personnage avec croisement de versets\n  const generateCharacterHistory = async (character) => {\n    setIsCharacterLoading(true);\n    setSelectedCharacter(character);\n\n    try {\n      // Simuler un appel API pour gnrer l'histoire du personnage\n      await new Promise(resolve => setTimeout(resolve, 1500));\n\n      // Prompt spcialis pour gnrer l'histoire complte du personnage\n      const prompt = `Gnre l'histoire biblique complte de ${character} en croisant tous les versets bibliques le concernant. \n\nSTRUCTURE REQUISE :\n1. IDENTIT ET GNALOGIE\n2. NAISSANCE ET JEUNESSE  \n3. VNEMENTS MAJEURS DE SA VIE\n4. SES RELATIONS FAMILIALES ET AMICALES\n5. SES UVRES ET ACCOMPLISSEMENTS\n6. SES PREUVES ET DFIS\n7. SA FOI ET SA RELATION AVEC DIEU\n8. SA MORT OU FIN DE VIE (si mentionne)\n9. SON HRITAGE ET POSTRIT\n10. VERSETS-CLS  RETENIR\n\nCroise tous les passages bibliques disponibles. Sois narratif, dtaill et historiquement prcis selon les critures. Minimum 2000 mots.`;\n\n      // Histoire gnre (simule pour la dmo)\n      const mockHistory = generateMockCharacterHistory(character);\n      setCharacterHistory(mockHistory);\n\n    } catch (error) {\n      console.error(\"Erreur gnration histoire:\", error);\n      setCharacterHistory(\"Erreur lors de la gnration de l'histoire du personnage.\");\n    } finally {\n      setIsCharacterLoading(false);\n    }\n  };\n\n  // Fonction pour gnrer une histoire mock (en attendant l'intgration API)\n  const generateMockCharacterHistory = (character) => {\n    const histories = {\n      \"Abraham\": `\n        ##  ABRAHAM - Le Pre de la Foi (vers 2000 av. J.-C.)\n\n        ### 1. IDENTIT ET GNALOGIE\n        Abraham, n Abram (signifiant \"pre lev\"), fils de Trach, descendant de Sem. Originaire d'Ur en Chalde (actuel Irak). Sa gnalogie remonte  No par Sem. Mari  Sara (d'abord appele Sara), sa demi-sur par son pre.\n\n        ### 2. NAISSANCE ET JEUNESSE  UR\n        N vers 2166 av. J.-C.  Ur, grande cit msopotamienne connue pour ses ziggourats et le culte des idoles. Trah, son pre, tait probablement marchand. Environnement paen o l'on adorait le dieu-lune Nanna.\n\n        ### 3. L'APPEL DE DIEU ET LA GRANDE MIGRATION\n        **Gense 12:1-3** : \"L'ternel dit  Abram: Va-t'en de ton pays, de ta patrie, et de la maison de ton pre, dans le pays que je te montrerai.\"  75 ans, obit  l'appel divin sans connatre sa destination. Premire manifestation de sa foi exceptionnelle.\n\n        **tapes du voyage** :\n        - Ur  Charan (avec Trach, mort  205 ans)  \n        - Charan  Canaan (avec Sara, Lot, serviteurs)\n        - Premire tape en Canaan : Sichem, chne de Mor\n\n        ### 4. LES ALLIANCES DIVINES\n        **Premire alliance (Gense 12:2-3)** : Promesse d'une grande nation, bndiction personnelle, bndiction universelle.\n\n        **Alliance renforce (Gense 15:5-6)** : \"Regarde vers le ciel, et compte les toiles... Ainsi sera ta postrit.\" Abraham crut et cela lui fut imput  justice.\n\n        **Alliance de la circoncision (Gense 17:4-8)** : Changement de nom (Abram  Abraham, \"pre d'une multitude\"), circoncision comme signe, promesse de la terre de Canaan.\n\n        ### 5. PREUVES DE FOI MAJEURES\n        **La famine en gypte (Gense 12:10-20)** : Premire grande preuve, mensonge sur Sara, intervention divine pour la protger.\n\n        **Sparation d'avec Lot (Gense 13)** : Conflits entre bergers, Abraham choisit la paix en laissant Lot choisir sa terre.\n\n        **Guerre des rois (Gense 14)** : Abraham guerrier librant Lot, rencontre avec Melchisdek, refus des biens du roi de Sodome.\n\n        **Le sacrifice d'Isaac (Gense 22)** : preuve suprme de la foi. \"Prends ton fils, ton unique, que tu aimes, Isaac...\" Intervention de l'ange au dernier moment.\n\n        ### 6. DESCENDANCE ET PROMESSES\n        **Ismal avec Agar** (Gense 16) : N quand Abraham avait 86 ans. Sara strile pousse Abraham vers sa servante. Source de tensions familiales.\n\n        **Isaac, fils de la promesse** (Gense 21) : N quand Abraham avait 100 ans et Sara 90 ans. Rire de Sara : \"Dieu m'a fait un sujet de rire.\"\n\n        ### 7. RELATIONS ET INTERCESSION\n        **Intercession pour Sodome** (Gense 18:22-33) : Dialogue extraordinaire avec Dieu, marchandage pour sauver la ville. Rvle son cur compassionnel.\n\n        **Relations avec les peuples locaux** : Alliances avec Abimlec, respect mutuel avec les Hthiens pour l'achat de la grotte de Macpla.\n\n        ### 8. MORT ET SPULTURE\n        Mort  175 ans (Gense 25:7-8) : \"Abraham expira et mourut dans une heureuse vieillesse, g et rassasi de jours.\" Enterr dans la grotte de Macpla avec Sara par Isaac et Ismal rconcilis.\n\n        ### 9. HRITAGE SPIRITUEL\n        **Pre de trois religions monothistes** : Judasme, Christianisme, Islam le vnrent.\n\n        **Modle de foi** (Romains 4:16, Hbreux 11:8-12) : \"C'est pourquoi les hritiers le sont par la foi, pour que ce soit par grce.\"\n\n        **Ami de Dieu** (Jacques 2:23, 2 Chroniques 20:7) : Titre unique dans les critures.\n\n        ### 10. VERSETS-CLS  RETENIR\n        - **Gense 15:6** : \"Abram crut  l'ternel, qui le lui imputa  justice.\"\n        - **Gense 22:14** : \"Abraham donna  ce lieu le nom de Jhovah-Jir.\"  \n        - **Romains 4:17** : \"Dieu qui donne la vie aux morts, et qui appelle les choses qui ne sont point comme si elles taient.\"\n        - **Galates 3:9** : \"De sorte que ceux qui croient sont bnis avec Abraham le croyant.\"\n\n        Abraham demeure le prototype du croyant qui obit  Dieu par la foi, modle ternel pour tous les ges.\n      `,\n      \"Aaron\": `\n        ## AARON - Le Grand Prtre d'Isral (vers 1393-1273 av. J.-C.)\n\n        Aaron, dont le nom hbreu signifie \"montagnard\" ou \"clair\", nat vers 1396 av. J.-C. en gypte sous l'oppression pharaonique. Fils d'Amram et de Jokbed de la tribu de Lvi, il grandit aux cts de son frre cadet Mose et de sa sur Miriam dans une famille pieuse qui prserve la foi d'Abraham malgr l'esclavage. Son mariage avec lischba, fille d'Amminadab, lui donne quatre fils : Nadab, Abihu, lazar et Ithamar, qui marqueront l'histoire du sacerdoce d'Isral.\n\n        L'appel divin transforme Aaron en porte-parole de Mose. Selon **Exode 4:14-16**, l'ternel dclare : \"N'y a-t-il pas ton frre Aaron, le Lvite ? Je sais qu'il parlera facilement.\" Cette lection divine scelle le destin d'Aaron comme mdiateur entre Dieu et son peuple. Leur premire rencontre prophtique  la montagne de Dieu aprs quarante ans de sparation inaugure un ministre commun extraordinaire.\n\n        Devant Pharaon, Aaron dmontre la puissance divine en transformant son bton en serpent qui dvore ceux des magiciens gyptiens. Il excute plusieurs des dix plaies : l'eau change en sang, les grenouilles et les moustiques, attestant ainsi la supriorit du Dieu d'Isral sur les divinits gyptiennes. Cette dmonstration de force prpare la libration d'Isral de l'esclavage.\n\n        Pendant l'Exode, Aaron guide avec Mose plus de 600 000 hommes hors d'gypte, participant aux grands miracles : le passage de la mer Rouge, l'eau jaillissant du rocher et la manne tombant du ciel. Lors de la bataille contre Amalek, Aaron soutient avec Hur les mains leves de Mose, assurant ainsi la victoire d'Isral par la prire et l'intercession.\n\n        L'institution divine de la prtrise marque l'apoge de la vie d'Aaron. Selon **Exode 28:1**, Dieu ordonne : \"Fais approcher de toi Aaron, ton frre, et ses fils avec lui, du milieu des enfants d'Isral, pour qu'ils soient  mon service dans le sacerdoce.\" Aaron revt alors les vtements sacrs : l'phod, le pectoral orn de douze pierres prcieuses reprsentant les tribus d'Isral, et la tiare portant l'inscription \"Saintet  l'ternel\". Sept jours de conscration, l'onction d'huile sainte et des sacrifices d'expiation tablissent le sacerdoce aaronique pour l'ternit.\n\n        Comme Grand Prtre, Aaron assume des responsabilits uniques. Seul autoris  pntrer dans le Saint des Saints lors du Jour des Expiations, il offre l'expiation pour les pchs d'Isral. Ses journes se remplissent d'holocaustes perptuels matin et soir, d'intercession constante pour le peuple. La bndiction sacerdotale de **Nombres 6:24-26** rsonne de sa bouche : \"Que l'ternel te bnisse, et qu'il te garde ! Que l'ternel fasse luire sa face sur toi, et qu'il t'accorde sa grce !\"\n\n        Cependant, Aaron n'chappe pas aux preuves humaines. En l'absence de Mose au Sina, il cde  la pression populaire et faonne le veau d'or, proclamant : \"Voici ton dieu, Isral, qui t'a fait sortir d'gypte !\" Ce grave pch d'idoltrie rvle sa vulnrabilit, mais l'intercession de Mose lui obtient le pardon divin. Plus tard, la mort foudroyante de ses fils Nadab et Abihu, qui offrent un \"feu tranger\" devant l'ternel, le plonge dans un silence douloureux mais soumis au jugement de Dieu.\n\n        Sa rbellion avec Miriam contre Mose concernant sa femme thiopienne rvle galement ses luttes fraternelles. Quand Miriam est frappe de lpre, Aaron intercde pour sa sur, manifestant son cur compatissant. La rvolte de Kor contre son autorit sacerdotale trouve sa rponse divine dans le miracle de la verge : seule celle d'Aaron fleurit et produit des amandes, confirmant son lection. Cette verge miraculeuse est conserve dans l'arche comme tmoignage perptuel.\n\n         123 ans, Aaron gravit le mont Hor avec Mose et son fils lazar. Dieu lui annonce sa mort imminente en chtiment de sa rbellion aux eaux de Meriba. Dans un geste solennel, Aaron transmet ses vtements sacerdotaux  lazar qui lui succde, puis rend paisiblement son dernier souffle. \"Toute la maison d'Isral pleura Aaron pendant trente jours,\" tmoignage de l'amour du peuple pour son Grand Prtre.\n\n        L'hritage spirituel d'Aaron traverse les sicles. Sa ligne assure le sacerdoce jusqu' l'poque de Jsus, prfigurant le Christ, notre Grand Souverain Sacrificateur selon **Hbreux 4:14-16**. Tandis qu'Aaron offrait des sacrifices rpts, Christ s'est offert une fois pour toutes. Aaron demeure le modle du mdiateur fidle, intercdant malgr ses faiblesses humaines, annonant le parfait sacerdoce du Messie qui rconcilie dfinitivement Dieu et les hommes.\n      `\n    };\n\n    return histories[character] || `\n      ## ${character} - Histoire Biblique Dtaille\n\n      L'histoire complte de ${character} sera gnre en croisant tous les passages bibliques le concernant. Cette fonctionnalit utilisera l'API Gemini pour crer un rcit dtaill incluant :\n\n      - Sa gnalogie et origine\n      - Les vnements majeurs de sa vie\n      - Ses relations avec Dieu et les hommes  \n      - Son hritage spirituel\n      - Les versets-cls le concernant\n\n      *Gnration en cours de dveloppement...*\n    `;\n  };\n\n  // Fonction Gemini pour enrichir la concordance de thmes\n  const handleGeminiConcordance = async () => {\n    if (!searchTerm.trim()) {\n      alert(\"Veuillez d'abord saisir un terme  rechercher\");\n      return;\n    }\n    \n    setIsLoading(true);\n    try {\n      // Simuler appel API Gemini pour enrichir la concordance\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      // Gnrer plus de versets avec Gemini (simul)\n      const enrichedResults = [\n        ...results,\n        // Ajouter des versets enrichis par Gemini\n        { book: \"Proverbes\", chapter: 8, verse: 17, text: `Les versets enrichis par Gemini pour \"${searchTerm}\" incluent des rfrences croises et des contextes approfondis...` },\n        { book: \"Psaume\", chapter: 119, verse: 105, text: `Analyse thologique approfondie du terme \"${searchTerm}\" selon les commentaires bibliques et la tradition...` }\n      ];\n      \n      setResults(enrichedResults);\n      console.log(`[GEMINI CONCORDANCE] Enrichissement pour \"${searchTerm}\"`);\n    } catch (error) {\n      console.error(\"Erreur Gemini concordance:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Fonction Gemini pour enrichir l'histoire des personnages\n  const handleGeminiCharacter = async () => {\n    if (!selectedCharacter) {\n      alert(\"Veuillez d'abord slectionner un personnage biblique\");\n      return;\n    }\n    \n    setIsCharacterLoading(true);\n    try {\n      // Simuler appel API Gemini pour enrichir l'histoire du personnage\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      const enrichedHistory = `\n${characterHistory}\n\n##  ENRICHISSEMENT GEMINI\n\n### ANALYSE THOLOGIQUE APPROFONDIE\nL'intelligence artificielle Gemini a analys ${selectedCharacter} en croisant tous les passages bibliques et apporte ces clairages supplmentaires :\n\n- **Contexte historique enrichi** : Analyse des sources extra-bibliques\n- **Typologie christologique** : Prfigurations du Christ dans la vie de ${selectedCharacter}\n- **Applications contemporaines** : Leons pour le croyant d'aujourd'hui\n- **Rfrences croises** : Liens avec d'autres personnages bibliques\n\n*Enrichissement gnr par Gemini AI pour une comprhension plus profonde des critures.*\n      `;\n      \n      setCharacterHistory(enrichedHistory);\n      console.log(`[GEMINI PERSONNAGE] Enrichissement pour ${selectedCharacter}`);\n    } catch (error) {\n      console.error(\"Erreur Gemini personnage:\", error);\n    } finally {\n      setIsCharacterLoading(false);\n    }\n  };\n\n  const generateConcordanceResults = (term) => {\n    const mockVerses = {\n      \"amour\": [\n        { book: \"Jean\", chapter: 3, verse: 16, text: \"Car Dieu a tant aim le monde qu'il a donn son Fils unique, afin que quiconque croit en lui ne prisse point, mais qu'il ait la vie ternelle.\" },\n        { book: \"1 Corinthiens\", chapter: 13, verse: 4, text: \"L'amour est patient, il est plein de bont; l'amour n'est point envieux; l'amour ne se vante point, il ne s'enfle point d'orgueil,\" },\n        { book: \"1 Jean\", chapter: 4, verse: 8, text: \"Celui qui n'aime pas n'a pas connu Dieu, car Dieu est amour.\" },\n        { book: \"1 Jean\", chapter: 4, verse: 19, text: \"Pour nous, nous l'aimons, parce qu'il nous a aims le premier.\" },\n        { book: \"Romains\", chapter: 8, verse: 38, text: \"Car j'ai l'assurance que ni la mort ni la vie, ni les anges ni les dominations, ni les choses prsentes ni les choses  venir, ni les puissances, ni la hauteur, ni la profondeur, ni aucune autre crature ne pourra nous sparer de l'amour de Dieu manifest en Jsus-Christ notre Seigneur.\" },\n        { book: \"1 Corinthiens\", chapter: 13, verse: 13, text: \"Maintenant donc ces trois choses demeurent: la foi, l'esprance, la charit; mais la plus grande de ces choses, c'est la charit.\" },\n        { book: \"phsiens\", chapter: 3, verse: 19, text: \"et connatre l'amour de Christ, qui surpasse toute connaissance, en sorte que vous soyez remplis jusqu' toute la plnitude de Dieu.\" }\n      ],\n      \"paix\": [\n        { book: \"Jean\", chapter: 14, verse: 27, text: \"Je vous laisse la paix, je vous donne ma paix. Je ne vous donne pas comme le monde donne. Que votre cur ne se trouble point, et ne s'alarme point.\" },\n        { book: \"Philippiens\", chapter: 4, verse: 7, text: \"Et la paix de Dieu, qui surpasse toute intelligence, gardera vos curs et vos penses en Jsus-Christ.\" },\n        { book: \"sae\", chapter: 26, verse: 3, text: \"A celui qui est ferme dans ses sentiments Tu assures la paix, la paix, Parce qu'il se confie en toi.\" },\n        { book: \"Romains\", chapter: 5, verse: 1, text: \"tant donc justifis par la foi, nous avons la paix avec Dieu par notre Seigneur Jsus-Christ.\" },\n        { book: \"Jean\", chapter: 16, verse: 33, text: \"Je vous ai dit ces choses, afin que vous ayez la paix en moi. Vous aurez des tribulations dans le monde; mais prenez courage, j'ai vaincu le monde.\" }\n      ],\n      \"foi\": [\n        { book: \"Hbreux\", chapter: 11, verse: 1, text: \"Or la foi est une ferme assurance des choses qu'on espre, une dmonstration de celles qu'on ne voit point.\" },\n        { book: \"Romains\", chapter: 10, verse: 17, text: \"Ainsi la foi vient de ce qu'on entend, et ce qu'on entend vient de la parole de Christ.\" },\n        { book: \"phsiens\", chapter: 2, verse: 8, text: \"Car c'est par la grce que vous tes sauvs, par le moyen de la foi. Et cela ne vient pas de vous, c'est le don de Dieu.\" },\n        { book: \"Marc\", chapter: 11, verse: 22, text: \"Jsus prit la parole, et leur dit: Ayez foi en Dieu.\" },\n        { book: \"Habacuc\", chapter: 2, verse: 4, text: \"Voici, son me s'est enfle, elle n'est pas droite en lui; Mais le juste vivra par sa foi.\" },\n        { book: \"Jacques\", chapter: 2, verse: 17, text: \"Il en est ainsi de la foi: si elle n'a pas les uvres, elle est morte en elle-mme.\" }\n      ],\n      \"joie\": [\n        { book: \"Nhmie\", chapter: 8, verse: 10, text: \"Il leur dit: Allez, mangez des viandes grasses et buvez des liqueurs douces, et envoyez des portions  ceux qui n'ont rien de prpar, car ce jour est consacr  notre Seigneur; ne vous affligez pas, car la joie de l'ternel sera votre force.\" },\n        { book: \"Psaume\", chapter: 16, verse: 11, text: \"Tu me feras connatre le sentier de la vie; Il y a d'abondantes joies devant ta face, Des dlices ternelles  ta droite.\" },\n        { book: \"Galates\", chapter: 5, verse: 22, text: \"Mais le fruit de l'Esprit, c'est l'amour, la joie, la paix, la patience, la bont, la bnignit, la fidlit, la douceur, la temprance;\" },\n        { book: \"Jean\", chapter: 15, verse: 11, text: \"Je vous ai dit ces choses, afin que ma joie soit en vous, et que votre joie soit parfaite.\" },\n        { book: \"1 Pierre\", chapter: 1, verse: 8, text: \"vous l'aimez sans l'avoir vu, vous croyez en lui sans le voir encore, vous rjouissant d'une joie ineffable et glorieuse,\" }\n      ],\n      \"espoir\": [\n        { book: \"Romains\", chapter: 15, verse: 13, text: \"Que le Dieu de l'esprance vous remplisse de toute joie et de toute paix dans la foi, pour que vous abondiez en esprance, par la puissance du Saint-Esprit!\" },\n        { book: \"Jrmie\", chapter: 29, verse: 11, text: \"Car je connais les projets que j'ai forms sur vous, dit l'ternel, projets de paix et non de malheur, afin de vous donner un avenir et de l'esprance.\" },\n        { book: \"1 Pierre\", chapter: 1, verse: 3, text: \"Bni soit Dieu, le Pre de notre Seigneur Jsus-Christ, qui, selon sa grande misricorde, nous a rgnrs, pour une esprance vivante, par la rsurrection de Jsus-Christ d'entre les morts,\" },\n        { book: \"Hbreux\", chapter: 6, verse: 19, text: \"Cette esprance, nous la possdons comme une ancre de l'me, sre et solide;\" }\n      ],\n      \"sagesse\": [\n        { book: \"Proverbes\", chapter: 1, verse: 7, text: \"La crainte de l'ternel est le commencement de la science; Les insenss mprisent la sagesse et l'instruction.\" },\n        { book: \"Jacques\", chapter: 1, verse: 5, text: \"Si quelqu'un d'entre vous manque de sagesse, qu'il la demande  Dieu, qui donne  tous simplement et sans reproche, et elle lui sera donne.\" },\n        { book: \"Proverbes\", chapter: 3, verse: 13, text: \"Heureux l'homme qui a trouv la sagesse, Et l'homme qui possde l'intelligence!\" },\n        { book: \"Ecclsiaste\", chapter: 7, verse: 12, text: \"Car  l'ombre de la sagesse on est abrit comme  l'ombre de l'argent; mais un avantage de la science, c'est que la sagesse fait vivre ceux qui la possdent.\" }\n      ],\n      \"pardon\": [\n        { book: \"1 Jean\", chapter: 1, verse: 9, text: \"Si nous confessons nos pchs, il est fidle et juste pour nous les pardonner, et pour nous purifier de toute iniquit.\" },\n        { book: \"Matthieu\", chapter: 6, verse: 14, text: \"Si vous pardonnez aux hommes leurs offenses, votre Pre cleste vous pardonnera aussi;\" },\n        { book: \"Colossiens\", chapter: 3, verse: 13, text: \"Supportez-vous les uns les autres, et, si l'un a sujet de se plaindre de l'autre, pardonnez-vous rciproquement. De mme que Christ vous a pardonn, pardonnez-vous aussi.\" },\n        { book: \"phsiens\", chapter: 4, verse: 32, text: \"Soyez bons les uns envers les autres, compatissants, vous pardonnant rciproquement, comme Dieu vous a pardonn en Christ.\" }\n      ],\n      \"prire\": [\n        { book: \"1 Thessaloniciens\", chapter: 5, verse: 17, text: \"Priez sans cesse.\" },\n        { book: \"Philippiens\", chapter: 4, verse: 6, text: \"Ne vous inquitez de rien; mais en toute chose faites connatre vos besoins  Dieu par des prires et des supplications, avec des actions de grces.\" },\n        { book: \"Matthieu\", chapter: 6, verse: 9, text: \"Voici donc comment vous devez prier: Notre Pre qui es aux cieux! Que ton nom soit sanctifi;\" },\n        { book: \"Jacques\", chapter: 5, verse: 16, text: \"Confessez donc vos pchs les uns aux autres, et priez les uns pour les autres, afin que vous soyez guris. La prire fervente du juste a une grande efficace.\" }\n      ]\n    };\n\n    const termLower = term.toLowerCase();\n    const matchingEntries = [];\n    \n    for (const [key, verses] of Object.entries(mockVerses)) {\n      if (key.includes(termLower) || termLower.includes(key)) {\n        matchingEntries.push(...verses);\n      }\n    }\n    \n    const uniqueResults = matchingEntries.filter((verse, index, arr) => \n      arr.findIndex(v => v.book === verse.book && v.chapter === verse.chapter && v.verse === verse.verse) === index\n    );\n    \n    return uniqueResults.slice(0, 10);\n  };\n\n  const searchBibleConcordance = async (searchTerm) => {\n    if (!searchTerm || searchTerm.trim().length < 2) {\n      setResults([]);\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      await new Promise(resolve => setTimeout(resolve, 800));\n      const mockResults = generateConcordanceResults(searchTerm.trim());\n      setResults(mockResults);\n    } catch (error) {\n      console.error(\"Erreur de recherche:\", error);\n      setResults([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSearchSubmit = (e) => {\n    e.preventDefault();\n    searchBibleConcordance(searchTerm);\n  };\n\n  const handleSuggestionClick = (term) => {\n    setSearchTerm(term);\n    searchBibleConcordance(term);\n  };\n\n  const openYouVersionConcordance = () => {\n    const searchUrl = searchTerm \n      ? `https://www.bible.com/search/bible?q=${encodeURIComponent(searchTerm)}`\n      : 'https://www.bible.com/';\n    window.open(searchUrl, '_blank');\n  };\n\n  const highlightSearchTerm = (text, term) => {\n    if (!term) return text;\n    const regex = new RegExp(`(${term})`, 'gi');\n    return text.replace(regex, '<mark style=\"background: #fef3c7; color: #92400e; padding: 2px 4px; border-radius: 4px;\">$1</mark>');\n  };\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, rgba(139, 92, 246, 0.95) 0%, rgba(124, 58, 237, 0.98) 100%)',\n      fontFamily: 'Inter, sans-serif'\n    }}>\n      {/* En-tte */}\n      <div style={{\n        padding: '40px 20px',\n        textAlign: 'center',\n        color: 'white'\n      }}>\n        <button \n          onClick={onGoBack}\n          style={{\n            background: 'rgba(255, 255, 255, 0.2)',\n            border: '1px solid rgba(255, 255, 255, 0.3)',\n            color: 'white',\n            padding: '12px 24px',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            marginBottom: '20px'\n          }}\n        >\n           Retour  l'tude\n        </button>\n        \n        <h1 style={{\n          fontSize: '2.5rem',\n          fontWeight: '800',\n          margin: '0 0 10px 0'\n        }}>\n           Bible de Concordance\n        </h1>\n        \n        <p style={{\n          fontSize: '1.1rem',\n          opacity: 0.9\n        }}>\n          Explorez les critures par mots-cls et personnages bibliques\n        </p>\n\n        {/* Onglets de navigation */}\n        <div style={{\n          display: 'flex',\n          justifyContent: 'center',\n          gap: '16px',\n          marginTop: '24px'\n        }}>\n          <button\n            onClick={() => setActiveTab('concordance')}\n            style={{\n              background: activeTab === 'concordance' ? 'rgba(255, 255, 255, 0.3)' : 'rgba(255, 255, 255, 0.1)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              color: 'white',\n              padding: '12px 24px',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: '600',\n              transition: 'all 0.3s ease',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px'\n            }}\n          >\n             Concordance\n          </button>\n          <button\n            onClick={() => setActiveTab('characters')}\n            style={{\n              background: activeTab === 'characters' ? 'rgba(255, 255, 255, 0.3)' : 'rgba(255, 255, 255, 0.1)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              color: 'white',\n              padding: '12px 24px',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: '600',\n              transition: 'all 0.3s ease',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px'\n            }}\n          >\n             Personnages Bibliques\n          </button>\n        </div>\n      </div>\n\n      {/* Contenu selon l'onglet actif */}\n      {activeTab === 'concordance' ? (\n        // SECTION CONCORDANCE EXISTANTE\n        <>\n          {/* Zone de recherche concordance */}\n          <div style={{\n            maxWidth: '800px',\n            margin: '20px auto 0',\n            padding: '0 20px'\n          }}>\n            <div style={{\n              background: 'white',\n              borderRadius: '16px',\n              padding: '30px',\n              boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)'\n            }}>\n              <h3 style={{\n                margin: '0 0 20px 0',\n                color: '#333',\n                fontSize: '18px',\n                fontWeight: 'bold'\n              }}>\n                 Recherche par Mots-Cls\n              </h3>\n              <form onSubmit={handleSearchSubmit}>\n                <div style={{\n                  display: 'flex',\n                  gap: '10px',\n                  marginBottom: '20px'\n                }}>\n                  <input\n                    type=\"text\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    placeholder=\"Rechercher un mot dans la Bible...\"\n                    style={{\n                      flex: 1,\n                      padding: '15px',\n                      border: '1px solid #ddd',\n                      borderRadius: '8px',\n                      fontSize: '16px'\n                    }}\n                  />\n                  <button\n                    type=\"submit\"\n                    disabled={isLoading}\n                    style={{\n                      background: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',\n                      color: 'white',\n                      border: 'none',\n                      padding: '15px 20px',\n                      borderRadius: '8px',\n                      cursor: isLoading ? 'not-allowed' : 'pointer',\n                      opacity: isLoading ? 0.6 : 1,\n                      minWidth: '100px'\n                    }}\n                  >\n                    {isLoading ? 'Recherche...' : 'Rechercher'}\n                  </button>\n                  \n                  {/* BOUTON GEMINI POUR CONCORDANCE */}\n                  <button\n                    type=\"button\"\n                    onClick={handleGeminiConcordance}\n                    disabled={isLoading || !searchTerm.trim()}\n                    style={{\n                      background: 'linear-gradient(135deg, #00d2d3, #54a0ff)',\n                      color: 'white',\n                      border: 'none',\n                      padding: '15px 20px',\n                      borderRadius: '8px',\n                      cursor: isLoading || !searchTerm.trim() ? 'not-allowed' : 'pointer',\n                      opacity: isLoading || !searchTerm.trim() ? 0.6 : 1,\n                      minWidth: '110px',\n                      fontSize: '14px',\n                      fontWeight: '600',\n                      display: 'flex',\n                      alignItems: 'center',\n                      gap: '6px'\n                    }}\n                    title=\"Enrichir la concordance avec Gemini AI\"\n                  >\n                     Gemini\n                  </button>\n                </div>\n              </form>\n\n              {/* Section des 30 thmes de la sainte doctrine */}\n              <div style={{ marginBottom: '40px' }}>\n                <h3 style={{\n                  textAlign: 'center',\n                  color: '#475569',\n                  fontSize: '1.3rem',\n                  fontWeight: '700',\n                  marginBottom: '24px',\n                  background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)',\n                  WebkitBackgroundClip: 'text',\n                  WebkitTextFillColor: 'transparent',\n                  backgroundClip: 'text'\n                }}>\n                   Suggestions populaires : les 30 thmes de la sainte doctrine\n                </h3>\n                \n                <div style={{\n                  display: 'grid',\n                  gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\n                  gap: '12px',\n                  maxWidth: '1200px',\n                  margin: '0 auto'\n                }}>\n                  {[\n                    'Salut', 'Grce', 'Foi', 'Amour', 'Paix', 'Joie', \n                    'Esprance', 'Pardon', 'Rdemption', 'Justification',\n                    'Sanctification', 'Rsurrection', 'Vie ternelle', 'Royaume de Dieu',\n                    'Repentance', 'Baptme', 'Saint-Esprit', 'Prire',\n                    'Louange', 'Adoration', 'Obissance', 'Humilit',\n                    'Compassion', 'Misricorde', 'Vrit', 'Sagesse',\n                    'Justice', 'Saintet', 'Providence', 'Gloire'\n                  ].map((theme) => (\n                    <button\n                      key={theme}\n                      onClick={() => {\n                        setSearchTerm(theme);\n                        searchBibleConcordance(theme);\n                      }}\n                      style={{\n                        background: 'linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9))',\n                        border: '2px solid rgba(139, 92, 246, 0.2)',\n                        color: '#7c3aed',\n                        padding: '12px 16px',\n                        borderRadius: '12px',\n                        cursor: 'pointer',\n                        fontSize: '14px',\n                        fontWeight: '600',\n                        transition: 'all 0.3s ease',\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n                        textAlign: 'center'\n                      }}\n                      onMouseOver={(e) => {\n                        e.target.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';\n                        e.target.style.color = 'white';\n                        e.target.style.transform = 'translateY(-2px)';\n                        e.target.style.boxShadow = '0 4px 16px rgba(139, 92, 246, 0.3)';\n                      }}\n                      onMouseOut={(e) => {\n                        e.target.style.background = 'linear-gradient(135deg, rgba(255,255,255,0.95), rgba(248,250,252,0.9))';\n                        e.target.style.color = '#7c3aed';\n                        e.target.style.transform = 'translateY(0)';\n                        e.target.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';\n                      }}\n                    >\n                      {theme}\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Suggestions rapides classiques */}\n              <div style={{\n                display: 'flex',\n                flexWrap: 'wrap',\n                gap: '12px',\n                justifyContent: 'center',\n                marginBottom: '30px'\n              }}>\n                <p style={{\n                  width: '100%',\n                  textAlign: 'center',\n                  color: '#64748b',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  margin: '0 0 16px 0'\n                }}>\n                  Recherches rapides :\n                </p>\n                {['miracle', 'prophtie', 'temple', 'alliance', 'bndiction', 'pch', 'cration', 'jugement'].map((suggestion) => (\n                  <button\n                    key={suggestion}\n                    onClick={() => setSearchTerm(suggestion)}\n                    style={{\n                      background: 'rgba(255, 255, 255, 0.9)',\n                      border: '2px solid rgba(139, 92, 246, 0.3)',\n                      color: '#7c3aed',\n                      padding: '8px 16px',\n                      borderRadius: '20px',\n                      cursor: 'pointer',\n                      fontSize: '14px',\n                      fontWeight: '600',\n                      transition: 'all 0.3s ease',\n                      boxShadow: '0 2px 8px rgba(0,0,0,0.1)'\n                    }}\n                  >\n                    {suggestion}\n                  </button>\n                ))}\n              </div>\n\n              {/* Bouton YouVersion */}\n              <div style={{\n                textAlign: 'center'\n              }}>\n                <button\n                  onClick={openYouVersionConcordance}\n                  style={{\n                    background: 'linear-gradient(135deg, #059669 0%, #047857 100%)',\n                    color: 'white',\n                    border: 'none',\n                    padding: '12px 24px',\n                    borderRadius: '8px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    fontWeight: '600'\n                  }}\n                >\n                   Ouvrir sur YouVersion\n                </button>\n              </div>\n            </div>\n          </div>\n        </>\n      ) : (\n        // NOUVELLE SECTION PERSONNAGES BIBLIQUES  \n        <>\n          {/* Zone de recherche personnages */}\n          <div style={{\n            maxWidth: '800px',\n            margin: '20px auto 0',\n            padding: '0 20px'\n          }}>\n            <div style={{\n              background: 'white',\n              borderRadius: '16px',\n              padding: '30px',\n              boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)'\n            }}>\n              <h3 style={{\n                margin: '0 0 20px 0',\n                color: '#333',\n                fontSize: '18px',\n                fontWeight: 'bold'\n              }}>\n                 Recherche de Personnages Bibliques\n              </h3>\n              \n              {!selectedCharacter ? (\n                <>\n                  <div style={{\n                    marginBottom: '20px'\n                  }}>\n                    <input\n                      type=\"text\"\n                      value={characterSearchTerm}\n                      onChange={(e) => setCharacterSearchTerm(e.target.value)}\n                      placeholder=\"Tapez le nom d'un personnage biblique...\"\n                      style={{\n                        width: '100%',\n                        padding: '15px',\n                        border: '1px solid #ddd',\n                        borderRadius: '8px',\n                        fontSize: '16px',\n                        boxSizing: 'border-box'\n                      }}\n                    />\n                  </div>\n\n                  {/* Liste filtre des personnages */}\n                  <div className=\"biblical-characters-grid\" style={{\n                    display: 'grid',\n                    gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',\n                    gap: '10px',\n                    maxHeight: '350px',\n                    overflowY: 'auto',\n                    border: '1px solid #eee',\n                    borderRadius: '8px',\n                    padding: '16px',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  }}>\n                    {biblicalCharacters\n                      .filter(character => \n                        characterSearchTerm === '' || \n                        character.toLowerCase().includes(characterSearchTerm.toLowerCase())\n                      )\n                      .map(character => (\n                        <button\n                          key={character}\n                          onClick={() => generateCharacterHistory(character)}\n                          className=\"biblical-character-btn\"\n                          style={{\n                            background: 'rgba(139, 92, 246, 0.1)',\n                            border: '1px solid rgba(139, 92, 246, 0.3)',\n                            color: '#7c3aed',\n                            padding: '12px 8px',\n                            borderRadius: '8px',\n                            cursor: 'pointer',\n                            fontSize: '13px',\n                            fontWeight: '500',\n                            transition: 'all 0.3s ease',\n                            textAlign: 'center',\n                            width: '100%',\n                            boxSizing: 'border-box',\n                            minHeight: '48px',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center'\n                          }}\n                          onMouseOver={(e) => {\n                            e.target.style.background = 'rgba(139, 92, 246, 0.2)';\n                            e.target.style.transform = 'translateY(-1px)';\n                          }}\n                          onMouseOut={(e) => {\n                            e.target.style.background = 'rgba(139, 92, 246, 0.1)';\n                            e.target.style.transform = 'translateY(0)';\n                          }}\n                        >\n                          {character}\n                        </button>\n                      ))}}}\n                  </div>\n\n                  {characterSearchTerm && biblicalCharacters.filter(c => \n                    c.toLowerCase().includes(characterSearchTerm.toLowerCase())\n                  ).length === 0 && (\n                    <div style={{\n                      textAlign: 'center',\n                      padding: '20px',\n                      color: '#666',\n                      fontSize: '14px'\n                    }}>\n                      Aucun personnage trouv pour \"{characterSearchTerm}\"\n                    </div>\n                  )}\n                </>\n              ) : (\n                // Affichage de l'histoire du personnage slectionn\n                <div>\n                  <div style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    marginBottom: '20px'\n                  }}>\n                    <h2 style={{\n                      margin: 0,\n                      color: '#333',\n                      fontSize: '20px',\n                      fontWeight: 'bold'\n                    }}>\n                       Histoire de {selectedCharacter}\n                    </h2>\n                    <div style={{\n                      display: 'flex',\n                      gap: '12px',\n                      alignItems: 'center'\n                    }}>\n                      {/* BOUTON GEMINI POUR PERSONNAGE SLECTIONN */}\n                      <button\n                        onClick={handleGeminiCharacter}\n                        disabled={isCharacterLoading}\n                        style={{\n                          background: 'linear-gradient(135deg, #00d2d3, #54a0ff)',\n                          color: 'white',\n                          border: 'none',\n                          padding: '10px 16px',\n                          borderRadius: '6px',\n                          cursor: isCharacterLoading ? 'not-allowed' : 'pointer',\n                          opacity: isCharacterLoading ? 0.6 : 1,\n                          fontSize: '12px',\n                          fontWeight: '600',\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: '6px'\n                        }}\n                        title=\"Enrichir avec Gemini AI\"\n                      >\n                         Gemini\n                      </button>\n                      \n                      <button\n                        onClick={() => {\n                          setSelectedCharacter(null);\n                          setCharacterHistory('');\n                          setCharacterSearchTerm('');\n                        }}\n                        style={{\n                          background: 'rgba(107, 114, 128, 0.1)',\n                          border: '1px solid rgba(107, 114, 128, 0.3)',\n                          color: '#6b7280',\n                          padding: '8px 16px',\n                          borderRadius: '6px',\n                          cursor: 'pointer',\n                          fontSize: '12px'\n                        }}\n                      >\n                         Retour  la liste\n                      </button>\n                    </div>\n                  </div>\n\n                  {isCharacterLoading ? (\n                    <div style={{\n                      textAlign: 'center',\n                      padding: '60px 20px'\n                    }}>\n                      <div style={{\n                        width: '40px',\n                        height: '40px',\n                        border: '4px solid #e2e8f0',\n                        borderTop: '4px solid #8b5cf6',\n                        borderRadius: '50%',\n                        animation: 'spin 1s linear infinite',\n                        margin: '0 auto 20px'\n                      }} />\n                      <p style={{\n                        color: '#666',\n                        fontSize: '16px',\n                        margin: 0\n                      }}>\n                        Gnration de l'histoire complte de {selectedCharacter}...\n                      </p>\n                      <p style={{\n                        color: '#999',\n                        fontSize: '12px',\n                        margin: '8px 0 0'\n                      }}>\n                        Croisement des versets bibliques en cours\n                      </p>\n                    </div>\n                  ) : (\n                    <div style={{\n                      background: 'linear-gradient(135deg, #f8fafc, #f1f5f9)',\n                      border: '1px solid rgba(139, 92, 246, 0.2)',\n                      borderRadius: '12px',\n                      padding: '30px',\n                      maxHeight: '700px',\n                      overflowY: 'auto',\n                      fontSize: '15px',\n                      lineHeight: '1.7',\n                      boxShadow: '0 4px 20px rgba(0,0,0,0.08)'\n                    }}>\n                      <div dangerouslySetInnerHTML={{\n                        __html: characterHistory\n                          .replace(/\\n/g, '<br>')\n                          // Titre principal sur une ligne\n                          .replace(/##\\s(.+)/g, '<h2 style=\"color: #1e293b; margin: 24px 0 20px 0; font-size: 20px; font-weight: 700; border-bottom: 2px solid rgba(139, 92, 246, 0.3); padding-bottom: 8px; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\">$1</h2>')\n                          // Supprimer les ### et numrotation pour un style narratif\n                          .replace(/###\\s?\\d*\\.?\\s*(.+)/g, '<p style=\"color: #1e293b; margin: 16px 0 12px 0; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;\">$1</p>')\n                          // Gras pour les passages importants\n                          .replace(/\\*\\*(.+?)\\*\\*/g, '<strong style=\"color: #7c3aed; font-weight: 700;\">$1</strong>')\n                          // Italique pour les mots trangers et citations\n                          .replace(/\\*(.+?)\\*/g, '<em style=\"color: #64748b; font-style: italic;\">$1</em>')\n                          // Versets cliquables\n                          .replace(/(Exode|Lvitique|Nombres|Gense|Deutronome|Psaumes|Hbreux|Matthieu|Marc|Luc|Jean|Actes|Romains|1 Corinthiens|2 Corinthiens|Galates|phsiens|Philippiens|Colossiens)\\s+(\\d+):(\\d+(?:-\\d+)?)/g, \n                            '<span onclick=\"window.open(\\'https://www.bible.com/search/bible?q=$1+$2%3A$3\\', \\'_blank\\')\" style=\"background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; padding: 4px 8px; border-radius: 6px; cursor: pointer; text-decoration: none; font-weight: 600; display: inline-block; margin: 2px; transition: all 0.3s ease;\" onmouseover=\"this.style.transform=\\'scale(1.05)\\'\" onmouseout=\"this.style.transform=\\'scale(1)\\'\" title=\"Cliquer pour lire ce verset\"> $1 $2:$3</span>')\n                          // Crer des paragraphes narratifs\n                          .replace(/([.!?])\\s*<br>/g, '$1</p><p style=\"color: #374151; font-size: 15px; line-height: 1.7; margin: 12px 0; text-align: justify; text-indent: 20px;\">')\n                          .replace(/^/, '<p style=\"color: #374151; font-size: 15px; line-height: 1.7; margin: 12px 0; text-align: justify; text-indent: 20px;\">')\n                          .replace(/$/, '</p>')\n                      }} />\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n\n      {/* Rsultats de recherche concordance */}\n      {activeTab === 'concordance' && (\n        <div style={{\n          maxWidth: '1000px',\n          margin: '20px auto 0',\n          padding: '0 20px'\n        }}>\n          {/* Rsultats */}\n          {isLoading ? (\n            <div style={{ textAlign: 'center', padding: '40px' }}>\n              <div style={{\n                width: '40px',\n                height: '40px',\n                border: '4px solid #e5e7eb',\n                borderTop: '4px solid #8b5cf6',\n                borderRadius: '50%',\n                animation: 'spin 1s linear infinite',\n                margin: '0 auto'\n              }}></div>\n              <p style={{ color: 'white', marginTop: '15px' }}>\n                Recherche en cours...\n              </p>\n            </div>\n          ) : results.length > 0 ? (\n            <div>\n              <h2 style={{\n                textAlign: 'center',\n                color: 'white',\n                fontSize: '1.5rem',\n                marginBottom: '20px'\n              }}>\n                 {results.length} rsultat(s) pour \"{searchTerm}\"\n              </h2>\n              <div style={{\n                display: 'grid',\n                gap: '20px'\n              }}>\n                {results.map((verse, index) => (\n                  <div \n                    key={index}\n                    style={{\n                      background: 'white',\n                      borderRadius: '12px',\n                      padding: '20px',\n                      boxShadow: '0 4px 12px rgba(0, 0, 0, 0.1)',\n                      borderLeft: '4px solid #8b5cf6'\n                    }}\n                  >\n                    <div style={{\n                      color: '#7c3aed',\n                      fontSize: '14px',\n                      fontWeight: 'bold',\n                      marginBottom: '10px'\n                    }}>\n                      {verse.book} {verse.chapter}:{verse.verse}\n                    </div>\n                    <div \n                      style={{\n                        color: '#374151',\n                        lineHeight: '1.6'\n                      }}\n                      dangerouslySetInnerHTML={{ \n                        __html: highlightSearchTerm(verse.text, searchTerm) \n                      }}\n                    />\n                  </div>\n                ))}\n              </div>\n            </div>\n          ) : searchTerm.length > 0 ? (\n            <div style={{\n              background: 'white',\n              borderRadius: '12px',\n              padding: '40px',\n              textAlign: 'center'\n            }}>\n              <h3 style={{ color: '#6b7280' }}>\n                 Aucun rsultat pour \"{searchTerm}\"\n              </h3>\n              <p style={{ color: '#999', fontSize: '14px', marginTop: '10px' }}>\n                Essayez avec d'autres termes ou consultez les suggestions.\n              </p>\n            </div>\n          ) : (\n            /* Message de bienvenue supprim pour plus de clart */\n            null\n          )}\n        </div>\n      )}\n\n      {/* Styles CSS pour les animations */}\n      <style jsx>{`\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default BibleConcordancePage;","import React, { useState, useEffect } from 'react';\n\n// Configuration du backend - utilise la variable d'environnement\nconst getBackendUrl = () => {\n  if (process.env.REACT_APP_BACKEND_URL) {\n    return process.env.REACT_APP_BACKEND_URL;\n  }\n  const hostname = window.location.hostname;\n  if (hostname === \"localhost\" || hostname === \"127.0.0.1\") return \"http://localhost:8001\";\n  return \"https://scripture-ai-8.preview.emergentagent.com\";\n};\n\nconst BACKEND_URL = getBackendUrl();\nconst API_BASE = `${BACKEND_URL.replace(/\\/+$/g, \"\")}/api`;\n\nconst VersetParVersetPage = ({ onGoBack, content, bookInfo }) => {\n  const [currentBatch, setCurrentBatch] = useState(1); // Batch actuel (1, 2, 3...)\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\n  const [allVersetsBatches, setAllVersetsBatches] = useState({}); // Stocke tous les batches chargs\n  const [totalVersetsExpected, setTotalVersetsExpected] = useState(null);\n  const [enrichingVersets, setEnrichingVersets] = useState({}); // Track quels versets sont en cours d'enrichissement\n\n  useEffect(() => {\n    // Quand le contenu arrive, le stocker comme batch 1\n    if (content) {\n      setAllVersetsBatches(prev => ({\n        ...prev,\n        1: content\n      }));\n      setCurrentBatch(1);\n    }\n  }, [content]);\n\n  // Fonction pour enrichir une explication thologique spcifique avec Gemini\n  const enrichirExplicationGemini = async (versetNumber, currentExplication, versetText) => {\n    const enrichKey = `${currentBatch}-${versetNumber}`;\n    \n    if (enrichingVersets[enrichKey]) return; // Dj en cours\n    \n    setEnrichingVersets(prev => ({...prev, [enrichKey]: true}));\n    \n    try {\n      console.log(`[GEMINI ENRICHISSEMENT] Enrichissement verset ${versetNumber} batch ${currentBatch}`);\n      \n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      \n      const prompt = `ENRICHISSEMENT THOLOGIQUE APPROFONDI\n\nVerset biblique : \"${versetText}\"\nExplication actuelle : \"${currentExplication}\"\n\nMISSION : Enrichir et approfondir cette explication thologique avec 200-300 mots supplmentaires.\n\nAJOUTE :\n- Contexte historique et culturel\n- Liens avec d'autres passages bibliques\n- Implications doctrinales profondes\n- Applications pratiques modernes\n- Perspectives hermneutiques\n\nCONSERVE le texte original ET enrichis-le substantiellement.\n\nGNRE DIRECTEMENT l'explication enrichie complte :`;\n\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({\n          passage: `Enrichissement thologique`,\n          version: 'LSG',\n          tokens: 300,\n          use_gemini: true,\n          enriched: true,\n          custom_prompt: prompt\n        })\n      });\n      \n      if (!response.ok) throw new Error(`Erreur API: ${response.status}`);\n      \n      const data = await response.json();\n      \n      if (data.content) {\n        // Remplacer l'explication dans le batch actuel\n        const currentBatchContent = allVersetsBatches[currentBatch];\n        const versetPattern = new RegExp(`(VERSET ${versetNumber}[\\\\s\\\\S]*?EXPLICATION THOLOGIQUE[\\\\s\\\\S]*?:)([\\\\s\\\\S]*?)(?=VERSET|$)`, 'i');\n        \n        const enrichedExplication = data.content.replace(/.*EXPLICATION THOLOGIQUE.*?:/i, '').trim();\n        const enrichedContent = currentBatchContent.replace(versetPattern, `$1\\n${enrichedExplication}\\n`);\n        \n        // Mettre  jour le batch avec le contenu enrichi\n        setAllVersetsBatches(prev => ({\n          ...prev,\n          [currentBatch]: enrichedContent\n        }));\n        \n        console.log(`[GEMINI ENRICHISSEMENT] Verset ${versetNumber} enrichi avec succs`);\n      }\n      \n    } catch (error) {\n      console.error(`[GEMINI ENRICHISSEMENT] Erreur verset ${versetNumber}:`, error);\n    } finally {\n      setEnrichingVersets(prev => ({...prev, [enrichKey]: false}));\n    }\n  };\n\n  // Fonction pour charger le batch suivant (versets 6-10, 11-15, etc.)\n  const loadNextBatch = async () => {\n    if (isLoadingMore) return;\n    \n    const nextBatch = currentBatch + 1;\n    \n    // Si on a dj ce batch en cache, l'afficher directement\n    if (allVersetsBatches[nextBatch]) {\n      setCurrentBatch(nextBatch);\n      return;\n    }\n    \n    setIsLoadingMore(true);\n    \n    try {\n      // Calculer le range de versets  demander\n      const startVerse = (nextBatch - 1) * 5 + 1; // Batch 2 = versets 6-10, etc.\n      const endVerse = startVerse + 4;\n      \n      // Extraire le livre et chapitre du bookInfo\n      const bookChapter = bookInfo?.split(':')[0] || 'Gense 1';\n      const requestPassage = `${bookChapter}:${startVerse}-${endVerse}`;\n      \n      console.log(`[PAGINATION] Chargement batch ${nextBatch}: ${requestPassage}`);\n      \n      // Appeler l'API pour les versets suivants\n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      \n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          passage: requestPassage,\n          version: 'LSG',\n          tokens: 500,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Erreur API: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.content) {\n        // Stocker le nouveau batch\n        setAllVersetsBatches(prev => ({\n          ...prev,\n          [nextBatch]: data.content\n        }));\n        setCurrentBatch(nextBatch);\n        console.log(`[PAGINATION] Batch ${nextBatch} charg avec succs`);\n      } else {\n        throw new Error('Pas de contenu reu');\n      }\n      \n    } catch (error) {\n      console.error(`[PAGINATION] Erreur chargement batch ${nextBatch}:`, error);\n      // Optionnel : afficher une erreur  l'utilisateur\n    } finally {\n      setIsLoadingMore(false);\n    }\n  };\n\n  // Fonction pour naviguer vers un batch prcdent\n  const goToPreviousBatch = () => {\n    if (currentBatch > 1) {\n      setCurrentBatch(currentBatch - 1);\n    }\n  };\n\n  // Obtenir le contenu du batch actuel\n  const getCurrentBatchContent = () => {\n    return allVersetsBatches[currentBatch] || '';\n  };\n\n  // Fonction pour grer l'enrichissement d'un verset via React (pas via HTML onclick)\n  const handleEnrichirVerset = async (versetNumber) => {\n    console.log(`[GEMINI] Clic enrichissement verset ${versetNumber}`);\n    \n    // Extraire le texte du verset et l'explication actuelle\n    const currentContent = getCurrentBatchContent();\n    const versetRegex = new RegExp(`VERSET ${versetNumber}[\\\\s\\\\S]*?TEXTE BIBLIQUE[\\\\s\\\\S]*?:([\\\\s\\\\S]*?)EXPLICATION THOLOGIQUE[\\\\s\\\\S]*?:([\\\\s\\\\S]*?)(?=VERSET|$)`, 'i');\n    const match = currentContent.match(versetRegex);\n    \n    if (match) {\n      const versetText = match[1].trim();\n      const currentExplication = match[2].trim();\n      \n      await enrichirExplicationGemini(versetNumber, currentExplication, versetText);\n    }\n  };\n  \n  // Fonction pour nettoyer les marqueurs Markdown\n  const cleanMarkdownFormatting = (text) => {\n    if (!text) return '';\n    \n    return text\n      // Supprimer les ** pour le gras\n      .replace(/\\*\\*/g, '')\n      // Supprimer les * pour l'italique\n      .replace(/(?<!\\*)\\*(?!\\*)/g, '')\n      // Nettoyer les espaces multiples\n      .replace(/\\s+/g, ' ')\n      // Nettoyer les lignes vides multiples\n      .replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n')\n      .trim();\n  };\n\n  // Nouvelle approche : Analyser le contenu et crer des composants React avec boutons intgrs\n  const parseContentWithGeminiButtons = (content) => {\n    if (!content) return [];\n    \n    const sections = [];\n    const versetPattern = /(\\*\\*VERSET\\s+(\\d+)\\*\\*[\\s\\S]*?)(?=\\*\\*VERSET\\s+\\d+|$)/gi;\n    \n    let match;\n    while ((match = versetPattern.exec(content)) !== null) {\n      const versetNumber = parseInt(match[2]);\n      const versetContent = match[1].trim();\n      \n      // Sparer le contenu en parties\n      const parts = versetContent.split(/(\\*\\*TEXTE BIBLIQUE\\s*:\\*\\*|\\*\\*EXPLICATION THOLOGIQUE\\s*:\\*\\*)/i);\n      \n      let versetTitle = '';\n      let texteContent = '';\n      let explicationContent = '';\n      \n      for (let i = 0; i < parts.length; i++) {\n        const part = parts[i].trim();\n        \n        if (part.includes('**VERSET')) {\n          versetTitle = cleanMarkdownFormatting(part);\n        } else if (part.match(/TEXTE BIBLIQUE/i)) {\n          texteContent = cleanMarkdownFormatting(parts[i + 1]?.trim() || '');\n          i++; // Skip next part as we've consumed it\n        } else if (part.match(/\\*\\*EXPLICATION THOLOGIQUE/i)) {\n          explicationContent = cleanMarkdownFormatting(parts[i + 1]?.trim() || '');\n          i++; // Skip next part as we've consumed it\n        }\n      }\n      \n      sections.push({\n        number: versetNumber,\n        title: versetTitle,\n        texte: texteContent,\n        explication: explicationContent\n      });\n    }\n    \n    return sections;\n  };\n\n  // Fonction pour extraire les numros de versets du contenu\n  const extractVersetNumbers = (content) => {\n    if (!content) return [];\n    \n    const versetPattern = /\\*\\*VERSET\\s+(\\d+)\\*\\*/gi;\n    const matches = [];\n    let match;\n    \n    while ((match = versetPattern.exec(content)) !== null) {\n      matches.push(parseInt(match[1]));\n    }\n    \n    return matches;\n  };\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, rgba(248, 250, 252, 0.98) 0%, rgba(241, 245, 249, 0.95) 50%, rgba(248, 250, 252, 0.98) 100%)',\n      fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, sans-serif'\n    }}>\n      {/* En-tte moderne */}\n      <div style={{\n        background: 'linear-gradient(135deg, rgba(139, 92, 246, 0.95) 0%, rgba(124, 58, 237, 0.98) 100%)',\n        color: 'white',\n        padding: '30px 20px',\n        boxShadow: '0 8px 32px rgba(139, 92, 246, 0.25)',\n        position: 'sticky',\n        top: 0,\n        zIndex: 100,\n        overflow: 'hidden'\n      }}>\n        <div style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'linear-gradient(45deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%)',\n          pointerEvents: 'none'\n        }}></div>\n        \n        <div style={{\n          maxWidth: '900px',\n          margin: '0 auto',\n          position: 'relative',\n          zIndex: 10\n        }}>\n          <button \n            onClick={onGoBack}\n            style={{\n              background: 'rgba(255, 255, 255, 0.2)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              color: 'white',\n              padding: '10px 20px',\n              borderRadius: '12px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: '600',\n              marginBottom: '20px',\n              backdropFilter: 'blur(10px)',\n              transition: 'all 0.3s ease'\n            }}\n            onMouseOver={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.3)';\n              e.target.style.transform = 'translateY(-2px)';\n            }}\n            onMouseOut={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.2)';\n              e.target.style.transform = 'translateY(0)';\n            }}\n          >\n             Retour  l'tude\n          </button>\n          \n          <h1 style={{\n            fontSize: 'clamp(1.8rem, 4vw, 2.5rem)',\n            fontWeight: '800',\n            margin: '0 0 8px 0',\n            textAlign: 'center',\n            textShadow: '0 2px 8px rgba(0, 0, 0, 0.1)'\n          }}>\n             tude Verset par Verset\n          </h1>\n          \n          {bookInfo && (\n            <div style={{\n              fontSize: 'clamp(1rem, 3vw, 1.2rem)',\n              textAlign: 'center',\n              opacity: 0.9,\n              fontWeight: '500'\n            }}>\n              {bookInfo}  Batch {currentBatch} (versets {(currentBatch - 1) * 5 + 1}-{currentBatch * 5})\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Contenu principal avec optimisation mobile */}\n      <div style={{\n        maxWidth: '900px',\n        margin: '0 auto',\n        padding: '20px',\n        // Optimisation mobile : padding plus petit sur mobile\n        '@media (maxWidth: 768px)': {\n          padding: '15px'\n        }\n      }}>\n        {getCurrentBatchContent() ? (\n          <div style={{\n            background: 'white',\n            borderRadius: '16px',\n            padding: 'clamp(20px, 5vw, 40px)',\n            boxShadow: '0 8px 32px rgba(0, 0, 0, 0.08)',\n            border: '1px solid rgba(226, 232, 240, 0.8)',\n            lineHeight: '1.7',\n            fontSize: 'clamp(15px, 4vw, 16px)',\n            marginBottom: '20px'\n          }}>\n            {/* Nouveau rendu avec boutons intgrs */}\n            {parseContentWithGeminiButtons(getCurrentBatchContent()).map((section, index) => (\n              <div key={section.number} style={{ marginBottom: '40px' }}>\n                {/* Titre du verset */}\n                <div className=\"verset-header\">\n                  {section.title}\n                </div>\n                \n                {/* Texte biblique */}\n                {section.texte && (\n                  <>\n                    <div className=\"texte-biblique-label\">TEXTE BIBLIQUE :</div>\n                    <div style={{ \n                      marginBottom: '20px', \n                      padding: '10px 0',\n                      color: '#374151'\n                    }}>\n                      {section.texte}\n                    </div>\n                  </>\n                )}\n                \n                {/* Explication thologique avec bouton Gemini intgr */}\n                {section.explication && (\n                  <>\n                    <div style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'space-between',\n                      gap: '15px',\n                      marginBottom: '16px',\n                      flexWrap: 'wrap'\n                    }}>\n                      <div className=\"explication-label\" style={{ flex: '1', minWidth: '200px' }}>\n                        EXPLICATION THOLOGIQUE :\n                      </div>\n                      \n                      {/* Bouton Gemini  droite de l'explication */}\n                      <button \n                        onClick={() => handleEnrichirVerset(section.number)}\n                        disabled={enrichingVersets[`${currentBatch}-${section.number}`]}\n                        style={{\n                          background: enrichingVersets[`${currentBatch}-${section.number}`]\n                            ? 'linear-gradient(135deg, #94a3b8 0%, #64748b 100%)'\n                            : 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',\n                          color: 'white',\n                          border: 'none',\n                          padding: 'clamp(8px, 2vw, 12px) clamp(12px, 3vw, 18px)',\n                          borderRadius: '8px',\n                          fontSize: 'clamp(12px, 3vw, 14px)',\n                          fontWeight: '600',\n                          cursor: enrichingVersets[`${currentBatch}-${section.number}`] ? 'not-allowed' : 'pointer',\n                          transition: 'all 0.3s ease',\n                          boxShadow: '0 3px 12px rgba(139, 92, 246, 0.25)',\n                          whiteSpace: 'nowrap',\n                          flexShrink: 0,\n                          opacity: enrichingVersets[`${currentBatch}-${section.number}`] ? 0.7 : 1\n                        }}\n                        onMouseOver={(e) => {\n                          if (!enrichingVersets[`${currentBatch}-${section.number}`]) {\n                            e.target.style.transform = 'translateY(-1px)';\n                            e.target.style.boxShadow = '0 4px 16px rgba(139, 92, 246, 0.35)';\n                          }\n                        }}\n                        onMouseOut={(e) => {\n                          if (!enrichingVersets[`${currentBatch}-${section.number}`]) {\n                            e.target.style.transform = 'translateY(0)';\n                            e.target.style.boxShadow = '0 3px 12px rgba(139, 92, 246, 0.25)';\n                          }\n                        }}\n                      >\n                        {enrichingVersets[`${currentBatch}-${section.number}`] \n                          ? ' Gemini...' \n                          : ' Gemini gratuit'\n                        }\n                      </button>\n                    </div>\n                    \n                    {/* Contenu de l'explication */}\n                    <div style={{ \n                      color: '#374151',\n                      lineHeight: '1.7',\n                      marginBottom: '10px'\n                    }}>\n                      {section.explication.split('\\n').map((line, lineIndex) => (\n                        <React.Fragment key={lineIndex}>\n                          {line}\n                          {lineIndex < section.explication.split('\\n').length - 1 && <br />}\n                        </React.Fragment>\n                      ))}\n                    </div>\n                    \n                    {/* Indicateur de chargement */}\n                    {enrichingVersets[`${currentBatch}-${section.number}`] && (\n                      <div style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: '8px',\n                        marginTop: '12px',\n                        color: '#6b7280',\n                        fontSize: 'clamp(12px, 3vw, 14px)',\n                        justifyContent: 'center',\n                        padding: '10px',\n                        background: 'rgba(139, 92, 246, 0.05)',\n                        borderRadius: '8px'\n                      }}>\n                        <div style={{\n                          width: '16px',\n                          height: '16px',\n                          border: '2px solid #e5e7eb',\n                          borderTop: '2px solid #8b5cf6',\n                          borderRadius: '50%',\n                          animation: 'spin 1s linear infinite'\n                        }}></div>\n                        Enrichissement en cours avec Gemini...\n                      </div>\n                    )}\n                  </>\n                )}\n              </div>\n            ))}\n            \n            {/* Boutons de navigation */}\n            <div style={{\n              display: 'flex',\n              gap: '15px',\n              marginTop: '40px',\n              justifyContent: 'center',\n              flexWrap: 'wrap'\n            }}>\n              {/* Bouton Prcdent */}\n              {currentBatch > 1 && (\n                <button\n                  onClick={goToPreviousBatch}\n                  style={{\n                    background: 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)',\n                    color: 'white',\n                    border: 'none',\n                    padding: 'clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px)',\n                    borderRadius: '12px',\n                    fontSize: 'clamp(14px, 3.5vw, 16px)',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 4px 16px rgba(107, 114, 128, 0.25)',\n                    minWidth: '140px'\n                  }}\n                  onMouseOver={(e) => {\n                    e.target.style.transform = 'translateY(-2px)';\n                    e.target.style.boxShadow = '0 6px 24px rgba(107, 114, 128, 0.35)';\n                  }}\n                  onMouseOut={(e) => {\n                    e.target.style.transform = 'translateY(0)';\n                    e.target.style.boxShadow = '0 4px 16px rgba(107, 114, 128, 0.25)';\n                  }}\n                >\n                   Prcdent\n                </button>\n              )}\n\n              {/* Bouton Suivant */}\n              <button\n                onClick={loadNextBatch}\n                disabled={isLoadingMore}\n                style={{\n                  background: isLoadingMore \n                    ? 'linear-gradient(135deg, #94a3b8 0%, #64748b 100%)'\n                    : 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',\n                  color: 'white',\n                  border: 'none',\n                  padding: 'clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px)',\n                  borderRadius: '12px',\n                  fontSize: 'clamp(14px, 3.5vw, 16px)',\n                  fontWeight: '600',\n                  cursor: isLoadingMore ? 'not-allowed' : 'pointer',\n                  transition: 'all 0.3s ease',\n                  boxShadow: '0 4px 16px rgba(139, 92, 246, 0.25)',\n                  minWidth: '140px',\n                  opacity: isLoadingMore ? 0.7 : 1\n                }}\n                onMouseOver={(e) => {\n                  if (!isLoadingMore) {\n                    e.target.style.transform = 'translateY(-2px)';\n                    e.target.style.boxShadow = '0 6px 24px rgba(139, 92, 246, 0.35)';\n                  }\n                }}\n                onMouseOut={(e) => {\n                  if (!isLoadingMore) {\n                    e.target.style.transform = 'translateY(0)';\n                    e.target.style.boxShadow = '0 4px 16px rgba(139, 92, 246, 0.25)';\n                  }\n                }}\n              >\n                {isLoadingMore ? ' Chargement...' : 'Suivant '}\n              </button>\n            </div>\n\n            {/* Indicateur de progression */}\n            <div style={{\n              textAlign: 'center',\n              marginTop: '20px',\n              fontSize: 'clamp(12px, 3vw, 14px)',\n              color: '#6b7280'\n            }}>\n               Batch {currentBatch}  Versets {(currentBatch - 1) * 5 + 1}  {currentBatch * 5}\n            </div>\n            \n            {/* Styles CSS intgrs pour les couleurs */}\n            <style>\n              {`\n                .verset-header {\n                  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);\n                  color: white;\n                  font-size: clamp(1.2rem, 4vw, 1.4rem);\n                  font-weight: 800;\n                  padding: clamp(12px, 3vw, 16px) clamp(16px, 4vw, 24px);\n                  border-radius: 12px;\n                  margin: clamp(24px, 6vw, 32px) 0 clamp(16px, 4vw, 20px) 0;\n                  text-align: center;\n                  box-shadow: 0 4px 16px rgba(139, 92, 246, 0.25);\n                  text-transform: uppercase;\n                  letter-spacing: 1px;\n                }\n                \n                .texte-biblique-label {\n                  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n                  color: white;\n                  font-size: clamp(1rem, 3.5vw, 1.1rem);\n                  font-weight: 700;\n                  padding: clamp(10px, 3vw, 12px) clamp(16px, 4vw, 20px);\n                  border-radius: 10px;\n                  margin: clamp(20px, 5vw, 24px) 0 clamp(12px, 3vw, 16px) 0;\n                  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25);\n                  text-transform: uppercase;\n                  letter-spacing: 0.5px;\n                }\n                \n                .explication-label {\n                  background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);\n                  color: white;\n                  font-size: clamp(1rem, 3.5vw, 1.1rem);\n                  font-weight: 700;\n                  padding: clamp(10px, 3vw, 12px) clamp(16px, 4vw, 20px);\n                  border-radius: 10px;\n                  margin: clamp(20px, 5vw, 24px) 0 clamp(12px, 3vw, 16px) 0;\n                  box-shadow: 0 4px 12px rgba(249, 115, 22, 0.25);\n                  text-transform: uppercase;\n                  letter-spacing: 0.5px;\n                }\n                \n                .verset-content p {\n                  margin-bottom: clamp(16px, 4vw, 18px);\n                  line-height: 1.7;\n                  font-size: clamp(15px, 4vw, 16px);\n                }\n                \n                .verset-content br {\n                  line-height: 1.7;\n                }\n                \n                /* Animation spin pour les loadings */\n                @keyframes spin {\n                  0% { transform: rotate(0deg); }\n                  100% { transform: rotate(360deg); }\n                }\n                \n                /* Responsive mobile - lecture optimise */\n                @media (max-width: 768px) {\n                  .verset-header {\n                    margin: 20px 0 16px 0;\n                    border-radius: 8px;\n                  }\n                  \n                  .texte-biblique-label,\n                  .explication-label {\n                    margin: 16px 0 12px 0;\n                    border-radius: 8px;\n                  }\n                  \n                  .verset-content p {\n                    margin-bottom: 14px;\n                    text-align: left;\n                  }\n                }\n                \n                /* Styles pour trs petits crans */\n                @media (max-width: 480px) {\n                  .verset-header {\n                    font-size: 1.1rem;\n                    padding: 10px 14px;\n                  }\n                  \n                  .texte-biblique-label,\n                  .explication-label {\n                    font-size: 0.95rem;\n                    padding: 8px 14px;\n                  }\n                }\n              `}\n            </style>\n          </div>\n        ) : (\n          <div style={{\n            background: 'white',\n            borderRadius: '20px',\n            padding: 'clamp(40px, 8vw, 60px)',\n            textAlign: 'center',\n            boxShadow: '0 12px 40px rgba(0, 0, 0, 0.08)'\n          }}>\n            <div style={{\n              fontSize: 'clamp(3rem, 8vw, 4rem)',\n              marginBottom: '20px'\n            }}></div>\n            <h2 style={{\n              fontSize: 'clamp(1.5rem, 5vw, 2rem)',\n              color: '#1f2937',\n              marginBottom: '16px',\n              fontWeight: '700'\n            }}>\n              Prt pour l'tude Verset par Verset\n            </h2>\n            <p style={{\n              color: '#6b7280',\n              fontSize: 'clamp(1rem, 3vw, 1.1rem)',\n              maxWidth: '500px',\n              margin: '0 auto',\n              lineHeight: '1.6'\n            }}>\n              Slectionnez un passage biblique depuis la page principale pour commencer une tude approfondie verset par verset avec explications thologiques.\n              <br /><br />\n              <strong>Nouveau :</strong> 5 versets par batch avec navigation fluide !\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default VersetParVersetPage;","import React, { useState, useEffect, useRef } from 'react';\n\nconst NotesPage = ({ onGoBack }) => {\n  const [notes, setNotes] = useState('');\n  const [lastSaved, setLastSaved] = useState(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [saveCount, setSaveCount] = useState(0);\n  const textareaRef = useRef(null);\n  const autoSaveIntervalRef = useRef(null);\n\n  // Cls de sauvegarde multiples pour scurit maximale\n  const STORAGE_KEYS = {\n    primary: 'bible-study-notes',\n    backup1: 'bible-study-notes-backup-1', \n    backup2: 'bible-study-notes-backup-2',\n    metadata: 'bible-study-notes-meta'\n  };\n\n  // Fonction de sauvegarde ultra-robuste avec multiples backups\n  const saveNotesToStorage = (notesContent) => {\n    try {\n      const timestamp = new Date().toISOString();\n      const metadata = {\n        lastSaved: timestamp,\n        saveCount: saveCount + 1,\n        contentLength: notesContent.length\n      };\n\n      // Sauvegarde primaire\n      localStorage.setItem(STORAGE_KEYS.primary, JSON.stringify(notesContent));\n      \n      // Sauvegarde backup 1\n      localStorage.setItem(STORAGE_KEYS.backup1, JSON.stringify(notesContent));\n      \n      // Sauvegarde backup 2 (rotation toutes les 5 sauvegardes)\n      if (saveCount % 5 === 0) {\n        localStorage.setItem(STORAGE_KEYS.backup2, JSON.stringify(notesContent));\n      }\n      \n      // Mtadonnes\n      localStorage.setItem(STORAGE_KEYS.metadata, JSON.stringify(metadata));\n      \n      setLastSaved(timestamp);\n      setSaveCount(prev => prev + 1);\n      \n      console.log(`[NOTES] Sauvegarde russie - Count: ${saveCount + 1}, Taille: ${notesContent.length} chars`);\n      return true;\n    } catch (error) {\n      console.error('[NOTES] Erreur sauvegarde:', error);\n      return false;\n    }\n  };\n\n  // Fonction de rcupration avec fallback sur les backups\n  const loadNotesFromStorage = () => {\n    try {\n      // Essayer la sauvegarde primaire\n      let savedNotes = localStorage.getItem(STORAGE_KEYS.primary);\n      if (savedNotes) {\n        const parsed = JSON.parse(savedNotes);\n        console.log('[NOTES] Chargement depuis sauvegarde primaire');\n        return parsed;\n      }\n\n      // Fallback sur backup 1\n      savedNotes = localStorage.getItem(STORAGE_KEYS.backup1);\n      if (savedNotes) {\n        const parsed = JSON.parse(savedNotes);\n        console.log('[NOTES] Chargement depuis backup 1');\n        // Restaurer la sauvegarde primaire\n        localStorage.setItem(STORAGE_KEYS.primary, savedNotes);\n        return parsed;\n      }\n\n      // Fallback sur backup 2\n      savedNotes = localStorage.getItem(STORAGE_KEYS.backup2);\n      if (savedNotes) {\n        const parsed = JSON.parse(savedNotes);\n        console.log('[NOTES] Chargement depuis backup 2');\n        // Restaurer les sauvegardes primaire et backup 1\n        localStorage.setItem(STORAGE_KEYS.primary, savedNotes);\n        localStorage.setItem(STORAGE_KEYS.backup1, savedNotes);\n        return parsed;\n      }\n\n      console.log('[NOTES] Aucune sauvegarde trouve');\n      return '';\n    } catch (error) {\n      console.error('[NOTES] Erreur chargement:', error);\n      return '';\n    }\n  };\n\n  // Chargement initial des notes\n  useEffect(() => {\n    const loadedNotes = loadNotesFromStorage();\n    setNotes(loadedNotes);\n\n    // Charger les mtadonnes\n    try {\n      const metadata = localStorage.getItem(STORAGE_KEYS.metadata);\n      if (metadata) {\n        const parsed = JSON.parse(metadata);\n        setLastSaved(parsed.lastSaved);\n        setSaveCount(parsed.saveCount || 0);\n      }\n    } catch (error) {\n      console.error('[NOTES] Erreur chargement mtadonnes:', error);\n    }\n  }, []);\n\n  // Auto-sauvegarde toutes les 3 secondes lors de la saisie\n  useEffect(() => {\n    if (autoSaveIntervalRef.current) {\n      clearInterval(autoSaveIntervalRef.current);\n    }\n\n    autoSaveIntervalRef.current = setInterval(() => {\n      if (notes.trim().length > 0) {\n        setIsSaving(true);\n        saveNotesToStorage(notes);\n        setTimeout(() => setIsSaving(false), 1000);\n      }\n    }, 3000);\n\n    return () => {\n      if (autoSaveIntervalRef.current) {\n        clearInterval(autoSaveIntervalRef.current);\n      }\n    };\n  }, [notes, saveCount]);\n\n  // Sauvegarde manuelle\n  const handleManualSave = () => {\n    setIsSaving(true);\n    const success = saveNotesToStorage(notes);\n    setTimeout(() => setIsSaving(false), 1000);\n    \n    if (success) {\n      // Feedback visuel\n      if (textareaRef.current) {\n        textareaRef.current.style.borderColor = '#10b981';\n        setTimeout(() => {\n          if (textareaRef.current) {\n            textareaRef.current.style.borderColor = '';\n          }\n        }, 2000);\n      }\n    }\n  };\n\n  // Sauvegarde avant fermeture de page\n  useEffect(() => {\n    const handleBeforeUnload = (e) => {\n      if (notes.trim().length > 0) {\n        saveNotesToStorage(notes);\n      }\n    };\n\n    const handleVisibilityChange = () => {\n      if (document.hidden && notes.trim().length > 0) {\n        saveNotesToStorage(notes);\n      }\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, [notes]);\n\n  const formatLastSaved = () => {\n    if (!lastSaved) return 'Jamais sauvegard';\n    \n    const date = new Date(lastSaved);\n    const now = new Date();\n    const diffMs = now - date;\n    const diffMinutes = Math.floor(diffMs / 60000);\n    \n    if (diffMinutes < 1) return 'Sauvegard  l\\'instant';\n    if (diffMinutes === 1) return 'Sauvegard il y a 1 minute';\n    if (diffMinutes < 60) return `Sauvegard il y a ${diffMinutes} minutes`;\n    \n    const diffHours = Math.floor(diffMinutes / 60);\n    if (diffHours === 1) return 'Sauvegard il y a 1 heure';\n    if (diffHours < 24) return `Sauvegard il y a ${diffHours} heures`;\n    \n    return `Sauvegard le ${date.toLocaleDateString()}  ${date.toLocaleTimeString()}`;\n  };\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, rgba(248, 250, 252, 0.98) 0%, rgba(241, 245, 249, 0.95) 50%, rgba(248, 250, 252, 0.98) 100%)',\n      fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, sans-serif'\n    }}>\n      {/* En-tte moderne */}\n      <div style={{\n        background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.95) 0%, rgba(5, 150, 105, 0.98) 100%)',\n        color: 'white',\n        padding: '30px 20px',\n        boxShadow: '0 8px 32px rgba(16, 185, 129, 0.25)',\n        position: 'sticky',\n        top: 0,\n        zIndex: 100,\n        overflow: 'hidden'\n      }}>\n        <div style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'linear-gradient(45deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%)',\n          pointerEvents: 'none'\n        }}></div>\n        \n        <div style={{\n          maxWidth: '900px',\n          margin: '0 auto',\n          position: 'relative',\n          zIndex: 10\n        }}>\n          <button \n            onClick={onGoBack}\n            style={{\n              background: 'rgba(255, 255, 255, 0.2)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              color: 'white',\n              padding: '10px 20px',\n              borderRadius: '12px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: '600',\n              marginBottom: '20px',\n              backdropFilter: 'blur(10px)',\n              transition: 'all 0.3s ease'\n            }}\n            onMouseOver={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.3)';\n              e.target.style.transform = 'translateY(-2px)';\n            }}\n            onMouseOut={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.2)';\n              e.target.style.transform = 'translateY(0)';\n            }}\n          >\n             Retour  l'tude\n          </button>\n          \n          <h1 style={{\n            fontSize: 'clamp(1.8rem, 4vw, 2.5rem)',\n            fontWeight: '800',\n            margin: '0 0 8px 0',\n            textAlign: 'center',\n            textShadow: '0 2px 8px rgba(0, 0, 0, 0.1)'\n          }}>\n             Mes Notes d'tude Biblique\n          </h1>\n          \n          <div style={{\n            fontSize: 'clamp(1rem, 3vw, 1.1rem)',\n            textAlign: 'center',\n            opacity: 0.9,\n            fontWeight: '500'\n          }}>\n            Carnet personnel permanent  {notes.length} caractres\n          </div>\n        </div>\n      </div>\n\n      {/* Contenu principal */}\n      <div style={{\n        maxWidth: '900px',\n        margin: '0 auto',\n        padding: '20px'\n      }}>\n        {/* Zone de saisie */}\n        <div style={{\n          background: 'white',\n          borderRadius: '16px',\n          padding: 'clamp(20px, 5vw, 30px)',\n          boxShadow: '0 8px 32px rgba(0, 0, 0, 0.08)',\n          border: '2px solid rgba(226, 232, 240, 0.8)',\n          marginBottom: '20px',\n          transition: 'border-color 0.3s ease'\n        }}>\n          <textarea\n            ref={textareaRef}\n            value={notes}\n            onChange={(e) => setNotes(e.target.value)}\n            placeholder={` crivez vos rflexions spirituelles ici...\n\nExemples d'utilisation :\n Versets qui m'ont marqu aujourd'hui\n Questions pour approfondir ma foi  \n Rvlations reues pendant l'tude\n Applications personnelles des enseignements\n Prires inspires par les passages tudis\n Liens entre diffrents passages bibliques\n Tmoignages et expriences spirituelles\n\n Vos notes sont sauvegardes automatiquement et de faon permanente !`}\n            style={{\n              width: '100%',\n              minHeight: 'clamp(300px, 50vh, 500px)',\n              border: 'none',\n              outline: 'none',\n              resize: 'vertical',\n              fontSize: 'clamp(15px, 4vw, 16px)',\n              lineHeight: '1.6',\n              fontFamily: 'Georgia, serif',\n              backgroundColor: 'transparent',\n              color: '#374151',\n              transition: 'border-color 0.3s ease'\n            }}\n          />\n          \n          {/* Barre d'actions */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginTop: '20px',\n            flexWrap: 'wrap',\n            gap: '15px'\n          }}>\n            {/* Informations de sauvegarde */}\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '15px',\n              flexWrap: 'wrap'\n            }}>\n              <div style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px',\n                fontSize: 'clamp(12px, 3vw, 14px)',\n                color: '#6b7280'\n              }}>\n                {isSaving ? (\n                  <>\n                    <div style={{\n                      width: '12px',\n                      height: '12px',\n                      border: '2px solid #e5e7eb',\n                      borderTop: '2px solid #10b981',\n                      borderRadius: '50%',\n                      animation: 'spin 0.8s linear infinite'\n                    }}></div>\n                    Sauvegarde...\n                  </>\n                ) : (\n                  <>\n                    <span style={{ color: '#10b981' }}></span>\n                    {formatLastSaved()}\n                  </>\n                )}\n              </div>\n              \n              <div style={{\n                fontSize: 'clamp(12px, 3vw, 14px)',\n                color: '#6b7280'\n              }}>\n                {saveCount} sauvegarde{saveCount > 1 ? 's' : ''}\n              </div>\n            </div>\n            \n            {/* Bouton de sauvegarde manuelle */}\n            <button\n              onClick={handleManualSave}\n              disabled={isSaving}\n              style={{\n                background: isSaving \n                  ? 'linear-gradient(135deg, #94a3b8 0%, #64748b 100%)'\n                  : 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\n                color: 'white',\n                border: 'none',\n                padding: 'clamp(10px, 3vw, 12px) clamp(16px, 4vw, 20px)',\n                borderRadius: '10px',\n                fontSize: 'clamp(13px, 3.5vw, 15px)',\n                fontWeight: '600',\n                cursor: isSaving ? 'not-allowed' : 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: '0 3px 12px rgba(16, 185, 129, 0.25)',\n                opacity: isSaving ? 0.7 : 1\n              }}\n              onMouseOver={(e) => {\n                if (!isSaving) {\n                  e.target.style.transform = 'translateY(-1px)';\n                  e.target.style.boxShadow = '0 4px 16px rgba(16, 185, 129, 0.35)';\n                }\n              }}\n              onMouseOut={(e) => {\n                if (!isSaving) {\n                  e.target.style.transform = 'translateY(0)';\n                  e.target.style.boxShadow = '0 3px 12px rgba(16, 185, 129, 0.25)';\n                }\n              }}\n            >\n               Sauvegarder maintenant\n            </button>\n          </div>\n        </div>\n\n        {/* Informations sur la scurit des donnes */}\n        <div style={{\n          background: 'rgba(16, 185, 129, 0.05)',\n          border: '2px solid rgba(16, 185, 129, 0.2)',\n          borderRadius: '12px',\n          padding: '20px',\n          marginBottom: '20px'\n        }}>\n          <div style={{\n            display: 'flex',\n            alignItems: 'flex-start',\n            gap: '12px'\n          }}>\n            <div style={{\n              fontSize: '1.5rem',\n              minWidth: '32px',\n              textAlign: 'center'\n            }}></div>\n            <div>\n              <h3 style={{\n                margin: '0 0 8px 0',\n                color: '#059669',\n                fontSize: 'clamp(1rem, 4vw, 1.1rem)',\n                fontWeight: '700'\n              }}>\n                Scurit Maximum de vos Notes\n              </h3>\n              <ul style={{\n                margin: 0,\n                paddingLeft: '20px',\n                color: '#374151',\n                fontSize: 'clamp(13px, 3.5vw, 14px)',\n                lineHeight: '1.5'\n              }}>\n                <li> <strong>Auto-sauvegarde</strong> toutes les 3 secondes</li>\n                <li> <strong>Triple sauvegarde</strong> : primaire + 2 backups</li>\n                <li> <strong>Sauvegarde avant fermeture</strong> de page automatique</li>\n                <li> <strong>Rcupration automatique</strong> en cas de problme</li>\n                <li> <strong>Persistance garantie</strong> : vos notes ne seront JAMAIS perdues</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Styles CSS pour les animations */}\n      <style>\n        {`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n          \n          /* Optimisations mobile supplmentaires */\n          @media (max-width: 768px) {\n            textarea {\n              min-height: 400px !important;\n            }\n          }\n          \n          @media (max-width: 480px) {\n            textarea {\n              min-height: 350px !important;\n              font-size: 16px !important; /* vite le zoom sur iOS */\n            }\n          }\n        `}\n      </style>\n    </div>\n  );\n};\n\nexport default NotesPage;","import React, { useState, useEffect } from 'react';\n\nconst ApiControlPanel = ({ backendUrl }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [apiStatus, setApiStatus] = useState(null);\n  const [lastUpdate, setLastUpdate] = useState(null);\n  const [apiHistory, setApiHistory] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  // Fonction pour rcuprer le statut des API\n  const fetchApiStatus = async () => {\n    try {\n      const response = await fetch(`${backendUrl}/api/health`);\n      if (response.ok) {\n        const healthData = await response.json();\n        \n        // Adapter la rponse au format attendu par l'UI\n        const adaptedStatus = {\n          timestamp: new Date().toISOString(),\n          apis: {\n            gemini_1: { color: 'green', name: 'Gemini Key 1', status: 'active' },\n            gemini_2: { color: 'green', name: 'Gemini Key 2', status: 'active' },\n            gemini_3: { color: 'green', name: 'Gemini Key 3', status: 'active' },\n            gemini_4: { color: 'green', name: 'Gemini Key 4', status: 'active' },\n            bible_api: { color: healthData.bible_api_configured ? 'green' : 'red', name: 'Bible API', status: healthData.bible_api_configured ? 'active' : 'inactive' }\n          },\n          call_history: [],\n          active_api: healthData.current_key || 'gemini_1'\n        };\n        \n        setApiStatus(adaptedStatus);\n        setLastUpdate(new Date().toLocaleTimeString());\n        console.log('[API STATUS] Mise  jour:', adaptedStatus);\n      }\n    } catch (error) {\n      console.error('[API STATUS] Erreur:', error);\n    }\n  };\n\n  // Fonction pour rcuprer l'historique des API  \n  const fetchApiHistory = async () => {\n    try {\n      const response = await fetch(`${backendUrl}/api/health`);\n      if (response.ok) {\n        const healthData = await response.json();\n        \n        // Adapter pour l'historique\n        const adaptedHistory = {\n          timestamp: new Date().toISOString(),\n          total_calls: 0,\n          history: []\n        };\n        \n        setApiHistory(adaptedHistory);\n        console.log('[API HISTORY] Historique rcupr:', adaptedHistory);\n      }\n    } catch (error) {\n      console.error('[API HISTORY] Erreur:', error);\n    }\n  };\n\n  // Mise  jour toutes les 30 secondes\n  useEffect(() => {\n    // Premire rcupration\n    fetchApiStatus();\n    fetchApiHistory();\n    \n    // Mise  jour automatique toutes les 30 secondes\n    const interval = setInterval(() => {\n      fetchApiStatus();\n      fetchApiHistory();\n    }, 30000);\n    \n    return () => clearInterval(interval);\n  }, [backendUrl]);\n\n  // Fonction pour obtenir la couleur LED\n  const getLedColor = (apiInfo) => {\n    return apiInfo?.color === 'green' ? '#00ff00' : '#ff0000';\n  };\n\n  // Fonction pour obtenir l'icne de statut\n  const getStatusIcon = (apiInfo) => {\n    return apiInfo?.color === 'green' ? '' : '';\n  };\n\n  // Style pour les LED clignotantes (amlior)\n  const ledStyle = (color) => ({\n    width: '14px',\n    height: '14px',\n    borderRadius: '50%',\n    backgroundColor: color,\n    boxShadow: `0 0 12px ${color}, 0 0 24px ${color}`,\n    animation: color === '#00ff00' ? 'pulse-green 2s infinite' : 'pulse-red 1s infinite',\n    display: 'inline-block',\n    marginRight: '8px',\n    border: '2px solid rgba(255,255,255,0.3)'\n  });\n\n  return (\n    <div style={{ position: 'relative', display: 'inline-block' }}>\n      {/* CSS pour les animations LED amliores */}\n      <style>\n        {`\n          @keyframes pulse-green {\n            0%, 100% { \n              box-shadow: 0 0 12px #00ff00, 0 0 24px #00ff00; \n              opacity: 1; \n              transform: scale(1);\n            }\n            50% { \n              box-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; \n              opacity: 0.8; \n              transform: scale(1.1);\n            }\n          }\n          @keyframes pulse-red {\n            0%, 100% { \n              box-shadow: 0 0 12px #ff0000, 0 0 24px #ff0000; \n              opacity: 1; \n              transform: scale(1);\n            }\n            50% { \n              box-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000; \n              opacity: 0.4; \n              transform: scale(1.2);\n            }\n          }\n          .api-control-tooltip {\n            position: absolute;\n            top: -40px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0,0,0,0.9);\n            color: white;\n            padding: 6px 12px;\n            borderRadius: 8px;\n            fontSize: 11px;\n            whiteSpace: nowrap;\n            zIndex: 1001;\n            opacity: 0;\n            transition: opacity 0.3s ease;\n          }\n          .api-control-tooltip.visible {\n            opacity: 1;\n          }\n          @keyframes scroll-up {\n            0%, 70% { transform: translateY(0); }\n            85%, 100% { transform: translateY(-100%); }\n          }\n          .api-elevator {\n            height: 18px;\n            overflow: hidden;\n            position: relative;\n            background: rgba(255,255,255,0.15);\n            borderRadius: 6px;\n            padding: 0 8px;\n            minWidth: 75px;\n            zIndex: 2;\n          }\n          @keyframes api-ticker {\n            0%, 30% { transform: translateY(0); }\n            33%, 63% { transform: translateY(-18px); }\n            66%, 96% { transform: translateY(-36px); }\n            100% { transform: translateY(0); }\n          }\n          @keyframes shine {\n            0% { left: -100%; }\n            100% { left: 100%; }\n          }\n        `}\n      </style>\n\n      {/* Bouton de contrle harmonis avec GNRER */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        style={{\n          // Mme style que btn-generate\n          background: 'linear-gradient(135deg, #3742fa, #2f3542)',\n          border: 'none',\n          borderRadius: '14px',\n          color: 'white',\n          padding: '16px 24px',\n          fontSize: '14px',\n          fontWeight: '700',\n          cursor: 'pointer',\n          boxShadow: '0 6px 20px rgba(0,0,0,0.15)',\n          transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n          textTransform: 'uppercase',\n          letterSpacing: '0.8px',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '8px',\n          marginLeft: '10px',\n          minWidth: '140px',\n          textAlign: 'center',\n          backdropFilter: 'blur(10px)',\n          position: 'relative',\n          overflow: 'hidden'\n        }}\n        onMouseOver={(e) => {\n          e.target.style.transform = 'translateY(-4px) scale(1.02)';\n          e.target.style.boxShadow = '0 10px 30px rgba(55,66,250,0.4)';\n          setShowTooltip(true);\n        }}\n        onMouseOut={(e) => {\n          e.target.style.transform = 'translateY(0) scale(1)';\n          e.target.style.boxShadow = '0 6px 20px rgba(0,0,0,0.15)';\n          setShowTooltip(false);\n        }}\n      >\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <span> API</span>\n          \n          {/* Indicateur de statut global plus visible */}\n          {apiStatus && (\n            <div style={{ \n              display: 'flex', \n              alignItems: 'center',\n              gap: '6px',\n              background: 'rgba(255,255,255,0.2)',\n              padding: '4px 8px',\n              borderRadius: '8px'\n            }}>\n              {/* Statut global */}\n              <div style={{\n                width: '8px',\n                height: '8px',\n                borderRadius: '50%',\n                backgroundColor: Object.values(apiStatus.apis).every(api => api.color === 'green') ? '#00ff00' : '#ff0000',\n                boxShadow: `0 0 8px ${Object.values(apiStatus.apis).every(api => api.color === 'green') ? '#00ff00' : '#ff0000'}`,\n                animation: Object.values(apiStatus.apis).every(api => api.color === 'green') ? 'pulse-green 2s infinite' : 'pulse-red 1s infinite'\n              }} />\n              \n              {/* Ascenseur API avec rotation des noms */}\n              <div className=\"api-elevator\">\n                <div style={{\n                  fontSize: '9px',\n                  fontWeight: 'bold',\n                  whiteSpace: 'nowrap',\n                  animation: 'api-ticker 6s infinite',\n                  lineHeight: '18px',\n                  display: 'flex',\n                  flexDirection: 'column'\n                }}>\n                  {Object.entries(apiStatus.apis).map(([key, api]) => (\n                    <div \n                      key={key}\n                      style={{ \n                        height: '18px',\n                        display: 'flex',\n                        alignItems: 'center',\n                        color: key === apiStatus.active_api ? '#fff' : 'rgba(255,255,255,0.7)'\n                      }}\n                    >\n                      <span style={{ \n                        color: api.color === 'green' ? '#00ff00' : '#ff0000',\n                        marginRight: '2px' \n                      }}>\n                        {api.color === 'green' ? '' : ''}\n                      </span>\n                      {api.name.replace('Gemini Key ', 'G').replace(' (Primary)', '').replace(' (Secondary)', '').replace('Bible API', 'Bible')}\n                      <span style={{ marginLeft: '2px', fontSize: '8px' }}>\n                        {api.color === 'green' ? 'OK' : 'ERR'}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n              \n              {/* LED individuelles plus grandes */}\n              <div style={{ display: 'flex', gap: '2px' }}>\n                {Object.entries(apiStatus.apis).map(([key, api]) => (\n                  <div \n                    key={key}\n                    style={{\n                      width: '6px',\n                      height: '6px',\n                      borderRadius: '50%',\n                      backgroundColor: getLedColor(api),\n                      boxShadow: `0 0 6px ${getLedColor(api)}`,\n                      animation: api.color === 'green' ? 'pulse-green 2s infinite' : 'pulse-red 1s infinite'\n                    }}\n                    title={`${api.name}: ${api.status === 'available' ? 'Disponible' : 'Quota dpass'}`}\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n        \n        {/* Effet de brillance comme sur btn-generate */}\n        <div style={{\n          content: '',\n          position: 'absolute',\n          top: '0',\n          left: '-100%',\n          width: '100%',\n          height: '100%',\n          background: 'linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent)',\n          animation: 'shine 3s infinite',\n          zIndex: 1\n        }} />\n        \n        {/* Tooltip amliore */}\n        {showTooltip && apiStatus && (\n          <div className={`api-control-tooltip ${showTooltip ? 'visible' : ''}`}>\n            {Object.values(apiStatus.apis).every(api => api.color === 'green') \n              ? ' Toutes les API sont oprationnelles' \n              : ' Certaines API ont des problmes'\n            }\n          </div>\n        )}\n      </button>\n\n      {/* Panneau de contrle */}\n      {isOpen && (\n        <div style={{\n          position: 'absolute',\n          top: '100%',\n          right: '0',\n          marginTop: '10px',\n          background: 'rgba(255, 255, 255, 0.95)',\n          backdropFilter: 'blur(10px)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          borderRadius: '16px',\n          padding: '20px',\n          minWidth: '350px',\n          boxShadow: '0 20px 40px rgba(0,0,0,0.1)',\n          zIndex: 1000\n        }}>\n          {/* En-tte */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginBottom: '16px',\n            borderBottom: '1px solid rgba(0,0,0,0.1)',\n            paddingBottom: '12px'\n          }}>\n            <h3 style={{\n              margin: 0,\n              color: '#333',\n              fontSize: '16px',\n              fontWeight: 'bold'\n            }}>\n               Statut des API\n            </h3>\n            <button\n              onClick={() => setIsOpen(false)}\n              style={{\n                background: 'none',\n                border: 'none',\n                fontSize: '18px',\n                cursor: 'pointer',\n                color: '#999'\n              }}\n            >\n              \n            </button>\n          </div>\n\n          {/* Liste des API */}\n          {apiStatus ? (\n            <div style={{ marginBottom: '16px' }}>\n              {Object.entries(apiStatus.apis).map(([key, api]) => (\n                <div\n                  key={key}\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    padding: '12px',\n                    marginBottom: '8px',\n                    background: api.color === 'green' ? 'rgba(0, 255, 0, 0.1)' : 'rgba(255, 0, 0, 0.1)',\n                    border: `1px solid ${api.color === 'green' ? 'rgba(0, 255, 0, 0.3)' : 'rgba(255, 0, 0, 0.3)'}`,\n                    borderRadius: '8px',\n                    transition: 'all 0.3s ease'\n                  }}\n                >\n                  <div style={{ display: 'flex', flexDirection: 'column' }}>\n                    <div style={{ display: 'flex', alignItems: 'center' }}>\n                      <div style={ledStyle(getLedColor(api))} />\n                      <span style={{\n                        fontWeight: 'bold',\n                        color: '#333',\n                        marginRight: '8px'\n                      }}>\n                        {api.name}\n                      </span>\n                      {key === apiStatus.active_api && (\n                        <span style={{\n                          background: 'linear-gradient(135deg, #4CAF50, #45a049)',\n                          color: 'white',\n                          padding: '2px 8px',\n                          borderRadius: '12px',\n                          fontSize: '10px',\n                          fontWeight: 'bold'\n                        }}>\n                          ACTIVE\n                        </span>\n                      )}\n                    </div>\n                    <div style={{ fontSize: '10px', color: '#666', marginLeft: '20px' }}>\n                       {api.success_count} succs |  {api.error_count} checs\n                      {api.last_used && (\n                        <div>Dernire utilisation: {new Date(api.last_used).toLocaleTimeString()}</div>\n                      )}\n                    </div>\n                  </div>\n                  <div style={{ display: 'flex', alignItems: 'center' }}>\n                    <span style={{\n                      fontSize: '12px',\n                      color: api.color === 'green' ? '#4CAF50' : '#f44336',\n                      fontWeight: 'bold',\n                      textTransform: 'uppercase'\n                    }}>\n                      {api.status === 'available' ? 'Disponible' : 'Quota Dpass'}\n                    </span>\n                    <span style={{ fontSize: '16px', marginLeft: '8px' }}>\n                      {getStatusIcon(api)}\n                    </span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div style={{\n              textAlign: 'center',\n              padding: '20px',\n              color: '#666'\n            }}>\n               Chargement du statut...\n            </div>\n          )}\n\n          {/* Bouton pour afficher l'historique */}\n          <button\n            onClick={() => setShowHistory(!showHistory)}\n            style={{\n              width: '100%',\n              padding: '8px',\n              marginBottom: '12px',\n              background: 'linear-gradient(135deg, #667eea, #764ba2)',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '12px',\n              fontWeight: 'bold'\n            }}\n          >\n             {showHistory ? 'Masquer' : 'Afficher'} l'Historique\n          </button>\n\n          {/* Historique dtaill */}\n          {showHistory && apiHistory && (\n            <div style={{\n              marginBottom: '16px',\n              maxHeight: '200px',\n              overflowY: 'auto',\n              border: '1px solid rgba(0,0,0,0.1)',\n              borderRadius: '8px',\n              padding: '8px',\n              background: 'rgba(0,0,0,0.02)'\n            }}>\n              <h4 style={{ margin: '0 0 8px 0', fontSize: '12px', color: '#666' }}>\n                 Derniers appels API ({apiHistory.total_calls} total)\n              </h4>\n              {apiHistory.history.slice().reverse().map((call, index) => (\n                <div\n                  key={index}\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    padding: '6px',\n                    marginBottom: '4px',\n                    background: call.success ? 'rgba(0, 255, 0, 0.05)' : 'rgba(255, 0, 0, 0.05)',\n                    border: `1px solid ${call.success ? 'rgba(0, 255, 0, 0.2)' : 'rgba(255, 0, 0, 0.2)'}`,\n                    borderRadius: '4px',\n                    fontSize: '10px'\n                  }}\n                >\n                  <div>\n                    <strong>{call.api_name}</strong>\n                    <div style={{ color: '#666' }}>\n                      {new Date(call.timestamp).toLocaleTimeString()}\n                    </div>\n                  </div>\n                  <div style={{ textAlign: 'right' }}>\n                    <div style={{ color: call.success ? '#4CAF50' : '#f44336' }}>\n                      {call.success ? ' SUCCESS' : ' ERROR'}\n                    </div>\n                    <div style={{ color: '#666' }}>\n                      {call.content_length > 0 ? `${call.content_length} chars` : call.error}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Informations de mise  jour */}\n          <div style={{\n            fontSize: '11px',\n            color: '#666',\n            textAlign: 'center',\n            borderTop: '1px solid rgba(0,0,0,0.1)',\n            paddingTop: '12px'\n          }}>\n             Mise  jour automatique toutes les 30s\n            {lastUpdate && (\n              <div>Dernire mise  jour: {lastUpdate}</div>\n            )}\n          </div>\n\n          {/* Lgende */}\n          <div style={{\n            fontSize: '10px',\n            color: '#888',\n            marginTop: '12px',\n            display: 'flex',\n            justifyContent: 'space-between'\n          }}>\n            <span> Disponible</span>\n            <span> Quota dpass</span>\n            <span> Rotation automatique</span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ApiControlPanel;","import React from 'react';\nimport ApiControlPanel from './ApiControlPanel';\n\nconst RubriquePage = ({ \n  onGoBack, \n  rubriqueNumber, \n  rubriqueTitle, \n  content, \n  bookInfo,\n  onNavigateToRubrique,\n  // Nouvelles props pour les boutons fonctionnels\n  selectedBook = \"Gense\",\n  selectedChapter = \"1\",\n  selectedVerse = \"--\",\n  selectedLength = 500,\n  setCurrentPage,\n  API_BASE,\n  setContent,\n  setRubriquesStatus,\n  setIsLoading,\n  isLoading = false,\n  BASE_RUBRIQUES = []\n}) => {\n  \n  // Debug: Afficher le contenu reu\n  console.log(`[RUBRIQUE PAGE DEBUG] Rubrique ${rubriqueNumber}:`);\n  console.log(`[RUBRIQUE PAGE DEBUG] Content type:`, typeof content);\n  console.log(`[RUBRIQUE PAGE DEBUG] Content length:`, content ? content.length : 0);\n  console.log(`[RUBRIQUE PAGE DEBUG] Content preview:`, content ? content.slice(0, 100) + \"...\" : \"VIDE\");\n  console.log(`[RUBRIQUE PAGE DEBUG] Content truthy:`, !!content);\n\n  // tat pour le modal API\n  const [isApiModalOpen, setIsApiModalOpen] = React.useState(false);\n  const [apiStatus, setApiStatus] = React.useState(null);\n  const [apiHistory, setApiHistory] = React.useState(null);\n\n  // Fonctions pour grer le modal API\n  const fetchApiStatus = async () => {\n    if (!API_BASE) return;\n    try {\n      const response = await fetch(`${API_BASE}/api-status`);\n      if (response.ok) {\n        const status = await response.json();\n        setApiStatus(status);\n        console.log('[RUBRIQUE API] Statut rcupr:', status);\n      }\n    } catch (error) {\n      console.error('[RUBRIQUE API] Erreur statut:', error);\n    }\n  };\n\n  const fetchApiHistory = async () => {\n    if (!API_BASE) return;\n    try {\n      const response = await fetch(`${API_BASE}/api-history`);\n      if (response.ok) {\n        const history = await response.json();\n        setApiHistory(history);\n        console.log('[RUBRIQUE API] Historique rcupr:', history);\n      }\n    } catch (error) {\n      console.error('[RUBRIQUE API] Erreur historique:', error);\n    }\n  };\n\n  // Charger les donnes API au montage du composant\n  React.useEffect(() => {\n    if (isApiModalOpen) {\n      fetchApiStatus();\n      fetchApiHistory();\n    }\n  }, [isApiModalOpen, API_BASE]);\n\n  // Fonctions utilitaires pour l'affichage API\n  const getLedColor = (api) => {\n    return api.color === 'green' ? '#00ff00' : '#ff0000';\n  };\n\n  const ledStyle = (color) => ({\n    width: '10px',\n    height: '10px',\n    borderRadius: '50%',\n    backgroundColor: color,\n    marginRight: '12px',\n    boxShadow: `0 0 8px ${color}`,\n    animation: 'pulse-led 2s infinite ease-in-out'\n  });\n\n  const getStatusIcon = (api) => {\n    return api.color === 'green' ? '' : '';\n  };\n\n  // Fonctions de gestion des boutons - COPIES DE LA PAGE PRINCIPALE\n\n  // 1. Fonction Gemini (copie de App.js)\n  const handleGeminiAction = async () => {\n    if (!API_BASE || !setContent || !setRubriquesStatus || !setIsLoading) {\n      console.warn(\"[RUBRIQUE] API functions not available\");\n      return;\n    }\n\n    try {\n      setIsLoading(true); \n      setContent(\"Enrichissement thologique avec votre Gemini gratuit en cours...\");\n      setRubriquesStatus(p => ({ ...p, [rubriqueNumber]: \"in-progress\" }));\n\n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook} ${selectedChapter}`\n        : `${selectedBook} ${selectedChapter}:${selectedVerse}`;\n\n      // Enrichir thologiquement avec votre cl Gemini gratuite\n      if (rubriqueNumber >= 1 && rubriqueNumber <= 28) {\n        const rubriqueTitle = BASE_RUBRIQUES[rubriqueNumber] || `Rubrique ${rubriqueNumber}`;\n        \n        // Gnrer un enrichissement thologique avec longueur augmente\n        const enrichedLength = Math.min(2000, parseInt(selectedLength) + 500);\n        console.log(`[ENRICHISSEMENT GEMINI GRATUIT] Rubrique ${rubriqueNumber} - Longueur enrichie: ${enrichedLength} caractres`);\n        \n        // Appeler votre backend avec votre cl Gemini gratuite\n        const response = await fetch(`${API_BASE}/generate-verse-by-verse`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            passage: passage,\n            tokens: enrichedLength,\n            use_gemini: true,\n            enriched: true,\n            rubrique_context: rubriqueTitle\n          })\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          const enrichedContent = data.content || \"Contenu enrichi non disponible\";\n          \n          console.log(`[ENRICHISSEMENT GEMINI GRATUIT] Contenu enrichi reu: ${enrichedContent.length} caractres`);\n          setContent(enrichedContent);\n          setRubriquesStatus(p => ({ ...p, [rubriqueNumber]: \"completed\" }));\n        } else {\n          throw new Error(`Erreur API: ${response.status}`);\n        }\n      }\n    } catch (err) {\n      console.error(\"Erreur enrichissement Gemini:\", err);\n      setContent(`Erreur lors de l'enrichissement Gemini: ${err.message}`);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNumber]: \"error\" }));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 2. Fonction ChatGPT (copie de App.js)\n  const handleChatGPTAction = () => {\n    window.open('https://chatgpt.com/', '_blank');\n  };\n\n  // 3. Fonction Notes (copie de App.js)  \n  const handleNotesAction = () => {\n    if (setCurrentPage) {\n      setCurrentPage('notes');\n    } else {\n      console.warn(\"[RUBRIQUE] setCurrentPage not available\");\n    }\n  };\n\n  // 4. Fonction API Control Panel (base sur ApiControlPanel)\n  const handleApiAction = () => {\n    console.log('[CONTROL BUTTON] API button clicked for Rubrique', rubriqueNumber);\n    setIsApiModalOpen(true);\n  };\n\n  // 5. Nouvelle fonction \"Lire la Bible\" (copie de App.js)\n  const handleBibleAction = () => {\n    if (selectedBook === \"--\") {\n      alert(\"Veuillez d'abord slectionner un livre de la Bible\");\n      return;\n    }\n    \n    const bookCodes = {\n      \"Gense\":\"GEN\",\"Exode\":\"EXO\",\"Lvitique\":\"LEV\",\"Nombres\":\"NUM\",\"Deutronome\":\"DEU\",\n      \"Josu\":\"JOS\",\"Juges\":\"JDG\",\"Ruth\":\"RUT\",\"1 Samuel\":\"1SA\",\"2 Samuel\":\"2SA\",\n      \"1 Rois\":\"1KI\",\"2 Rois\":\"2KI\",\"1 Chroniques\":\"1CH\",\"2 Chroniques\":\"2CH\",\n      \"Esdras\":\"EZR\",\"Nhmie\":\"NEH\",\"Esther\":\"EST\",\"Job\":\"JOB\",\"Psaumes\":\"PSA\",\n      \"Proverbes\":\"PRO\",\"Ecclsiaste\":\"ECC\",\"Cantique des cantiques\":\"SNG\",\n      \"sae\":\"ISA\",\"Jrmie\":\"JER\",\"Lamentations\":\"LAM\",\"zchiel\":\"EZK\",\"Daniel\":\"DAN\",\n      \"Ose\":\"HOS\",\"Jol\":\"JOL\",\"Amos\":\"AMO\",\"Abdias\":\"OBA\",\"Jonas\":\"JON\",\"Miche\":\"MIC\",\n      \"Nahum\":\"NAM\",\"Habacuc\":\"HAB\",\"Sophonie\":\"ZEP\",\"Agge\":\"HAG\",\"Zacharie\":\"ZEC\",\"Malachie\":\"MAL\",\n      \"Matthieu\":\"MAT\",\"Marc\":\"MRK\",\"Luc\":\"LUK\",\"Jean\":\"JHN\",\"Actes\":\"ACT\",\n      \"Romains\":\"ROM\",\"1 Corinthiens\":\"1CO\",\"2 Corinthiens\":\"2CO\",\"Galates\":\"GAL\",\n      \"phsiens\":\"EPH\",\"Philippiens\":\"PHP\",\"Colossiens\":\"COL\",\"1 Thessaloniciens\":\"1TH\",\n      \"2 Thessaloniciens\":\"2TH\",\"1 Timothe\":\"1TI\",\"2 Timothe\":\"2TI\",\"Tite\":\"TIT\",\n      \"Philmon\":\"PHM\",\"Hbreux\":\"HEB\",\"Jacques\":\"JAS\",\"1 Pierre\":\"1PE\",\"2 Pierre\":\"2PE\",\n      \"1 Jean\":\"1JN\",\"2 Jean\":\"2JN\",\"3 Jean\":\"3JN\",\"Jude\":\"JUD\",\"Apocalypse\":\"REV\"\n    };\n    \n    const code = bookCodes[selectedBook]; \n    if (!code) {\n      alert(\"Livre non reconnu pour YouVersion\");\n      return;\n    }\n    \n    let url = `https://www.bible.com/fr/bible/63/${code}`;\n    if (selectedChapter !== \"--\") { \n      url += `.${selectedChapter}`; \n      if (selectedVerse !== \"--\") url += `.${selectedVerse}`; \n    }\n    window.open(url, \"_blank\");\n  };\n  \n  const getRubriqueColor = (number) => {\n    // Couleurs varies pour les diffrentes rubriques\n    const colors = {\n      1: { start: '#8b5cf6', end: '#7c3aed', name: 'Violet' },\n      2: { start: '#3b82f6', end: '#2563eb', name: 'Bleu' },\n      3: { start: '#10b981', end: '#059669', name: 'Vert' },\n      4: { start: '#f59e0b', end: '#d97706', name: 'Orange' },\n      5: { start: '#ef4444', end: '#dc2626', name: 'Rouge' },\n      6: { start: '#8b5cf6', end: '#7c3aed', name: 'Violet' },\n      7: { start: '#06b6d4', end: '#0891b2', name: 'Cyan' },\n      8: { start: '#84cc16', end: '#65a30d', name: 'Lime' },\n      9: { start: '#f97316', end: '#ea580c', name: 'Orange' },\n      10: { start: '#ec4899', end: '#db2777', name: 'Rose' },\n      // Cycle pour les rubriques suivantes\n      default: { start: '#6b7280', end: '#4b5563', name: 'Gris' }\n    };\n    \n    return colors[number] || colors[((number - 1) % 10) + 1] || colors.default;\n  };\n\n  const rubriqueColor = getRubriqueColor(rubriqueNumber);\n\n  const formatRubriqueContent = (content) => {\n    if (!content) return '';\n    \n    // Formatage simple pour le contenu des rubriques\n    return content\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\n\\n/g, '</p><p>')\n      .replace(/\\n/g, '<br/>');\n  };\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, rgba(248, 250, 252, 0.98) 0%, rgba(241, 245, 249, 0.95) 50%, rgba(248, 250, 252, 0.98) 100%)',\n      fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, sans-serif'\n    }}>\n      {/* En-tte color selon la rubrique */}\n      <div style={{\n        background: `linear-gradient(135deg, ${rubriqueColor.start} 0%, ${rubriqueColor.end} 100%)`,\n        color: 'white',\n        padding: '30px 20px',\n        boxShadow: `0 8px 32px ${rubriqueColor.start}40`,\n        position: 'sticky',\n        top: 0,\n        zIndex: 100,\n        overflow: 'hidden'\n      }}>\n        <div style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'linear-gradient(45deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(255, 255, 255, 0.05) 100%)',\n          pointerEvents: 'none'\n        }}></div>\n        \n        <div style={{\n          maxWidth: '900px',\n          margin: '0 auto',\n          position: 'relative',\n          zIndex: 10\n        }}>\n          <button \n            onClick={onGoBack}\n            style={{\n              background: 'rgba(255, 255, 255, 0.2)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              color: 'white',\n              padding: '10px 20px',\n              borderRadius: '12px',\n              cursor: 'pointer',\n              fontSize: '14px',\n              fontWeight: '600',\n              marginBottom: '20px',\n              backdropFilter: 'blur(10px)',\n              transition: 'all 0.3s ease'\n            }}\n            onMouseOver={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.3)';\n              e.target.style.transform = 'translateY(-2px)';\n            }}\n            onMouseOut={(e) => {\n              e.target.style.background = 'rgba(255, 255, 255, 0.2)';\n              e.target.style.transform = 'translateY(0)';\n            }}\n          >\n             Retour  l'tude\n          </button>\n          \n          {/* Titre et boutons de contrle */}\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            gap: '20px',\n            marginBottom: '20px',\n            flexWrap: 'wrap'\n          }}>\n            <div style={{ flex: 1, minWidth: '300px' }}>\n              <h1 style={{\n                fontSize: 'clamp(1.8rem, 4vw, 2.5rem)',\n                fontWeight: '800',\n                margin: '0 0 8px 0',\n                textAlign: 'center',\n                textShadow: '0 2px 8px rgba(0, 0, 0, 0.1)'\n              }}>\n                 Rubrique {rubriqueNumber}\n              </h1>\n              \n              <div style={{\n                fontSize: 'clamp(1rem, 3vw, 1.2rem)',\n                textAlign: 'center',\n                opacity: 0.9,\n                fontWeight: '500'\n              }}>\n                {rubriqueTitle}\n              </div>\n            </div>\n\n            {/* 5 boutons de contrle */}\n            <div style={{\n              display: 'flex',\n              gap: '8px',\n              flexWrap: 'wrap',\n              justifyContent: 'center'\n            }}>\n              {/* Bouton Gemini */}\n              <button\n                onClick={handleGeminiAction}\n                className=\"btn-gemini control-btn\"\n                disabled={isLoading}\n                title=\"Enrichissement thologique avec Gemini\"\n              >\n                 Gemini\n              </button>\n\n              {/* Bouton ChatGPT */}\n              <button\n                onClick={handleChatGPTAction}\n                className=\"btn-chat control-btn\"\n                title=\"Ouvrir ChatGPT dans un nouvel onglet\"\n              >\n                 ChatGPT\n              </button>\n\n              {/* Bouton Prise de Note */}\n              <button\n                onClick={handleNotesAction}\n                className=\"btn-notes control-btn\"\n                title=\"Ouvrir la page de prise de notes\"\n              >\n                 Notes\n              </button>\n\n              {/* Bouton Lire la Bible */}\n              <button\n                onClick={handleBibleAction}\n                className=\"btn-read control-btn\"\n                title=\"Ouvrir ce passage sur YouVersion\"\n              >\n                 Bible\n              </button>\n\n              {/* Composant API complet avec LEDs */}\n              <ApiControlPanel backendUrl={process.env.REACT_APP_BACKEND_URL || window.location.origin} />\n            </div>\n          </div>\n\n          {bookInfo && (\n            <div style={{\n              fontSize: 'clamp(0.9rem, 3vw, 1rem)',\n              textAlign: 'center',\n              opacity: 0.8,\n              fontWeight: '400'\n            }}>\n              {bookInfo}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Contenu principal */}\n      <div style={{\n        maxWidth: '900px',\n        margin: '0 auto',\n        padding: '20px'\n      }}>\n        {content && content.trim().length > 0 ? (\n          <div style={{\n            background: 'white',\n            borderRadius: '16px',\n            padding: 'clamp(20px, 5vw, 40px)',\n            boxShadow: '0 8px 32px rgba(0, 0, 0, 0.08)',\n            border: '1px solid rgba(226, 232, 240, 0.8)',\n            lineHeight: '1.7',\n            fontSize: 'clamp(15px, 4vw, 16px)',\n            marginBottom: '20px'\n          }}>\n            <div \n              dangerouslySetInnerHTML={{ __html: `<p>${formatRubriqueContent(content)}</p>` }}\n              style={{ color: '#374151' }}\n            />\n          </div>\n        ) : (\n          <div style={{\n            background: 'white',\n            borderRadius: '20px',\n            padding: 'clamp(40px, 8vw, 60px)',\n            textAlign: 'center',\n            boxShadow: '0 12px 40px rgba(0, 0, 0, 0.08)'\n          }}>\n            <div style={{\n              fontSize: 'clamp(3rem, 8vw, 4rem)',\n              marginBottom: '20px'\n            }}></div>\n            <h2 style={{\n              fontSize: 'clamp(1.5rem, 5vw, 2rem)',\n              color: '#1f2937',\n              marginBottom: '16px',\n              fontWeight: '700'\n            }}>\n              Gnration en cours...\n            </h2>\n            <p style={{\n              color: '#6b7280',\n              fontSize: 'clamp(1rem, 3vw, 1.1rem)',\n              maxWidth: '500px',\n              margin: '0 auto',\n              lineHeight: '1.6'\n            }}>\n               Gnration automatique du contenu thologique pour \"{rubriqueTitle}\"...\n            </p>\n            <div style={{\n              marginTop: '20px',\n              fontSize: '12px',\n              color: '#9ca3af'\n            }}>\n               Votre contenu authentique sera disponible dans quelques instants\n            </div>\n          </div>\n        )}\n\n        {/* Navigation entre rubriques */}\n        <div style={{\n          display: 'flex',\n          gap: '15px',\n          marginTop: '30px',\n          justifyContent: 'center',\n          flexWrap: 'wrap'\n        }}>\n          {/* Bouton Prcdent */}\n          {rubriqueNumber > 1 && (\n            <button\n              onClick={() => onNavigateToRubrique(rubriqueNumber - 1)}\n              style={{\n                background: 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)',\n                color: 'white',\n                border: 'none',\n                padding: 'clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px)',\n                borderRadius: '12px',\n                fontSize: 'clamp(14px, 3.5vw, 16px)',\n                fontWeight: '600',\n                cursor: 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: '0 4px 16px rgba(107, 114, 128, 0.25)',\n                minWidth: '160px'\n              }}\n              onMouseOver={(e) => {\n                e.target.style.transform = 'translateY(-2px)';\n                e.target.style.boxShadow = '0 6px 24px rgba(107, 114, 128, 0.35)';\n              }}\n              onMouseOut={(e) => {\n                e.target.style.transform = 'translateY(0)';\n                e.target.style.boxShadow = '0 4px 16px rgba(107, 114, 128, 0.25)';\n              }}\n            >\n               Rubrique {rubriqueNumber - 1}\n            </button>\n          )}\n\n          {/* Bouton Suivant */}\n          {rubriqueNumber < 28 && (\n            <button\n              onClick={() => onNavigateToRubrique(rubriqueNumber + 1)}\n              style={{\n                background: `linear-gradient(135deg, ${rubriqueColor.start} 0%, ${rubriqueColor.end} 100%)`,\n                color: 'white',\n                border: 'none',\n                padding: 'clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px)',\n                borderRadius: '12px',\n                fontSize: 'clamp(14px, 3.5vw, 16px)',\n                fontWeight: '600',\n                cursor: 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: `0 4px 16px ${rubriqueColor.start}40`,\n                minWidth: '160px'\n              }}\n              onMouseOver={(e) => {\n                e.target.style.transform = 'translateY(-2px)';\n                e.target.style.boxShadow = `0 6px 24px ${rubriqueColor.start}50`;\n              }}\n              onMouseOut={(e) => {\n                e.target.style.transform = 'translateY(0)';\n                e.target.style.boxShadow = `0 4px 16px ${rubriqueColor.start}40`;\n              }}\n            >\n              Rubrique {rubriqueNumber + 1} \n            </button>\n          )}\n        </div>\n\n        {/* Indicateur de position */}\n        <div style={{\n          textAlign: 'center',\n          marginTop: '20px',\n          fontSize: 'clamp(12px, 3vw, 14px)',\n          color: '#6b7280'\n        }}>\n           Rubrique {rubriqueNumber} sur 28  tude complte en 28 points\n        </div>\n      </div>\n\n      {/* Modal API Control Panel */}\n      {isApiModalOpen && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0, 0, 0, 0.5)',\n          zIndex: 1000,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          padding: '20px'\n        }}>\n          <div style={{\n            background: 'rgba(255, 255, 255, 0.95)',\n            backdropFilter: 'blur(10px)',\n            border: '1px solid rgba(255, 255, 255, 0.2)',\n            borderRadius: '16px',\n            padding: '24px',\n            minWidth: '400px',\n            maxWidth: '600px',\n            maxHeight: '80vh',\n            overflowY: 'auto',\n            boxShadow: '0 20px 40px rgba(0,0,0,0.15)',\n            position: 'relative'\n          }}>\n            {/* CSS pour les animations LED */}\n            <style>\n              {`\n                @keyframes pulse-led {\n                  0% { \n                    box-shadow: 0 0 8px currentColor; \n                    opacity: 1; \n                    transform: scale(1);\n                  }\n                  50% { \n                    box-shadow: 0 0 20px currentColor, 0 0 40px currentColor; \n                    opacity: 0.4; \n                    transform: scale(1.2);\n                  }\n                }\n              `}\n            </style>\n\n            {/* En-tte du modal */}\n            <div style={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              marginBottom: '20px',\n              borderBottom: '1px solid rgba(0,0,0,0.1)',\n              paddingBottom: '16px'\n            }}>\n              <h3 style={{\n                margin: 0,\n                color: '#333',\n                fontSize: '18px',\n                fontWeight: 'bold',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px'\n              }}>\n                 API Status - Rubrique {rubriqueNumber}\n              </h3>\n              <button\n                onClick={() => setIsApiModalOpen(false)}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  fontSize: '24px',\n                  cursor: 'pointer',\n                  color: '#999',\n                  padding: '4px',\n                  borderRadius: '4px',\n                  transition: 'color 0.3s ease'\n                }}\n                onMouseOver={(e) => e.target.style.color = '#333'}\n                onMouseOut={(e) => e.target.style.color = '#999'}\n              >\n                \n              </button>\n            </div>\n\n            {/* Contenu du statut API */}\n            {apiStatus ? (\n              <div>\n                {/* Liste des 5 APIs avec leurs couleurs */}\n                <div style={{ marginBottom: '20px' }}>\n                  <h4 style={{ \n                    margin: '0 0 12px 0', \n                    color: '#666', \n                    fontSize: '14px',\n                    fontWeight: '600',\n                    textTransform: 'uppercase',\n                    letterSpacing: '0.5px'\n                  }}>\n                    tat des APIs ({Object.keys(apiStatus.apis).length} APIs configures)\n                  </h4>\n                  \n                  {Object.entries(apiStatus.apis).map(([key, api]) => (\n                    <div\n                      key={key}\n                      style={{\n                        display: 'flex',\n                        justifyContent: 'space-between',\n                        alignItems: 'center',\n                        padding: '14px',\n                        marginBottom: '8px',\n                        background: api.color === 'green' ? 'rgba(0, 255, 0, 0.08)' : 'rgba(255, 0, 0, 0.08)',\n                        border: `2px solid ${api.color === 'green' ? 'rgba(0, 255, 0, 0.3)' : 'rgba(255, 0, 0, 0.3)'}`,\n                        borderRadius: '10px',\n                        transition: 'all 0.3s ease',\n                        boxShadow: `0 2px 8px ${api.color === 'green' ? 'rgba(0, 255, 0, 0.1)' : 'rgba(255, 0, 0, 0.1)'}`\n                      }}\n                    >\n                      <div style={{ display: 'flex', flexDirection: 'column' }}>\n                        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '4px' }}>\n                          <div style={ledStyle(getLedColor(api))} />\n                          <span style={{\n                            fontWeight: 'bold',\n                            color: '#333',\n                            marginRight: '12px',\n                            fontSize: '14px'\n                          }}>\n                            {api.name}\n                          </span>\n                          {key === apiStatus.active_api && (\n                            <span style={{\n                              background: 'linear-gradient(135deg, #4CAF50, #45a049)',\n                              color: 'white',\n                              padding: '2px 10px',\n                              borderRadius: '12px',\n                              fontSize: '10px',\n                              fontWeight: 'bold',\n                              textTransform: 'uppercase'\n                            }}>\n                              ACTIVE\n                            </span>\n                          )}\n                        </div>\n                        <div style={{ \n                          fontSize: '11px', \n                          color: '#666', \n                          marginLeft: '22px',\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: '12px'\n                        }}>\n                          <span> {api.success_count} succs</span>\n                          <span> {api.error_count} checs</span>\n                          {api.last_used && (\n                            <span> {new Date(api.last_used).toLocaleTimeString()}</span>\n                          )}\n                        </div>\n                      </div>\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                        <span style={{\n                          fontSize: '12px',\n                          color: api.color === 'green' ? '#4CAF50' : '#f44336',\n                          fontWeight: 'bold',\n                          textTransform: 'uppercase'\n                        }}>\n                          {api.status === 'available' ? 'Disponible' : 'Quota Dpass'}\n                        </span>\n                        <span style={{ fontSize: '18px' }}>\n                          {getStatusIcon(api)}\n                        </span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n\n                {/* Informations gnrales */}\n                <div style={{\n                  background: 'rgba(55, 66, 250, 0.05)',\n                  border: '1px solid rgba(55, 66, 250, 0.2)',\n                  borderRadius: '10px',\n                  padding: '16px',\n                  marginBottom: '16px'\n                }}>\n                  <h5 style={{ \n                    margin: '0 0 8px 0', \n                    color: '#3742fa', \n                    fontSize: '13px',\n                    fontWeight: 'bold' \n                  }}>\n                     Statistiques Globales\n                  </h5>\n                  <div style={{ fontSize: '12px', color: '#666', display: 'flex', flexWrap: 'wrap', gap: '16px' }}>\n                    <span> API Active: {apiStatus.active_api || 'Aucune'}</span>\n                    <span> Fallback: {apiStatus.fallback_active ? 'Activ' : 'Disponible'}</span>\n                    <span> Contexte: Rubrique {rubriqueNumber} - {rubriqueTitle}</span>\n                  </div>\n                </div>\n\n                {/* Bouton de rafrachissement */}\n                <div style={{ textAlign: 'center', marginTop: '16px' }}>\n                  <button\n                    onClick={() => {\n                      fetchApiStatus();\n                      fetchApiHistory();\n                    }}\n                    style={{\n                      background: 'linear-gradient(135deg, #3742fa, #2f3542)',\n                      color: 'white',\n                      border: 'none',\n                      padding: '10px 20px',\n                      borderRadius: '8px',\n                      fontSize: '12px',\n                      fontWeight: '600',\n                      cursor: 'pointer',\n                      transition: 'all 0.3s ease'\n                    }}\n                  >\n                     Actualiser\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <div style={{ textAlign: 'center', padding: '40px 20px' }}>\n                <div style={{ fontSize: '24px', marginBottom: '12px' }}></div>\n                <p style={{ color: '#666', margin: 0 }}>Chargement du statut des APIs...</p>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default RubriquePage;","/* eslint-disable */\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport \"./App.css\";\nimport \"./rubriques.css\";\nimport RubriquesInline from \"./RubriquesInline\";\nimport BibleConcordancePage from \"./BibleConcordancePage\";\nimport VersetParVersetPage from \"./VersetParVersetPage\";\nimport NotesPage from \"./NotesPage\";\nimport RubriquePage from \"./RubriquePage\";\nimport ApiControlPanel from \"./ApiControlPanel\";\n\n/* =========================\n   Configuration et Helpers\n========================= */\n\n// Backend: 1) REACT_APP_BACKEND_URL si dfini (nettoy), 2) localhost en dev, 3) Railway en prod\nconst getBackendUrl = () => {\n  // Utiliser la variable d'environnement en priorit\n  if (process.env.REACT_APP_BACKEND_URL) {\n    return process.env.REACT_APP_BACKEND_URL;\n  }\n  \n  const hostname = window.location.hostname;\n  if (hostname === \"localhost\" || hostname === \"127.0.0.1\") return \"http://localhost:8001\";\n  // fallback pour les environnements non configurs\n  return \"https://scripture-ai-8.preview.emergentagent.com\";\n};\n\nconst BACKEND_URL = getBackendUrl();\nconst API_BASE = `${BACKEND_URL.replace(/\\/+$/g, \"\")}/api`;\n\n// Variables d'environnement configures\n// BACKEND_URL et API_BASE sont prts  utiliser\n\n// Palette de couleurs harmonieuse pour les 6 boutons\nconst getButtonStyle = (gradientColors, shadowColor, isHovered = false) => ({\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  justifyContent: 'center',\n  padding: '16px 12px',\n  borderRadius: '16px',\n  minHeight: '90px',\n  fontSize: '11px',\n  fontWeight: '700',\n  color: 'white',\n  border: 'none',\n  cursor: 'pointer',\n  background: `linear-gradient(135deg, ${gradientColors.start} 0%, ${gradientColors.end} 100%)`,\n  boxShadow: isHovered \n    ? `0 12px 40px ${shadowColor.replace('0.25', '0.35')}, 0 4px 20px rgba(0, 0, 0, 0.15)`\n    : `0 8px 32px ${shadowColor}, 0 2px 16px rgba(0, 0, 0, 0.1)`,\n  transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n  transform: isHovered ? 'translateY(-3px) scale(1.02)' : 'translateY(0)',\n})\n\nconst buttonColors = {\n  reset: { start: '#4facfe', end: '#00f2fe', shadow: 'rgba(79, 172, 254, 0.25)' },\n  mystique: { start: '#a855f7', end: '#e879f9', shadow: 'rgba(168, 85, 247, 0.25)' },\n  genese: { start: '#10b981', end: '#34d399', shadow: 'rgba(16, 185, 129, 0.25)' },\n  gemini: { start: '#f59e0b', end: '#fbbf24', shadow: 'rgba(245, 158, 11, 0.25)' },\n  versets: { start: '#ef4444', end: '#f87171', shadow: 'rgba(239, 68, 68, 0.25)' },\n  generate: { start: '#8b5cf6', end: '#a78bfa', shadow: 'rgba(139, 92, 246, 0.25)' }\n}\n\nfunction asString(x) {\n  if (x === undefined || x === null) return \"\";\n  if (typeof x === \"string\") return x;\n  try { return JSON.stringify(x, null, 2); } catch { return String(x); }\n}\n\nfunction postProcessMarkdown(t) {\n  const s = asString(t);\n  return s\n    .replace(/VERSET (\\d+)/g, \"**VERSET $1**\")\n    .replace(/TEXTE BIBLIQUE\\s*:/g, \"**TEXTE BIBLIQUE :**\")\n    .replace(/EXPLICATION THOLOGIQUE\\s*:/g, \"**EXPLICATION THOLOGIQUE :**\")\n    .replace(/Introduction au Chapitre/g, \"**Introduction au Chapitre**\")\n    .replace(/Synthse Spirituelle/g, \"**Synthse Spirituelle**\")\n    .replace(/Principe Hermneutique/g, \"**Principe Hermneutique**\");\n}\n\n/* =========================\n   Donnes statiques\n========================= */\n\nconst BOOKS = [\n  \"Gense\", \"Exode\", \"Lvitique\", \"Nombres\", \"Deutronome\",\n  \"Josu\", \"Juges\", \"Ruth\", \"1 Samuel\", \"2 Samuel\", \"1 Rois\", \"2 Rois\",\n  \"1 Chroniques\", \"2 Chroniques\", \"Esdras\", \"Nhmie\", \"Esther\",\n  \"Job\", \"Psaumes\", \"Proverbes\", \"Ecclsiaste\", \"Cantique des cantiques\",\n  \"sae\", \"Jrmie\", \"Lamentations\", \"zchiel\", \"Daniel\",\n  \"Ose\", \"Jol\", \"Amos\", \"Abdias\", \"Jonas\", \"Miche\", \"Nahum\", \"Habacuc\",\n  \"Sophonie\", \"Agge\", \"Zacharie\", \"Malachie\",\n  \"Matthieu\", \"Marc\", \"Luc\", \"Jean\", \"Actes\",\n  \"Romains\", \"1 Corinthiens\", \"2 Corinthiens\", \"Galates\", \"phsiens\",\n  \"Philippiens\", \"Colossiens\", \"1 Thessaloniciens\", \"2 Thessaloniciens\",\n  \"1 Timothe\", \"2 Timothe\", \"Tite\", \"Philmon\", \"Hbreux\",\n  \"Jacques\", \"1 Pierre\", \"2 Pierre\", \"1 Jean\", \"2 Jean\", \"3 Jean\", \"Jude\",\n  \"Apocalypse\"\n];\n\nconst BOOK_CHAPTERS = {\n  \"Gense\": 50, \"Exode\": 40, \"Lvitique\": 27, \"Nombres\": 36, \"Deutronome\": 34,\n  \"Josu\": 24, \"Juges\": 21, \"Ruth\": 4, \"1 Samuel\": 31, \"2 Samuel\": 24,\n  \"1 Rois\": 22, \"2 Rois\": 25, \"1 Chroniques\": 29, \"2 Chroniques\": 36,\n  \"Esdras\": 10, \"Nhmie\": 13, \"Esther\": 10, \"Job\": 42, \"Psaumes\": 150,\n  \"Proverbes\": 31, \"Ecclsiaste\": 12, \"Cantique des cantiques\": 8,\n  \"sae\": 66, \"Jrmie\": 52, \"Lamentations\": 5, \"zchiel\": 48, \"Daniel\": 12,\n  \"Ose\": 14, \"Jol\": 3, \"Amos\": 9, \"Abdias\": 1, \"Jonas\": 4, \"Miche\": 7,\n  \"Nahum\": 3, \"Habacuc\": 3, \"Sophonie\": 3, \"Agge\": 2, \"Zacharie\": 14, \"Malachie\": 4,\n  \"Matthieu\": 28, \"Marc\": 16, \"Luc\": 24, \"Jean\": 21, \"Actes\": 28,\n  \"Romains\": 16, \"1 Corinthiens\": 16, \"2 Corinthiens\": 13, \"Galates\": 6,\n  \"phsiens\": 6, \"Philippiens\": 4, \"Colossiens\": 4, \"1 Thessaloniciens\": 5,\n  \"2 Thessaloniciens\": 3, \"1 Timothe\": 6, \"2 Timothe\": 4, \"Tite\": 3,\n  \"Philmon\": 1, \"Hbreux\": 13, \"Jacques\": 5, \"1 Pierre\": 5, \"2 Pierre\": 3,\n  \"1 Jean\": 5, \"2 Jean\": 1, \"3 Jean\": 1, \"Jude\": 1, \"Apocalypse\": 22\n};\n\nconst BASE_RUBRIQUES = [\n  \"tude verset par verset\",\n  \"Prire d'ouverture\",\n  \"Structure littraire\", \n  \"Questions du chapitre prcdent\",\n  \"Thme doctrinal\",\n  \"Fondements thologiques\",\n  \"Contexte historique\",\n  \"Contexte culturel\", \n  \"Contexte gographique\",\n  \"Analyse lexicale\",\n  \"Parallles bibliques\",\n  \"Prophtie et accomplissement\",\n  \"Personnages\",\n  \"Structure rhtorique\",\n  \"Thologie trinitaire\",\n  \"Christ au centre\",\n  \"vangile et grce\",\n  \"Application personnelle\", \n  \"Application communautaire\",\n  \"Prire de rponse\",\n  \"Questions d'tude\",\n  \"Points de vigilance\",\n  \"Objections et rponses\",\n  \"Perspective missionnelle\",\n  \"thique chrtienne\", \n  \"Louange / liturgie\",\n  \"Mditation guide\",\n  \"Mmoire / versets cls\",\n  \"Plan d'action\"\n];\n\n/* =========================\n   Utilitaires fetch (fallbacks)\n========================= */\n\n// mapping endpoints (nouveau  legacy)\nconst ENDPOINTS = {\n  verseProgressive: [\n    \"/generate-verse-by-verse-progressive\",\n    \"/g_verse_progressive\",\n  ],\n  verse: [\n    \"/generate-verse-by-verse\",\n    \"/g_te-verse-by-verse\",\n  ],\n  study: [\n    \"/generate-study\",\n    \"/g_study_28\",\n  ],\n  verseGemini: [\n    \"/generate-verse-by-verse-gemini\",\n    \"/generate-verse-by-verse\",\n    \"/g_te-verse-by-verse\",\n  ],\n  studyGemini: [\n    \"/generate-study-gemini\",\n    \"/generate-study\",\n    \"/g_study_28\",\n  ],\n};\n\nasync function smartPost(pathList, payload) {\n  let lastErr = null;\n  for (const p of pathList) {\n    const url = `${API_BASE}${p}`;\n    try {\n      console.log(\"[API] POST \", url);\n      const r = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload || {}),\n      });\n      if (r.ok) {\n        const ct = r.headers.get(\"content-type\") || \"\";\n        if (ct.includes(\"application/json\")) {\n          return { data: await r.json(), url };\n        }\n        return { data: { raw: await r.text() }, url };\n      }\n      if (r.status === 404) { lastErr = new Error(`404 @ ${url}`); continue; }\n      const bodyText = await r.text().catch(() => \"\");\n      throw new Error(`HTTP ${r.status} @ ${url}${bodyText ? \"  \" + bodyText.slice(0, 300) : \"\"}`);\n    } catch (e) {\n      lastErr = e;\n    }\n  }\n  throw lastErr || new Error(\"Tous les endpoints ont chou\");\n}\n\n/* =========================\n   Composant Principal App\n========================= */\n\nfunction App() {\n  // tats principaux\n  const [selectedBook, setSelectedBook] = useState(\"Gense\");\n  const [selectedChapter, setSelectedChapter] = useState(\"1\");\n  const [selectedVerse, setSelectedVerse] = useState(\"--\");\n  const [selectedVersion, setSelectedVersion] = useState(\"LSG\");\n  const [selectedLength, setSelectedLength] = useState(500);\n  const [activeRubrique, setActiveRubrique] = useState(0);\n  const [content, setContent] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [generatedRubriques, setGeneratedRubriques] = useState({}); // Stockage du contenu gnr\n  const [rubriquesStatus, setRubriquesStatus] = useState({});\n  const [currentTheme, setCurrentTheme] = useState(0);\n  const [lastStudy, setLastStudy] = useState(null);\n  const [progressPercent, setProgressPercent] = useState(0);\n  const [searchQuery, setSearchQuery] = useState(\"\"); //  unique dclaration\n\n  // tats gnration progressive\n  const [isProgressiveLoading, setIsProgressiveLoading] = useState(false);\n  const [currentBatchVerse, setCurrentBatchVerse] = useState(1);\n  const [progressiveStats, setProgressiveStats] = useState(null);\n  const [isVersetsProgContent, setIsVersetsProgContent] = useState(false);\n  const [currentVerseCount, setCurrentVerseCount] = useState(5);\n  const [canContinueVerses, setCanContinueVerses] = useState(true);\n  \n  // tats pour les notes persistantes - SUPPRIMES (remplaces par page ddie)\n  // const [personalNotes, setPersonalNotes] = useState(...)\n  // const [showNotesModal, setShowNotesModal] = useState(false)\n\n  // tat pour la navigation\n  const [currentPage, setCurrentPage] = useState('main'); // 'main', 'concordance', 'versets', 'notes', ou 'rubrique'\n  const [versetPageContent, setVersetPageContent] = useState('');\n  const [currentBookInfo, setCurrentBookInfo] = useState('');\n  const [currentRubriqueNumber, setCurrentRubriqueNumber] = useState(1);\n  const [currentRubriqueContent, setCurrentRubriqueContent] = useState('');\n\n  // Thmes\n  const colorThemes = [\n    { name: \"Violet Mystique\", primary: \"#667eea\", secondary: \"#764ba2\", accent: \"#667eea\",\n      background: \"linear-gradient(135deg, #667eea 0%, #764ba2 100%)\",\n      headerBg: \"linear-gradient(90deg, #3b4371 0%, #f093fb 50%, #f5576c 100%)\" },\n    { name: \"Ocan Profond\", primary: \"#0891b2\", secondary: \"#0284c7\", accent: \"#0891b2\",\n      background: \"linear-gradient(135deg, #0891b2 0%, #0284c7 100%)\",\n      headerBg: \"linear-gradient(90deg, #075985 0%, #0ea5e9 50%, #38bdf8 100%)\" },\n    { name: \"meraude Vert\", primary: \"#10b981\", secondary: \"#059669\", accent: \"#10b981\",\n      background: \"linear-gradient(135deg, #10b981 0%, #059669 100%)\",\n      headerBg: \"linear-gradient(90deg, #064e3b 0%, #34d399 50%, #6ee7b7 100%)\" },\n    { name: \"Rose Passion\", primary: \"#ec4899\", secondary: \"#db2777\", accent: \"#ec4899\",\n      background: \"linear-gradient(135deg, #ec4899 0%, #db2777 100%)\",\n      headerBg: \"linear-gradient(90deg, #831843 0%, #f472b6 50%, #f9a8d4 100%)\" },\n    { name: \"Orange Sunset\", primary: \"#f59e0b\", secondary: \"#d97706\", accent: \"#f59e0b\",\n      background: \"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",\n      headerBg: \"linear-gradient(90deg, #92400e 0%, #fbbf24 50%, #fcd34d 100%)\" },\n    { name: \"Indigo Royal\", primary: \"#6366f1\", secondary: \"#4f46e5\", accent: \"#6366f1\",\n      background: \"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)\",\n      headerBg: \"linear-gradient(90deg, #312e81 0%, #8b5cf6 50%, #c4b5fd 100%)\" },\n    { name: \"Teal Tropical\", primary: \"#14b8a6\", secondary: \"#0f766e\", accent: \"#14b8a6\",\n      background: \"linear-gradient(135deg, #14b8a6 0%, #0f766e 100%)\",\n      headerBg: \"linear-gradient(90deg, #134e4a 0%, #5eead4 50%, #99f6e4 100%)\" },\n    { name: \"Crimson Fire\", primary: \"#dc2626\", secondary: \"#b91c1c\", accent: \"#dc2626\",\n      background: \"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)\",\n      headerBg: \"linear-gradient(90deg, #7f1d1d 0%, #f87171 50%, #fecaca 100%)\" },\n    { name: \"Amber Gold\", primary: \"#f59e0b\", secondary: \"#d97706\", accent: \"#f59e0b\",\n      background: \"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",\n      headerBg: \"linear-gradient(90deg, #78350f 0%, #fbbf24 50%, #fef3c7 100%)\" },\n    { name: \"Slate Modern\", primary: \"#64748b\", secondary: \"#475569\", accent: \"#64748b\",\n      background: \"linear-gradient(135deg, #64748b 0%, #475569 100%)\",\n      headerBg: \"linear-gradient(90deg, #1e293b 0%, #94a3b8 50%, #e2e8f0 100%)\" },\n    { name: \"Lime Electric\", primary: \"#65a30d\", secondary: \"#4d7c0f\", accent: \"#65a30d\",\n      background: \"linear-gradient(135deg, #65a30d 0%, #4d7c0f 100%)\",\n      headerBg: \"linear-gradient(90deg, #365314 0%, #84cc16 50%, #d9f99d 100%)\" },\n    { name: \"Fuchsia Magic\", primary: \"#c026d3\", secondary: \"#a21caf\", accent: \"#c026d3\",\n      background: \"linear-gradient(135deg, #c026d3 0%, #a21caf 100%)\",\n      headerBg: \"linear-gradient(90deg, #701a75 0%, #e879f9 50%, #f5d0fe 100%)\" },\n  ];\n\n  // Options de chapitres\n  const availableChapters = useMemo(() => {\n    if (selectedBook === \"--\" || !BOOK_CHAPTERS[selectedBook]) return [\"--\"];\n    const max = BOOK_CHAPTERS[selectedBook] || 1;\n    return [\"--\", ...Array.from({ length: max }, (_, i) => i + 1)];\n  }, [selectedBook]);\n\n  // Charger/sauver dernire tude et initialiser couleurs\n  useEffect(() => {\n    const saved = localStorage.getItem(\"lastBibleStudy\");\n    if (saved) { try { setLastStudy(JSON.parse(saved)); } catch(e){ console.error(e);} }\n    const beforeUnload = () => saveCurrentStudy();\n    window.addEventListener(\"beforeunload\", beforeUnload);\n    \n    // Initialiser les couleurs du thme par dfaut\n    const theme = colorThemes[currentTheme];\n    document.documentElement.style.setProperty('--theme-primary', `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`);\n    document.documentElement.style.setProperty('--theme-secondary', `linear-gradient(135deg, ${theme.secondary}, ${theme.primary})`);\n    document.documentElement.style.setProperty('--theme-accent', `linear-gradient(135deg, ${theme.accent}, ${theme.secondary})`);\n    \n    const hexToRgba = (hex, alpha) => {\n      const r = parseInt(hex.slice(1, 3), 16);\n      const g = parseInt(hex.slice(3, 5), 16);\n      const b = parseInt(hex.slice(5, 7), 16);\n      return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n    };\n    \n    document.documentElement.style.setProperty('--theme-accent-shadow', hexToRgba(theme.accent, 0.3));\n    document.documentElement.style.setProperty('--theme-accent-shadow-hover', hexToRgba(theme.accent, 0.4));\n    \n    return () => window.removeEventListener(\"beforeunload\", beforeUnload);\n  }, [currentTheme]);\n\n  // Appliquer thme au chargement\n  useEffect(() => {\n    setTimeout(() => { changePalette(); setCurrentTheme(0); }, 100);\n  }, []);\n  // Test immdiat de sauvegarde quand slection change\n  useEffect(() => {\n    if (selectedBook !== \"--\" && selectedChapter !== \"--\") {\n      console.log(\"[TEST SAUVEGARDE] Slection valide dtecte:\", selectedBook, selectedChapter);\n      saveCurrentStudy();\n    }\n  }, [selectedBook, selectedChapter]);\n\n  const saveCurrentStudy = () => {\n    console.log(\"[DEBUG SAUVEGARDE] Tentative sauvegarde:\", {\n      selectedBook,\n      selectedChapter,\n      selectedVerse,\n      content_length: content ? content.length : 0\n    });\n    \n    if (selectedBook !== \"--\" && selectedChapter !== \"--\") {\n      const currentStudy = {\n        book: selectedBook, chapter: selectedChapter, verse: selectedVerse,\n        version: selectedVersion, length: selectedLength, activeRubrique,\n        content, rubriquesStatus, timestamp: new Date().toISOString(),\n        displayTitle: `${selectedBook} ${selectedChapter}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`\n      };\n      localStorage.setItem(\"lastBibleStudy\", JSON.stringify(currentStudy));\n      setLastStudy(currentStudy);\n      console.log(\"[SAUVEGARDE SUCCESS] tude sauvegarde:\", currentStudy.displayTitle);\n    } else {\n      console.log(\"[SAUVEGARDE SKIP] Conditions non remplies - livre ou chapitre = '--'\");\n    }\n  };\n\n  const restoreLastStudy = () => {\n    if (!lastStudy) return;\n    setSelectedBook(lastStudy.book);\n    setSelectedChapter(lastStudy.chapter);\n    setSelectedVerse(lastStudy.verse || \"--\");\n    setSelectedVersion(lastStudy.version || \"LSG\");\n    setSelectedLength(lastStudy.length || 500);\n    setActiveRubrique(lastStudy.activeRubrique || 0);\n    setContent(lastStudy.content || \"\");\n    setRubriquesStatus(lastStudy.rubriquesStatus || {});\n  };\n\n  const rubriquesItems = BASE_RUBRIQUES.map((title, index) => ({ id: index, title }));\n\n  /* =========================\n     Gestionnaires\n  ========================= */\n\n  const handleBookChange = (e) => {\n    saveCurrentStudy();\n    const book = e.target.value;\n    setSelectedBook(book);\n    setSelectedChapter(book === \"--\" ? \"--\" : 1);\n    setSelectedVerse(\"--\");\n  };\n\n  const handleChapterChange = (e) => {\n    saveCurrentStudy();\n    const chapter = e.target.value;\n    setSelectedChapter(chapter === \"--\" ? \"--\" : Number(chapter));\n    setSelectedVerse(\"--\");\n  };\n\n  const handleVerseChange = (e) => setSelectedVerse(e.target.value);\n  const handleVersionChange = (e) => setSelectedVersion(e.target.value);\n  const handleLengthChange = (e) => setSelectedLength(Number(e.target.value));\n\n  // Recherche intelligente\n  const parseSearchQuery = (query) => {\n    if (!query.trim()) return null;\n    const normalized = query.trim();\n    const patterns = [/^(.+?)\\s+(\\d+):(\\d+)$/, /^(.+?)\\s+(\\d+)$/, /^(.+)$/];\n    for (const pat of patterns) {\n      const m = normalized.match(pat);\n      if (m) {\n        const bookName = m[1].trim();\n        const chapter = m[2] ? parseInt(m[2]) : null;\n        const verse = m[3] ? parseInt(m[3]) : null;\n        const found = BOOKS.find(b =>\n          b.toLowerCase() === bookName.toLowerCase() ||\n          b.toLowerCase().includes(bookName.toLowerCase()) ||\n          bookName.toLowerCase().includes(b.toLowerCase())\n        );\n        if (found) return { book: found, chapter: chapter || 1, verse: verse || \"--\" };\n      }\n    }\n    return null;\n  };\n\n  const handleSearchChange = (e) => {\n    const q = e.target.value;\n    setSearchQuery(q);\n    const parsed = parseSearchQuery(q);\n    if (parsed) {\n      saveCurrentStudy();\n      setSelectedBook(parsed.book);\n      setSelectedChapter(parsed.chapter);\n      setSelectedVerse(parsed.verse);\n    }\n  };\n\n  // Gestionnaires supprims - dfinis plus bas\n\n  // Fonction pour dtecter et transformer les rfrences bibliques en liens YouVersion\n  const transformBibleReferences = (text) => {\n    if (!text) return text;\n    \n    // Sauvegarder les balises HTML existantes pour les restaurer aprs\n    const htmlTags = [];\n    let tempText = text.replace(/<[^>]*>/g, (match) => {\n      const placeholder = `__HTML_TAG_${htmlTags.length}__`;\n      htmlTags.push(match);\n      return placeholder;\n    });\n    \n    // Set pour viter les doublons\n    const processedRefs = new Set();\n    \n    // Regex amliore pour dtecter les rfrences bibliques (seulement dans le texte brut)\n    const bibleRefRegex = /(\\d?\\s*[A-Z-][a-z-]*(?:\\s+\\d*\\s*[A-Z-][a-z-]*)*)\\s+(\\d+)(?::(\\d+)(?:[-](\\d+))?)?(?!\\d)/g;\n    \n    // Traiter les rfrences dans le texte temporaire (sans HTML)\n    tempText = tempText.replace(bibleRefRegex, (match, book, chapter, verse1, verse2) => {\n      const cleanMatch = match.trim();\n      \n      // Vrifier si cette rfrence a dj t traite (viter les doublons)\n      if (processedRefs.has(cleanMatch)) {\n        return cleanMatch; // Retourner le texte sans lien si c'est un doublon\n      }\n      \n      processedRefs.add(cleanMatch);\n      \n      // Construire l'URL YouVersion avec recherche directe\n      const youVersionUrl = `https://www.bible.com/search/bible?q=${encodeURIComponent(cleanMatch)}`;\n      \n      // Crer le lien HTML avec styles\n      return `<a href=\"${youVersionUrl}\" target=\"_blank\" class=\"bible-reference\" title=\"${cleanMatch}\">${cleanMatch}</a>`;\n    });\n    \n    // Restaurer les balises HTML originales\n    htmlTags.forEach((tag, index) => {\n      tempText = tempText.replace(`__HTML_TAG_${index}__`, tag);\n    });\n    \n    return tempText;\n  };\n\n  // Progress bar\n  const wait = (ms) => new Promise(r => setTimeout(r, ms));\n\n  // Fonction pour parser le contenu des 28 rubriques retourn par l'API\n  const parseRubriquesContent = (fullContent) => {\n    const rubriques = {};\n    \n    console.log(\"[PARSING DEBUG] Contenu reu:\", fullContent.length, \"caractres\");\n    console.log(\"[PARSING DEBUG] Dbut du contenu:\", fullContent.substring(0, 200));\n    \n    // Diviser le contenu par les titres de rubriques (## Rubrique 1: , ## Rubrique 2: , etc.)\n    const sections = fullContent.split(/##\\s*Rubrique\\s*(\\d+):\\s*/i);\n    \n    console.log(\"[PARSING DEBUG] Sections trouves:\", sections.length);\n    \n    for (let i = 1; i < sections.length; i += 2) {\n      const rubriqueNumber = parseInt(sections[i]); // Garder l'index 1-based pour correspondre aux rubriques\n      let rubriqueContent = sections[i + 1] ? sections[i + 1].trim() : \"\";\n      \n      console.log(`[PARSING DEBUG] Rubrique ${rubriqueNumber}:`, rubriqueContent.length, \"caractres\");\n      \n      // Nettoyer le contenu - enlever le titre suivant s'il existe\n      if (rubriqueContent) {\n        // Enlever une ventuelle rubrique suivante qui serait incluse\n        rubriqueContent = rubriqueContent.split('## Rubrique')[0].trim();\n        \n        // Nettoyer les sauts de ligne multiples\n        rubriqueContent = rubriqueContent.replace(/\\n{3,}/g, '\\n\\n').trim();\n        \n        if (rubriqueContent.length > 0) {\n          rubriques[rubriqueNumber] = rubriqueContent;\n          console.log(`[PARSING SUCCESS] Rubrique ${rubriqueNumber} parse:`, rubriqueContent.substring(0, 100) + \"...\");\n        }\n      }\n    }\n    \n    console.log(\"[PARSING FINAL] Rubriques parses:\", Object.keys(rubriques).length);\n    return rubriques;\n  };\n\n  // Configuration des longueurs par rubrique\n  const getRubriqueLength = (rubriqueNum) => {\n    const lengthConfig = {\n      1: 500,   // Prire d'ouverture\n      2: 500,   // Structure littraire\n      3: 500,   // Questions du chapitre prcdent\n      4: 500,   // Thme doctrinal\n      5: 1500,  // Fondements thologiques\n      6: 1500,  // Contexte historique\n      7: 1500,  // Contexte culturel\n      8: 1500,  // Contexte gographique\n      9: 1500,  // Analyse lexicale\n      10: 1500, // Parallles bibliques\n      11: 1500, // Prophtie et accomplissement\n      12: 1500, // Personnages\n      13: 1500, // Structure rhtorique\n      14: 1500, // Thologie trinitaire\n      15: 2000, // Christ au centre\n      16: 2000, // vangile et grce\n      17: 2000, // Application personnelle\n      18: 2000, // Application communautaire\n      19: 2000, // Prire de rponse\n      20: 2000, // Questions d'tude\n      21: 2000, // Points de vigilance\n      22: 2000, // Objections et rponses\n      23: 2000, // Perspective missionnelle\n      24: 2000, // thique chrtienne\n      25: 2000, // Louange / liturgie\n      26: 2000, // Mditation guide\n      27: 2000, // Mmoire / versets cls\n      28: 2000  // Plan d'action\n    };\n    return lengthConfig[rubriqueNum] || 500;\n  };\n\n  // Fonction pour gnrer du contenu narratif thologique spcifique\n  const generateRubriqueContent = (rubriqueNum, rubriqueTitle, passage, book, chapter, userSelectedLength = null) => {\n    // Utiliser la longueur choisie par l'utilisateur ou la longueur par dfaut de la rubrique\n    const targetLength = userSelectedLength || getRubriqueLength(rubriqueNum);\n    \n    const contenuParRubrique = {\n      1: generatePrayerContent(passage, targetLength),\n      2: generateStructureContent(passage, book, chapter, targetLength),\n      3: generatePreviousChapterContent(passage, book, chapter, targetLength),\n      4: generateDoctrinalThemeContent(passage, book, chapter, targetLength),\n      5: generateTheologicalFoundationsContent(passage, book, chapter, targetLength),\n      6: generateHistoricalContextContent(passage, book, chapter, targetLength),\n      7: generateCulturalContextContent(passage, book, chapter, targetLength),\n      8: generateGeographicalContextContent(passage, book, chapter, targetLength),\n      9: generateLexicalAnalysisContent(passage, book, chapter, targetLength),\n      10: generateBiblicalParallelsContent(passage, book, chapter, targetLength),\n      11: generateProphecyContent(passage, book, chapter, targetLength),\n      12: generateCharactersContent(passage, book, chapter, targetLength),\n      13: generateRhetoricalStructureContent(passage, book, chapter, targetLength),\n      14: generateTrinityTheologyContent(passage, book, chapter, targetLength),\n      15: generateChristCenteredContent(passage, book, chapter, targetLength),\n      16: generateGospelGraceContent(passage, book, chapter, targetLength),\n      17: generatePersonalApplicationContent(passage, book, chapter, targetLength),\n      18: generateCommunityApplicationContent(passage, book, chapter, targetLength),\n      19: generateResponsePrayerContent(passage, book, chapter, targetLength),\n      20: generateStudyQuestionsContent(passage, book, chapter, targetLength),\n      21: generateVigilancePointsContent(passage, book, chapter, targetLength),\n      22: generateObjectionsResponsesContent(passage, book, chapter, targetLength),\n      23: generateMissionalPerspectiveContent(passage, book, chapter, targetLength),\n      24: generateChristianEthicsContent(passage, book, chapter, targetLength),\n      25: generateWorshipLiturgyContent(passage, book, chapter, targetLength),\n      26: generateGuidedMeditationContent(passage, book, chapter, targetLength),\n      27: generateMemoryVersesContent(passage, book, chapter, targetLength),\n      28: generateActionPlanContent(passage, book, chapter, targetLength)\n    };\n\n    return contenuParRubrique[rubriqueNum] || \n      generateDefaultContent(rubriqueTitle, passage, book, chapter, targetLength);\n  };\n\n  // Fonction pour la prire d'ouverture avec progression narrative thologique\n  const generatePrayerContent = (passage, targetLength) => {\n    const baseContent = `**Adoration :** Seigneur Dieu, Crateur du ciel et de la terre, nous reconnaissons ta grandeur manifeste dans ${passage}. Tu es celui qui appelle  l'existence ce qui n'tait pas.\n\n**Confession :** Pre, nous confessons notre petitesse face  ta majest cratrice rvle dans ${passage}. Pardonne-nous nos manquements.\n\n**Demande :** Esprit Saint, claire notre comprhension de ${passage}.`;\n\n    if (targetLength >= 500) {\n      return baseContent + `\n\nDans cette prire d'ouverture, nous nous approchons du trne de la grce avec une rvrence qui sied  la majest divine rvle dans ${passage}. L'adoration authentique nat de la contemplation des perfections divines manifestes dans l'criture sainte.`;\n    }\n\n    if (targetLength >= 1000) {\n      return baseContent + `\n\nDans cette prire d'ouverture, nous nous approchons du trne de la grce avec une rvrence qui sied  la majest divine rvle dans ${passage}. L'adoration authentique nat de la contemplation des perfections divines manifestes dans l'criture sainte.\n\nLa tradition patristique et rforme nous enseigne que la lectio divina doit dbuter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le pch. Comme l'affirme Jean Chrysostome : \"Les critures sont une lettre que Dieu nous a envoye d'en haut.\" Cette lettre divine ncessite l'illumination cleste pour tre comprise dans toute sa profondeur sotriologique.\n\nNotre confession s'enracine dans la reconnaissance de notre finitude craturelle face  l'infinit divine. L'humilit hermneutique constitue le pralable indispensable  toute exgse fidle.`;\n    }\n\n    if (targetLength >= 2000) {\n      return baseContent + `\n\nDans cette prire d'ouverture, nous nous approchons du trne de la grce avec une rvrence qui sied  la majest divine rvle dans ${passage}. L'adoration authentique nat de la contemplation des perfections divines manifestes dans l'criture sainte.\n\nLa tradition patristique et rforme nous enseigne que la lectio divina doit dbuter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le pch. Comme l'affirme Jean Chrysostome : \"Les critures sont une lettre que Dieu nous a envoye d'en haut.\" Cette lettre divine ncessite l'illumination cleste pour tre comprise dans toute sa profondeur sotriologique.\n\nNotre confession s'enracine dans la reconnaissance de notre finitude craturelle face  l'infinit divine. L'humilit hermneutique constitue le pralable indispensable  toute exgse fidle.\n\nL'cole d'Antioche et l'cole d'Alexandrie, malgr leurs divergences hermneutiques, s'accordaient sur cette vrit fondamentale : l'criture ne se dvoile pleinement qu' celui qui s'approche d'elle dans la prire et la dpendance de l'Esprit. Origne crivait : \"La parole de Dieu est comme un grain de froment : si tu n'en broies pas l'corce par la mditation et la prire, tu ne peux en goter la moelle.\"\n\nCette dmarche spirituelle s'inscrit dans la ligne de la Sola Scriptura rforme, qui affirme non seulement l'autorit suprme de l'criture, mais aussi la ncessit de l'illumination divine pour sa juste comprhension. Calvin soulignait que \"l'criture est son propre interprte\", mais sous la conduite du Saint-Esprit qui en est l'auteur principal.\n\nAinsi, notre prire d'ouverture devant ${passage} n'est pas une simple formalit liturgique, mais l'expression de notre thologie de la rvlation : Dieu se rvle, l'homme reoit par grce, et l'Esprit rend tmoignage  la vrit divine dans le cur du croyant rgnr.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour structure littraire (500 caractres)\n  const generateStructureContent = (passage, book, chapter, targetLength) => {\n    return `L'architecture littraire de ${passage} rvle l'ordre divin dans la cration. Cette structure en sept jours manifeste la perfection divine : trois jours de sparation (lumire/tnbres, eaux/eaux, terre/mer) suivis de trois jours de peuplement (luminaires, animaux aquatiques et volants, animaux terrestres et l'homme). Le septime jour couronne l'uvre par le repos divin, tablissant le principe du sabbat. Cette progression mthodique \"Dieu dit... et cela fut... Dieu vit que cela tait bon\" dmontre la souverainet divine.`;\n  };\n\n  // Fonction pour questions du chapitre prcdent (500 caractres)\n  const generatePreviousChapterContent = (passage, book, chapter, targetLength) => {\n    if (chapter === \"1\") {\n      return `${passage} ouvre le rcit biblique sans prologue humain, plongeant directement dans l'acte crateur divin. Cette ouverture majestueuse tablit Dieu comme l'acteur principal de l'histoire. L'absence de contexte pralable souligne l'ternit et la primaut divines. Cette introduction thologique prpare tout le dveloppement biblique ultrieur, posant les fondements de l'alliance, de la rvlation progressive et du plan de salut qui se dploieront dans toute l'criture.`;\n    }\n    return `L'tude de ${passage} s'inscrit dans la continuit du rcit biblique. Les vnements prcdents clairent la comprhension de ce passage et prparent les dveloppements thologiques qui suivront.`;\n  };\n\n  // Fonction pour thme doctrinal (500 caractres)\n  const generateDoctrinalThemeContent = (passage, book, chapter, targetLength) => {\n    return `Le thme doctrinal central de ${passage} proclame la souverainet cratrice de Dieu. Trois vrits fondamentales mergent : l'existence ternelle de Dieu avant toute cration, sa parole efficace qui appelle  l'existence ce qui n'tait pas, et sa bonne volont envers son uvre. L'homme, cr  l'image divine, reoit la dignit unique de reprsentant de Dieu sur terre. Le sabbat tablit le rythme divin entre travail et repos, rvlant la nature mme de Dieu dans l'alternance activit/contemplation.`;\n  };\n\n  // Fonction pour fondements thologiques avec progression narrative selon longueur\n  const generateTheologicalFoundationsContent = (passage, book, chapter, targetLength) => {\n    const baseContent = `La narration de ${passage} tablit les piliers thologiques de la foi chrtienne. L'criture rvle que Dieu, dans sa trinit ternelle, prcde toute ralit cre.`;\n\n    if (targetLength >= 500) {\n      return baseContent + ` La cration ex nihilo manifeste la toute-puissance divine. L'anthropologie biblique trouve ici ses racines : l'homme, cr  l'image de Dieu (imago Dei), reoit une dignit unique dans la cration.`;\n    }\n\n    if (targetLength >= 1000) {\n      return baseContent + ` La cration ex nihilo manifeste la toute-puissance divine. Contrairement aux cosmogonies babyloniennes qui dcrivent des thomachies primordiales, l'criture prsente un Dieu souverain crant par sa seule parole.\n\nL'anthropologie biblique trouve ici ses fondements : l'homme, cr  l'image de Dieu (imago Dei), reoit une dignit unique. Cette ressemblance divine ne rside pas dans la corporit mais dans les facults spirituelles : intelligence, volont, capacit relationnelle et responsabilit morale. L'homme devient ainsi le vice-grent de Dieu sur terre.\n\nLe sabbat rvle la pdagogie divine. En se reposant le septime jour, Dieu tablit un modle anthropologique : l'alternance entre activit cratrice et contemplation adoratrice. Cette institution sabbatique prfigure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sotriologique en Christ, notre repos sabbatique vritable selon l'ptre aux Hbreux.`;\n    }\n\n    if (targetLength >= 2000) {\n      return baseContent + ` La cration ex nihilo ( partir du nant) manifeste la toute-puissance divine et constitue un dogme fondamental distinguant radicalement la foi biblique de toute philosophie naturaliste ou panthiste. Contrairement aux cosmogonies babyloniennes (Enuma Elish) qui dcrivent des thomachies primordiales, l'criture prsente un Dieu souverain crant par sa seule parole efficace.\n\nL'anthropologie biblique trouve ici ses fondements doctrinaux incontournables. L'homme, cr  l'image de Dieu (imago Dei selon Gense 1:27), reoit une dignit ontologique unique dans l'ordre crationnel. Cette ressemblance divine ne rside pas dans la corporit (contra l'anthropomorphisme naf) mais dans les facults spirituelles : intellectus, voluntas, capacit relationnelle et responsabilit morale coram Deo. L'homme devient ainsi le vice-grent divin sur terre, participant  la souverainet divine par dlgation gracieuse.\n\nLa thologie sabbatique rvle la pdagogie divine et tablit les fondements de la sanctification du temps. En se reposant le septime jour, Dieu tablit un paradigme anthropologique fondamental : l'alternance entre activit cratrice (opus Dei) et contemplation adoratrice (otium sanctum). Cette institution sabbatique prfigure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sotriologique en Christ, notre repos sabbatique vritable selon l'exgse de l'ptre aux Hbreux (chapitre 4).\n\nL'cole de Westminster et les thologiens rforms orthodoxes (Turretin, Brakel, Owen) ont dvelopp ces fondements avec une rigueur scolastique remarquable, tablissant la thologie systmatique sur ces bases scripturaires inbranlables. Ces vrits rvles constituent le socle doctrinal de la foi rforme et demeurent le rempart thologique face aux dfis de la modernit sculire et du naturalisme mthodologique contemporain.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour contexte historique (1500 caractres) - Plus narratif et thologique\n  const generateHistoricalContextContent = (passage, book, chapter, targetLength) => {\n    return `L'tude du contexte historique de ${passage} nous plonge dans l'univers du Proche-Orient ancien, o les cosmogonies babyloniennes et gyptiennes dominaient la pense religieuse. Dans ce milieu culturel satur de mythologies, la rvlation biblique merge comme une voix prophtique unique et rvolutionnaire.\n\nLes rcits babyloniens comme l'Enuma Elish prsentent la cration comme le rsultat de conflits titanesques entre divinits primordiales. Marduk vainc Tiamat, desse du chaos, et de son cadavre forme le cosmos. Ces mythes refltent une vision cyclique du temps et une comprhension polythiste du divin. La rvlation mosaque s'oppose radicalement  ces conceptions.\n\nL'criture proclame un Dieu unique, ternel, qui cre par sa parole sans opposition ni combat. Cette vrit rvle corrige les erreurs thologiques de l'environnement culturel isralite. Le peuple de Dieu reoit ainsi une comprhension purifie de la divinit, libre des superstitions et des craintes lies aux forces naturelles divinises.\n\nL'historicit du rcit, dbattue dans les cercles acadmiques contemporains, ne diminue en rien sa porte thologique. Que l'on adopte une lecture littrale ou littraire, l'enseignement doctrinal demeure inchang : Dieu est le crateur souverain, l'homme porte son image, et la cration rvle sa gloire.\n\nCette perspective historique enrichit notre comprhension et renforce notre foi en la vracit de la rvlation divine face aux idologies contemporaines qui tentent de rduire l'homme  un simple produit du hasard volutif.`;\n  };\n\n  // Fonction gnrique pour contenu par dfaut\n  const generateDefaultContent = (rubriqueTitle, passage, book, chapter, targetLength) => {\n    const baseContent = `**${rubriqueTitle}** dans le contexte de ${passage}\n\nCette rubrique examine ${passage} sous l'angle de \"${rubriqueTitle}\". L'analyse rvle des vrits importantes pour notre comprhension thologique et notre marche chrtienne.\n\n**Enseignement biblique :** ${passage} nous instruit sur la nature de Dieu et son uvre dans l'histoire du salut.\n**Application pratique :** Ces vrits transforment notre relation avec le Crateur et notre vision du monde.`;\n\n    // tendre le contenu selon la longueur cible\n    if (targetLength >= 1500) {\n      return baseContent + `\n\nLa narration scripturaire nous invite  une mditation approfondie sur les implications de ce passage. L'Esprit Saint, par sa grce illuminatrice, nous rvle les richesses caches de la Parole divine. Cette section de l'criture s'inscrit dans le grand dessein rdempteur de Dieu, prparant la venue du Messie et l'tablissement de son royaume ternel.\n\n**Dimension thologique :** L'tude de ${passage} enrichit notre comprhension de la nature divine et de ses attributs.\n**Porte sotriologique :** Ce texte contribue  notre comprhension du salut par grce au moyen de la foi.\n**Perspective eschatologique :** Les vrits rvles ici clairent notre esprance en la consommation du royaume de Dieu.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour Christ au centre (2000 caractres) - Trs thologique et narratif\n  const generateChristCenteredContent = (passage, book, chapter, targetLength) => {\n    return `La lecture christocentrique de ${passage} rvle la prsence du Fils ternel ds l'uvre cratrice. L'criture nous enseigne que \"toutes choses ont t faites par lui, et rien de ce qui a t fait n'a t fait sans lui\" (Jean 1:3). Cette vrit transforme radicalement notre comprhension de la cration.\n\nLe Logos divin, second membre de la Trinit sainte, participe activement  l'acte crateur. Quand Dieu dit \"Que la lumire soit\", c'est la Parole ternelle qui s'exprime. Cette lumire primordiale prfigure Christ, \"lumire du monde\" qui viendra clairer les tnbres spirituelles de l'humanit dchue.\n\nL'expression \"Faisons l'homme  notre image\" (Gense 1:26) rvle la consultation trinitaire. Le Pre, le Fils et le Saint-Esprit concourent  la cration de l'homme. Cette image divine imprime en Adam trouve son archtype parfait en Jsus-Christ, \"image du Dieu invisible\" (Colossiens 1:15). L'homme dchu sera restaur  cette image par l'uvre rdemptrice du Fils incarn.\n\nLe sabbat crationnel annonce prophtiquement le repos que Christ procurera  son peuple. \"Venez  moi, vous tous qui tes fatigus et chargs, et je vous donnerai du repos\" (Matthieu 11:28). Le sabbat temporel s'accomplit dans le repos ternel que le Sauveur assure  tous ceux qui croient en lui.\n\nLa domination accorde  l'homme sur la cration prfigure la royaut universelle du Fils de l'homme. Christ, second Adam, restaurera cette domination perdue par la chute et l'exercera parfaitement dans son royaume millnaire et ternel.\n\nCette lecture christologique de la cration enrichit notre adoration et affermit notre esprance en celui qui est \"l'Alpha et l'Omga, le commencement et la fin\".`;\n  };\n\n  // Fonction pour vangile et grce (2000 caractres) - Trs thologique et narratif\n  const generateGospelGraceContent = (passage, book, chapter, targetLength) => {\n    return `Dans la magnificence de ${passage}, l'vangile de la grce divine se dessine dj en filigrane. Bien que l'humanit n'ait pas encore chut, la prescience divine connat dj le plan rdempteur qui se dploiera  travers l'histoire sainte.\n\nLa cration ex nihilo manifeste la grce premire de Dieu. Rien ne l'obligeait  crer ; aucun besoin ne le contraignait  donner l'existence  l'univers. Cette cration gratuite rvle la nature gnreuse et aimante du Crateur. Cette gratuit originelle prfigure la grce salvatrice qui sera manifeste en Jsus-Christ.\n\nLa bndiction divine sur l'humanit - \"Dieu les bnit\" - constitue la premire effusion de grce sur les cratures portant son image. Cette bndiction crationnelle anticipe la bndiction rdemptrice qui coulera du sacrifice de l'Agneau immol ds la fondation du monde.\n\nL'tablissement du sabbat rvle la pdagogie divine. Dieu enseigne  l'homme le rythme de la grce : six jours de labeur suivis d'un jour de repos et de communion. Ce principe ducatif prpare l'humanit  comprendre que le salut ne s'obtient pas par les uvres mais par la grce, au moyen de la foi.\n\nL'environnement dnique - implicite dans ce chapitre et explicit au suivant - manifeste la bont gratuite de Dieu envers ses cratures. Cette bont originelle tmoigne du dsir divin de communion avec l'humanit, dsir qui trouvera son accomplissement parfait dans l'incarnation du Fils.\n\nMme la capacit humaine de rpondre  Dieu, de le connatre et de l'adorer, constitue un don de la grce divine. L'imago Dei n'est pas un mrite humain mais un cadeau du Crateur aimant.\n\nCette perspective vanglique de la cration nourrit notre gratitude et nous prpare  mieux saisir la grandeur de la grce salvatrice manifeste en Christ Jsus notre Seigneur.`;\n  };\n\n  // Ajouter d'autres fonctions pour les rubriques restantes...\n  const generateCulturalContextContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Contexte culturel\", passage, book, chapter, targetLength);\n  };\n\n  const generateGeographicalContextContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Contexte gographique\", passage, book, chapter, targetLength);\n  };\n\n  const generateLexicalAnalysisContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Analyse lexicale\", passage, book, chapter, targetLength);\n  };\n\n  const generateBiblicalParallelsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Parallles bibliques\", passage, book, chapter, targetLength);\n  };\n\n  const generateProphecyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Prophtie et accomplissement\", passage, book, chapter, targetLength);\n  };\n\n  const generateCharactersContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Personnages\", passage, book, chapter, targetLength);\n  };\n\n  const generateRhetoricalStructureContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Structure rhtorique\", passage, book, chapter, targetLength);\n  };\n\n  const generateTrinityTheologyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Thologie trinitaire\", passage, book, chapter, targetLength);\n  };\n\n  const generatePersonalApplicationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Application personnelle\", passage, book, chapter, targetLength);\n  };\n\n  const generateCommunityApplicationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Application communautaire\", passage, book, chapter, targetLength);\n  };\n\n  const generateResponsePrayerContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Prire de rponse\", passage, book, chapter, targetLength);\n  };\n\n  const generateStudyQuestionsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Questions d'tude\", passage, book, chapter, targetLength);\n  };\n\n  const generateVigilancePointsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Points de vigilance\", passage, book, chapter, targetLength);\n  };\n\n  const generateObjectionsResponsesContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Objections et rponses\", passage, book, chapter, targetLength);\n  };\n\n  const generateMissionalPerspectiveContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Perspective missionnelle\", passage, book, chapter, targetLength);\n  };\n\n  const generateChristianEthicsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"thique chrtienne\", passage, book, chapter, targetLength);\n  };\n\n  const generateWorshipLiturgyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Louange / liturgie\", passage, book, chapter, targetLength);\n  };\n\n  const generateGuidedMeditationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Mditation guide\", passage, book, chapter, targetLength);\n  };\n\n  const generateMemoryVersesContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Mmoire / versets cls\", passage, book, chapter, targetLength);\n  };\n\n  const generateActionPlanContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Plan d'action\", passage, book, chapter, targetLength);\n  };\n\n  // Fonction pour gnrer un contenu fallback intelligent\n  const generateIntelligentFallback = (passage, book, chapter) => {\n    return `**TUDE BIBLIQUE  28 RUBRIQUES**\n**Passage :** ${passage} (LSG)\n\n## 1. Prire d'ouverture\nSeigneur, ouvre nos curs  la comprhension de ${passage}. Que ton Esprit nous guide dans ta vrit et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.\n\n## 2. Structure littraire\nLe passage de ${passage} rvle une structure littraire soigneusement orchestre qui sert le propos thologique de l'auteur inspir. Cette organisation guide le lecteur vers une comprhension progressive des vrits divines rvles.\n\n## 3. Questions du chapitre prcdent\nL'tude de ${passage} doit tre mise en relation avec le contexte qui prcde. Quels thmes et enseignements prparent le lecteur  comprendre ce passage dans sa continuit narrative et thologique ?\n\n## 4. Thme doctrinal\nLe thme doctrinal central de ${passage} manifeste des vrits fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la rvlation progressive de Dieu.\n\n## 5. Fondements thologiques\n${passage} tablit des fondements thologiques importants qui clairent notre comprhension de l'uvre de Dieu dans l'histoire et dans nos vies. Ces vrits fondamentales structurent la foi chrtienne.\n\n## 6. Contexte historique\nLe contexte historique de ${passage} claire la situation des premiers auditeurs et enrichit notre comprhension contemporaine. Connatre les circonstances originales aide  saisir l'intention divine.\n\n## 7. Contexte culturel\nLes lments culturels prsents dans ${passage} rvlent les coutumes et pratiques de l'poque, permettant une meilleure interprtation des enseignements bibliques dans leur cadre original.\n\n## 8. Contexte gographique\nLa gographie de ${passage} offre des cls d'interprtation importantes. Les lieux mentionns portent souvent une signification symbolique et thologique qui enrichit le message.\n\n## 9. Analyse lexicale\nL'tude des termes cls dans ${passage} rvle la richesse du vocabulaire biblique et les nuances importantes pour une comprhension prcise du texte inspir.\n\n## 10. Parallles bibliques\n${passage} trouve des chos dans d'autres parties de l'criture. Ces parallles bibliques clairent le sens et montrent l'unit de la rvlation divine.\n\n## 11. Prophtie et accomplissement\nLes lments prophtiques prsents dans ${passage} s'inscrivent dans le plan rdempteur de Dieu et trouvent leur accomplissement ultime en Jsus-Christ.\n\n## 12. Personnages\nLes personnages mentionns dans ${passage} offrent des modles ou des avertissements pour notre marche chrtienne. Leur exemple instruit notre foi.\n\n## 13. Structure rhtorique\nLa rhtorique employe dans ${passage} rvle l'art divin de la communication. La structure argumentative guide le lecteur vers les vrits essentielles.\n\n## 14. Thologie trinitaire\n${passage} rvle des aspects de la nature trinitaire de Dieu : Pre, Fils et Saint-Esprit uvrent ensemble dans l'histoire du salut.\n\n## 15. Christ au centre\nChrist se rvle au centre de ${passage} comme accomplissement des promesses et cl d'interprtation de l'criture. L'hermneutique christocentrique claire ce texte.\n\n## 16. vangile et grce\n${passage} manifeste la grce de Dieu et les vrits vangliques fondamentales. Le salut par grce au moyen de la foi transparat dans ce texte.\n\n## 17. Application personnelle\nComment ${passage} transforme-t-il notre marche quotidienne avec Dieu ? Ce texte nous interpelle sur nos attitudes, nos priorits et notre relation avec le Seigneur.\n\n## 18. Application communautaire\n${passage} claire la vie de l'glise et les relations fraternelles. Les principes noncs s'appliquent  la communaut des croyants.\n\n## 19. Prire de rponse\nEn rponse  l'tude de ${passage}, offrons  Dieu notre reconnaissance, notre confession et nos requtes. Que sa Parole transforme nos curs.\n\n## 20. Questions d'tude\n- Que rvle ${passage} sur la nature de Dieu ?\n- Que nous enseigne ce texte sur la condition humaine ?\n- Quels changements ce passage appelle-t-il dans notre vie ?\n\n## 21. Points de vigilance\nQuelles sont les erreurs d'interprtation  viter concernant ${passage} ? Quels cueils thologiques ce texte nous aide-t-il  contourner ?\n\n## 22. Objections et rponses\nComment rpondre aux objections couramment souleves contre les enseignements de ${passage} ? Quels arguments bibliques y rpondent ?\n\n## 23. Perspective missionnelle\n${passage} claire-t-il notre mission d'vanglisation ? Comment ce texte motive-t-il et oriente-t-il l'uvre missionnaire ?\n\n## 24. thique chrtienne\nQuels principes thiques ${passage} tablit-il ? Comment guide-t-il nos choix moraux et notre conduite chrtienne ?\n\n## 25. Louange / liturgie\nComment ${passage} nourrit-il notre adoration ? Quels lments peuvent enrichir notre louange communautaire et personnelle ?\n\n## 26. Mditation guide\nPrenons un moment pour mditer personnellement sur ${passage}. Que le Saint-Esprit grave ces vrits dans nos curs.\n\n## 27. Mmoire / versets cls\nVerset-cl suggr : ${passage}:1\nMmorisons ce verset pour porter sa vrit dans notre quotidien.\n\n## 28. Plan d'action\n- Une action personnelle cette semaine en rponse  ${passage}\n- Une application communautaire ce mois-ci\n- Un tmoignage  partager de l'impact de ce texte`;\n  };\n\n  // Fonction pour gnrer du contenu de fallback intelligent par rubrique\n  const generateFallbackRubriqueContent = (rubriqueNum, rubriqueTitle, passage) => {\n    const fallbacks = {\n      1: `Seigneur, ouvre nos curs  la comprhension de ${passage}. Que ton Esprit nous guide dans ta vrit et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.`,\n      \n      2: `Le passage de ${passage} rvle une structure littraire soigneusement orchestre qui sert le propos thologique de l'auteur inspir. Cette organisation n'est pas fortuite mais guide le lecteur vers une comprhension progressive des vrits divines rvles.`,\n      \n      4: `Le thme doctrinal central de ${passage} manifeste des vrits fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la rvlation progressive de Dieu et trouvent leur accomplissement en Christ.`,\n      \n      6: `Le contexte historique de ${passage} claire la situation des premiers auditeurs et enrichit notre comprhension contemporaine. Connatre les circonstances originales nous aide  mieux saisir l'intention divine et l'application universelle du texte.`,\n      \n      15: `Christ se rvle au centre de ${passage} comme accomplissement des promesses et cl d'interprtation de l'criture. L'hermneutique christocentrique nous permet de dcouvrir comment ce passage tmoigne de l'uvre rdemptrice du Sauveur.`,\n      \n      17: `Application personnelle : comment ${passage} transforme-t-il notre marche quotidienne avec Dieu et notre croissance spirituelle ? Ce texte nous interpelle sur nos attitudes, nos priorits et notre relation avec le Seigneur.`\n    };\n\n    return fallbacks[rubriqueNum] || `**${rubriqueTitle}**\\n\\nCette section de ${passage} nous enseigne des vrits importantes selon la perspective de ${rubriqueTitle.toLowerCase()}. L'analyse de ce passage rvle des insights prcieux pour notre comprhension biblique et notre application pratique.\\n\\n*Contenu gnr automatiquement - ${rubriqueNum}/${BASE_RUBRIQUES.length} rubriques*`;\n  };\n  const animateProgress = async (duration = 3000) => {\n    setProgressPercent(0);\n    const steps = 100, step = duration / steps;\n    for (let i = 0; i <= steps; i++) { setProgressPercent(i); await wait(step); }\n  };\n\n  // YouVersion\n  const openYouVersion = () => {\n    if (selectedBook === \"--\") return alert(\"Veuillez d'abord slectionner un livre de la Bible\");\n    const bookCodes = {\"Gense\":\"GEN\",\"Exode\":\"EXO\",\"Lvitique\":\"LEV\",\"Nombres\":\"NUM\",\"Deutronome\":\"DEU\",\"Josu\":\"JOS\",\"Juges\":\"JDG\",\"Ruth\":\"RUT\",\"1 Samuel\":\"1SA\",\"2 Samuel\":\"2SA\",\"1 Rois\":\"1KI\",\"2 Rois\":\"2KI\",\"1 Chroniques\":\"1CH\",\"2 Chroniques\":\"2CH\",\"Esdras\":\"EZR\",\"Nhmie\":\"NEH\",\"Esther\":\"EST\",\"Job\":\"JOB\",\"Psaumes\":\"PSA\",\"Proverbes\":\"PRO\",\"Ecclsiaste\":\"ECC\",\"Cantique des cantiques\":\"SNG\",\"sae\":\"ISA\",\"Jrmie\":\"JER\",\"Lamentations\":\"LAM\",\"zchiel\":\"EZK\",\"Daniel\":\"DAN\",\"Ose\":\"HOS\",\"Jol\":\"JOL\",\"Amos\":\"AMO\",\"Abdias\":\"OBA\",\"Jonas\":\"JON\",\"Miche\":\"MIC\",\"Nahum\":\"NAM\",\"Habacuc\":\"HAB\",\"Sophonie\":\"ZEP\",\"Agge\":\"HAG\",\"Zacharie\":\"ZEC\",\"Malachie\":\"MAL\",\"Matthieu\":\"MAT\",\"Marc\":\"MRK\",\"Luc\":\"LUK\",\"Jean\":\"JHN\",\"Actes\":\"ACT\",\"Romains\":\"ROM\",\"1 Corinthiens\":\"1CO\",\"2 Corinthiens\":\"2CO\",\"Galates\":\"GAL\",\"phsiens\":\"EPH\",\"Philippiens\":\"PHP\",\"Colossiens\":\"COL\",\"1 Thessaloniciens\":\"1TH\",\"2 Thessaloniciens\":\"2TH\",\"1 Timothe\":\"1TI\",\"2 Timothe\":\"2TI\",\"Tite\":\"TIT\",\"Philmon\":\"PHM\",\"Hbreux\":\"HEB\",\"Jacques\":\"JAS\",\"1 Pierre\":\"1PE\",\"2 Pierre\":\"2PE\",\"1 Jean\":\"1JN\",\"2 Jean\":\"2JN\",\"3 Jean\":\"3JN\",\"Jude\":\"JUD\",\"Apocalypse\":\"REV\"};\n    const code = bookCodes[selectedBook]; if (!code) return alert(\"Livre non reconnu pour YouVersion\");\n    let url = `https://www.bible.com/fr/bible/63/${code}`;\n    if (selectedChapter !== \"--\") { url += `.${selectedChapter}`; if (selectedVerse !== \"--\") url += `.${selectedVerse}`; }\n    window.open(url, \"_blank\");\n  };\n\n  const handleReset = () => {\n    saveCurrentStudy();\n    setSelectedBook(\"--\"); setSelectedChapter(\"--\"); setSelectedVerse(\"--\");\n    setSelectedVersion(\"LSG\"); setSelectedLength(500); setActiveRubrique(0);\n    setContent(\"\"); setRubriquesStatus({});\n    setProgressiveStats(null);\n    // Note: Les notes personnelles ne sont jamais effaces lors du reset\n  };\n\n  // Fonctions pour les notes persistantes\n  const handleNotesClick = () => {\n    navigateToNotes();\n  };\n\n  // SUPPRIM : showNotesModal et fonctions de modal - remplaces par page ddie\n\n  // SUPPRIM : handleCloseNotes - plus besoin avec page ddie\n\n  // Fonctions pour la navigation\n  const navigateToConcordance = () => {\n    setCurrentPage('concordance');\n  };\n\n  const navigateToVersets = (content, bookInfo) => {\n    setVersetPageContent(content);\n    setCurrentBookInfo(bookInfo);\n    setCurrentPage('versets');\n  };\n\n  const navigateToNotes = () => {\n    setCurrentPage('notes');\n  };\n\n  const navigateToRubrique = (rubriqueNumber, content = '') => {\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Rubrique ${rubriqueNumber}:`);\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Content reu:`, content ? content.length : 0, \"caractres\");\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Content preview:`, content ? content.slice(0, 100) + \"...\" : \"VIDE\");\n    \n    setCurrentRubriqueNumber(rubriqueNumber);\n    setCurrentRubriqueContent(content);\n    const bookInfo = `${selectedBook || 'Gense'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n    setCurrentBookInfo(bookInfo);\n    setCurrentPage('rubrique');\n  };\n\n  const navigateToMain = () => {\n    setCurrentPage('main');\n  };\n\n  const continueVerses = async () => {\n    try {\n      setIsLoading(true);\n      \n      const book = selectedBook || 'Gense';\n      const chapter = selectedChapter || '1';\n      const passage = `${book} ${chapter}`;\n      const startVerse = currentVerseCount + 1;\n      const endVerse = currentVerseCount + 5;\n      \n      console.log(`[CONTINUE VERSETS] Gnration versets ${startVerse}  ${endVerse} pour ${passage}`);\n      \n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      \n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          passage: `${passage}:${startVerse}-${endVerse}`,\n          version: selectedVersion || 'LSG',\n          tokens: parseInt(selectedLength) || 500,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Erreur API: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.content) {\n        const currentContent = content;\n        const newContent = postProcessMarkdown(data.content);\n        const formattedNewContent = formatContent(newContent, 'versets-prog');\n        \n        // Ajouter le nouveau contenu au contenu existant\n        setContent(currentContent + '\\n\\n' + formattedNewContent);\n        setCurrentVerseCount(endVerse);\n        \n        // Vrifier s'il y a encore des versets  gnrer\n        if (endVerse >= 31) { // Gense 1 a 31 versets\n          setCanContinueVerses(false);\n        }\n        \n        console.log(`[SUCCESS] Versets ${startVerse}-${endVerse} ajouts avec succs`);\n      }\n      \n    } catch (error) {\n      console.error('[ERROR] Erreur continuation versets:', error);\n      setContent(prev => prev + '\\n\\n Erreur lors de la gnration des versets suivants');\n    }\n    \n    setIsLoading(false);\n  };\n\n  const handleRubriqueSelect = async (id) => {\n    setActiveRubrique(id);\n    \n    // Crer une cl unique pour cette combinaison livre/chapitre\n    const contentKey = `${selectedBook}_${selectedChapter}_${id}`;\n    \n    // Si la rubrique est dj gnre, afficher le contenu\n    if (rubriquesStatus[id] === \"completed\" && generatedRubriques[contentKey]) {\n      console.log(`[AFFICHAGE RUBRIQUE ${id}] Contenu sauvegard trouv - longueur: ${generatedRubriques[contentKey].length}`);\n      \n      // Si rubrique 0 et qu'il y a du contenu verset par verset, naviguer vers la page verset ddie\n      if (id === 0 && (generatedRubriques[contentKey].includes('VERSET') || generatedRubriques[contentKey].includes('**TEXTE BIBLIQUE'))) {\n        const bookInfo = `${selectedBook || 'Gense'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n        navigateToVersets(generatedRubriques[contentKey], bookInfo);\n      }\n      // Si rubrique 1-28, naviguer vers la page rubrique ddie avec le contenu existant\n      else if (id >= 1 && id <= 28) {\n        console.log(`[NAVIGATION RUBRIQUE ${id}] Avec contenu existant`);\n        navigateToRubrique(id, generatedRubriques[contentKey]);\n      }\n      else {\n        setContent(generatedRubriques[contentKey]);\n      }\n    } else if (id >= 1 && id <= 28) {\n      // Gnrer la rubrique  la demande ET naviguer vers sa page ddie\n      console.log(`[GNRATION REQUISE] Rubrique ${id} non trouve dans le cache`);\n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook || 'Gense'} ${selectedChapter || '1'}`\n        : `${selectedBook || 'Gense'} ${selectedChapter || '1'}:${selectedVerse}`;\n      const generatedContent = await generateSingleRubrique(id, BASE_RUBRIQUES[id], passage);\n      \n      // Aprs gnration, naviguer vers la page de rubrique avec le contenu gnr\n      navigateToRubrique(id, generatedContent || '');\n    } else if (id === 0) {\n      // Rubrique 0 utilise VERSETS PROG - ne pas interfrer\n      setContent(\"\");\n    } else {\n      setContent(\"\");\n    }\n  };\n\n  // Fonction pour gnrer une rubrique  la demande\n  const generateRubriqueOnDemand = async (rubriqueNum) => {\n    if (rubriqueNum === 0) return; // Rubrique 0 utilise VERSETS PROG\n    \n    const rubriqueTitle = BASE_RUBRIQUES[rubriqueNum];\n    const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n      ? `${selectedBook || 'Gense'} ${selectedChapter || '1'}`\n      : `${selectedBook || 'Gense'} ${selectedChapter || '1'}:${selectedVerse}`;\n    \n    try {\n      console.log(`[GNRATION  LA DEMANDE] Rubrique ${rubriqueNum}: ${rubriqueTitle}`);\n      \n      setIsLoading(true);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"in-progress\" }));\n      \n      // Afficher le contenu en cours de gnration\n      const contentEnCours = `# tude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n Gnration intelligente en cours...`;\n      setContent(formatContent(contentEnCours));\n      \n      // Gnrer le contenu intelligent pour cette rubrique\n      const rubriqueContent = generateRubriqueContent(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      \n      // Dlai pour effet visuel\n      await wait(1000);\n      \n      // Afficher le contenu final\n      const contentFinal = `# tude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n${rubriqueContent}`;\n      const formattedContent = formatContent(contentFinal);\n      setContent(formattedContent);\n      \n      // Sauvegarder le contenu dans l'tat (plus fiable que localStorage)\n      const contentKey = `${selectedBook}_${selectedChapter}_${rubriqueNum}`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: formattedContent\n      }));\n      \n      // Marquer comme termin\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"completed\" }));\n      \n      console.log(`[RUBRIQUE ${rubriqueNum} GNRE] ${rubriqueContent.length} caractres`);\n      \n    } catch (error) {\n      console.error(`[ERREUR GNRATION RUBRIQUE ${rubriqueNum}]`, error);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"error\" }));\n      setContent(`# Erreur\\n\\nErreur lors de la gnration de la rubrique ${rubriqueNum}: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Palette (reprend ta logique initiale)\n  const changePalette = () => {\n    const nextTheme = (currentTheme + 1) % colorThemes.length;\n    setCurrentTheme(nextTheme);\n    const theme = colorThemes[nextTheme];\n\n    const app = document.querySelector('.App');\n    if (app) app.style.background = theme.background;\n\n    const header = document.querySelector('.header-banner');\n    if (header) header.style.background = theme.headerBg;\n\n    document.documentElement.style.setProperty('--theme-primary', `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`);\n    document.documentElement.style.setProperty('--theme-secondary', `linear-gradient(135deg, ${theme.secondary}, ${theme.primary})`);\n    document.documentElement.style.setProperty('--theme-accent', `linear-gradient(135deg, ${theme.accent}, ${theme.secondary})`);\n    \n    // Couleurs pour les ombres\n    const hexToRgba = (hex, alpha) => {\n      const r = parseInt(hex.slice(1, 3), 16);\n      const g = parseInt(hex.slice(3, 5), 16);\n      const b = parseInt(hex.slice(5, 7), 16);\n      return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n    };\n    \n    document.documentElement.style.setProperty('--theme-accent-shadow', hexToRgba(theme.accent, 0.3));\n    document.documentElement.style.setProperty('--theme-accent-shadow-hover', hexToRgba(theme.accent, 0.4));\n\n    const progressPill = document.querySelector('.progress-pill');\n    if (progressPill) progressPill.style.background = theme.primary;\n\n    const contentHeader = document.querySelector('.content-header');\n    if (contentHeader)\n      contentHeader.style.background = `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`;\n\n    const btnReset = document.querySelector('.btn-reset');\n    if (btnReset) { btnReset.style.background = theme.secondary; btnReset.style.color = 'white'; btnReset.style.border = 'none'; }\n\n    const btnPalette = document.querySelector('.btn-palette');\n    if (btnPalette) { btnPalette.style.background = theme.primary; btnPalette.style.color = 'white'; btnPalette.style.border = 'none'; }\n\n    const btnLastStudy = document.querySelector('.btn-last-study');\n    if (btnLastStudy) {\n      btnLastStudy.style.background = `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`;\n      btnLastStudy.style.color = 'white'; btnLastStudy.style.border = 'none';\n    }\n\n    const btnGemini = document.querySelector('.btn-gemini');\n    if (btnGemini) { btnGemini.style.background = `linear-gradient(90deg, ${theme.secondary}, ${theme.accent})`; btnGemini.style.color = 'white'; btnGemini.style.border = 'none'; }\n\n    const btnVersets = document.querySelector('.btn-versets-prog');\n    if (btnVersets) { btnVersets.style.background = theme.accent; btnVersets.style.color = 'white'; btnVersets.style.border = 'none'; }\n\n    const btnGenerate = document.querySelector('.btn-generate');\n    if (btnGenerate) { btnGenerate.style.background = `linear-gradient(45deg, ${theme.primary}, ${theme.secondary})`; btnGenerate.style.color = 'white'; btnGenerate.style.border = 'none'; }\n\n    const btnValidate = document.querySelector('.btn-validate');\n    if (btnValidate) { btnValidate.style.background = theme.primary; btnValidate.style.color = 'white'; btnValidate.style.border = 'none'; }\n  };\n\n  /* =========================\n     Gnration (avec fallbacks)\n  ========================= */\n\n  const generateVerseByVerseProgressive = async () => {\n    console.log(\"[DEBUG] generateVerseByVerseProgressive function called!\");\n    \n    try {\n      setIsLoading(true); setIsProgressiveLoading(true);\n      setContent(\"\"); setProgressPercent(0);\n      setIsVersetsProgContent(true); // Marquer que c'est du contenu VERSETS PROG\n      setRubriquesStatus(p => ({ ...p, 0: \"in-progress\" }));\n      \n      // Format exact requis par l'API Railway\n      const book = selectedBook || 'Gense';\n      const chapter = selectedChapter || '1';\n      const passage = `${book} ${chapter}`;\n      console.log(\"[VERSETS PROG] Gnration progressive pour:\", passage);\n\n      //  UTILISER VOTRE BACKEND avec votre cl Gemini GRATUITE\n      console.log(\"[VERSETS PROG] Utilisation de votre backend avec cl Gemini gratuite\");\n      \n      // CORRECTION: Utiliser la variable d'environnement pour l'endpoint\n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      console.log(\"[VERSETS PROG] URL backend utilise:\", apiUrl);\n      \n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          passage: passage,\n          version: selectedVersion || 'LSG',\n          tokens: parseInt(selectedLength) || 500,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n      \n      if (!response.ok) {\n        console.error(`[VERSETS PROG] Erreur API Railway: ${response.status}`);\n        throw new Error(`API Railway Error ${response.status}`);\n      }\n      \n      const data = await response.json();\n      console.log(\"[API RAILWAY OK] Contenu reu:\", data.content ? data.content.length : 0, \"caractres\");\n      \n      // Afficher des informations sur la source du contenu\n      const sourceInfo = data.source || \"API\";\n      const fromCache = data.from_cache || false;\n      const cost = data.cost || \"Traitement\";\n      \n      console.log(`[SOURCE] ${sourceInfo} ${fromCache ? '(Cache)' : '(Nouveau)'} - ${cost}`);\n      \n      // Afficher un message informatif selon la source\n      if (fromCache) {\n        console.log(\" Contenu rcupr du cache - rponse instantane\");\n      } else if (sourceInfo.includes(\"Fallback\") || sourceInfo.includes(\"thologique\")) {\n        console.log(\" Quota Gemini atteint - utilisation du systme de fallback intelligent\");\n      } else if (sourceInfo.includes(\"Gemini\")) {\n        console.log(\" Contenu gnr par Gemini avec votre cl personnelle\");\n      }\n      \n      // Utiliser le contenu de l'API (correction du bug d'affichage)\n      if (!data.content) {\n        throw new Error(\"Aucun contenu reu de l'API\");\n      }\n      \n      const fullContent = data.content;\n      \n      // Initialiser les tats de continuation\n      setCurrentVerseCount(5); // Par dfaut, on gnre 5 versets\n      setCanContinueVerses(true); // Permettre la continuation\n      \n      // Affichage immdiat du contenu optimis avec boutons Gemini\n      const finalContent = postProcessMarkdown(fullContent);\n      setContent(formatContent(finalContent, 'versets-prog'));\n      setProgressPercent(100);\n      setRubriquesStatus(p => ({ ...p, 0: \"completed\" }));\n      setIsVersetsProgContent(true); // IMPORTANT : activer l'tat VERSETS PROG\n      console.log(\"[SUCCESS] Contenu VERSETS PROG affich correctement\");\n      \n      // Sauvegarder l'tude aprs gnration russie\n      saveCurrentStudy();\n      console.log(\"[SAUVEGARDE] tude verset par verset sauvegarde\");\n      \n      // Sauvegarder le contenu dans generatedRubriques pour la navigation\n      const contentKey = `${selectedBook || 'Gense'}_${selectedChapter || '1'}_0`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: fullContent\n      }));\n      \n      // Naviguer automatiquement vers la page ddie \"Verset par Verset\"\n      const bookInfo = `${selectedBook || 'Gense'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n      console.log(\"[NAVIGATION] Prparation navigation vers page Verset par Verset:\", bookInfo);\n      setTimeout(() => {\n        console.log(\"[NAVIGATION] Navigation vers la page ddie Verset par Verset\");\n        navigateToVersets(fullContent, bookInfo);\n      }, 500); // Petit dlai pour l'effet visuel\n      \n    } catch (err) {\n      console.error(\"Erreur gnration VERSETS PROG:\", err);\n      setContent(`Erreur lors de la gnration progressive: ${err.message}`);\n      setRubriquesStatus(p => ({ ...p, 0: \"error\" }));\n    } finally {\n      setIsLoading(false); setIsProgressiveLoading(false);\n      setProgressPercent(100);\n    }\n  };\n\n  const generateWithGemini = async () => {\n    try {\n      setIsLoading(true); \n      setContent(\"Enrichissement thologique avec votre Gemini gratuit en cours...\");\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"in-progress\" }));\n\n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook} ${selectedChapter}`\n        : `${selectedBook} ${selectedChapter}:${selectedVerse}`;\n\n      // Enrichir thologiquement avec votre cl Gemini gratuite\n      if (activeRubrique >= 1 && activeRubrique <= 28) {\n        const rubriqueTitle = BASE_RUBRIQUES[activeRubrique];\n        \n        // Gnrer un enrichissement thologique avec longueur augmente\n        const enrichedLength = Math.min(2000, parseInt(selectedLength) + 500);\n        console.log(`[ENRICHISSEMENT GEMINI GRATUIT] Rubrique ${activeRubrique} - Longueur enrichie: ${enrichedLength} caractres`);\n        \n        // Appeler votre backend avec votre cl Gemini gratuite\n        const response = await fetch(`${API_BASE}/generate-verse-by-verse`, {\n          method: 'POST',\n          headers: { \n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            passage: passage,\n            version: selectedVersion || 'LSG',\n            tokens: enrichedLength,\n            use_gemini: true,\n            enriched: true,\n            rubric_type: rubriqueTitle\n          })\n        });\n\n        if (!response.ok) {\n          throw new Error(`Erreur API: ${response.status}`);\n        }\n\n        const data = await response.json();\n        console.log(\"[GEMINI GRATUIT] Enrichissement reu:\", data.content ? data.content.length : 0, \"caractres\");\n\n        if (data.content) {\n          // Afficher le contenu enrichi avec votre Gemini gratuit\n          const finalContent = `# tude Enrichie avec Gemini Gratuit - ${passage}\\n\\n## ${activeRubrique}. ${rubriqueTitle}\\n\\n${data.content}`;\n          setContent(formatContent(finalContent));\n          \n          // Sauvegarder le contenu enrichi\n          const contentKey = `${selectedBook}_${selectedChapter}_${activeRubrique}`;\n          setGeneratedRubriques(prev => ({\n            ...prev,\n            [contentKey]: formatContent(finalContent)\n          }));\n          \n          console.log(\"[SUCCESS] Enrichissement Gemini gratuit affich correctement\");\n          \n          // Sauvegarder l'tude aprs enrichissement russi\n          saveCurrentStudy();\n          console.log(\"[SAUVEGARDE] tude enrichie Gemini sauvegarde\");\n        } else {\n          throw new Error(\"Pas de contenu reu de votre Gemini gratuit\");\n        }\n        \n      } else if (activeRubrique === 0) {\n        // Pour la rubrique 0, utiliser VERSETS PROG qui utilise dj votre Gemini\n        setContent(\" Pour la rubrique 0, utilisez le bouton 'VERSETS PROG' qui utilise dj votre Gemini gratuit.\");\n      } else {\n        setContent(\" Rubrique non supporte pour l'enrichissement Gemini.\");\n      }\n\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"completed\" }));\n    } catch (err) {\n      console.error(\"Erreur enrichissement Gemini gratuit:\", err);\n      setContent(`Erreur enrichissement avec votre Gemini gratuit: ${err.message}`);\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"error\" }));\n    } finally { \n      setIsLoading(false); \n    }\n  };\n\n  // Fonction pour enrichissement thologique contextuel et intelligent\n  const generateTheologicalEnrichment = (rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength) => {\n    const baseContent = generateRubriqueContent(rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength);\n    \n    // Enrichissement spcifique selon le livre biblique\n    const bookEnrichment = getBookSpecificEnrichment(book, chapter);\n    \n    // Enrichissement spcifique selon la rubrique\n    const rubriqueEnrichment = getRubriqueSpecificEnrichment(rubriqueNum, rubriqueTitle);\n    \n    // Enrichissement contextuel combin\n    const contextualEnrichment = getCombinedContextualEnrichment(book, chapter, rubriqueNum, passage);\n    \n    const enrichmentSuffix = `\n\n** ENRICHISSEMENT CONTEXTUEL - ${passage}**\n\n${bookEnrichment}\n\n${rubriqueEnrichment}\n\n${contextualEnrichment}\n\n*Enrichissement gnr par analyse contextuelle approfondie*`;\n\n    return baseContent + enrichmentSuffix.substring(0, Math.max(0, targetLength - baseContent.length));\n  };\n\n  // Enrichissement spcifique par livre biblique\n  const getBookSpecificEnrichment = (book, chapter) => {\n    const bookEnrichments = {\n      'Gense': `**Perspective crationnelle :** ${book} ${chapter} s'inscrit dans le cadre de la thologie de la cration. Les commentateurs patristiques, notamment Basile de Csare dans ses Homlies sur l'Hexamron, ont dvelopp une exgse remarquable de ces passages fondateurs.`,\n      \n      'Exode': `**Perspective libratrice :** ${book} ${chapter} rvle la pdagogie divine de la rdemption. Philon d'Alexandrie et plus tard l'cole de thologie d'Antioche ont soulign les dimensions typologiques de ce rcit qui prfigure la libration spirituelle en Christ.`,\n      \n      'Lvitique': `**Perspective sacrificielle :** ${book} ${chapter} dveloppe la thologie cultuelle et sacrificielle. Les thologiens de l'Alliance (Cocceius, Witsius) ont magistralement dmontr comment ces prescriptions rituelles trouvent leur accomplissement dans l'uvre sacerdotale du Christ.`,\n      \n      'Nombres': `**Perspective plerine :** ${book} ${chapter} illustre la marche du peuple de Dieu vers la Terre Promise. John Bunyan dans \"The Pilgrim's Progress\" s'inspire de ces rcits pour dcrire le plerinage spirituel du chrtien.`,\n      \n      'Deutronome': `**Perspective testamentaire :** ${book} ${chapter} constitue le testament mosaque. Les thologiens de l'cole de Saumur (Amyraut, Cappel) ont analys la structure alliance-bndiction-maldiction qui structure ce livre.`,\n      \n      'Matthieu': `**Perspective messianique :** ${book} ${chapter} rvle l'accomplissement des promesses vtrotestamentaires. Chrysostome dans ses Homlies sur Matthieu dveloppe une christologie remarquable base sur ce texte vanglique.`,\n      \n      'Marc': `**Perspective krygmatique :** ${book} ${chapter} prsente le Christ en action. L'exgse moderne (Dodd, Jeremias) a soulign la dimension krygmatique primitive de ce rcit vanglique.`,\n      \n      'Luc': `**Perspective historico-salvifique :** ${book} ${chapter} s'inscrit dans l'histoire du salut. Conzelmann et l'cole de Tbingen ont dvelopp une thologie lucanienne de l'histoire sainte particulirement clairante.`,\n      \n      'Jean': `**Perspective thologique :** ${book} ${chapter} rvle la divinit du Christ. Les Pres cappadociens (Basile, Grgoire de Nazianze, Grgoire de Nysse) ont utilis ce corpus johannique pour dvelopper la thologie trinitaire.`,\n      \n      'Romains': `**Perspective sotriologique :** ${book} ${chapter} dveloppe la doctrine du salut par grce. Augustin, Luther, et Calvin ont fond leur thologie de la justification sur cette ptre magistrale.`,\n      \n      'Hbreux': `**Perspective sacerdotale :** ${book} ${chapter} prsente le sacerdoce parfait du Christ. Owen dans son commentaire monumental a dvelopp une thologie sacrificielle d'une profondeur ingale.`\n    };\n    \n    return bookEnrichments[book] || `**Perspective biblique :** Ce passage de ${book} ${chapter} rvle des dimensions thologiques que les commentateurs anciens et modernes ont explores avec profit.`;\n  };\n\n  // Enrichissement spcifique par rubrique\n  const getRubriqueSpecificEnrichment = (rubriqueNum, rubriqueTitle) => {\n    const rubriqueEnrichments = {\n      1: `**Enrichissement liturgique :** La tradition de la \"prire d'ouverture\" remonte aux Pres du dsert. Jean Cassien dans ses Confrences spirituelles enseigne l'importance de l'invocation pralable pour toute lectio divina authentique.`,\n      \n      2: `**Enrichissement littraire :** L'analyse structurelle moderne (rhtorique smitique, Meynet) rvle des patterns sophistiqus que l'exgse ancienne pressentait intuitivement. Cette approche enrichit considrablement la comprhension du texte.`,\n      \n      5: `**Enrichissement dogmatique :** Les fondements thologiques tablis ici nourrissent la thologie systmatique. Turretin dans ses Institutes of Elenctic Theology dveloppe ces vrits avec une rigueur scolastique remarquable.`,\n      \n      15: `**Enrichissement christologique :** La lecture christocentrique trouve ici ses fondements hermneutiques. Vos dans sa Biblical Theology dveloppe une approche christotlique qui claire remarquablement ce passage.`,\n      \n      16: `**Enrichissement sotriologique :** La doctrine de la grce rvle ici constitue le cur de l'vangile. Les thologiens de Dordrecht ont systematis ces vrits dans les Canons qui demeurent normatifs.`\n    };\n    \n    return rubriqueEnrichments[rubriqueNum] || `**Enrichissement thmatique :** Cette rubrique \"${rubriqueTitle}\" ouvre des perspectives thologiques que la tradition exgtique a particulirement dveloppes.`;\n  };\n\n  // Enrichissement contextuel combin\n  const getCombinedContextualEnrichment = (book, chapter, rubriqueNum, passage) => {\n    // Logique contextuelle sophistique combinant livre + rubrique\n    if (book === 'Gense' && rubriqueNum === 1) {\n      return `**Synthse contextuelle :** La prire d'ouverture sur Gense ${chapter} nous place dans la contemplation de l'uvre cratrice primordiale. Basile le Grand souligne que cette mditation doit commencer par l'adoration du Crateur avant l'analyse de la cration.`;\n    }\n    \n    if (book === 'Gense' && rubriqueNum === 15) {\n      return `**Synthse christologique :** Christ prsent ds Gense ${chapter} selon l'exgse patristique. Justin Martyr dans son Dialogue avec Tryphon identifie le Logos aux thophanies primitives, perspective reprise par la tradition rforme.`;\n    }\n    \n    if (book === 'Matthieu' && rubriqueNum === 16) {\n      return `**Synthse vanglique :** L'vangile de la grce rvl en Matthieu ${chapter} accomplit les promesses vtrotestamentaires. Cette continuit rdemptrice structure toute la thologie de l'alliance selon la tradition rforme (Westminster Confession).`;\n    }\n    \n    if ((book === 'Lvitique' || book === 'Hbreux') && rubriqueNum === 15) {\n      return `**Synthse typologique :** Le systme sacrificiel de ${book} ${chapter} trouve son accomplissement parfait dans l'uvre sacerdotale du Christ. Cette typologie biblique, dveloppe par l'cole d'Antioche, rvle l'unit de l'histoire sainte.`;\n    }\n    \n    return `**Synthse thologique :** L'intersection entre ${book} ${chapter} et cette dimension thologique rvle des vrits que l'exgse traditionnelle a particulirement valorises dans l'dification de l'glise.`;\n  };\n\n  const generate28Points = async () => {\n    try {\n      setIsLoading(true);\n      setIsVersetsProgContent(false); // Dsactiver le style VERSETS PROG\n      \n      //  TAPE 1: Vider la rubrique 0 et passer sa LED au gris\n      setRubriquesStatus(p => ({ ...p, 0: \"inactive\" })); // LED grise pour rubrique 0\n      setContent(\"\"); // Vider le contenu affich\n      \n      console.log(\"[GNRATION RUBRIQUE PAR RUBRIQUE] Dbut avec Prire d'ouverture\");\n      \n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook || 'Gense'} ${selectedChapter || '1'}`\n        : `${selectedBook || 'Gense'} ${selectedChapter || '1'}:${selectedVerse}`;\n\n      //  STRATGIE OPTIMISE: Rubrique 1 d'abord, puis les autres\n      console.log(\"[GNRATION OPTIMISE] Gnration immdiate de la Rubrique 1, puis les autres en arrire-plan\");\n      \n      //  PHASE 1: Gnrer et naviguer vers Rubrique 1 immdiatement\n      console.log(\"[PHASE 1] Gnration et navigation immdiate vers Rubrique 1 - Prire d'ouverture\");\n      \n      try {\n        // Gnrer la Rubrique 1 avec un appel API direct plus rapide\n        const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/generate-study`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            passage: passage,\n            version: selectedVersion || 'LSG',\n            tokens: 500, // Plus court pour plus de rapidit\n            selected_rubriques: [1], // Rubrique 1 uniquement\n            use_gemini: true\n          })\n        });\n        \n        if (response.ok) {\n          const data = await response.json();\n          const rubrique1Content = data.content || '';\n          \n          console.log(`[NAVIGATION IMMDIATE] Rubrique 1 gnre: ${rubrique1Content.length} caractres`);\n          console.log(`[CONTENU PREVIEW]`, rubrique1Content.slice(0, 100) + \"...\");\n          \n          // Sauvegarder le contenu dans l'tat\n          const contentKey = `${selectedBook}_${selectedChapter}_1`;\n          setGeneratedRubriques(prev => ({ ...prev, [contentKey]: rubrique1Content }));\n          setRubriquesStatus(p => ({ ...p, 1: \"completed\" }));\n          \n          // Navigation immdiate avec le contenu frais\n          navigateToRubrique(1, rubrique1Content);\n          setProgressPercent(4); // 1/28  4%\n          \n        } else {\n          console.error(\"[API ERREUR] Impossible de gnrer la Rubrique 1\");\n          throw new Error(\"API call failed\");\n        }\n        \n      } catch (error) {\n        console.error(\"[ERREUR PHASE 1]\", error);\n        // Fallback: utiliser la gnration normale\n        const rubrique1Content = await generateSingleRubrique(1, BASE_RUBRIQUES[1], passage);\n        if (rubrique1Content) {\n          navigateToRubrique(1, rubrique1Content);\n          setProgressPercent(4);\n        }\n      }\n      \n      //  PHASE 2: Gnrer les 27 autres rubriques en arrire-plan\n      console.log(\"[PHASE 2] Gnration des 27 autres rubriques en arrire-plan\");\n      \n      // Gnrer les rubriques restantes par lots de 5\n      const generateRemainingRubriques = async () => {\n        const batchSize = 5;\n        for (let i = 2; i <= 28; i += batchSize) {\n          const batch = [];\n          const endIndex = Math.min(i + batchSize - 1, 28);\n          \n          console.log(`[ARRIRE-PLAN] Gnration rubriques ${i}  ${endIndex}`);\n          \n          for (let j = i; j <= endIndex; j++) {\n            if (j <= BASE_RUBRIQUES.length - 1) {\n              const rubriqueTitle = BASE_RUBRIQUES[j];\n              batch.push(generateSingleRubrique(j, rubriqueTitle, passage));\n            }\n          }\n          \n          await Promise.all(batch);\n          \n          // Mettre  jour le progrs\n          const progress = Math.floor((endIndex / 28) * 100);\n          setProgressPercent(progress);\n          console.log(`[ARRIRE-PLAN] ${endIndex}/28 rubriques gnres (${progress}%)`);\n          \n          // Petit dlai entre les batches\n          if (endIndex < 28) {\n            await new Promise(resolve => setTimeout(resolve, 1000));\n          }\n        }\n      };\n      \n      // Lancer la gnration en arrire-plan (non-bloquante)\n      generateRemainingRubriques().then(() => {\n        console.log(\"[ARRIRE-PLAN] Toutes les rubriques termines!\");\n        setProgressPercent(100);\n      }).catch((error) => {\n        console.error(\"[ARRIRE-PLAN] Erreur:\", error);\n      });\n      \n      console.log(\"[GNRATION AUTOMATIQUE] Toutes les 28 rubriques gnres!\");\n      \n      // Sauvegarder l'tude aprs gnration russie\n      saveCurrentStudy();\n      console.log(\"[SAUVEGARDE] tude complte des 28 rubriques sauvegarde\");\n      \n    } catch (error) {\n      console.error(\"[ERREUR GNRATION]\", error);\n      setContent(formatContent(`# Erreur\\n\\nUne erreur est survenue lors de la gnration : ${error.message}`));\n    } finally {\n      setIsLoading(false);\n      setProgressPercent(100);\n    }\n  };\n\n  // Nouvelle fonction pour gnrer UNE SEULE rubrique\n  const generateSingleRubrique = async (rubriqueNum, rubriqueTitle, passage) => {\n    try {\n      console.log(`[GNRATION RUBRIQUE ${rubriqueNum}] DEMANDE: \"${rubriqueTitle}\" pour ${passage}`);\n      console.log(`[DEBUG PARAMS] rubriqueNum=${rubriqueNum}, rubriqueTitle=\"${rubriqueTitle}\", passage=\"${passage}\"`);\n      \n      // Marquer la rubrique en cours\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"in-progress\" }));\n      setProgressPercent(20);\n      \n      // Afficher le titre en attente\n      const contentEnCours = `# tude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n Gnration intelligente en cours...`;\n      setContent(formatContent(contentEnCours));\n      \n      // Appel API LOCAL pour CETTE rubrique avec notre systme Gemini intelligent\n      const apiUrl = `${API_BASE}/generate-study`;\n      \n      let rubriqueContent;\n      \n      try {\n        setProgressPercent(50);\n        \n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            passage: passage,\n            version: selectedVersion || 'LSG',\n            tokens: selectedLength || 1000,\n            selected_rubriques: [rubriqueNum], // Cette rubrique spcifiquement\n            use_gemini: true\n          })\n        });\n        \n        if (!response.ok) {\n          throw new Error(`API Error: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        console.log(`[API SUCCESS RUBRIQUE ${rubriqueNum}]`, data.content ? data.content.length : 0, \"caractres\");\n        console.log(`[API DATA FULL CONTENT]`, data.content); // Debug pour voir le contenu complet\n        \n        // Parser pour extraire SEULEMENT cette rubrique\n        const rubriques = parseRubriquesContent(data.content || \"\");\n        console.log(`[PARSING] Rubriques extraites:`, Object.keys(rubriques).length, \"rubriques trouves\");\n        console.log(`[PARSING] Cls disponibles:`, Object.keys(rubriques));\n        rubriqueContent = rubriques[rubriqueNum];\n        console.log(`[PARSING] Contenu rubrique ${rubriqueNum}:`, rubriqueContent ? rubriqueContent.slice(0, 100) + \"...\" : \"VIDE\");\n        \n        // Debug: Afficher TOUTES les rubriques disponibles\n        console.log(`[DEBUG TOUTES RUBRIQUES] Contenu disponible:`);\n        Object.keys(rubriques).forEach(key => {\n          console.log(`  Rubrique ${key}: ${rubriques[key] ? rubriques[key].slice(0, 50) + \"...\" : \"VIDE\"}`);\n        });\n        \n        // Si pas trouv, utiliser le contenu complet pour cette rubrique\n        if (!rubriqueContent && data.content) {\n          console.log(`[FALLBACK PARSING] Utilisation du contenu complet pour rubrique ${rubriqueNum}`);\n          rubriqueContent = data.content;\n        }\n        \n      } catch (apiError) {\n        console.error(`[API CHEC RUBRIQUE ${rubriqueNum}] ${apiError.message}`, apiError);\n        console.warn(`[FALLBACK] Utilisation generateRubriqueContent pour rubrique ${rubriqueNum}`);\n        // Fallback avec contenu intelligent spcifique\n        rubriqueContent = generateRubriqueContent(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      }\n      \n      setProgressPercent(80);\n      \n      // Si pas de contenu spcifique, utiliser le gnrateur intelligent\n      if (!rubriqueContent || rubriqueContent.length < 50) {\n        rubriqueContent = generateRubriqueContent(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      }\n      \n      // Afficher le contenu final\n      const contentFinal = `# tude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n${rubriqueContent}`;\n      const formattedContent = formatContent(contentFinal);\n      setContent(formattedContent);\n      \n      // Sauvegarder dans l'tat pour la fonction generateSingleRubrique aussi\n      const contentKey = `${selectedBook}_${selectedChapter}_${rubriqueNum}`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: formattedContent\n      }));\n      \n      // Marquer comme termin\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"completed\" }));\n      setProgressPercent(100);\n      \n      console.log(`[RUBRIQUE ${rubriqueNum} TERMINE] ${rubriqueContent.length} caractres gnrs`);\n      \n      // Debug: Vrifier le contenu avant de le retourner\n      console.log(`[GENERATE SINGLE DEBUG] Rubrique ${rubriqueNum} contenu final:`, formattedContent ? formattedContent.length : 0, \"caractres\");\n      console.log(`[GENERATE SINGLE DEBUG] Contenu preview:`, formattedContent ? formattedContent.slice(0, 200) + \"...\" : \"VIDE\");\n      \n      // Retourner le contenu format pour utilisation ultrieure\n      return formattedContent;\n      \n    } catch (error) {\n      console.error(`[ERREUR RUBRIQUE ${rubriqueNum}]`, error);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"error\" }));\n      throw error;\n    }\n  };\n\n  /* =========================\n     Formatage du contenu\n  ========================= */\n\n  const formatContent = (text, context = 'default') => {\n    if (!text) return \"\";\n    \n    // Formatage avec contexte pour VERSETS PROG\n    let formattedText = text\n      // D'abord transformer les labels spcifiques - REGEX LARGIES pour matcher diffrents formats\n      .replace(/^\\*\\*VERSET (\\d+)\\*\\*$/gim, \"<h2 class='verset-header'> VERSET $1</h2>\")\n      .replace(/^VERSE\\s*T(\\d+)$/gim, \"<h2 class='verset-header'> VERSET $1</h2>\")  // Format preview\n      .replace(/^VERSET\\s*(\\d+)$/gim, \"<h2 class='verset-header'> VERSET $1</h2>\")    // Format alternatif\n      .replace(/^\\*\\*TEXTE BIBLIQUE\\s*:\\*\\*$/gim, \"<h4 class='texte-biblique-label'> TEXTE BIBLIQUE :</h4>\")\n      .replace(/^TEXTE BIBLIQUE\\s*:?$/gim, \"<h4 class='texte-biblique-label'> TEXTE BIBLIQUE :</h4>\")  // Format preview\n      .replace(/^\\*\\*EXPLICATION THOLOGIQUE\\s*:\\*\\*$/gim, \"<h4 class='explication-label'> EXPLICATION THOLOGIQUE :</h4>\")\n      .replace(/^EXPLICATION THOLOGIQUE\\s*:?$/gim, \"<h4 class='explication-label'> EXPLICATION THOLOGIQUE :</h4>\")  // Format preview\n      // Puis transformer les autres lments en gras gnriques\n      .replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\")\n      .replace(/^\\# (.*$)/gim, \"<h1>$1</h1>\")\n      .replace(/^\\## (.*$)/gim, \"<h2>$1</h2>\")\n      .replace(/^\\### (.*$)/gim, \"<h3>$1</h3>\")\n      .split(\"\\n\\n\")\n      .map(p => (p.trim() ? `<p>${p.replace(/\\n/g, \"<br>\")}</p>` : \"\"))\n      .join(\"\");\n\n    // Appliquer la transformation des rfrences bibliques\n    formattedText = transformBibleReferences(formattedText);\n\n    // Wrapper spcial pour le contexte VERSETS PROG\n    if (context === 'versets-prog') {\n      return `<div class=\"versets-prog-content\">${formattedText}</div>`;\n    }\n    \n    return formattedText;\n  };\n\n  const formatVerseByVerseContent = (text) => {\n    const sections = text.split(/VERSET (\\d+)/);\n    let html = '<div class=\"verse-study-container\">';\n\n    if (sections[0]) {\n      const intro = sections[0]\n        .replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\")\n        .replace(/^\\### (.*$)/gim, \"<h3>$1</h3>\")\n        .replace(/^\\## (.*$)/gim, \"<h2>$1</h2>\")\n        .replace(/^\\# (.*$)/gim, \"<h1>$1</h1>\");\n      html += `<div style=\"margin-bottom: 30px;\">${intro.replace(/\\n/g, \"<br>\")}</div>`;\n    }\n\n    for (let i = 1; i < sections.length; i += 2) {\n      const verseNumber = sections[i];\n      const block = sections[i + 1];\n\n      if (block) {\n        html += `<div class=\"verse-block\">\n          <div class=\"verse-header\">VERSET ${verseNumber}</div>`;\n\n        const parts = block.split(/TEXTE BIBLIQUE\\s*:/);\n        if (parts.length > 1) {\n          const afterBiblical = parts[1].split(/EXPLICATION THOLOGIQUE\\s*:/);\n          const biblicalText = (afterBiblical[0] || \"\").trim();\n          const theologicalExplanation = afterBiblical[1] ? afterBiblical[1].trim() : \"\";\n\n          html += `\n            <div class=\"section-label biblical-label\"> TEXTE BIBLIQUE</div>\n            <div class=\"biblical-text\">${biblicalText.replace(/\\n/g, \"<br>\")}</div>`;\n\n          if (theologicalExplanation) {\n            html += `\n              <div class=\"section-label theological-label\"> EXPLICATION THOLOGIQUE</div>\n              <div class=\"theological-explanation\">${theologicalExplanation.replace(/\\n/g, \"<br>\")}</div>`;\n          }\n        }\n\n        html += \"</div>\";\n      }\n    }\n\n    html += \"</div>\";\n    return html;\n  };\n\n  /* =========================\n     Rendu (UI intacte)\n  ========================= */\n\n  return (\n    <div className=\"App\">\n      {currentPage === 'concordance' ? (\n        <BibleConcordancePage onGoBack={navigateToMain} />\n      ) : currentPage === 'versets' ? (\n        <VersetParVersetPage \n          onGoBack={navigateToMain} \n          content={versetPageContent}\n          bookInfo={currentBookInfo}\n        />\n      ) : currentPage === 'notes' ? (\n        <NotesPage onGoBack={navigateToMain} />\n      ) : currentPage === 'rubrique' ? (\n        <RubriquePage \n          onGoBack={navigateToMain}\n          rubriqueNumber={currentRubriqueNumber}\n          rubriqueTitle={getRubTitle(currentRubriqueNumber)}\n          content={currentRubriqueContent}\n          bookInfo={currentBookInfo}\n          onNavigateToRubrique={(newRubriqueNumber) => {\n            // Navigation entre rubriques depuis la page de rubrique\n            const contentKey = `${selectedBook}_${selectedChapter}_${newRubriqueNumber}`;\n            const content = generatedRubriques[contentKey] || '';\n            navigateToRubrique(newRubriqueNumber, content);\n          }}\n          // Nouvelles props pour les boutons fonctionnels\n          selectedBook={selectedBook}\n          selectedChapter={selectedChapter}\n          selectedVerse={selectedVerse}\n          selectedLength={selectedLength}\n          setCurrentPage={setCurrentPage}\n          API_BASE={API_BASE}\n          setContent={setContent}\n          setRubriquesStatus={setRubriquesStatus}\n          setIsLoading={setIsLoading}\n          isLoading={isLoading}\n          BASE_RUBRIQUES={BASE_RUBRIQUES}\n        />\n      ) : (\n        <>\n          {/* Header avec texte dfilant */}\n          <header className=\"header-banner\">\n            <div className=\"scroll-text\">\n               MDITATION BIBLIQUE  TUDE SPIRITUELLE  SAGESSE DIVINE  MDITATION THOLOGIQUE  CONTEMPLATION SACRE  RFLEXION INSPIRE \n            </div>\n          </header>\n\n          {/* Indicateur de progression centr */}\n          <div className=\"progress-container\">\n            <div className=\"progress-pill\">\n              {progressPercent}%\n              {isProgressiveLoading && progressiveStats && (\n                <span className=\"progressive-indicator\">\n                   {progressiveStats.speed} - {progressiveStats.current_batch} ({progressiveStats.processed}/{progressiveStats.total})\n                </span>\n              )}\n            </div>\n          </div>\n\n          {/* Interface principale */}\n          <div className=\"main-container\">\n            {/* Section de recherche */}\n            <div className=\"search-section\">\n              <div className=\"search-input\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Rechercher (ex : Marc 5:1, 1 Jean 2, Gense 1:1-5)\"\n                  className=\"search-field\"\n                  value={searchQuery}\n                  onChange={handleSearchChange}\n                />\n              </div>\n\n              <div className=\"controls-row\">\n                <SelectPill label=\"Livre\" value={selectedBook} options={[\"--\", ...BOOKS]} onChange={handleBookChange} />\n                <SelectPill label=\"Chapitre\" value={selectedChapter} options={availableChapters} onChange={handleChapterChange} />\n                <SelectPill label=\"Verset\" value={selectedVerse} options={[\"--\", ...Array.from({ length: 50 }, (_, i) => i + 1)]} onChange={handleVerseChange} />\n                <SelectPill label=\"Version\" value={selectedVersion} options={[\"LSG\", \"Darby\", \"NEG\"]} onChange={handleVersionChange} />\n                <button className=\"btn-validate\" disabled={isLoading}>Valider</button>\n                <SelectPill label=\"Longueur\" value={selectedLength} options={[300, 500, 1000, 2000]} onChange={handleLengthChange} />\n                <button className=\"btn-read\" onClick={openYouVersion}>Lire la Bible</button>\n                <button className=\"btn-chat\" onClick={() => window.open('https://chatgpt.com/', '_blank')}>ChatGPT</button>\n                <button className=\"btn-notes\" onClick={handleNotesClick}> Prise de Note</button>\n                <button className=\"btn-concordance\" onClick={navigateToConcordance}> BIBLE DE CONCORDANCE</button>\n              </div>\n\n              {/* Boutons d'action - Design quilibr et soign */}\n              <div className=\"balanced-controls-container\">\n                <div className=\"balanced-buttons-grid\" style={{\n                  display: 'grid',\n                  gridTemplateColumns: 'repeat(6, 1fr)',\n                  gap: '14px',\n                  marginBottom: '24px',\n                  padding: '0 10px',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                }}>\n                  <button className=\"btn-control\" style={getButtonStyle(buttonColors.reset, buttonColors.reset.shadow)} onClick={handleReset}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">Reset</span>\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(buttonColors.mystique, buttonColors.mystique.shadow)} onClick={changePalette}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">{colorThemes[currentTheme].name}</span>\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(buttonColors.genese, buttonColors.genese.shadow)} onClick={restoreLastStudy} disabled={!lastStudy}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">{lastStudy ? `${lastStudy.book} ${lastStudy.chapter}` : \"Gense 1\"}</span>\n                  </button>\n                  \n                  <button className={`btn-control ${isLoading ? \"loading\" : \"\"}`} style={getButtonStyle(buttonColors.gemini, buttonColors.gemini.shadow)} onClick={generateWithGemini} disabled={isLoading}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">Gemini Gratuit</span>\n                    {isLoading && <div className=\"btn-mini-loader\"></div>}\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(buttonColors.versets, buttonColors.versets.shadow)} onClick={generateVerseByVerseProgressive}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">Versets Prog</span>\n                  </button>\n                  \n                  <button className={`btn-control btn-primary ${isLoading ? \"loading\" : \"\"}`} style={getButtonStyle(buttonColors.generate, buttonColors.generate.shadow)} onClick={generate28Points} disabled={isLoading}>\n                    <span className=\"control-icon\"></span>\n                    <span className=\"control-label\">Gnrer</span>\n                    {isLoading && <div className=\"btn-mini-loader\"></div>}\n                  </button>\n                </div>\n                \n                {/* API Control Panel centr en bas */}\n                <div className=\"api-centered\">\n                  <ApiControlPanel backendUrl={process.env.REACT_APP_BACKEND_URL || \"https://scripture-ai-8.preview.emergentagent.com\"} />\n                </div>\n              </div>\n            </div>\n\n            {/* Layout responsive */}\n            <div className=\"three-column-layout\">\n              {/* Colonne gauche - Rubriques */}\n              <div className=\"left-column\">\n                <h3>Rubriques (29)</h3>\n                <RubriquesInline items={rubriquesItems} activeId={activeRubrique} onSelect={handleRubriqueSelect} rubriquesStatus={rubriquesStatus} />\n              </div>\n\n              {/* Colonne centrale - Contenu */}\n              <div className=\"center-column\">\n                <div className=\"content-header\">\n                  <h2>{`${activeRubrique}. ${getRubTitle(activeRubrique)}`}</h2>\n                  <div className=\"nav-buttons\">\n                    <button onClick={() => handleRubriqueSelect(Math.max(0, activeRubrique - 1))} disabled={activeRubrique === 0}> Prcdent</button>\n                    <button onClick={() => handleRubriqueSelect(Math.min(BASE_RUBRIQUES.length - 1, activeRubrique + 1))} disabled={activeRubrique === BASE_RUBRIQUES.length - 1}>Suivant </button>\n                  </div>\n                </div>\n\n                <div className=\"content-area\">\n                  {isLoading ? (\n                    <div className=\"loading-container\">\n                      <div className=\"loading-spinner\"></div>\n                      <p>Gnration en cours...</p>\n                      {progressiveStats && (\n                        <div className=\"progressive-stats\">\n                          <p> Versets traits: {progressiveStats.processed}/{progressiveStats.total}</p>\n                          <p> Batch actuel: {progressiveStats.current_batch}</p>\n                          <p> Mode: {progressiveStats.speed}</p>\n                        </div>\n                      )}\n                    </div>\n                  ) : content ? (\n                    <div>\n                      <div className=\"content-text\" dangerouslySetInnerHTML={{ __html: formatContent(content, isVersetsProgContent ? 'versets-prog' : 'default') }} />\n                      {(isVersetsProgContent || content.includes('VERSET')) && canContinueVerses && (\n                        <div className=\"continue-verses-section\">\n                          <button \n                            className=\"btn-continue-verses\" \n                            onClick={continueVerses} \n                            disabled={isLoading}\n                            title={`Gnrer les versets ${currentVerseCount + 1}  ${currentVerseCount + 5}`}\n                          >\n                             Continuer les versets ({currentVerseCount + 1}-{currentVerseCount + 5})\n                          </button>\n                          <p className=\"continue-verses-info\">\n                            Versets actuels : 1-{currentVerseCount}  Cliquez pour continuer la lecture\n                          </p>\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div className=\"empty-content-message\">\n                      <p>Slectionnez une rubrique pour voir son contenu.</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n          {/* SUPPRIM : Modal Notes - remplace par page ddie */}\n        </>\n      )}\n    </div>\n  );\n}\n\n/* =========================\n   Composants auxiliaires\n========================= */\n\nfunction getRubTitle(index) {\n  return BASE_RUBRIQUES[index] || `Rubrique ${index}`;\n}\n\nfunction SelectPill({ label, value, options, onChange }) {\n  return (\n    <div className=\"select-pill\">\n      <label>{label}</label>\n      <select value={value} onChange={onChange}>\n        {options.map((o) => <option key={o} value={o}>{o}</option>)}\n      </select>\n    </div>\n  );\n}\n\nfunction NotesModal({ isOpen, notes, onNotesChange, onSave, onClose }) {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"notes-modal-overlay\" onClick={onClose}>\n      <div className=\"notes-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"notes-modal-header\">\n          <h3> Mes Notes d'tude Biblique</h3>\n          <button className=\"notes-close-btn\" onClick={onClose}></button>\n        </div>\n        <div className=\"notes-modal-content\">\n          <textarea\n            className=\"notes-textarea\"\n            value={notes}\n            onChange={(e) => onNotesChange(e.target.value)}\n            placeholder=\"crivez vos rflexions, questions, et insights spirituels ici...\n\nExemples :\n Versets qui m'ont marqu\n Questions pour approfondir\n Applications personnelles\n Prires inspires par l'tude\"\n            rows={15}\n          />\n        </div>\n        <div className=\"notes-modal-footer\">\n          <button className=\"notes-save-btn\" onClick={onSave}>\n             Sauvegarder\n          </button>\n          <button className=\"notes-cancel-btn\" onClick={onClose}>\n            Annuler\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport './index.css';\nimport App from './App.js';\n\n// Protection globale contre les erreurs\ntry {\n  const root = createRoot(document.getElementById('root'));\n  root.render(<App />);\n} catch (error) {\n  console.error('Erreur de rendu React:', error);\n  // Fallback d'affichage en cas d'erreur\n  document.getElementById('root').innerHTML = `\n    <div style=\"padding: 20px; text-align: center;\">\n      <h1>Application Bible Study</h1>\n      <p>Chargement en cours...</p>\n      <p style=\"color: red;\">Erreur: ${error.message}</p>\n    </div>\n  `;\n}"],"sourceRoot":""}