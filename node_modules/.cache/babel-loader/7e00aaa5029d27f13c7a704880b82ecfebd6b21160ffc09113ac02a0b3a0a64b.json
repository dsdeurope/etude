{"ast":null,"code":"import _objectSpread from\"/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/* eslint-disable */import React,{useState,useEffect,useMemo}from\"react\";import\"./App.css\";import\"./rubriques.css\";import RubriquesInline from\"./RubriquesInline\";import BibleConcordancePage from\"./BibleConcordancePage\";import CharacterHistoryPage from'./CharacterHistoryPage';import VersetParVersetPage from'./VersetParVersetPage';import NotesPage from\"./NotesPage\";import RubriquePage from\"./RubriquePage\";import ApiControlPanel from\"./ApiControlPanel\";/* =========================\n   Configuration et Helpers\n========================= */// Backend: 1) REACT_APP_BACKEND_URL si défini (nettoyé), 2) localhost en dev, 3) Railway en prod\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const getBackendUrl=()=>{// Utiliser la variable d'environnement en priorité\nif(process.env.REACT_APP_BACKEND_URL){return process.env.REACT_APP_BACKEND_URL;}const hostname=window.location.hostname;if(hostname===\"localhost\"||hostname===\"127.0.0.1\")return\"http://localhost:8001\";// fallback pour les environnements non configurés\nreturn\"https://rubrique-study.preview.emergentagent.com\";};const BACKEND_URL=getBackendUrl();const API_BASE=\"\".concat(BACKEND_URL.replace(/\\/+$/g,\"\"),\"/api\");// Variables d'environnement configurées\n// BACKEND_URL et API_BASE sont prêts à utiliser\n// Style unifié pour tous les boutons de contrôle (même typographie que btn-validate)\nconst getButtonStyle=function(gradientColors,shadowColor){let isHovered=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',padding:'12px 8px',borderRadius:'14px',minHeight:'75px',fontSize:'12px',// Adapté de btn-validate (16px → 12px pour boutons plus petits)\nfontWeight:'700',// Identique à btn-validate\nfontFamily:\"'Montserrat', sans-serif\",// Identique à btn-validate\ncolor:'white',border:'none',cursor:'pointer',background:\"linear-gradient(135deg, \".concat(gradientColors.start,\" 0%, \").concat(gradientColors.end,\" 100%)\"),boxShadow:isHovered?\"0 10px 35px \".concat(shadowColor.replace('0.25','0.35'),\", 0 3px 18px rgba(0, 0, 0, 0.15)\"):\"0 6px 20px \".concat(shadowColor,\", 0 2px 14px rgba(0, 0, 0, 0.1)\"),// Adapté de btn-validate\ntransition:'all 0.3s ease',// Identique à btn-validate\ntransform:isHovered?'translateY(-2px) scale(1.02)':'translateY(0)',textTransform:'uppercase',// Identique à btn-validate\nletterSpacing:'0.8px',// Adapté de btn-validate (1px → 0.8px)\nposition:'relative',// Identique à btn-validate\noverflow:'hidden'// Identique à btn-validate\n};};// Fonction pour générer les couleurs des boutons basées sur le thème actuel\n// TOUS LES BOUTONS ont la même couleur basée sur le thème sélectionné\nconst getThemeButtonColors=theme=>{// Couleur unique basée sur le thème actuel\nconst themeColor={start:theme.primary,end:theme.secondary,shadow:\"rgba(\".concat(hexToRgb(theme.primary),\", 0.25)\")};// Fonction helper pour convertir hex en rgb\nfunction hexToRgb(hex){const r=parseInt(hex.slice(1,3),16);const g=parseInt(hex.slice(3,5),16);const b=parseInt(hex.slice(5,7),16);return\"\".concat(r,\", \").concat(g,\", \").concat(b);}// Tous les boutons utilisent la même couleur thématique\nreturn{reset:themeColor,mystique:themeColor,genese:themeColor,gemini:themeColor,versets:themeColor,generate:themeColor,concordance:themeColor};};function asString(x){if(x===undefined||x===null)return\"\";if(typeof x===\"string\")return x;try{return JSON.stringify(x,null,2);}catch(_unused){return String(x);}}function postProcessMarkdown(t){const s=asString(t);return s.replace(/VERSET (\\d+)/g,\"**VERSET $1**\").replace(/TEXTE BIBLIQUE\\s*:/g,\"**TEXTE BIBLIQUE :**\").replace(/EXPLICATION THÉOLOGIQUE\\s*:/g,\"**EXPLICATION THÉOLOGIQUE :**\").replace(/Introduction au Chapitre/g,\"**Introduction au Chapitre**\").replace(/Synthèse Spirituelle/g,\"**Synthèse Spirituelle**\").replace(/Principe Herméneutique/g,\"**Principe Herméneutique**\");}/* =========================\n   Données statiques\n========================= */const BOOKS=[\"Genèse\",\"Exode\",\"Lévitique\",\"Nombres\",\"Deutéronome\",\"Josué\",\"Juges\",\"Ruth\",\"1 Samuel\",\"2 Samuel\",\"1 Rois\",\"2 Rois\",\"1 Chroniques\",\"2 Chroniques\",\"Esdras\",\"Néhémie\",\"Esther\",\"Job\",\"Psaumes\",\"Proverbes\",\"Ecclésiaste\",\"Cantique des cantiques\",\"Ésaïe\",\"Jérémie\",\"Lamentations\",\"Ézéchiel\",\"Daniel\",\"Osée\",\"Joël\",\"Amos\",\"Abdias\",\"Jonas\",\"Michée\",\"Nahum\",\"Habacuc\",\"Sophonie\",\"Aggée\",\"Zacharie\",\"Malachie\",\"Matthieu\",\"Marc\",\"Luc\",\"Jean\",\"Actes\",\"Romains\",\"1 Corinthiens\",\"2 Corinthiens\",\"Galates\",\"Éphésiens\",\"Philippiens\",\"Colossiens\",\"1 Thessaloniciens\",\"2 Thessaloniciens\",\"1 Timothée\",\"2 Timothée\",\"Tite\",\"Philémon\",\"Hébreux\",\"Jacques\",\"1 Pierre\",\"2 Pierre\",\"1 Jean\",\"2 Jean\",\"3 Jean\",\"Jude\",\"Apocalypse\"];const BOOK_CHAPTERS={\"Genèse\":50,\"Exode\":40,\"Lévitique\":27,\"Nombres\":36,\"Deutéronome\":34,\"Josué\":24,\"Juges\":21,\"Ruth\":4,\"1 Samuel\":31,\"2 Samuel\":24,\"1 Rois\":22,\"2 Rois\":25,\"1 Chroniques\":29,\"2 Chroniques\":36,\"Esdras\":10,\"Néhémie\":13,\"Esther\":10,\"Job\":42,\"Psaumes\":150,\"Proverbes\":31,\"Ecclésiaste\":12,\"Cantique des cantiques\":8,\"Ésaïe\":66,\"Jérémie\":52,\"Lamentations\":5,\"Ézéchiel\":48,\"Daniel\":12,\"Osée\":14,\"Joël\":3,\"Amos\":9,\"Abdias\":1,\"Jonas\":4,\"Michée\":7,\"Nahum\":3,\"Habacuc\":3,\"Sophonie\":3,\"Aggée\":2,\"Zacharie\":14,\"Malachie\":4,\"Matthieu\":28,\"Marc\":16,\"Luc\":24,\"Jean\":21,\"Actes\":28,\"Romains\":16,\"1 Corinthiens\":16,\"2 Corinthiens\":13,\"Galates\":6,\"Éphésiens\":6,\"Philippiens\":4,\"Colossiens\":4,\"1 Thessaloniciens\":5,\"2 Thessaloniciens\":3,\"1 Timothée\":6,\"2 Timothée\":4,\"Tite\":3,\"Philémon\":1,\"Hébreux\":13,\"Jacques\":5,\"1 Pierre\":5,\"2 Pierre\":3,\"1 Jean\":5,\"2 Jean\":1,\"3 Jean\":1,\"Jude\":1,\"Apocalypse\":22};const BASE_RUBRIQUES=[\"Étude verset par verset\",\"Prière d'ouverture\",\"Structure littéraire\",\"Questions du chapitre précédent\",\"Thème doctrinal\",\"Fondements théologiques\",\"Contexte historique\",\"Contexte culturel\",\"Contexte géographique\",\"Analyse lexicale\",\"Parallèles bibliques\",\"Prophétie et accomplissement\",\"Personnages\",\"Structure rhétorique\",\"Théologie trinitaire\",\"Christ au centre\",\"Évangile et grâce\",\"Application personnelle\",\"Application communautaire\",\"Prière de réponse\",\"Questions d'étude\",\"Points de vigilance\",\"Objections et réponses\",\"Perspective missionnelle\",\"Éthique chrétienne\",\"Louange / liturgie\",\"Méditation guidée\",\"Mémoire / versets clés\",\"Plan d'action\"];/* =========================\n   Utilitaires fetch (fallbacks)\n========================= */// mapping endpoints (nouveau → legacy)\nconst ENDPOINTS={verseProgressive:[\"/generate-verse-by-verse-progressive\",\"/g_verse_progressive\"],verse:[\"/generate-verse-by-verse\",\"/g_te-verse-by-verse\"],study:[\"/generate-study\",\"/g_study_28\"],verseGemini:[\"/generate-verse-by-verse-gemini\",\"/generate-verse-by-verse\",\"/g_te-verse-by-verse\"],studyGemini:[\"/generate-study-gemini\",\"/generate-study\",\"/g_study_28\"]};async function smartPost(pathList,payload){let lastErr=null;for(const p of pathList){const url=\"\".concat(API_BASE).concat(p);try{console.log(\"[API] POST →\",url);const r=await fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload||{})});if(r.ok){const ct=r.headers.get(\"content-type\")||\"\";if(ct.includes(\"application/json\")){return{data:await r.json(),url};}return{data:{raw:await r.text()},url};}if(r.status===404){lastErr=new Error(\"404 @ \".concat(url));continue;}const bodyText=await r.text().catch(()=>\"\");throw new Error(\"HTTP \".concat(r.status,\" @ \").concat(url).concat(bodyText?\" – \"+bodyText.slice(0,300):\"\"));}catch(e){lastErr=e;}}throw lastErr||new Error(\"Tous les endpoints ont échoué\");}/* =========================\n   Composant Principal App\n========================= */function App(){// Thèmes (définis en premier pour éviter erreur d'initialisation)\nconst colorThemes=[{name:\"Violet Mystique\",primary:\"#667eea\",secondary:\"#764ba2\",accent:\"#667eea\",background:\"linear-gradient(135deg, #667eea 0%, #764ba2 100%)\",headerBg:\"linear-gradient(90deg, #3b4371 0%, #f093fb 50%, #f5576c 100%)\"},{name:\"Océan Profond\",primary:\"#0891b2\",secondary:\"#0284c7\",accent:\"#0891b2\",background:\"linear-gradient(135deg, #0891b2 0%, #0284c7 100%)\",headerBg:\"linear-gradient(90deg, #075985 0%, #0ea5e9 50%, #38bdf8 100%)\"},{name:\"Émeraude Vert\",primary:\"#10b981\",secondary:\"#059669\",accent:\"#10b981\",background:\"linear-gradient(135deg, #10b981 0%, #059669 100%)\",headerBg:\"linear-gradient(90deg, #064e3b 0%, #34d399 50%, #6ee7b7 100%)\"},{name:\"Rose Passion\",primary:\"#ec4899\",secondary:\"#db2777\",accent:\"#ec4899\",background:\"linear-gradient(135deg, #ec4899 0%, #db2777 100%)\",headerBg:\"linear-gradient(90deg, #831843 0%, #f472b6 50%, #f9a8d4 100%)\"},{name:\"Orange Sunset\",primary:\"#f59e0b\",secondary:\"#d97706\",accent:\"#f59e0b\",background:\"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",headerBg:\"linear-gradient(90deg, #92400e 0%, #fbbf24 50%, #fcd34d 100%)\"},{name:\"Indigo Royal\",primary:\"#6366f1\",secondary:\"#4f46e5\",accent:\"#6366f1\",background:\"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)\",headerBg:\"linear-gradient(90deg, #312e81 0%, #818cf8 50%, #a5b4fc 100%)\"}];// États principaux\nconst[currentTheme,setCurrentTheme]=useState(0);// Couleurs dynamiques basées sur le thème actuel (après colorThemes et currentTheme)\nconst currentButtonColors=getThemeButtonColors(colorThemes[currentTheme]);const[selectedBook,setSelectedBook]=useState(\"Genèse\");const[selectedChapter,setSelectedChapter]=useState(\"1\");const[selectedVerse,setSelectedVerse]=useState(\"--\");const[selectedVersion,setSelectedVersion]=useState(\"LSG\");const[selectedLength,setSelectedLength]=useState(500);const[activeRubrique,setActiveRubrique]=useState(0);const[content,setContent]=useState(\"\");const[isLoading,setIsLoading]=useState(false);const[generatedRubriques,setGeneratedRubriques]=useState({});// Stockage du contenu généré\nconst[rubriquesStatus,setRubriquesStatus]=useState({});const[lastStudy,setLastStudy]=useState(null);const[progressPercent,setProgressPercent]=useState(0);const[searchQuery,setSearchQuery]=useState(\"\");// ← unique déclaration\n// États génération progressive\nconst[isProgressiveLoading,setIsProgressiveLoading]=useState(false);const[currentBatchVerse,setCurrentBatchVerse]=useState(1);const[progressiveStats,setProgressiveStats]=useState(null);const[isVersetsProgContent,setIsVersetsProgContent]=useState(false);const[currentVerseCount,setCurrentVerseCount]=useState(5);const[canContinueVerses,setCanContinueVerses]=useState(true);// États pour les notes persistantes - SUPPRIMÉES (remplacées par page dédiée)\n// const [personalNotes, setPersonalNotes] = useState(...)\n// const [showNotesModal, setShowNotesModal] = useState(false)\n// État pour la navigation\nconst[currentPage,setCurrentPage]=useState('main');// 'main', 'concordance', 'versets', 'notes', ou 'rubrique'\nconst[versetPageContent,setVersetPageContent]=useState('');const[currentBookInfo,setCurrentBookInfo]=useState('');const[currentRubriqueNumber,setCurrentRubriqueNumber]=useState(1);const[currentRubriqueContent,setCurrentRubriqueContent]=useState('');// États pour la navigation entre les pages dédiées\nconst[selectedTheme,setSelectedTheme]=useState(null);const[selectedCharacterForHistory,setSelectedCharacterForHistory]=useState(null);const[currentTab,setCurrentTab]=useState('concordance');// Thèmes déplacés en début de fonction\n// Options de chapitres\nconst availableChapters=useMemo(()=>{if(selectedBook===\"--\"||!BOOK_CHAPTERS[selectedBook])return[\"--\"];const max=BOOK_CHAPTERS[selectedBook]||1;return[\"--\",...Array.from({length:max},(_,i)=>i+1)];},[selectedBook]);// Charger/sauver dernière étude et initialiser couleurs\nuseEffect(()=>{const saved=localStorage.getItem(\"lastBibleStudy\");if(saved){try{setLastStudy(JSON.parse(saved));}catch(e){console.error(e);}}const beforeUnload=()=>saveCurrentStudy();window.addEventListener(\"beforeunload\",beforeUnload);// Initialiser les couleurs du thème par défaut\nconst theme=colorThemes[currentTheme];document.documentElement.style.setProperty('--theme-primary',\"linear-gradient(135deg, \".concat(theme.primary,\", \").concat(theme.secondary,\")\"));document.documentElement.style.setProperty('--theme-secondary',\"linear-gradient(135deg, \".concat(theme.secondary,\", \").concat(theme.primary,\")\"));document.documentElement.style.setProperty('--theme-accent',\"linear-gradient(135deg, \".concat(theme.accent,\", \").concat(theme.secondary,\")\"));const hexToRgba=(hex,alpha)=>{const r=parseInt(hex.slice(1,3),16);const g=parseInt(hex.slice(3,5),16);const b=parseInt(hex.slice(5,7),16);return\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\", \").concat(alpha,\")\");};document.documentElement.style.setProperty('--theme-accent-shadow',hexToRgba(theme.accent,0.3));document.documentElement.style.setProperty('--theme-accent-shadow-hover',hexToRgba(theme.accent,0.4));return()=>window.removeEventListener(\"beforeunload\",beforeUnload);},[currentTheme]);// Appliquer thème au chargement\nuseEffect(()=>{setTimeout(()=>{changePalette();setCurrentTheme(0);},100);},[]);// Test immédiat de sauvegarde quand sélection change\nuseEffect(()=>{if(selectedBook!==\"--\"&&selectedChapter!==\"--\"){console.log(\"[TEST SAUVEGARDE] Sélection valide détectée:\",selectedBook,selectedChapter);saveCurrentStudy();}},[selectedBook,selectedChapter]);// Initialiser la rubrique 0 au chargement avec le livre et chapitre sélectionnés\nuseEffect(()=>{if(selectedBook!==\"--\"&&selectedChapter!==\"--\"&&activeRubrique===0){console.log(\"[INIT RUBRIQUE] Initialisation rubrique 0 pour:\",selectedBook,selectedChapter);handleRubriqueSelect(0);}},[selectedBook,selectedChapter]);const saveCurrentStudy=()=>{console.log(\"[DEBUG SAUVEGARDE] Tentative sauvegarde:\",{selectedBook,selectedChapter,selectedVerse,content_length:content?content.length:0});if(selectedBook!==\"--\"&&selectedChapter!==\"--\"){const currentStudy={book:selectedBook,chapter:selectedChapter,verse:selectedVerse,version:selectedVersion,length:selectedLength,activeRubrique,content,rubriquesStatus,timestamp:new Date().toISOString(),displayTitle:\"\".concat(selectedBook,\" \").concat(selectedChapter).concat(selectedVerse!==\"--\"?\":\"+selectedVerse:\"\")};localStorage.setItem(\"lastBibleStudy\",JSON.stringify(currentStudy));setLastStudy(currentStudy);console.log(\"[SAUVEGARDE SUCCESS] Étude sauvegardée:\",currentStudy.displayTitle);}else{console.log(\"[SAUVEGARDE SKIP] Conditions non remplies - livre ou chapitre = '--'\");}};const restoreLastStudy=()=>{if(!lastStudy)return;setSelectedBook(lastStudy.book);setSelectedChapter(lastStudy.chapter);setSelectedVerse(lastStudy.verse||\"--\");setSelectedVersion(lastStudy.version||\"LSG\");setSelectedLength(lastStudy.length||500);setActiveRubrique(lastStudy.activeRubrique||0);setContent(lastStudy.content||\"\");setRubriquesStatus(lastStudy.rubriquesStatus||{});};const rubriquesItems=BASE_RUBRIQUES.map((title,index)=>({id:index,title}));/* =========================\n     Gestionnaires\n  ========================= */const handleBookChange=e=>{saveCurrentStudy();const book=e.target.value;setSelectedBook(book);setSelectedChapter(book===\"--\"?\"--\":1);setSelectedVerse(\"--\");};const handleChapterChange=e=>{saveCurrentStudy();const chapter=e.target.value;setSelectedChapter(chapter===\"--\"?\"--\":Number(chapter));setSelectedVerse(\"--\");};const handleVerseChange=e=>setSelectedVerse(e.target.value);const handleVersionChange=e=>setSelectedVersion(e.target.value);const handleLengthChange=e=>setSelectedLength(Number(e.target.value));// Recherche intelligente\nconst parseSearchQuery=query=>{if(!query.trim())return null;const normalized=query.trim();const patterns=[/^(.+?)\\s+(\\d+):(\\d+)$/,/^(.+?)\\s+(\\d+)$/,/^(.+)$/];for(const pat of patterns){const m=normalized.match(pat);if(m){const bookName=m[1].trim();const chapter=m[2]?parseInt(m[2]):null;const verse=m[3]?parseInt(m[3]):null;const found=BOOKS.find(b=>b.toLowerCase()===bookName.toLowerCase()||b.toLowerCase().includes(bookName.toLowerCase())||bookName.toLowerCase().includes(b.toLowerCase()));if(found)return{book:found,chapter:chapter||1,verse:verse||\"--\"};}}return null;};const handleSearchChange=e=>{const q=e.target.value;setSearchQuery(q);const parsed=parseSearchQuery(q);if(parsed){saveCurrentStudy();setSelectedBook(parsed.book);setSelectedChapter(parsed.chapter);setSelectedVerse(parsed.verse);}};// Gestionnaires supprimés - définis plus bas\n// Fonction pour détecter et transformer les références bibliques en liens YouVersion\nconst transformBibleReferences=text=>{if(!text)return text;// Sauvegarder les balises HTML existantes pour les restaurer après\nconst htmlTags=[];let tempText=text.replace(/<[^>]*>/g,match=>{const placeholder=\"__HTML_TAG_\".concat(htmlTags.length,\"__\");htmlTags.push(match);return placeholder;});// Set pour éviter les doublons\nconst processedRefs=new Set();// Regex améliorée pour détecter les références bibliques (seulement dans le texte brut)\nconst bibleRefRegex=/(\\d?\\s*[A-ZÀ-ÿ][a-zà-ÿ]*(?:\\s+\\d*\\s*[A-ZÀ-ÿ][a-zà-ÿ]*)*)\\s+(\\d+)(?::(\\d+)(?:[-–](\\d+))?)?(?!\\d)/g;// Traiter les références dans le texte temporaire (sans HTML)\ntempText=tempText.replace(bibleRefRegex,(match,book,chapter,verse1,verse2)=>{const cleanMatch=match.trim();// Vérifier si cette référence a déjà été traitée (éviter les doublons)\nif(processedRefs.has(cleanMatch)){return cleanMatch;// Retourner le texte sans lien si c'est un doublon\n}processedRefs.add(cleanMatch);// Construire l'URL YouVersion avec recherche directe\nconst youVersionUrl=\"https://www.bible.com/search/bible?q=\".concat(encodeURIComponent(cleanMatch));// Créer le lien HTML avec styles\nreturn\"<a href=\\\"\".concat(youVersionUrl,\"\\\" target=\\\"_blank\\\" class=\\\"bible-reference\\\" title=\\\"\").concat(cleanMatch,\"\\\">\").concat(cleanMatch,\"</a>\");});// Restaurer les balises HTML originales\nhtmlTags.forEach((tag,index)=>{tempText=tempText.replace(\"__HTML_TAG_\".concat(index,\"__\"),tag);});return tempText;};// Progress bar\nconst wait=ms=>new Promise(r=>setTimeout(r,ms));// Fonction pour parser le contenu des 28 rubriques retourné par l'API\nconst parseRubriquesContent=fullContent=>{const rubriques={};console.log(\"[PARSING DEBUG] Contenu reçu:\",fullContent.length,\"caractères\");console.log(\"[PARSING DEBUG] Début du contenu:\",fullContent.substring(0,200));// Diviser le contenu par les titres de rubriques (## Rubrique 1: , ## Rubrique 2: , etc.)\nconst sections=fullContent.split(/##\\s*Rubrique\\s*(\\d+):\\s*/i);console.log(\"[PARSING DEBUG] Sections trouvées:\",sections.length);for(let i=1;i<sections.length;i+=2){const rubriqueNumber=parseInt(sections[i]);// Garder l'index 1-based pour correspondre aux rubriques\nlet rubriqueContent=sections[i+1]?sections[i+1].trim():\"\";console.log(\"[PARSING DEBUG] Rubrique \".concat(rubriqueNumber,\":\"),rubriqueContent.length,\"caractères\");// Nettoyer le contenu - enlever le titre suivant s'il existe\nif(rubriqueContent){// Enlever une éventuelle rubrique suivante qui serait incluse\nrubriqueContent=rubriqueContent.split('## Rubrique')[0].trim();// Nettoyer les sauts de ligne multiples\nrubriqueContent=rubriqueContent.replace(/\\n{3,}/g,'\\n\\n').trim();if(rubriqueContent.length>0){rubriques[rubriqueNumber]=rubriqueContent;console.log(\"[PARSING SUCCESS] Rubrique \".concat(rubriqueNumber,\" pars\\xE9e:\"),rubriqueContent.substring(0,100)+\"...\");}}}console.log(\"[PARSING FINAL] Rubriques parsées:\",Object.keys(rubriques).length);return rubriques;};// Configuration des longueurs par rubrique\nconst getRubriqueLength=rubriqueNum=>{const lengthConfig={1:500,// Prière d'ouverture\n2:500,// Structure littéraire\n3:500,// Questions du chapitre précédent\n4:500,// Thème doctrinal\n5:1500,// Fondements théologiques\n6:1500,// Contexte historique\n7:1500,// Contexte culturel\n8:1500,// Contexte géographique\n9:1500,// Analyse lexicale\n10:1500,// Parallèles bibliques\n11:1500,// Prophétie et accomplissement\n12:1500,// Personnages\n13:1500,// Structure rhétorique\n14:1500,// Théologie trinitaire\n15:2000,// Christ au centre\n16:2000,// Évangile et grâce\n17:2000,// Application personnelle\n18:2000,// Application communautaire\n19:2000,// Prière de réponse\n20:2000,// Questions d'étude\n21:2000,// Points de vigilance\n22:2000,// Objections et réponses\n23:2000,// Perspective missionnelle\n24:2000,// Éthique chrétienne\n25:2000,// Louange / liturgie\n26:2000,// Méditation guidée\n27:2000,// Mémoire / versets clés\n28:2000// Plan d'action\n};return lengthConfig[rubriqueNum]||500;};// Fonction pour générer du contenu narratif théologique spécifique\n// Nouvelle fonction pour générer le contenu des rubriques via API\nconst generateRubriqueContentViaAPI=async(rubriqueNum,rubriqueTitle,passage,book,chapter,targetLength)=>{try{console.log(\"[API RUBRIQUE \".concat(rubriqueNum,\"] G\\xE9n\\xE9ration via API: \").concat(rubriqueTitle,\" pour \").concat(book,\" \").concat(chapter));const response=await fetch(\"\".concat(getBackendUrl(),\"/api/generate-rubrique-content\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({rubrique_number:rubriqueNum,rubrique_title:rubriqueTitle,book:book,chapter:parseInt(chapter),passage:passage,target_length:targetLength,use_gemini:true,enriched:true})});if(!response.ok){throw new Error(\"Erreur API: \".concat(response.status));}const result=await response.json();if(result.status==='success'){console.log(\"[API RUBRIQUE \".concat(rubriqueNum,\"] Succ\\xE8s - \").concat(result.word_count,\" mots - API: \").concat(result.api_used));return result.content;}else{throw new Error('Erreur lors de la génération du contenu');}}catch(error){console.error(\"[ERROR RUBRIQUE \".concat(rubriqueNum,\"]\"),error);// Fallback vers le contenu statique en cas d'erreur API\nreturn generateRubriqueContentStatic(rubriqueNum,rubriqueTitle,passage,book,chapter,targetLength);}};// Renommer l'ancienne fonction pour le fallback\nconst generateRubriqueContentStatic=function(rubriqueNum,rubriqueTitle,passage,book,chapter){let userSelectedLength=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;// Utiliser la longueur choisie par l'utilisateur ou la longueur par défaut de la rubrique\nconst targetLength=userSelectedLength||getRubriqueLength(rubriqueNum);const contenuParRubrique={1:generatePrayerContent(passage,targetLength),2:generateStructureContent(passage,book,chapter,targetLength),3:generatePreviousChapterContent(passage,book,chapter,targetLength),4:generateDoctrinalThemeContent(passage,book,chapter,targetLength),5:generateTheologicalFoundationsContent(passage,book,chapter,targetLength),6:generateHistoricalContextContent(passage,book,chapter,targetLength),7:generateCulturalContextContent(passage,book,chapter,targetLength),8:generateGeographicalContextContent(passage,book,chapter,targetLength),9:generateLexicalAnalysisContent(passage,book,chapter,targetLength),10:generateBiblicalParallelsContent(passage,book,chapter,targetLength),11:generateProphecyContent(passage,book,chapter,targetLength),12:generateCharactersContent(passage,book,chapter,targetLength),13:generateRhetoricalStructureContent(passage,book,chapter,targetLength),14:generateTrinityTheologyContent(passage,book,chapter,targetLength),15:generateChristCenteredContent(passage,book,chapter,targetLength),16:generateGospelGraceContent(passage,book,chapter,targetLength),17:generatePersonalApplicationContent(passage,book,chapter,targetLength),18:generateCommunityApplicationContent(passage,book,chapter,targetLength),19:generateResponsePrayerContent(passage,book,chapter,targetLength),20:generateStudyQuestionsContent(passage,book,chapter,targetLength),21:generateVigilancePointsContent(passage,book,chapter,targetLength),22:generateObjectionsResponsesContent(passage,book,chapter,targetLength),23:generateMissionalPerspectiveContent(passage,book,chapter,targetLength),24:generateChristianEthicsContent(passage,book,chapter,targetLength),25:generateWorshipLiturgyContent(passage,book,chapter,targetLength),26:generateGuidedMeditationContent(passage,book,chapter,targetLength),27:generateMemoryVersesContent(passage,book,chapter,targetLength),28:generateActionPlanContent(passage,book,chapter,targetLength)};return contenuParRubrique[rubriqueNum]||generateDefaultContent(rubriqueTitle,passage,book,chapter,targetLength);};// Fonction pour la prière d'ouverture avec progression narrative théologique\nconst generatePrayerContent=(passage,targetLength)=>{const baseContent=\"**Adoration :** Seigneur Dieu, Cr\\xE9ateur du ciel et de la terre, nous reconnaissons ta grandeur manifest\\xE9e dans \".concat(passage,\". Tu es celui qui appelle \\xE0 l'existence ce qui n'\\xE9tait pas.\\n\\n**Confession :** P\\xE8re, nous confessons notre petitesse face \\xE0 ta majest\\xE9 cr\\xE9atrice r\\xE9v\\xE9l\\xE9e dans \").concat(passage,\". Pardonne-nous nos manquements.\\n\\n**Demande :** Esprit Saint, \\xE9claire notre compr\\xE9hension de \").concat(passage,\".\");if(targetLength>=500){return baseContent+\"\\n\\nDans cette pri\\xE8re d'ouverture, nous nous approchons du tr\\xF4ne de la gr\\xE2ce avec une r\\xE9v\\xE9rence qui sied \\xE0 la majest\\xE9 divine r\\xE9v\\xE9l\\xE9e dans \".concat(passage,\". L'adoration authentique na\\xEEt de la contemplation des perfections divines manifest\\xE9es dans l'\\xC9criture sainte.\");}if(targetLength>=1000){return baseContent+\"\\n\\nDans cette pri\\xE8re d'ouverture, nous nous approchons du tr\\xF4ne de la gr\\xE2ce avec une r\\xE9v\\xE9rence qui sied \\xE0 la majest\\xE9 divine r\\xE9v\\xE9l\\xE9e dans \".concat(passage,\". L'adoration authentique na\\xEEt de la contemplation des perfections divines manifest\\xE9es dans l'\\xC9criture sainte.\\n\\nLa tradition patristique et r\\xE9form\\xE9e nous enseigne que la lectio divina doit d\\xE9buter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le p\\xE9ch\\xE9. Comme l'affirme Jean Chrysostome : \\\"Les \\xC9critures sont une lettre que Dieu nous a envoy\\xE9e d'en haut.\\\" Cette lettre divine n\\xE9cessite l'illumination c\\xE9leste pour \\xEAtre comprise dans toute sa profondeur sot\\xE9riologique.\\n\\nNotre confession s'enracine dans la reconnaissance de notre finitude cr\\xE9aturelle face \\xE0 l'infinit\\xE9 divine. L'humilit\\xE9 herm\\xE9neutique constitue le pr\\xE9alable indispensable \\xE0 toute ex\\xE9g\\xE8se fid\\xE8le.\");}if(targetLength>=2000){return baseContent+\"\\n\\nDans cette pri\\xE8re d'ouverture, nous nous approchons du tr\\xF4ne de la gr\\xE2ce avec une r\\xE9v\\xE9rence qui sied \\xE0 la majest\\xE9 divine r\\xE9v\\xE9l\\xE9e dans \".concat(passage,\". L'adoration authentique na\\xEEt de la contemplation des perfections divines manifest\\xE9es dans l'\\xC9criture sainte.\\n\\nLa tradition patristique et r\\xE9form\\xE9e nous enseigne que la lectio divina doit d\\xE9buter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le p\\xE9ch\\xE9. Comme l'affirme Jean Chrysostome : \\\"Les \\xC9critures sont une lettre que Dieu nous a envoy\\xE9e d'en haut.\\\" Cette lettre divine n\\xE9cessite l'illumination c\\xE9leste pour \\xEAtre comprise dans toute sa profondeur sot\\xE9riologique.\\n\\nNotre confession s'enracine dans la reconnaissance de notre finitude cr\\xE9aturelle face \\xE0 l'infinit\\xE9 divine. L'humilit\\xE9 herm\\xE9neutique constitue le pr\\xE9alable indispensable \\xE0 toute ex\\xE9g\\xE8se fid\\xE8le.\\n\\nL'\\xC9cole d'Antioche et l'\\xC9cole d'Alexandrie, malgr\\xE9 leurs divergences herm\\xE9neutiques, s'accordaient sur cette v\\xE9rit\\xE9 fondamentale : l'\\xC9criture ne se d\\xE9voile pleinement qu'\\xE0 celui qui s'approche d'elle dans la pri\\xE8re et la d\\xE9pendance de l'Esprit. Orig\\xE8ne \\xE9crivait : \\\"La parole de Dieu est comme un grain de froment : si tu n'en broies pas l'\\xE9corce par la m\\xE9ditation et la pri\\xE8re, tu ne peux en go\\xFBter la moelle.\\\"\\n\\nCette d\\xE9marche spirituelle s'inscrit dans la lign\\xE9e de la Sola Scriptura r\\xE9form\\xE9e, qui affirme non seulement l'autorit\\xE9 supr\\xEAme de l'\\xC9criture, mais aussi la n\\xE9cessit\\xE9 de l'illumination divine pour sa juste compr\\xE9hension. Calvin soulignait que \\\"l'\\xC9criture est son propre interpr\\xE8te\\\", mais sous la conduite du Saint-Esprit qui en est l'auteur principal.\\n\\nAinsi, notre pri\\xE8re d'ouverture devant \").concat(passage,\" n'est pas une simple formalit\\xE9 liturgique, mais l'expression de notre th\\xE9ologie de la r\\xE9v\\xE9lation : Dieu se r\\xE9v\\xE8le, l'homme re\\xE7oit par gr\\xE2ce, et l'Esprit rend t\\xE9moignage \\xE0 la v\\xE9rit\\xE9 divine dans le c\\u0153ur du croyant r\\xE9g\\xE9n\\xE9r\\xE9.\");}return baseContent;};// Fonction pour structure littéraire (500 caractères)\nconst generateStructureContent=(passage,book,chapter,targetLength)=>{return\"L'architecture litt\\xE9raire de \".concat(passage,\" r\\xE9v\\xE8le l'ordre divin dans la cr\\xE9ation. Cette structure en sept jours manifeste la perfection divine : trois jours de s\\xE9paration (lumi\\xE8re/t\\xE9n\\xE8bres, eaux/eaux, terre/mer) suivis de trois jours de peuplement (luminaires, animaux aquatiques et volants, animaux terrestres et l'homme). Le septi\\xE8me jour couronne l'\\u0153uvre par le repos divin, \\xE9tablissant le principe du sabbat. Cette progression m\\xE9thodique \\\"Dieu dit... et cela fut... Dieu vit que cela \\xE9tait bon\\\" d\\xE9montre la souverainet\\xE9 divine.\");};// Fonction pour questions du chapitre précédent (500 caractères)\nconst generatePreviousChapterContent=(passage,book,chapter,targetLength)=>{if(chapter===\"1\"){return\"\".concat(passage,\" ouvre le r\\xE9cit biblique sans prologue humain, plongeant directement dans l'acte cr\\xE9ateur divin. Cette ouverture majestueuse \\xE9tablit Dieu comme l'acteur principal de l'histoire. L'absence de contexte pr\\xE9alable souligne l'\\xE9ternit\\xE9 et la primaut\\xE9 divines. Cette introduction th\\xE9ologique pr\\xE9pare tout le d\\xE9veloppement biblique ult\\xE9rieur, posant les fondements de l'alliance, de la r\\xE9v\\xE9lation progressive et du plan de salut qui se d\\xE9ploieront dans toute l'\\xC9criture.\");}return\"L'\\xE9tude de \".concat(passage,\" s'inscrit dans la continuit\\xE9 du r\\xE9cit biblique. Les \\xE9v\\xE9nements pr\\xE9c\\xE9dents \\xE9clairent la compr\\xE9hension de ce passage et pr\\xE9parent les d\\xE9veloppements th\\xE9ologiques qui suivront.\");};// Fonction pour thème doctrinal (500 caractères)\nconst generateDoctrinalThemeContent=(passage,book,chapter,targetLength)=>{return\"Le th\\xE8me doctrinal central de \".concat(passage,\" proclame la souverainet\\xE9 cr\\xE9atrice de Dieu. Trois v\\xE9rit\\xE9s fondamentales \\xE9mergent : l'existence \\xE9ternelle de Dieu avant toute cr\\xE9ation, sa parole efficace qui appelle \\xE0 l'existence ce qui n'\\xE9tait pas, et sa bonne volont\\xE9 envers son \\u0153uvre. L'homme, cr\\xE9\\xE9 \\xE0 l'image divine, re\\xE7oit la dignit\\xE9 unique de repr\\xE9sentant de Dieu sur terre. Le sabbat \\xE9tablit le rythme divin entre travail et repos, r\\xE9v\\xE9lant la nature m\\xEAme de Dieu dans l'alternance activit\\xE9/contemplation.\");};// Fonction pour fondements théologiques avec progression narrative selon longueur\nconst generateTheologicalFoundationsContent=(passage,book,chapter,targetLength)=>{const baseContent=\"La narration de \".concat(passage,\" \\xE9tablit les piliers th\\xE9ologiques de la foi chr\\xE9tienne. L'\\xC9criture r\\xE9v\\xE8le que Dieu, dans sa trinit\\xE9 \\xE9ternelle, pr\\xE9c\\xE8de toute r\\xE9alit\\xE9 cr\\xE9\\xE9e.\");if(targetLength>=500){return baseContent+\" La cr\\xE9ation ex nihilo manifeste la toute-puissance divine. L'anthropologie biblique trouve ici ses racines : l'homme, cr\\xE9\\xE9 \\xE0 l'image de Dieu (imago Dei), re\\xE7oit une dignit\\xE9 unique dans la cr\\xE9ation.\";}if(targetLength>=1000){return baseContent+\" La cr\\xE9ation ex nihilo manifeste la toute-puissance divine. Contrairement aux cosmogonies babyloniennes qui d\\xE9crivent des th\\xE9omachies primordiales, l'\\xC9criture pr\\xE9sente un Dieu souverain cr\\xE9ant par sa seule parole.\\n\\nL'anthropologie biblique trouve ici ses fondements : l'homme, cr\\xE9\\xE9 \\xE0 l'image de Dieu (imago Dei), re\\xE7oit une dignit\\xE9 unique. Cette ressemblance divine ne r\\xE9side pas dans la corpor\\xE9it\\xE9 mais dans les facult\\xE9s spirituelles : intelligence, volont\\xE9, capacit\\xE9 relationnelle et responsabilit\\xE9 morale. L'homme devient ainsi le vice-g\\xE9rent de Dieu sur terre.\\n\\nLe sabbat r\\xE9v\\xE8le la p\\xE9dagogie divine. En se reposant le septi\\xE8me jour, Dieu \\xE9tablit un mod\\xE8le anthropologique : l'alternance entre activit\\xE9 cr\\xE9atrice et contemplation adoratrice. Cette institution sabbatique pr\\xE9figure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sot\\xE9riologique en Christ, notre repos sabbatique v\\xE9ritable selon l'\\xE9p\\xEEtre aux H\\xE9breux.\";}if(targetLength>=2000){return baseContent+\" La cr\\xE9ation ex nihilo (\\xE0 partir du n\\xE9ant) manifeste la toute-puissance divine et constitue un dogme fondamental distinguant radicalement la foi biblique de toute philosophie naturaliste ou panth\\xE9iste. Contrairement aux cosmogonies babyloniennes (Enuma Elish) qui d\\xE9crivent des th\\xE9omachies primordiales, l'\\xC9criture pr\\xE9sente un Dieu souverain cr\\xE9ant par sa seule parole efficace.\\n\\nL'anthropologie biblique trouve ici ses fondements doctrinaux incontournables. L'homme, cr\\xE9\\xE9 \\xE0 l'image de Dieu (imago Dei selon Gen\\xE8se 1:27), re\\xE7oit une dignit\\xE9 ontologique unique dans l'ordre cr\\xE9ationnel. Cette ressemblance divine ne r\\xE9side pas dans la corpor\\xE9it\\xE9 (contra l'anthropomorphisme na\\xEFf) mais dans les facult\\xE9s spirituelles : intellectus, voluntas, capacit\\xE9 relationnelle et responsabilit\\xE9 morale coram Deo. L'homme devient ainsi le vice-g\\xE9rent divin sur terre, participant \\xE0 la souverainet\\xE9 divine par d\\xE9l\\xE9gation gracieuse.\\n\\nLa th\\xE9ologie sabbatique r\\xE9v\\xE8le la p\\xE9dagogie divine et \\xE9tablit les fondements de la sanctification du temps. En se reposant le septi\\xE8me jour, Dieu \\xE9tablit un paradigme anthropologique fondamental : l'alternance entre activit\\xE9 cr\\xE9atrice (opus Dei) et contemplation adoratrice (otium sanctum). Cette institution sabbatique pr\\xE9figure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sot\\xE9riologique en Christ, notre repos sabbatique v\\xE9ritable selon l'ex\\xE9g\\xE8se de l'\\xE9p\\xEEtre aux H\\xE9breux (chapitre 4).\\n\\nL'\\xC9cole de Westminster et les th\\xE9ologiens r\\xE9form\\xE9s orthodoxes (Turretin, Brakel, Owen) ont d\\xE9velopp\\xE9 ces fondements avec une rigueur scolastique remarquable, \\xE9tablissant la th\\xE9ologie syst\\xE9matique sur ces bases scripturaires in\\xE9branlables. Ces v\\xE9rit\\xE9s r\\xE9v\\xE9l\\xE9es constituent le socle doctrinal de la foi r\\xE9form\\xE9e et demeurent le rempart th\\xE9ologique face aux d\\xE9fis de la modernit\\xE9 s\\xE9culi\\xE8re et du naturalisme m\\xE9thodologique contemporain.\";}return baseContent;};// Fonction pour contexte historique (1500 caractères) - Plus narratif et théologique\nconst generateHistoricalContextContent=(passage,book,chapter,targetLength)=>{return\"L'\\xE9tude du contexte historique de \".concat(passage,\" nous plonge dans l'univers du Proche-Orient ancien, o\\xF9 les cosmogonies babyloniennes et \\xE9gyptiennes dominaient la pens\\xE9e religieuse. Dans ce milieu culturel satur\\xE9 de mythologies, la r\\xE9v\\xE9lation biblique \\xE9merge comme une voix proph\\xE9tique unique et r\\xE9volutionnaire.\\n\\nLes r\\xE9cits babyloniens comme l'Enuma Elish pr\\xE9sentent la cr\\xE9ation comme le r\\xE9sultat de conflits titanesques entre divinit\\xE9s primordiales. Marduk vainc Tiamat, d\\xE9esse du chaos, et de son cadavre forme le cosmos. Ces mythes refl\\xE8tent une vision cyclique du temps et une compr\\xE9hension polyth\\xE9iste du divin. La r\\xE9v\\xE9lation mosa\\xEFque s'oppose radicalement \\xE0 ces conceptions.\\n\\nL'\\xC9criture proclame un Dieu unique, \\xE9ternel, qui cr\\xE9e par sa parole sans opposition ni combat. Cette v\\xE9rit\\xE9 r\\xE9v\\xE9l\\xE9e corrige les erreurs th\\xE9ologiques de l'environnement culturel isra\\xE9lite. Le peuple de Dieu re\\xE7oit ainsi une compr\\xE9hension purifi\\xE9e de la divinit\\xE9, lib\\xE9r\\xE9e des superstitions et des craintes li\\xE9es aux forces naturelles divinis\\xE9es.\\n\\nL'historicit\\xE9 du r\\xE9cit, d\\xE9battue dans les cercles acad\\xE9miques contemporains, ne diminue en rien sa port\\xE9e th\\xE9ologique. Que l'on adopte une lecture litt\\xE9rale ou litt\\xE9raire, l'enseignement doctrinal demeure inchang\\xE9 : Dieu est le cr\\xE9ateur souverain, l'homme porte son image, et la cr\\xE9ation r\\xE9v\\xE8le sa gloire.\\n\\nCette perspective historique enrichit notre compr\\xE9hension et renforce notre foi en la v\\xE9racit\\xE9 de la r\\xE9v\\xE9lation divine face aux id\\xE9ologies contemporaines qui tentent de r\\xE9duire l'homme \\xE0 un simple produit du hasard \\xE9volutif.\");};// Fonction générique pour contenu par défaut\nconst generateDefaultContent=(rubriqueTitle,passage,book,chapter,targetLength)=>{const baseContent=\"**\".concat(rubriqueTitle,\"** dans le contexte de \").concat(passage,\"\\n\\nCette rubrique examine \").concat(passage,\" sous l'angle de \\\"\").concat(rubriqueTitle,\"\\\". L'analyse r\\xE9v\\xE8le des v\\xE9rit\\xE9s importantes pour notre compr\\xE9hension th\\xE9ologique et notre marche chr\\xE9tienne.\\n\\n**Enseignement biblique :** \").concat(passage,\" nous instruit sur la nature de Dieu et son \\u0153uvre dans l'histoire du salut.\\n**Application pratique :** Ces v\\xE9rit\\xE9s transforment notre relation avec le Cr\\xE9ateur et notre vision du monde.\");// Étendre le contenu selon la longueur cible\nif(targetLength>=1500){return baseContent+\"\\n\\nLa narration scripturaire nous invite \\xE0 une m\\xE9ditation approfondie sur les implications de ce passage. L'Esprit Saint, par sa gr\\xE2ce illuminatrice, nous r\\xE9v\\xE8le les richesses cach\\xE9es de la Parole divine. Cette section de l'\\xC9criture s'inscrit dans le grand dessein r\\xE9dempteur de Dieu, pr\\xE9parant la venue du Messie et l'\\xE9tablissement de son royaume \\xE9ternel.\\n\\n**Dimension th\\xE9ologique :** L'\\xE9tude de \".concat(passage,\" enrichit notre compr\\xE9hension de la nature divine et de ses attributs.\\n**Port\\xE9e sot\\xE9riologique :** Ce texte contribue \\xE0 notre compr\\xE9hension du salut par gr\\xE2ce au moyen de la foi.\\n**Perspective eschatologique :** Les v\\xE9rit\\xE9s r\\xE9v\\xE9l\\xE9es ici \\xE9clairent notre esp\\xE9rance en la consommation du royaume de Dieu.\");}return baseContent;};// Fonction pour Christ au centre (2000 caractères) - Très théologique et narratif\nconst generateChristCenteredContent=(passage,book,chapter,targetLength)=>{return\"La lecture christocentrique de \".concat(passage,\" r\\xE9v\\xE8le la pr\\xE9sence du Fils \\xE9ternel d\\xE8s l'\\u0153uvre cr\\xE9atrice. L'\\xC9criture nous enseigne que \\\"toutes choses ont \\xE9t\\xE9 faites par lui, et rien de ce qui a \\xE9t\\xE9 fait n'a \\xE9t\\xE9 fait sans lui\\\" (Jean 1:3). Cette v\\xE9rit\\xE9 transforme radicalement notre compr\\xE9hension de la cr\\xE9ation.\\n\\nLe Logos divin, second membre de la Trinit\\xE9 sainte, participe activement \\xE0 l'acte cr\\xE9ateur. Quand Dieu dit \\\"Que la lumi\\xE8re soit\\\", c'est la Parole \\xE9ternelle qui s'exprime. Cette lumi\\xE8re primordiale pr\\xE9figure Christ, \\\"lumi\\xE8re du monde\\\" qui viendra \\xE9clairer les t\\xE9n\\xE8bres spirituelles de l'humanit\\xE9 d\\xE9chue.\\n\\nL'expression \\\"Faisons l'homme \\xE0 notre image\\\" (Gen\\xE8se 1:26) r\\xE9v\\xE8le la consultation trinitaire. Le P\\xE8re, le Fils et le Saint-Esprit concourent \\xE0 la cr\\xE9ation de l'homme. Cette image divine imprim\\xE9e en Adam trouve son arch\\xE9type parfait en J\\xE9sus-Christ, \\\"image du Dieu invisible\\\" (Colossiens 1:15). L'homme d\\xE9chu sera restaur\\xE9 \\xE0 cette image par l'\\u0153uvre r\\xE9demptrice du Fils incarn\\xE9.\\n\\nLe sabbat cr\\xE9ationnel annonce proph\\xE9tiquement le repos que Christ procurera \\xE0 son peuple. \\\"Venez \\xE0 moi, vous tous qui \\xEAtes fatigu\\xE9s et charg\\xE9s, et je vous donnerai du repos\\\" (Matthieu 11:28). Le sabbat temporel s'accomplit dans le repos \\xE9ternel que le Sauveur assure \\xE0 tous ceux qui croient en lui.\\n\\nLa domination accord\\xE9e \\xE0 l'homme sur la cr\\xE9ation pr\\xE9figure la royaut\\xE9 universelle du Fils de l'homme. Christ, second Adam, restaurera cette domination perdue par la chute et l'exercera parfaitement dans son royaume mill\\xE9naire et \\xE9ternel.\\n\\nCette lecture christologique de la cr\\xE9ation enrichit notre adoration et affermit notre esp\\xE9rance en celui qui est \\\"l'Alpha et l'Om\\xE9ga, le commencement et la fin\\\".\");};// Fonction pour évangile et grâce (2000 caractères) - Très théologique et narratif\nconst generateGospelGraceContent=(passage,book,chapter,targetLength)=>{return\"Dans la magnificence de \".concat(passage,\", l'\\xE9vangile de la gr\\xE2ce divine se dessine d\\xE9j\\xE0 en filigrane. Bien que l'humanit\\xE9 n'ait pas encore chut\\xE9, la prescience divine conna\\xEEt d\\xE9j\\xE0 le plan r\\xE9dempteur qui se d\\xE9ploiera \\xE0 travers l'histoire sainte.\\n\\nLa cr\\xE9ation ex nihilo manifeste la gr\\xE2ce premi\\xE8re de Dieu. Rien ne l'obligeait \\xE0 cr\\xE9er ; aucun besoin ne le contraignait \\xE0 donner l'existence \\xE0 l'univers. Cette cr\\xE9ation gratuite r\\xE9v\\xE8le la nature g\\xE9n\\xE9reuse et aimante du Cr\\xE9ateur. Cette gratuit\\xE9 originelle pr\\xE9figure la gr\\xE2ce salvatrice qui sera manifest\\xE9e en J\\xE9sus-Christ.\\n\\nLa b\\xE9n\\xE9diction divine sur l'humanit\\xE9 - \\\"Dieu les b\\xE9nit\\\" - constitue la premi\\xE8re effusion de gr\\xE2ce sur les cr\\xE9atures portant son image. Cette b\\xE9n\\xE9diction cr\\xE9ationnelle anticipe la b\\xE9n\\xE9diction r\\xE9demptrice qui coulera du sacrifice de l'Agneau immol\\xE9 d\\xE8s la fondation du monde.\\n\\nL'\\xE9tablissement du sabbat r\\xE9v\\xE8le la p\\xE9dagogie divine. Dieu enseigne \\xE0 l'homme le rythme de la gr\\xE2ce : six jours de labeur suivis d'un jour de repos et de communion. Ce principe \\xE9ducatif pr\\xE9pare l'humanit\\xE9 \\xE0 comprendre que le salut ne s'obtient pas par les \\u0153uvres mais par la gr\\xE2ce, au moyen de la foi.\\n\\nL'environnement \\xE9d\\xE9nique - implicite dans ce chapitre et explicit\\xE9 au suivant - manifeste la bont\\xE9 gratuite de Dieu envers ses cr\\xE9atures. Cette bont\\xE9 originelle t\\xE9moigne du d\\xE9sir divin de communion avec l'humanit\\xE9, d\\xE9sir qui trouvera son accomplissement parfait dans l'incarnation du Fils.\\n\\nM\\xEAme la capacit\\xE9 humaine de r\\xE9pondre \\xE0 Dieu, de le conna\\xEEtre et de l'adorer, constitue un don de la gr\\xE2ce divine. L'imago Dei n'est pas un m\\xE9rite humain mais un cadeau du Cr\\xE9ateur aimant.\\n\\nCette perspective \\xE9vang\\xE9lique de la cr\\xE9ation nourrit notre gratitude et nous pr\\xE9pare \\xE0 mieux saisir la grandeur de la gr\\xE2ce salvatrice manifest\\xE9e en Christ J\\xE9sus notre Seigneur.\");};// Ajouter d'autres fonctions pour les rubriques restantes...\nconst generateCulturalContextContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Contexte culturel\",passage,book,chapter,targetLength);};const generateGeographicalContextContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Contexte géographique\",passage,book,chapter,targetLength);};const generateLexicalAnalysisContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Analyse lexicale\",passage,book,chapter,targetLength);};const generateBiblicalParallelsContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Parallèles bibliques\",passage,book,chapter,targetLength);};const generateProphecyContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Prophétie et accomplissement\",passage,book,chapter,targetLength);};const generateCharactersContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Personnages\",passage,book,chapter,targetLength);};const generateRhetoricalStructureContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Structure rhétorique\",passage,book,chapter,targetLength);};const generateTrinityTheologyContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Théologie trinitaire\",passage,book,chapter,targetLength);};const generatePersonalApplicationContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Application personnelle\",passage,book,chapter,targetLength);};const generateCommunityApplicationContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Application communautaire\",passage,book,chapter,targetLength);};const generateResponsePrayerContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Prière de réponse\",passage,book,chapter,targetLength);};const generateStudyQuestionsContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Questions d'étude\",passage,book,chapter,targetLength);};const generateVigilancePointsContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Points de vigilance\",passage,book,chapter,targetLength);};const generateObjectionsResponsesContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Objections et réponses\",passage,book,chapter,targetLength);};const generateMissionalPerspectiveContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Perspective missionnelle\",passage,book,chapter,targetLength);};const generateChristianEthicsContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Éthique chrétienne\",passage,book,chapter,targetLength);};const generateWorshipLiturgyContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Louange / liturgie\",passage,book,chapter,targetLength);};const generateGuidedMeditationContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Méditation guidée\",passage,book,chapter,targetLength);};const generateMemoryVersesContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Mémoire / versets clés\",passage,book,chapter,targetLength);};const generateActionPlanContent=(passage,book,chapter,targetLength)=>{return generateDefaultContent(\"Plan d'action\",passage,book,chapter,targetLength);};// Fonction pour générer un contenu fallback intelligent\nconst generateIntelligentFallback=(passage,book,chapter)=>{return\"**\\xC9TUDE BIBLIQUE \\u2014 28 RUBRIQUES**\\n**Passage :** \".concat(passage,\" (LSG)\\n\\n## 1. Pri\\xE8re d'ouverture\\nSeigneur, ouvre nos c\\u0153urs \\xE0 la compr\\xE9hension de \").concat(passage,\". Que ton Esprit nous guide dans ta v\\xE9rit\\xE9 et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.\\n\\n## 2. Structure litt\\xE9raire\\nLe passage de \").concat(passage,\" r\\xE9v\\xE8le une structure litt\\xE9raire soigneusement orchestr\\xE9e qui sert le propos th\\xE9ologique de l'auteur inspir\\xE9. Cette organisation guide le lecteur vers une compr\\xE9hension progressive des v\\xE9rit\\xE9s divines r\\xE9v\\xE9l\\xE9es.\\n\\n## 3. Questions du chapitre pr\\xE9c\\xE9dent\\nL'\\xE9tude de \").concat(passage,\" doit \\xEAtre mise en relation avec le contexte qui pr\\xE9c\\xE8de. Quels th\\xE8mes et enseignements pr\\xE9parent le lecteur \\xE0 comprendre ce passage dans sa continuit\\xE9 narrative et th\\xE9ologique ?\\n\\n## 4. Th\\xE8me doctrinal\\nLe th\\xE8me doctrinal central de \").concat(passage,\" manifeste des v\\xE9rit\\xE9s fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la r\\xE9v\\xE9lation progressive de Dieu.\\n\\n## 5. Fondements th\\xE9ologiques\\n\").concat(passage,\" \\xE9tablit des fondements th\\xE9ologiques importants qui \\xE9clairent notre compr\\xE9hension de l'\\u0153uvre de Dieu dans l'histoire et dans nos vies. Ces v\\xE9rit\\xE9s fondamentales structurent la foi chr\\xE9tienne.\\n\\n## 6. Contexte historique\\nLe contexte historique de \").concat(passage,\" \\xE9claire la situation des premiers auditeurs et enrichit notre compr\\xE9hension contemporaine. Conna\\xEEtre les circonstances originales aide \\xE0 saisir l'intention divine.\\n\\n## 7. Contexte culturel\\nLes \\xE9l\\xE9ments culturels pr\\xE9sents dans \").concat(passage,\" r\\xE9v\\xE8lent les coutumes et pratiques de l'\\xE9poque, permettant une meilleure interpr\\xE9tation des enseignements bibliques dans leur cadre original.\\n\\n## 8. Contexte g\\xE9ographique\\nLa g\\xE9ographie de \").concat(passage,\" offre des cl\\xE9s d'interpr\\xE9tation importantes. Les lieux mentionn\\xE9s portent souvent une signification symbolique et th\\xE9ologique qui enrichit le message.\\n\\n## 9. Analyse lexicale\\nL'\\xE9tude des termes cl\\xE9s dans \").concat(passage,\" r\\xE9v\\xE8le la richesse du vocabulaire biblique et les nuances importantes pour une compr\\xE9hension pr\\xE9cise du texte inspir\\xE9.\\n\\n## 10. Parall\\xE8les bibliques\\n\").concat(passage,\" trouve des \\xE9chos dans d'autres parties de l'\\xC9criture. Ces parall\\xE8les bibliques \\xE9clairent le sens et montrent l'unit\\xE9 de la r\\xE9v\\xE9lation divine.\\n\\n## 11. Proph\\xE9tie et accomplissement\\nLes \\xE9l\\xE9ments proph\\xE9tiques pr\\xE9sents dans \").concat(passage,\" s'inscrivent dans le plan r\\xE9dempteur de Dieu et trouvent leur accomplissement ultime en J\\xE9sus-Christ.\\n\\n## 12. Personnages\\nLes personnages mentionn\\xE9s dans \").concat(passage,\" offrent des mod\\xE8les ou des avertissements pour notre marche chr\\xE9tienne. Leur exemple instruit notre foi.\\n\\n## 13. Structure rh\\xE9torique\\nLa rh\\xE9torique employ\\xE9e dans \").concat(passage,\" r\\xE9v\\xE8le l'art divin de la communication. La structure argumentative guide le lecteur vers les v\\xE9rit\\xE9s essentielles.\\n\\n## 14. Th\\xE9ologie trinitaire\\n\").concat(passage,\" r\\xE9v\\xE8le des aspects de la nature trinitaire de Dieu : P\\xE8re, Fils et Saint-Esprit \\u0153uvrent ensemble dans l'histoire du salut.\\n\\n## 15. Christ au centre\\nChrist se r\\xE9v\\xE8le au centre de \").concat(passage,\" comme accomplissement des promesses et cl\\xE9 d'interpr\\xE9tation de l'\\xC9criture. L'herm\\xE9neutique christocentrique \\xE9claire ce texte.\\n\\n## 16. \\xC9vangile et gr\\xE2ce\\n\").concat(passage,\" manifeste la gr\\xE2ce de Dieu et les v\\xE9rit\\xE9s \\xE9vang\\xE9liques fondamentales. Le salut par gr\\xE2ce au moyen de la foi transpara\\xEEt dans ce texte.\\n\\n## 17. Application personnelle\\nComment \").concat(passage,\" transforme-t-il notre marche quotidienne avec Dieu ? Ce texte nous interpelle sur nos attitudes, nos priorit\\xE9s et notre relation avec le Seigneur.\\n\\n## 18. Application communautaire\\n\").concat(passage,\" \\xE9claire la vie de l'\\xC9glise et les relations fraternelles. Les principes \\xE9nonc\\xE9s s'appliquent \\xE0 la communaut\\xE9 des croyants.\\n\\n## 19. Pri\\xE8re de r\\xE9ponse\\nEn r\\xE9ponse \\xE0 l'\\xE9tude de \").concat(passage,\", offrons \\xE0 Dieu notre reconnaissance, notre confession et nos requ\\xEAtes. Que sa Parole transforme nos c\\u0153urs.\\n\\n## 20. Questions d'\\xE9tude\\n- Que r\\xE9v\\xE8le \").concat(passage,\" sur la nature de Dieu ?\\n- Que nous enseigne ce texte sur la condition humaine ?\\n- Quels changements ce passage appelle-t-il dans notre vie ?\\n\\n## 21. Points de vigilance\\nQuelles sont les erreurs d'interpr\\xE9tation \\xE0 \\xE9viter concernant \").concat(passage,\" ? Quels \\xE9cueils th\\xE9ologiques ce texte nous aide-t-il \\xE0 contourner ?\\n\\n## 22. Objections et r\\xE9ponses\\nComment r\\xE9pondre aux objections couramment soulev\\xE9es contre les enseignements de \").concat(passage,\" ? Quels arguments bibliques y r\\xE9pondent ?\\n\\n## 23. Perspective missionnelle\\n\").concat(passage,\" \\xE9claire-t-il notre mission d'\\xE9vang\\xE9lisation ? Comment ce texte motive-t-il et oriente-t-il l'\\u0153uvre missionnaire ?\\n\\n## 24. \\xC9thique chr\\xE9tienne\\nQuels principes \\xE9thiques \").concat(passage,\" \\xE9tablit-il ? Comment guide-t-il nos choix moraux et notre conduite chr\\xE9tienne ?\\n\\n## 25. Louange / liturgie\\nComment \").concat(passage,\" nourrit-il notre adoration ? Quels \\xE9l\\xE9ments peuvent enrichir notre louange communautaire et personnelle ?\\n\\n## 26. M\\xE9ditation guid\\xE9e\\nPrenons un moment pour m\\xE9diter personnellement sur \").concat(passage,\". Que le Saint-Esprit grave ces v\\xE9rit\\xE9s dans nos c\\u0153urs.\\n\\n## 27. M\\xE9moire / versets cl\\xE9s\\nVerset-cl\\xE9 sugg\\xE9r\\xE9 : \").concat(passage,\":1\\nM\\xE9morisons ce verset pour porter sa v\\xE9rit\\xE9 dans notre quotidien.\\n\\n## 28. Plan d'action\\n- Une action personnelle cette semaine en r\\xE9ponse \\xE0 \").concat(passage,\"\\n- Une application communautaire ce mois-ci\\n- Un t\\xE9moignage \\xE0 partager de l'impact de ce texte\");};// Fonction pour générer du contenu de fallback intelligent par rubrique\nconst generateFallbackRubriqueContent=(rubriqueNum,rubriqueTitle,passage)=>{const fallbacks={1:\"Seigneur, ouvre nos c\\u0153urs \\xE0 la compr\\xE9hension de \".concat(passage,\". Que ton Esprit nous guide dans ta v\\xE9rit\\xE9 et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.\"),2:\"Le passage de \".concat(passage,\" r\\xE9v\\xE8le une structure litt\\xE9raire soigneusement orchestr\\xE9e qui sert le propos th\\xE9ologique de l'auteur inspir\\xE9. Cette organisation n'est pas fortuite mais guide le lecteur vers une compr\\xE9hension progressive des v\\xE9rit\\xE9s divines r\\xE9v\\xE9l\\xE9es.\"),4:\"Le th\\xE8me doctrinal central de \".concat(passage,\" manifeste des v\\xE9rit\\xE9s fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la r\\xE9v\\xE9lation progressive de Dieu et trouvent leur accomplissement en Christ.\"),6:\"Le contexte historique de \".concat(passage,\" \\xE9claire la situation des premiers auditeurs et enrichit notre compr\\xE9hension contemporaine. Conna\\xEEtre les circonstances originales nous aide \\xE0 mieux saisir l'intention divine et l'application universelle du texte.\"),15:\"Christ se r\\xE9v\\xE8le au centre de \".concat(passage,\" comme accomplissement des promesses et cl\\xE9 d'interpr\\xE9tation de l'\\xC9criture. L'herm\\xE9neutique christocentrique nous permet de d\\xE9couvrir comment ce passage t\\xE9moigne de l'\\u0153uvre r\\xE9demptrice du Sauveur.\"),17:\"Application personnelle : comment \".concat(passage,\" transforme-t-il notre marche quotidienne avec Dieu et notre croissance spirituelle ? Ce texte nous interpelle sur nos attitudes, nos priorit\\xE9s et notre relation avec le Seigneur.\")};return fallbacks[rubriqueNum]||\"**\".concat(rubriqueTitle,\"**\\n\\nCette section de \").concat(passage,\" nous enseigne des v\\xE9rit\\xE9s importantes selon la perspective de \").concat(rubriqueTitle.toLowerCase(),\". L'analyse de ce passage r\\xE9v\\xE8le des insights pr\\xE9cieux pour notre compr\\xE9hension biblique et notre application pratique.\\n\\n*Contenu g\\xE9n\\xE9r\\xE9 automatiquement - \").concat(rubriqueNum,\"/\").concat(BASE_RUBRIQUES.length,\" rubriques*\");};const animateProgress=async function(){let duration=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3000;setProgressPercent(0);const steps=100,step=duration/steps;for(let i=0;i<=steps;i++){setProgressPercent(i);await wait(step);}};// YouVersion\nconst openYouVersion=()=>{if(selectedBook===\"--\")return alert(\"Veuillez d'abord sélectionner un livre de la Bible\");const bookCodes={\"Genèse\":\"GEN\",\"Exode\":\"EXO\",\"Lévitique\":\"LEV\",\"Nombres\":\"NUM\",\"Deutéronome\":\"DEU\",\"Josué\":\"JOS\",\"Juges\":\"JDG\",\"Ruth\":\"RUT\",\"1 Samuel\":\"1SA\",\"2 Samuel\":\"2SA\",\"1 Rois\":\"1KI\",\"2 Rois\":\"2KI\",\"1 Chroniques\":\"1CH\",\"2 Chroniques\":\"2CH\",\"Esdras\":\"EZR\",\"Néhémie\":\"NEH\",\"Esther\":\"EST\",\"Job\":\"JOB\",\"Psaumes\":\"PSA\",\"Proverbes\":\"PRO\",\"Ecclésiaste\":\"ECC\",\"Cantique des cantiques\":\"SNG\",\"Ésaïe\":\"ISA\",\"Jérémie\":\"JER\",\"Lamentations\":\"LAM\",\"Ézéchiel\":\"EZK\",\"Daniel\":\"DAN\",\"Osée\":\"HOS\",\"Joël\":\"JOL\",\"Amos\":\"AMO\",\"Abdias\":\"OBA\",\"Jonas\":\"JON\",\"Michée\":\"MIC\",\"Nahum\":\"NAM\",\"Habacuc\":\"HAB\",\"Sophonie\":\"ZEP\",\"Aggée\":\"HAG\",\"Zacharie\":\"ZEC\",\"Malachie\":\"MAL\",\"Matthieu\":\"MAT\",\"Marc\":\"MRK\",\"Luc\":\"LUK\",\"Jean\":\"JHN\",\"Actes\":\"ACT\",\"Romains\":\"ROM\",\"1 Corinthiens\":\"1CO\",\"2 Corinthiens\":\"2CO\",\"Galates\":\"GAL\",\"Éphésiens\":\"EPH\",\"Philippiens\":\"PHP\",\"Colossiens\":\"COL\",\"1 Thessaloniciens\":\"1TH\",\"2 Thessaloniciens\":\"2TH\",\"1 Timothée\":\"1TI\",\"2 Timothée\":\"2TI\",\"Tite\":\"TIT\",\"Philémon\":\"PHM\",\"Hébreux\":\"HEB\",\"Jacques\":\"JAS\",\"1 Pierre\":\"1PE\",\"2 Pierre\":\"2PE\",\"1 Jean\":\"1JN\",\"2 Jean\":\"2JN\",\"3 Jean\":\"3JN\",\"Jude\":\"JUD\",\"Apocalypse\":\"REV\"};const code=bookCodes[selectedBook];if(!code)return alert(\"Livre non reconnu pour YouVersion\");let url=\"https://www.bible.com/fr/bible/63/\".concat(code);if(selectedChapter!==\"--\"){url+=\".\".concat(selectedChapter);if(selectedVerse!==\"--\")url+=\".\".concat(selectedVerse);}window.open(url,\"_blank\");};// Rendre la fonction disponible globalement pour éviter les erreurs \"not defined\"\nReact.useEffect(()=>{window.openYouVersion=openYouVersion;return()=>{delete window.openYouVersion;};},[selectedBook,selectedChapter,selectedVerse]);const handleReset=()=>{saveCurrentStudy();setSelectedBook(\"--\");setSelectedChapter(\"--\");setSelectedVerse(\"--\");setSelectedVersion(\"LSG\");setSelectedLength(500);setActiveRubrique(0);setContent(\"\");setRubriquesStatus({});setProgressiveStats(null);// Note: Les notes personnelles ne sont jamais effacées lors du reset\n};// Fonctions pour les notes persistantes\nconst handleNotesClick=()=>{navigateToNotes();};// SUPPRIMÉ : showNotesModal et fonctions de modal - remplacées par page dédiée\n// SUPPRIMÉ : handleCloseNotes - plus besoin avec page dédiée\n// Fonctions pour la navigation\nconst navigateToConcordance=()=>{setCurrentPage('concordance');};const navigateToVersets=(content,bookInfo)=>{setVersetPageContent(content);setCurrentBookInfo(bookInfo);setCurrentPage('versets');};const navigateToNotes=()=>{setCurrentPage('notes');};const navigateToRubrique=function(rubriqueNumber){let content=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';console.log(\"[NAVIGATE RUBRIQUE DEBUG] Rubrique \".concat(rubriqueNumber,\":\"));console.log(\"[NAVIGATE RUBRIQUE DEBUG] Content re\\xE7u:\",content?content.length:0,\"caractères\");console.log(\"[NAVIGATE RUBRIQUE DEBUG] Content preview:\",content?content.slice(0,100)+\"...\":\"VIDE\");setCurrentRubriqueNumber(rubriqueNumber);setCurrentRubriqueContent(content);const bookInfo=\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1').concat(selectedVerse!==\"--\"?\":\"+selectedVerse:\"\");setCurrentBookInfo(bookInfo);setCurrentPage('rubrique');};const navigateToMain=()=>{setCurrentPage('main');};// Fonction pour revenir de la page d'histoire de personnage\nconst handleBackFromCharacter=()=>{setSelectedCharacterForHistory(null);};const continueVerses=async()=>{try{setIsLoading(true);const book=selectedBook||'Genèse';const chapter=selectedChapter||'1';const passage=\"\".concat(book,\" \").concat(chapter);const startVerse=currentVerseCount+1;const endVerse=currentVerseCount+5;console.log(\"[CONTINUE VERSETS] G\\xE9n\\xE9ration versets \".concat(startVerse,\" \\xE0 \").concat(endVerse,\" pour \").concat(passage));const apiUrl=\"\".concat(API_BASE,\"/generate-verse-by-verse\");const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({passage:\"\".concat(passage,\":\").concat(startVerse,\"-\").concat(endVerse),version:selectedVersion||'LSG',tokens:parseInt(selectedLength)||500,use_gemini:true,enriched:true})});if(!response.ok){throw new Error(\"Erreur API: \".concat(response.status));}const data=await response.json();if(data.content){const currentContent=content;const newContent=postProcessMarkdown(data.content);const formattedNewContent=formatContent(newContent,'versets-prog');// Ajouter le nouveau contenu au contenu existant\nsetContent(currentContent+'\\n\\n'+formattedNewContent);setCurrentVerseCount(endVerse);// Vérifier s'il y a encore des versets à générer\nif(endVerse>=31){// Genèse 1 a 31 versets\nsetCanContinueVerses(false);}console.log(\"[SUCCESS] Versets \".concat(startVerse,\"-\").concat(endVerse,\" ajout\\xE9s avec succ\\xE8s\"));}}catch(error){console.error('[ERROR] Erreur continuation versets:',error);setContent(prev=>prev+'\\n\\n❌ Erreur lors de la génération des versets suivants');}setIsLoading(false);};const handleRubriqueSelect=async id=>{setActiveRubrique(id);// Créer une clé unique pour cette combinaison livre/chapitre\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_\").concat(id);// Si la rubrique est déjà générée, afficher le contenu\nif(rubriquesStatus[id]===\"completed\"&&generatedRubriques[contentKey]){console.log(\"[AFFICHAGE RUBRIQUE \".concat(id,\"] Contenu sauvegard\\xE9 trouv\\xE9 - longueur: \").concat(generatedRubriques[contentKey].length));// Si rubrique 0 et qu'il y a du contenu verset par verset, naviguer vers la page verset dédiée\nif(id===0&&(generatedRubriques[contentKey].includes('VERSET')||generatedRubriques[contentKey].includes('**TEXTE BIBLIQUE'))){const bookInfo=\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1').concat(selectedVerse!==\"--\"?\":\"+selectedVerse:\"\");navigateToVersets(generatedRubriques[contentKey],bookInfo);}// Si rubrique 1-28, naviguer vers la page rubrique dédiée avec le contenu existant\nelse if(id>=1&&id<=28){console.log(\"[NAVIGATION RUBRIQUE \".concat(id,\"] Avec contenu existant\"));navigateToRubrique(id,generatedRubriques[contentKey]);}else{setContent(generatedRubriques[contentKey]);}}// Pour les rubriques 1-28, générer via API au lieu du contenu statique\nif(id>=1&&id<=28){console.log(\"[G\\xC9N\\xC9RATION API RUBRIQUE \".concat(id,\"] D\\xE9but g\\xE9n\\xE9ration via API pour \").concat(selectedBook,\" \").concat(selectedChapter));setIsLoading(true);setRubriquesStatus(prev=>_objectSpread(_objectSpread({},prev),{},{[id]:\"loading\"}));try{const rubriqueTitle=getRubTitle(id);const passage=\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1');const targetLength=getRubriqueLength(id);// Appel API pour générer le contenu dynamique\nconst apiContent=await generateRubriqueContentViaAPI(id,rubriqueTitle,passage,selectedBook||'Genèse',selectedChapter||'1',targetLength);// Sauvegarder le contenu généré\nsetGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:apiContent}));setRubriquesStatus(prev=>_objectSpread(_objectSpread({},prev),{},{[id]:\"completed\"}));console.log(\"[SUCC\\xC8S API RUBRIQUE \".concat(id,\"] Contenu g\\xE9n\\xE9r\\xE9 et sauvegard\\xE9 - longueur: \").concat(apiContent.length));// Naviguer vers la page rubrique dédiée avec le nouveau contenu\nnavigateToRubrique(id,apiContent);}catch(error){console.error(\"[ERREUR API RUBRIQUE \".concat(id,\"]\"),error);setRubriquesStatus(prev=>_objectSpread(_objectSpread({},prev),{},{[id]:\"error\"}));setContent(\"\\u274C Erreur lors de la g\\xE9n\\xE9ration de la rubrique \".concat(id,\": \").concat(getRubTitle(id)));}setIsLoading(false);return;}if(id===0){// Rubrique 0 : Étude verset par verset - naviguer vers la page dédiée si du contenu existe\nconsole.log(\"[RUBRIQUE 0] V\\xE9rification contenu existant - cl\\xE9: \".concat(contentKey));if(generatedRubriques[contentKey]&&(generatedRubriques[contentKey].includes('VERSET')||generatedRubriques[contentKey].includes('**TEXTE BIBLIQUE'))){console.log(\"[RUBRIQUE 0] Contenu verset par verset trouv\\xE9, navigation vers page d\\xE9di\\xE9e\");const bookInfo=\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1').concat(selectedVerse!==\"--\"?\":\"+selectedVerse:\"\");navigateToVersets(generatedRubriques[contentKey],bookInfo);}else{console.log(\"[RUBRIQUE 0] Aucun contenu trouv\\xE9, affichage message d'instruction\");setContent(\"Cliquez sur **Versets Prog** pour générer l'étude verset par verset de ce chapitre.\");setIsVersetsProgContent(false);}}else{setContent(\"\");}};// Fonction pour générer une rubrique à la demande\nconst generateRubriqueOnDemand=async rubriqueNum=>{if(rubriqueNum===0)return;// Rubrique 0 utilise VERSETS PROG\nconst rubriqueTitle=BASE_RUBRIQUES[rubriqueNum];const passage=selectedVerse===\"--\"||selectedVerse===\"vide\"?\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1'):\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1',\":\").concat(selectedVerse);try{console.log(\"[G\\xC9N\\xC9RATION \\xC0 LA DEMANDE] Rubrique \".concat(rubriqueNum,\": \").concat(rubriqueTitle));setIsLoading(true);setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"in-progress\"}));// Afficher le contenu en cours de génération\nconst contentEnCours=\"# \\xC9tude - \".concat(passage,\"\\n\\n## \").concat(rubriqueNum,\". \").concat(rubriqueTitle,\"\\n\\n\\uD83D\\uDD04 G\\xE9n\\xE9ration intelligente en cours...\");setContent(formatContent(contentEnCours));// Générer le contenu intelligent pour cette rubrique\nconst rubriqueContent=await generateRubriqueContentViaAPI(rubriqueNum,rubriqueTitle,passage,selectedBook,selectedChapter,parseInt(selectedLength));// Délai pour effet visuel\nawait wait(1000);// Afficher le contenu final\nconst contentFinal=\"# \\xC9tude - \".concat(passage,\"\\n\\n## \").concat(rubriqueNum,\". \").concat(rubriqueTitle,\"\\n\\n\").concat(rubriqueContent);const formattedContent=formatContent(contentFinal);setContent(formattedContent);// Sauvegarder le contenu dans l'état (plus fiable que localStorage)\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_\").concat(rubriqueNum);setGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:formattedContent}));// Marquer comme terminé\nsetRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"completed\"}));console.log(\"[RUBRIQUE \".concat(rubriqueNum,\" G\\xC9N\\xC9R\\xC9E] \").concat(rubriqueContent.length,\" caract\\xE8res\"));}catch(error){console.error(\"[ERREUR G\\xC9N\\xC9RATION RUBRIQUE \".concat(rubriqueNum,\"]\"),error);setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"error\"}));setContent(\"# Erreur\\n\\nErreur lors de la g\\xE9n\\xE9ration de la rubrique \".concat(rubriqueNum,\": \").concat(error.message));}finally{setIsLoading(false);}};// Palette (reprend ta logique initiale)\nconst changePalette=()=>{const nextTheme=(currentTheme+1)%colorThemes.length;setCurrentTheme(nextTheme);const theme=colorThemes[nextTheme];const app=document.querySelector('.App');if(app)app.style.background='transparent';// Garder arrière-plan transparent\nconst header=document.querySelector('.header-banner');if(header)header.style.background=theme.headerBg;document.documentElement.style.setProperty('--theme-primary',\"linear-gradient(135deg, \".concat(theme.primary,\", \").concat(theme.secondary,\")\"));document.documentElement.style.setProperty('--theme-secondary',\"linear-gradient(135deg, \".concat(theme.secondary,\", \").concat(theme.primary,\")\"));document.documentElement.style.setProperty('--theme-accent',\"linear-gradient(135deg, \".concat(theme.accent,\", \").concat(theme.secondary,\")\"));// Couleurs pour les ombres\nconst hexToRgba=(hex,alpha)=>{const r=parseInt(hex.slice(1,3),16);const g=parseInt(hex.slice(3,5),16);const b=parseInt(hex.slice(5,7),16);return\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\", \").concat(alpha,\")\");};document.documentElement.style.setProperty('--theme-accent-shadow',hexToRgba(theme.accent,0.3));document.documentElement.style.setProperty('--theme-accent-shadow-hover',hexToRgba(theme.accent,0.4));const progressPill=document.querySelector('.progress-pill');if(progressPill)progressPill.style.background=theme.primary;const contentHeader=document.querySelector('.content-header');if(contentHeader)contentHeader.style.background=\"linear-gradient(135deg, \".concat(theme.primary,\", \").concat(theme.secondary,\")\");const btnReset=document.querySelector('.btn-reset');if(btnReset){btnReset.style.background=theme.secondary;btnReset.style.color='white';btnReset.style.border='none';}const btnPalette=document.querySelector('.btn-palette');if(btnPalette){btnPalette.style.background=theme.primary;btnPalette.style.color='white';btnPalette.style.border='none';}const btnLastStudy=document.querySelector('.btn-last-study');if(btnLastStudy){btnLastStudy.style.background=\"linear-gradient(135deg, \".concat(theme.primary,\", \").concat(theme.secondary,\")\");btnLastStudy.style.color='white';btnLastStudy.style.border='none';}const btnGemini=document.querySelector('.btn-gemini');if(btnGemini){btnGemini.style.background=\"linear-gradient(90deg, \".concat(theme.secondary,\", \").concat(theme.accent,\")\");btnGemini.style.color='white';btnGemini.style.border='none';}const btnVersets=document.querySelector('.btn-versets-prog');if(btnVersets){btnVersets.style.background=theme.accent;btnVersets.style.color='white';btnVersets.style.border='none';}const btnGenerate=document.querySelector('.btn-generate');if(btnGenerate){btnGenerate.style.background=\"linear-gradient(45deg, \".concat(theme.primary,\", \").concat(theme.secondary,\")\");btnGenerate.style.color='white';btnGenerate.style.border='none';}const btnValidate=document.querySelector('.btn-validate');if(btnValidate){btnValidate.style.background=theme.primary;btnValidate.style.color='white';btnValidate.style.border='none';}};/* =========================\n     Génération (avec fallbacks)\n  ========================= */const generateVerseByVerseProgressive=async()=>{console.log(\"[DEBUG] generateVerseByVerseProgressive function called!\");try{setIsLoading(true);setIsProgressiveLoading(true);setContent(\"\");setProgressPercent(0);setIsVersetsProgContent(true);// Marquer que c'est du contenu VERSETS PROG\nsetRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{0:\"in-progress\"}));// Format exact requis par l'API Railway\nconst book=selectedBook||'Genèse';const chapter=selectedChapter||'1';const passage=\"\".concat(book,\" \").concat(chapter);console.log(\"[VERSETS PROG] Génération progressive pour:\",passage);// 🔹 UTILISER VOTRE BACKEND avec votre clé Gemini GRATUITE\nconsole.log(\"[VERSETS PROG] Utilisation de votre backend avec clé Gemini gratuite\");// CORRECTION: Utiliser la variable d'environnement pour l'endpoint\nconst apiUrl=\"\".concat(API_BASE,\"/generate-verse-by-verse\");console.log(\"[VERSETS PROG] URL backend utilisée:\",apiUrl);const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({passage:passage,version:selectedVersion||'LSG',tokens:parseInt(selectedLength)||500,use_gemini:true,enriched:true})});if(!response.ok){console.error(\"[VERSETS PROG] Erreur API Railway: \".concat(response.status));throw new Error(\"API Railway Error \".concat(response.status));}const data=await response.json();console.log(\"[API RAILWAY OK] Contenu reçu:\",data.content?data.content.length:0,\"caractères\");// Afficher des informations sur la source du contenu\nconst sourceInfo=data.source||\"API\";const fromCache=data.from_cache||false;const cost=data.cost||\"Traitement\";console.log(\"[SOURCE] \".concat(sourceInfo,\" \").concat(fromCache?'(Cache)':'(Nouveau)',\" - \").concat(cost));// Afficher un message informatif selon la source\nif(fromCache){console.log(\"📋 Contenu récupéré du cache - réponse instantanée\");}else if(sourceInfo.includes(\"Fallback\")||sourceInfo.includes(\"théologique\")){console.log(\"🔄 Quota Gemini atteint - utilisation du système de fallback intelligent\");}else if(sourceInfo.includes(\"Gemini\")){console.log(\"🤖 Contenu généré par Gemini avec votre clé personnelle\");}// Utiliser le contenu de l'API (correction du bug d'affichage)\nif(!data.content){throw new Error(\"Aucun contenu reçu de l'API\");}const fullContent=data.content;// Initialiser les états de continuation\nsetCurrentVerseCount(5);// Par défaut, on génère 5 versets\nsetCanContinueVerses(true);// Permettre la continuation\n// Affichage immédiat du contenu optimisé avec boutons Gemini\nconst finalContent=postProcessMarkdown(fullContent);setContent(formatContent(finalContent,'versets-prog'));setProgressPercent(100);setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{0:\"completed\"}));setIsVersetsProgContent(true);// IMPORTANT : activer l'état VERSETS PROG\nconsole.log(\"[SUCCESS] Contenu VERSETS PROG affiché correctement\");// Sauvegarder l'étude après génération réussie\nsaveCurrentStudy();console.log(\"[SAUVEGARDE] Étude verset par verset sauvegardée\");// Sauvegarder le contenu dans generatedRubriques pour la navigation\nconst contentKey=\"\".concat(selectedBook||'Genèse',\"_\").concat(selectedChapter||'1',\"_0\");setGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:fullContent}));// Naviguer automatiquement vers la page dédiée \"Verset par Verset\"\nconst bookInfo=\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1').concat(selectedVerse!==\"--\"?\":\"+selectedVerse:\"\");console.log(\"[NAVIGATION] Préparation navigation vers page Verset par Verset:\",bookInfo);setTimeout(()=>{console.log(\"[NAVIGATION] Navigation vers la page dédiée Verset par Verset\");navigateToVersets(fullContent,bookInfo);},500);// Petit délai pour l'effet visuel\n}catch(err){console.error(\"Erreur génération VERSETS PROG:\",err);setContent(\"Erreur lors de la g\\xE9n\\xE9ration progressive: \".concat(err.message));setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{0:\"error\"}));}finally{setIsLoading(false);setIsProgressiveLoading(false);setProgressPercent(100);}};const generateWithGemini=async()=>{try{setIsLoading(true);setContent(\"Enrichissement théologique avec votre Gemini gratuit en cours...\");setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[activeRubrique]:\"in-progress\"}));const passage=selectedVerse===\"--\"||selectedVerse===\"vide\"?\"\".concat(selectedBook,\" \").concat(selectedChapter):\"\".concat(selectedBook,\" \").concat(selectedChapter,\":\").concat(selectedVerse);// Enrichir théologiquement avec votre clé Gemini gratuite\nif(activeRubrique>=1&&activeRubrique<=28){const rubriqueTitle=BASE_RUBRIQUES[activeRubrique];// Générer un enrichissement théologique avec longueur augmentée\nconst enrichedLength=Math.min(2000,parseInt(selectedLength)+500);console.log(\"[ENRICHISSEMENT GEMINI GRATUIT] Rubrique \".concat(activeRubrique,\" - Longueur enrichie: \").concat(enrichedLength,\" caract\\xE8res\"));// Appeler votre backend avec votre clé Gemini gratuite\nconst response=await fetch(\"\".concat(API_BASE,\"/generate-verse-by-verse\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({passage:passage,version:selectedVersion||'LSG',tokens:enrichedLength,use_gemini:true,enriched:true,rubric_type:rubriqueTitle})});if(!response.ok){throw new Error(\"Erreur API: \".concat(response.status));}const data=await response.json();console.log(\"[GEMINI GRATUIT] Enrichissement reçu:\",data.content?data.content.length:0,\"caractères\");if(data.content){// Afficher le contenu enrichi avec votre Gemini gratuit\nconst finalContent=\"# \\xC9tude Enrichie avec Gemini Gratuit - \".concat(passage,\"\\n\\n## \").concat(activeRubrique,\". \").concat(rubriqueTitle,\"\\n\\n\").concat(data.content);setContent(formatContent(finalContent));// Sauvegarder le contenu enrichi\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_\").concat(activeRubrique);setGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:formatContent(finalContent)}));console.log(\"[SUCCESS] Enrichissement Gemini gratuit affiché correctement\");// Sauvegarder l'étude après enrichissement réussi\nsaveCurrentStudy();console.log(\"[SAUVEGARDE] Étude enrichie Gemini sauvegardée\");}else{throw new Error(\"Pas de contenu reçu de votre Gemini gratuit\");}}else if(activeRubrique===0){// Pour la rubrique 0, utiliser VERSETS PROG qui utilise déjà votre Gemini\nsetContent(\"⚠️ Pour la rubrique 0, utilisez le bouton 'VERSETS PROG' qui utilise déjà votre Gemini gratuit.\");}else{setContent(\"⚠️ Rubrique non supportée pour l'enrichissement Gemini.\");}setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[activeRubrique]:\"completed\"}));}catch(err){console.error(\"Erreur enrichissement Gemini gratuit:\",err);setContent(\"Erreur enrichissement avec votre Gemini gratuit: \".concat(err.message));setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[activeRubrique]:\"error\"}));}finally{setIsLoading(false);}};// Fonction pour enrichissement théologique contextuel et intelligent\nconst generateTheologicalEnrichment=async(rubriqueNum,rubriqueTitle,passage,book,chapter,targetLength)=>{const baseContent=await generateRubriqueContentViaAPI(rubriqueNum,rubriqueTitle,passage,book,chapter,targetLength);// Enrichissement spécifique selon le livre biblique\nconst bookEnrichment=getBookSpecificEnrichment(book,chapter);// Enrichissement spécifique selon la rubrique\nconst rubriqueEnrichment=getRubriqueSpecificEnrichment(rubriqueNum,rubriqueTitle);// Enrichissement contextuel combiné\nconst contextualEnrichment=getCombinedContextualEnrichment(book,chapter,rubriqueNum,passage);const enrichmentSuffix=\"\\n\\n**\\uD83E\\uDD16 ENRICHISSEMENT CONTEXTUEL - \".concat(passage,\"**\\n\\n\").concat(bookEnrichment,\"\\n\\n\").concat(rubriqueEnrichment,\"\\n\\n\").concat(contextualEnrichment,\"\\n\\n*Enrichissement g\\xE9n\\xE9r\\xE9 par analyse contextuelle approfondie*\");return baseContent+enrichmentSuffix.substring(0,Math.max(0,targetLength-baseContent.length));};// Enrichissement spécifique par livre biblique\nconst getBookSpecificEnrichment=(book,chapter)=>{const bookEnrichments={'Genèse':\"**Perspective cr\\xE9ationnelle :** \".concat(book,\" \").concat(chapter,\" s'inscrit dans le cadre de la th\\xE9ologie de la cr\\xE9ation. Les commentateurs patristiques, notamment Basile de C\\xE9sar\\xE9e dans ses Hom\\xE9lies sur l'Hexam\\xE9ron, ont d\\xE9velopp\\xE9 une ex\\xE9g\\xE8se remarquable de ces passages fondateurs.\"),'Exode':\"**Perspective lib\\xE9ratrice :** \".concat(book,\" \").concat(chapter,\" r\\xE9v\\xE8le la p\\xE9dagogie divine de la r\\xE9demption. Philon d'Alexandrie et plus tard l'\\xC9cole de th\\xE9ologie d'Antioche ont soulign\\xE9 les dimensions typologiques de ce r\\xE9cit qui pr\\xE9figure la lib\\xE9ration spirituelle en Christ.\"),'Lévitique':\"**Perspective sacrificielle :** \".concat(book,\" \").concat(chapter,\" d\\xE9veloppe la th\\xE9ologie cultuelle et sacrificielle. Les th\\xE9ologiens de l'Alliance (Cocceius, Witsius) ont magistralement d\\xE9montr\\xE9 comment ces prescriptions rituelles trouvent leur accomplissement dans l'\\u0153uvre sacerdotale du Christ.\"),'Nombres':\"**Perspective p\\xE8lerine :** \".concat(book,\" \").concat(chapter,\" illustre la marche du peuple de Dieu vers la Terre Promise. John Bunyan dans \\\"The Pilgrim's Progress\\\" s'inspire de ces r\\xE9cits pour d\\xE9crire le p\\xE8lerinage spirituel du chr\\xE9tien.\"),'Deutéronome':\"**Perspective testamentaire :** \".concat(book,\" \").concat(chapter,\" constitue le testament mosa\\xEFque. Les th\\xE9ologiens de l'\\xC9cole de Saumur (Amyraut, Cappel) ont analys\\xE9 la structure alliance-b\\xE9n\\xE9diction-mal\\xE9diction qui structure ce livre.\"),'Matthieu':\"**Perspective messianique :** \".concat(book,\" \").concat(chapter,\" r\\xE9v\\xE8le l'accomplissement des promesses v\\xE9t\\xE9rotestamentaires. Chrysostome dans ses Hom\\xE9lies sur Matthieu d\\xE9veloppe une christologie remarquable bas\\xE9e sur ce texte \\xE9vang\\xE9lique.\"),'Marc':\"**Perspective k\\xE9rygmatique :** \".concat(book,\" \").concat(chapter,\" pr\\xE9sente le Christ en action. L'ex\\xE9g\\xE8se moderne (Dodd, Jeremias) a soulign\\xE9 la dimension k\\xE9rygmatique primitive de ce r\\xE9cit \\xE9vang\\xE9lique.\"),'Luc':\"**Perspective historico-salvifique :** \".concat(book,\" \").concat(chapter,\" s'inscrit dans l'histoire du salut. Conzelmann et l'\\xC9cole de T\\xFCbingen ont d\\xE9velopp\\xE9 une th\\xE9ologie lucanienne de l'histoire sainte particuli\\xE8rement \\xE9clairante.\"),'Jean':\"**Perspective th\\xE9ologique :** \".concat(book,\" \").concat(chapter,\" r\\xE9v\\xE8le la divinit\\xE9 du Christ. Les P\\xE8res cappadociens (Basile, Gr\\xE9goire de Nazianze, Gr\\xE9goire de Nysse) ont utilis\\xE9 ce corpus johannique pour d\\xE9velopper la th\\xE9ologie trinitaire.\"),'Romains':\"**Perspective sot\\xE9riologique :** \".concat(book,\" \").concat(chapter,\" d\\xE9veloppe la doctrine du salut par gr\\xE2ce. Augustin, Luther, et Calvin ont fond\\xE9 leur th\\xE9ologie de la justification sur cette \\xE9p\\xEEtre magistrale.\"),'Hébreux':\"**Perspective sacerdotale :** \".concat(book,\" \").concat(chapter,\" pr\\xE9sente le sacerdoce parfait du Christ. Owen dans son commentaire monumental a d\\xE9velopp\\xE9 une th\\xE9ologie sacrificielle d'une profondeur in\\xE9gal\\xE9e.\")};return bookEnrichments[book]||\"**Perspective biblique :** Ce passage de \".concat(book,\" \").concat(chapter,\" r\\xE9v\\xE8le des dimensions th\\xE9ologiques que les commentateurs anciens et modernes ont explor\\xE9es avec profit.\");};// Enrichissement spécifique par rubrique\nconst getRubriqueSpecificEnrichment=(rubriqueNum,rubriqueTitle)=>{const rubriqueEnrichments={1:\"**Enrichissement liturgique :** La tradition de la \\\"pri\\xE8re d'ouverture\\\" remonte aux P\\xE8res du d\\xE9sert. Jean Cassien dans ses Conf\\xE9rences spirituelles enseigne l'importance de l'invocation pr\\xE9alable pour toute lectio divina authentique.\",2:\"**Enrichissement litt\\xE9raire :** L'analyse structurelle moderne (rh\\xE9torique s\\xE9mitique, Meynet) r\\xE9v\\xE8le des patterns sophistiqu\\xE9s que l'ex\\xE9g\\xE8se ancienne pressentait intuitivement. Cette approche enrichit consid\\xE9rablement la compr\\xE9hension du texte.\",5:\"**Enrichissement dogmatique :** Les fondements th\\xE9ologiques \\xE9tablis ici nourrissent la th\\xE9ologie syst\\xE9matique. Turretin dans ses Institutes of Elenctic Theology d\\xE9veloppe ces v\\xE9rit\\xE9s avec une rigueur scolastique remarquable.\",15:\"**Enrichissement christologique :** La lecture christocentrique trouve ici ses fondements herm\\xE9neutiques. Vos dans sa Biblical Theology d\\xE9veloppe une approche christot\\xE9lique qui \\xE9claire remarquablement ce passage.\",16:\"**Enrichissement sot\\xE9riologique :** La doctrine de la gr\\xE2ce r\\xE9v\\xE9l\\xE9e ici constitue le c\\u0153ur de l'\\xC9vangile. Les th\\xE9ologiens de Dordrecht ont systematis\\xE9 ces v\\xE9rit\\xE9s dans les Canons qui demeurent normatifs.\"};return rubriqueEnrichments[rubriqueNum]||\"**Enrichissement th\\xE9matique :** Cette rubrique \\\"\".concat(rubriqueTitle,\"\\\" ouvre des perspectives th\\xE9ologiques que la tradition ex\\xE9g\\xE9tique a particuli\\xE8rement d\\xE9velopp\\xE9es.\");};// Enrichissement contextuel combiné\nconst getCombinedContextualEnrichment=(book,chapter,rubriqueNum,passage)=>{// Logique contextuelle sophistiquée combinant livre + rubrique\nif(book==='Genèse'&&rubriqueNum===1){return\"**Synth\\xE8se contextuelle :** La pri\\xE8re d'ouverture sur Gen\\xE8se \".concat(chapter,\" nous place dans la contemplation de l'\\u0153uvre cr\\xE9atrice primordiale. Basile le Grand souligne que cette m\\xE9ditation doit commencer par l'adoration du Cr\\xE9ateur avant l'analyse de la cr\\xE9ation.\");}if(book==='Genèse'&&rubriqueNum===15){return\"**Synth\\xE8se christologique :** Christ pr\\xE9sent d\\xE8s Gen\\xE8se \".concat(chapter,\" selon l'ex\\xE9g\\xE8se patristique. Justin Martyr dans son Dialogue avec Tryphon identifie le Logos aux th\\xE9ophanies primitives, perspective reprise par la tradition r\\xE9form\\xE9e.\");}if(book==='Matthieu'&&rubriqueNum===16){return\"**Synth\\xE8se \\xE9vang\\xE9lique :** L'\\xE9vangile de la gr\\xE2ce r\\xE9v\\xE9l\\xE9 en Matthieu \".concat(chapter,\" accomplit les promesses v\\xE9t\\xE9rotestamentaires. Cette continuit\\xE9 r\\xE9demptrice structure toute la th\\xE9ologie de l'alliance selon la tradition r\\xE9form\\xE9e (Westminster Confession).\");}if((book==='Lévitique'||book==='Hébreux')&&rubriqueNum===15){return\"**Synth\\xE8se typologique :** Le syst\\xE8me sacrificiel de \".concat(book,\" \").concat(chapter,\" trouve son accomplissement parfait dans l'\\u0153uvre sacerdotale du Christ. Cette typologie biblique, d\\xE9velopp\\xE9e par l'\\xC9cole d'Antioche, r\\xE9v\\xE8le l'unit\\xE9 de l'histoire sainte.\");}return\"**Synth\\xE8se th\\xE9ologique :** L'intersection entre \".concat(book,\" \").concat(chapter,\" et cette dimension th\\xE9ologique r\\xE9v\\xE8le des v\\xE9rit\\xE9s que l'ex\\xE9g\\xE8se traditionnelle a particuli\\xE8rement valoris\\xE9es dans l'\\xE9dification de l'\\xC9glise.\");};const generate28Points=async()=>{try{setIsLoading(true);setIsVersetsProgContent(false);// Désactiver le style VERSETS PROG\n// 🔹 ÉTAPE 1: Vider la rubrique 0 et passer sa LED au gris\nsetRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{0:\"inactive\"}));// LED grise pour rubrique 0\nsetContent(\"\");// Vider le contenu affiché\nconsole.log(\"[GÉNÉRATION RUBRIQUE PAR RUBRIQUE] Début avec Prière d'ouverture\");const passage=selectedVerse===\"--\"||selectedVerse===\"vide\"?\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1'):\"\".concat(selectedBook||'Genèse',\" \").concat(selectedChapter||'1',\":\").concat(selectedVerse);// 🔹 STRATÉGIE OPTIMISÉE: Rubrique 1 d'abord, puis les autres\nconsole.log(\"[GÉNÉRATION OPTIMISÉE] Génération immédiate de la Rubrique 1, puis les autres en arrière-plan\");// 🎯 PHASE 1: Générer et naviguer vers Rubrique 1 immédiatement\nconsole.log(\"[PHASE 1] Génération et navigation immédiate vers Rubrique 1 - Prière d'ouverture\");try{// Générer la Rubrique 1 avec un appel API direct plus rapide\nconst response=await fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/generate-rubrique-content\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({rubrique_number:1,rubrique_title:\"Prière d'ouverture\",book:selectedBook||\"Genèse\",chapter:selectedChapter||\"1\",passage:passage,target_length:500})});if(response.ok){const data=await response.json();if(data.status===\"success\"||data.status===\"fallback\"){const rubrique1Content=data.content||'';console.log(\"[NAVIGATION IMM\\xC9DIATE] Rubrique 1 g\\xE9n\\xE9r\\xE9e: \".concat(rubrique1Content.length,\" caract\\xE8res - API: \").concat(data.api_used));console.log(\"[CONTENU PREVIEW]\",rubrique1Content.slice(0,100)+\"...\");// Sauvegarder le contenu dans l'état\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_1\");setGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:rubrique1Content}));setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{1:\"completed\"}));// Navigation immédiate avec le contenu frais\nnavigateToRubrique(1,rubrique1Content);setProgressPercent(4);// 1/28 ≈ 4%\n}else{console.error(\"[API ERREUR] Impossible de générer la Rubrique 1\");throw new Error(\"API call failed\");}}else{console.error(\"[API ERREUR] Réponse non OK:\",response.status);throw new Error(\"API call failed\");}}catch(error){console.error(\"[ERREUR PHASE 1]\",error);// Fallback: utiliser la génération normale\nconst rubrique1Content=await generateSingleRubrique(1,BASE_RUBRIQUES[1],passage);if(rubrique1Content){navigateToRubrique(1,rubrique1Content);setProgressPercent(4);}}// 🎯 PHASE 2: Générer les 27 autres rubriques en arrière-plan\nconsole.log(\"[PHASE 2] Génération des 27 autres rubriques en arrière-plan\");// Générer les rubriques restantes par lots de 5\nconst generateRemainingRubriques=async()=>{const batchSize=5;for(let i=2;i<=28;i+=batchSize){const batch=[];const endIndex=Math.min(i+batchSize-1,28);console.log(\"[ARRI\\xC8RE-PLAN] G\\xE9n\\xE9ration rubriques \".concat(i,\" \\xE0 \").concat(endIndex));for(let j=i;j<=endIndex;j++){if(j<=BASE_RUBRIQUES.length-1){const rubriqueTitle=BASE_RUBRIQUES[j];batch.push(generateSingleRubrique(j,rubriqueTitle,passage));}}await Promise.all(batch);// Mettre à jour le progrès\nconst progress=Math.floor(endIndex/28*100);setProgressPercent(progress);console.log(\"[ARRI\\xC8RE-PLAN] \".concat(endIndex,\"/28 rubriques g\\xE9n\\xE9r\\xE9es (\").concat(progress,\"%)\"));// Petit délai entre les batches\nif(endIndex<28){await new Promise(resolve=>setTimeout(resolve,1000));}}};// Lancer la génération en arrière-plan (non-bloquante)\ngenerateRemainingRubriques().then(()=>{console.log(\"[ARRIÈRE-PLAN] Toutes les rubriques terminées!\");setProgressPercent(100);}).catch(error=>{console.error(\"[ARRIÈRE-PLAN] Erreur:\",error);});console.log(\"[GÉNÉRATION AUTOMATIQUE] Toutes les 28 rubriques générées!\");// Sauvegarder l'étude après génération réussie\nsaveCurrentStudy();console.log(\"[SAUVEGARDE] Étude complète des 28 rubriques sauvegardée\");}catch(error){console.error(\"[ERREUR GÉNÉRATION]\",error);setContent(formatContent(\"# Erreur\\n\\nUne erreur est survenue lors de la g\\xE9n\\xE9ration : \".concat(error.message)));}finally{setIsLoading(false);setProgressPercent(100);}};// Nouvelle fonction pour générer UNE SEULE rubrique\nconst generateSingleRubrique=async(rubriqueNum,rubriqueTitle,passage)=>{try{console.log(\"[G\\xC9N\\xC9RATION RUBRIQUE \".concat(rubriqueNum,\"] DEMAND\\xC9E: \\\"\").concat(rubriqueTitle,\"\\\" pour \").concat(passage));console.log(\"[DEBUG PARAMS] rubriqueNum=\".concat(rubriqueNum,\", rubriqueTitle=\\\"\").concat(rubriqueTitle,\"\\\", passage=\\\"\").concat(passage,\"\\\"\"));// Marquer la rubrique en cours\nsetRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"in-progress\"}));setProgressPercent(20);// Afficher le titre en attente\nconst contentEnCours=\"# \\xC9tude - \".concat(passage,\"\\n\\n## \").concat(rubriqueNum,\". \").concat(rubriqueTitle,\"\\n\\n\\uD83D\\uDD04 G\\xE9n\\xE9ration intelligente en cours...\");setContent(formatContent(contentEnCours));// Appel API pour CETTE rubrique avec notre système Gemini intelligent\nconst apiUrl=\"\".concat(API_BASE,\"/api/generate-rubrique-content\");let rubriqueContent;try{setProgressPercent(50);const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({rubrique_number:rubriqueNum,rubrique_title:rubriqueTitle,book:selectedBook||\"Genèse\",chapter:selectedChapter||\"1\",passage:passage,target_length:parseInt(selectedLength)||500})});if(!response.ok){throw new Error(\"API Error: \".concat(response.status));}const data=await response.json();console.log(\"[API SUCCESS RUBRIQUE \".concat(rubriqueNum,\"]\"),data.content?data.content.length:0,\"caractères\");console.log(\"[API DATA]\",data);if(data.status===\"success\"||data.status===\"fallback\"){rubriqueContent=data.content;console.log(\"[RUBRIQUE \".concat(rubriqueNum,\"] Contenu g\\xE9n\\xE9r\\xE9 avec succ\\xE8s:\"),rubriqueContent.slice(0,100)+\"...\");}else{throw new Error(\"Réponse API invalide\");}}catch(apiError){console.error(\"[API \\xC9CHEC RUBRIQUE \".concat(rubriqueNum,\"] \").concat(apiError.message),apiError);console.warn(\"[FALLBACK] G\\xE9n\\xE9ration de contenu de base pour rubrique \".concat(rubriqueNum));// Fallback avec contenu statique\nrubriqueContent=generateRubriqueContentStatic(rubriqueNum,rubriqueTitle,passage,selectedBook,selectedChapter,parseInt(selectedLength));}setProgressPercent(80);// Si pas de contenu spécifique, utiliser le générateur intelligent\nif(!rubriqueContent||rubriqueContent.length<50){rubriqueContent=generateRubriqueContent(rubriqueNum,rubriqueTitle,passage,selectedBook,selectedChapter,parseInt(selectedLength));}// Afficher le contenu final\nconst contentFinal=\"# \\xC9tude - \".concat(passage,\"\\n\\n## \").concat(rubriqueNum,\". \").concat(rubriqueTitle,\"\\n\\n\").concat(rubriqueContent);const formattedContent=formatContent(contentFinal);setContent(formattedContent);// Sauvegarder dans l'état pour la fonction generateSingleRubrique aussi\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_\").concat(rubriqueNum);setGeneratedRubriques(prev=>_objectSpread(_objectSpread({},prev),{},{[contentKey]:formattedContent}));// Marquer comme terminé\nsetRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"completed\"}));setProgressPercent(100);console.log(\"[RUBRIQUE \".concat(rubriqueNum,\" TERMIN\\xC9E] \").concat(rubriqueContent.length,\" caract\\xE8res g\\xE9n\\xE9r\\xE9s\"));// Debug: Vérifier le contenu avant de le retourner\nconsole.log(\"[GENERATE SINGLE DEBUG] Rubrique \".concat(rubriqueNum,\" contenu final:\"),formattedContent?formattedContent.length:0,\"caractères\");console.log(\"[GENERATE SINGLE DEBUG] Contenu preview:\",formattedContent?formattedContent.slice(0,200)+\"...\":\"VIDE\");// Retourner le contenu formaté pour utilisation ultérieure\nreturn formattedContent;}catch(error){console.error(\"[ERREUR RUBRIQUE \".concat(rubriqueNum,\"]\"),error);setRubriquesStatus(p=>_objectSpread(_objectSpread({},p),{},{[rubriqueNum]:\"error\"}));throw error;}};/* =========================\n     Formatage du contenu\n  ========================= */const formatContent=function(text){let context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'default';if(!text)return\"\";// Formatage avec contexte pour VERSETS PROG\nlet formattedText=text// D'abord transformer les labels spécifiques - REGEX ÉLARGIES pour matcher différents formats\n.replace(/^\\*\\*VERSET (\\d+)\\*\\*$/gim,\"<h2 class='verset-header'>📖 VERSET $1</h2>\").replace(/^VERSE\\s*T(\\d+)$/gim,\"<h2 class='verset-header'>📖 VERSET $1</h2>\")// Format preview\n.replace(/^VERSET\\s*(\\d+)$/gim,\"<h2 class='verset-header'>📖 VERSET $1</h2>\")// Format alternatif\n.replace(/^\\*\\*TEXTE BIBLIQUE\\s*:\\*\\*$/gim,\"<h4 class='texte-biblique-label'>📜 TEXTE BIBLIQUE :</h4>\").replace(/^TEXTE BIBLIQUE\\s*:?$/gim,\"<h4 class='texte-biblique-label'>📜 TEXTE BIBLIQUE :</h4>\")// Format preview\n.replace(/^\\*\\*EXPLICATION THÉOLOGIQUE\\s*:\\*\\*$/gim,\"<h4 class='explication-label'>🎓 EXPLICATION THÉOLOGIQUE :</h4>\").replace(/^EXPLICATION THÉOLOGIQUE\\s*:?$/gim,\"<h4 class='explication-label'>🎓 EXPLICATION THÉOLOGIQUE :</h4>\")// Format preview\n// Puis transformer les autres éléments en gras génériques\n.replace(/\\*\\*(.*?)\\*\\*/g,\"<strong>$1</strong>\").replace(/^\\# (.*$)/gim,\"<h1>$1</h1>\").replace(/^\\## (.*$)/gim,\"<h2>$1</h2>\").replace(/^\\### (.*$)/gim,\"<h3>$1</h3>\").split(\"\\n\\n\").map(p=>p.trim()?\"<p>\".concat(p.replace(/\\n/g,\"<br>\"),\"</p>\"):\"\").join(\"\");// Appliquer la transformation des références bibliques\nformattedText=transformBibleReferences(formattedText);// Wrapper spécial pour le contexte VERSETS PROG\nif(context==='versets-prog'){return\"<div class=\\\"versets-prog-content\\\">\".concat(formattedText,\"</div>\");}return formattedText;};const formatVerseByVerseContent=text=>{const sections=text.split(/VERSET (\\d+)/);let html='<div class=\"verse-study-container\">';if(sections[0]){const intro=sections[0].replace(/\\*\\*(.*?)\\*\\*/g,\"<strong>$1</strong>\").replace(/^\\### (.*$)/gim,\"<h3>$1</h3>\").replace(/^\\## (.*$)/gim,\"<h2>$1</h2>\").replace(/^\\# (.*$)/gim,\"<h1>$1</h1>\");html+=\"<div style=\\\"margin-bottom: 30px;\\\">\".concat(intro.replace(/\\n/g,\"<br>\"),\"</div>\");}for(let i=1;i<sections.length;i+=2){const verseNumber=sections[i];const block=sections[i+1];if(block){html+=\"<div class=\\\"verse-block\\\">\\n          <div class=\\\"verse-header\\\">VERSET \".concat(verseNumber,\"</div>\");const parts=block.split(/TEXTE BIBLIQUE\\s*:/);if(parts.length>1){const afterBiblical=parts[1].split(/EXPLICATION THÉOLOGIQUE\\s*:/);const biblicalText=(afterBiblical[0]||\"\").trim();const theologicalExplanation=afterBiblical[1]?afterBiblical[1].trim():\"\";html+=\"\\n            <div class=\\\"section-label biblical-label\\\">\\uD83D\\uDCD6 TEXTE BIBLIQUE</div>\\n            <div class=\\\"biblical-text\\\">\".concat(biblicalText.replace(/\\n/g,\"<br>\"),\"</div>\");if(theologicalExplanation){html+=\"\\n              <div class=\\\"section-label theological-label\\\">\\uD83C\\uDF93 EXPLICATION TH\\xC9OLOGIQUE</div>\\n              <div class=\\\"theological-explanation\\\">\".concat(theologicalExplanation.replace(/\\n/g,\"<br>\"),\"</div>\");}}html+=\"</div>\";}}html+=\"</div>\";return html;};/* =========================\n     Rendu (UI intacte)\n  ========================= */return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:currentPage==='concordance'?/*#__PURE__*/_jsx(BibleConcordancePage,{onGoBack:navigateToMain}):currentPage==='versets'?/*#__PURE__*/_jsx(VersetParVersetPage,{onGoBack:navigateToMain,content:versetPageContent,bookInfo:currentBookInfo}):currentPage==='notes'?/*#__PURE__*/_jsx(NotesPage,{onGoBack:navigateToMain}):currentPage==='rubrique'?/*#__PURE__*/_jsx(RubriquePage,{onGoBack:navigateToMain,rubriqueNumber:currentRubriqueNumber,rubriqueTitle:getRubTitle(currentRubriqueNumber),content:currentRubriqueContent,bookInfo:currentBookInfo,onNavigateToRubrique:newRubriqueNumber=>{// Navigation entre rubriques depuis la page de rubrique\nconst contentKey=\"\".concat(selectedBook,\"_\").concat(selectedChapter,\"_\").concat(newRubriqueNumber);const content=generatedRubriques[contentKey]||'';navigateToRubrique(newRubriqueNumber,content);}// Nouvelles props pour les boutons fonctionnels\n,selectedBook:selectedBook,selectedChapter:selectedChapter,selectedVerse:selectedVerse,selectedLength:selectedLength,setCurrentPage:setCurrentPage,API_BASE:API_BASE,setContent:setContent,setRubriquesStatus:setRubriquesStatus,setIsLoading:setIsLoading,isLoading:isLoading,BASE_RUBRIQUES:BASE_RUBRIQUES}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{className:\"header-banner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"scroll-text\",children:\"\\u2728 M\\xC9DITATION BIBLIQUE \\u2728 \\xC9TUDE SPIRITUELLE \\u2728 SAGESSE DIVINE \\u2728 M\\xC9DITATION TH\\xC9OLOGIQUE \\u2728 CONTEMPLATION SACR\\xC9E \\u2728 R\\xC9FLEXION INSPIR\\xC9E \\u2728\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"centered-progress-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"progress-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-pill\",children:[progressPercent,\"%\",isProgressiveLoading&&progressiveStats&&/*#__PURE__*/_jsxs(\"span\",{className:\"progressive-indicator\",children:[\"\\u26A1 \",progressiveStats.speed,\" - \",progressiveStats.current_batch,\" (\",progressiveStats.processed,\"/\",progressiveStats.total,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"api-below-progress\",children:/*#__PURE__*/_jsx(ApiControlPanel,{backendUrl:process.env.REACT_APP_BACKEND_URL||\"https://rubrique-study.preview.emergentagent.com\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Rechercher (ex : Marc 5:1, 1 Jean 2, Gen\\xE8se 1:1-5)\",className:\"search-field\",value:searchQuery,onChange:handleSearchChange})}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls-row\",children:[/*#__PURE__*/_jsx(SelectPill,{label:\"Livre\",value:selectedBook,options:[\"--\",...BOOKS],onChange:handleBookChange}),/*#__PURE__*/_jsx(SelectPill,{label:\"Chapitre\",value:selectedChapter,options:availableChapters,onChange:handleChapterChange}),/*#__PURE__*/_jsx(SelectPill,{label:\"Verset\",value:selectedVerse,options:[\"--\",...Array.from({length:50},(_,i)=>i+1)],onChange:handleVerseChange}),/*#__PURE__*/_jsx(SelectPill,{label:\"Version\",value:selectedVersion,options:[\"LSG\",\"Darby\",\"NEG\"],onChange:handleVersionChange}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-validate\",disabled:isLoading,children:\"Valider\"}),/*#__PURE__*/_jsx(SelectPill,{label:\"Longueur\",value:selectedLength,options:[300,500,1000,2000],onChange:handleLengthChange}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-read\",onClick:openYouVersion,children:\"Lire la Bible\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-chat\",onClick:()=>window.open('https://chatgpt.com/','_blank'),children:\"ChatGPT\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-notes\",onClick:handleNotesClick,children:\"\\uD83D\\uDCDD Prise de Note\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"balanced-controls-container\",style:{width:'100%',maxWidth:'1600px',margin:'0 auto',padding:'0 25px',boxSizing:'border-box'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"balanced-buttons-grid\",style:{display:'grid',gap:'16px',marginBottom:'24px',padding:'20px 20px',width:'100%',boxSizing:'border-box',alignItems:'center',background:'rgba(255, 255, 255, 0.08)',backdropFilter:'blur(10px)',borderRadius:'20px',border:'1px solid rgba(255, 255, 255, 0.12)'},children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control\",style:getButtonStyle(currentButtonColors.reset,currentButtonColors.reset.shadow),onClick:handleReset,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\uD83D\\uDD04\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:\"Reset\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control\",style:getButtonStyle(currentButtonColors.mystique,currentButtonColors.mystique.shadow),onClick:changePalette,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\uD83C\\uDFA8\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:colorThemes[currentTheme].name})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control\",style:getButtonStyle(currentButtonColors.genese,currentButtonColors.genese.shadow),onClick:restoreLastStudy,disabled:!lastStudy,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\uD83D\\uDCDA\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:lastStudy?\"\".concat(lastStudy.book,\" \").concat(lastStudy.chapter):\"Genèse 1\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control \".concat(isLoading?\"loading\":\"\"),style:getButtonStyle(currentButtonColors.gemini,currentButtonColors.gemini.shadow),onClick:generateWithGemini,disabled:isLoading,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:\"Gemini Gratuit\"}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"btn-mini-loader\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control\",style:getButtonStyle(currentButtonColors.versets,currentButtonColors.versets.shadow),onClick:generateVerseByVerseProgressive,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\u26A1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:\"Versets Prog\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control btn-primary \".concat(isLoading?\"loading\":\"\"),style:getButtonStyle(currentButtonColors.generate,currentButtonColors.generate.shadow),onClick:generate28Points,disabled:isLoading,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:\"G\\xE9n\\xE9rer\"}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"btn-mini-loader\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-control\",style:getButtonStyle(currentButtonColors.concordance,currentButtonColors.concordance.shadow),onClick:navigateToConcordance,children:[/*#__PURE__*/_jsx(\"span\",{className:\"control-icon\",children:\"\\uD83D\\uDCD6\"}),/*#__PURE__*/_jsx(\"span\",{className:\"control-label\",children:\"Bible Concordance\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"three-column-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-column\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Rubriques (29)\"}),/*#__PURE__*/_jsx(RubriquesInline,{items:rubriquesItems,activeId:activeRubrique,onSelect:handleRubriqueSelect,rubriquesStatus:rubriquesStatus})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"center-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\".concat(activeRubrique,\". \").concat(getRubTitle(activeRubrique))}),/*#__PURE__*/_jsxs(\"div\",{className:\"nav-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRubriqueSelect(Math.max(0,activeRubrique-1)),disabled:activeRubrique===0,children:\"\\u25C0 Pr\\xE9c\\xE9dent\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRubriqueSelect(Math.min(BASE_RUBRIQUES.length-1,activeRubrique+1)),disabled:activeRubrique===BASE_RUBRIQUES.length-1,children:\"Suivant \\u25B6\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content-area\",children:isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"G\\xE9n\\xE9ration en cours...\"}),progressiveStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"progressive-stats\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCCA Versets trait\\xE9s: \",progressiveStats.processed,\"/\",progressiveStats.total]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83C\\uDFAF Batch actuel: \",progressiveStats.current_batch]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u26A1 Mode: \",progressiveStats.speed]})]})]}):content?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"content-text\",dangerouslySetInnerHTML:{__html:formatContent(content,isVersetsProgContent?'versets-prog':'default')}}),(isVersetsProgContent||content.includes('VERSET'))&&canContinueVerses&&/*#__PURE__*/_jsxs(\"div\",{className:\"continue-verses-section\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn-continue-verses\",onClick:continueVerses,disabled:isLoading,title:\"G\\xE9n\\xE9rer les versets \".concat(currentVerseCount+1,\" \\xE0 \").concat(currentVerseCount+5),children:[\"\\uD83D\\uDCD6 Continuer les versets (\",currentVerseCount+1,\"-\",currentVerseCount+5,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"continue-verses-info\",children:[\"Versets actuels : 1-\",currentVerseCount,\" \\u2022 Cliquez pour continuer la lecture\"]})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"empty-content-message\",children:/*#__PURE__*/_jsx(\"p\",{children:\"S\\xE9lectionnez une rubrique pour voir son contenu.\"})})})]})]})]})]})});}/* =========================\n   Composants auxiliaires\n========================= */function getRubTitle(index){return BASE_RUBRIQUES[index]||\"Rubrique \".concat(index);}function SelectPill(_ref){let{label,value,options,onChange}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"select-pill\",children:[/*#__PURE__*/_jsx(\"label\",{children:label}),/*#__PURE__*/_jsx(\"select\",{value:value,onChange:onChange,children:options.map(o=>/*#__PURE__*/_jsx(\"option\",{value:o,children:o},o))})]});}function NotesModal(_ref2){let{isOpen,notes,onNotesChange,onSave,onClose}=_ref2;if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"notes-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"notes-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notes-modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCDD Mes Notes d'\\xC9tude Biblique\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notes-close-btn\",onClick:onClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"notes-modal-content\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"notes-textarea\",value:notes,onChange:e=>onNotesChange(e.target.value),placeholder:\"\\xC9crivez vos r\\xE9flexions, questions, et insights spirituels ici... Exemples :\\n\\u2022 Versets qui m'ont marqu\\xE9\\n\\u2022 Questions pour approfondir\\n\\u2022 Applications personnelles\\n\\u2022 Pri\\xE8res inspir\\xE9es par l'\\xE9tude\",rows:15})}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"notes-save-btn\",onClick:onSave,children:\"\\uD83D\\uDCBE Sauvegarder\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notes-cancel-btn\",onClick:onClose,children:\"Annuler\"})]})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useMemo","RubriquesInline","BibleConcordancePage","CharacterHistoryPage","VersetParVersetPage","NotesPage","RubriquePage","ApiControlPanel","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","getBackendUrl","process","env","REACT_APP_BACKEND_URL","hostname","window","location","BACKEND_URL","API_BASE","concat","replace","getButtonStyle","gradientColors","shadowColor","isHovered","arguments","length","undefined","display","flexDirection","alignItems","justifyContent","padding","borderRadius","minHeight","fontSize","fontWeight","fontFamily","color","border","cursor","background","start","end","boxShadow","transition","transform","textTransform","letterSpacing","position","overflow","getThemeButtonColors","theme","themeColor","primary","secondary","shadow","hexToRgb","hex","r","parseInt","slice","g","b","reset","mystique","genese","gemini","versets","generate","concordance","asString","x","JSON","stringify","_unused","String","postProcessMarkdown","t","s","BOOKS","BOOK_CHAPTERS","BASE_RUBRIQUES","ENDPOINTS","verseProgressive","verse","study","verseGemini","studyGemini","smartPost","pathList","payload","lastErr","p","url","console","log","fetch","method","headers","body","ok","ct","get","includes","data","json","raw","text","status","Error","bodyText","catch","e","App","colorThemes","name","accent","headerBg","currentTheme","setCurrentTheme","currentButtonColors","selectedBook","setSelectedBook","selectedChapter","setSelectedChapter","selectedVerse","setSelectedVerse","selectedVersion","setSelectedVersion","selectedLength","setSelectedLength","activeRubrique","setActiveRubrique","content","setContent","isLoading","setIsLoading","generatedRubriques","setGeneratedRubriques","rubriquesStatus","setRubriquesStatus","lastStudy","setLastStudy","progressPercent","setProgressPercent","searchQuery","setSearchQuery","isProgressiveLoading","setIsProgressiveLoading","currentBatchVerse","setCurrentBatchVerse","progressiveStats","setProgressiveStats","isVersetsProgContent","setIsVersetsProgContent","currentVerseCount","setCurrentVerseCount","canContinueVerses","setCanContinueVerses","currentPage","setCurrentPage","versetPageContent","setVersetPageContent","currentBookInfo","setCurrentBookInfo","currentRubriqueNumber","setCurrentRubriqueNumber","currentRubriqueContent","setCurrentRubriqueContent","selectedTheme","setSelectedTheme","selectedCharacterForHistory","setSelectedCharacterForHistory","currentTab","setCurrentTab","availableChapters","max","Array","from","_","i","saved","localStorage","getItem","parse","error","beforeUnload","saveCurrentStudy","addEventListener","document","documentElement","style","setProperty","hexToRgba","alpha","removeEventListener","setTimeout","changePalette","handleRubriqueSelect","content_length","currentStudy","book","chapter","version","timestamp","Date","toISOString","displayTitle","setItem","restoreLastStudy","rubriquesItems","map","title","index","id","handleBookChange","target","value","handleChapterChange","Number","handleVerseChange","handleVersionChange","handleLengthChange","parseSearchQuery","query","trim","normalized","patterns","pat","m","match","bookName","found","find","toLowerCase","handleSearchChange","q","parsed","transformBibleReferences","htmlTags","tempText","placeholder","push","processedRefs","Set","bibleRefRegex","verse1","verse2","cleanMatch","has","add","youVersionUrl","encodeURIComponent","forEach","tag","wait","ms","Promise","parseRubriquesContent","fullContent","rubriques","substring","sections","split","rubriqueNumber","rubriqueContent","Object","keys","getRubriqueLength","rubriqueNum","lengthConfig","generateRubriqueContentViaAPI","rubriqueTitle","passage","targetLength","response","rubrique_number","rubrique_title","target_length","use_gemini","enriched","result","word_count","api_used","generateRubriqueContentStatic","userSelectedLength","contenuParRubrique","generatePrayerContent","generateStructureContent","generatePreviousChapterContent","generateDoctrinalThemeContent","generateTheologicalFoundationsContent","generateHistoricalContextContent","generateCulturalContextContent","generateGeographicalContextContent","generateLexicalAnalysisContent","generateBiblicalParallelsContent","generateProphecyContent","generateCharactersContent","generateRhetoricalStructureContent","generateTrinityTheologyContent","generateChristCenteredContent","generateGospelGraceContent","generatePersonalApplicationContent","generateCommunityApplicationContent","generateResponsePrayerContent","generateStudyQuestionsContent","generateVigilancePointsContent","generateObjectionsResponsesContent","generateMissionalPerspectiveContent","generateChristianEthicsContent","generateWorshipLiturgyContent","generateGuidedMeditationContent","generateMemoryVersesContent","generateActionPlanContent","generateDefaultContent","baseContent","generateIntelligentFallback","generateFallbackRubriqueContent","fallbacks","animateProgress","duration","steps","step","openYouVersion","alert","bookCodes","code","open","handleReset","handleNotesClick","navigateToNotes","navigateToConcordance","navigateToVersets","bookInfo","navigateToRubrique","navigateToMain","handleBackFromCharacter","continueVerses","startVerse","endVerse","apiUrl","tokens","currentContent","newContent","formattedNewContent","formatContent","prev","contentKey","_objectSpread","getRubTitle","apiContent","generateRubriqueOnDemand","contentEnCours","contentFinal","formattedContent","message","nextTheme","app","querySelector","header","progressPill","contentHeader","btnReset","btnPalette","btnLastStudy","btnGemini","btnVersets","btnGenerate","btnValidate","generateVerseByVerseProgressive","sourceInfo","source","fromCache","from_cache","cost","finalContent","err","generateWithGemini","enrichedLength","Math","min","rubric_type","generateTheologicalEnrichment","bookEnrichment","getBookSpecificEnrichment","rubriqueEnrichment","getRubriqueSpecificEnrichment","contextualEnrichment","getCombinedContextualEnrichment","enrichmentSuffix","bookEnrichments","rubriqueEnrichments","generate28Points","rubrique1Content","generateSingleRubrique","generateRemainingRubriques","batchSize","batch","endIndex","j","all","progress","floor","resolve","then","apiError","warn","generateRubriqueContent","context","formattedText","join","formatVerseByVerseContent","html","intro","verseNumber","block","parts","afterBiblical","biblicalText","theologicalExplanation","className","children","onGoBack","onNavigateToRubrique","newRubriqueNumber","speed","current_batch","processed","total","backendUrl","type","onChange","SelectPill","label","options","disabled","onClick","width","maxWidth","margin","boxSizing","gap","marginBottom","backdropFilter","items","activeId","onSelect","dangerouslySetInnerHTML","__html","_ref","o","NotesModal","_ref2","isOpen","notes","onNotesChange","onSave","onClose","stopPropagation","rows"],"sources":["/app/src/App.js"],"sourcesContent":["/* eslint-disable */\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport \"./App.css\";\nimport \"./rubriques.css\";\nimport RubriquesInline from \"./RubriquesInline\";\nimport BibleConcordancePage from \"./BibleConcordancePage\";\nimport CharacterHistoryPage from './CharacterHistoryPage';\nimport VersetParVersetPage from './VersetParVersetPage';\nimport NotesPage from \"./NotesPage\";\nimport RubriquePage from \"./RubriquePage\";\nimport ApiControlPanel from \"./ApiControlPanel\";\n\n/* =========================\n   Configuration et Helpers\n========================= */\n\n// Backend: 1) REACT_APP_BACKEND_URL si défini (nettoyé), 2) localhost en dev, 3) Railway en prod\nconst getBackendUrl = () => {\n  // Utiliser la variable d'environnement en priorité\n  if (process.env.REACT_APP_BACKEND_URL) {\n    return process.env.REACT_APP_BACKEND_URL;\n  }\n  \n  const hostname = window.location.hostname;\n  if (hostname === \"localhost\" || hostname === \"127.0.0.1\") return \"http://localhost:8001\";\n  // fallback pour les environnements non configurés\n  return \"https://rubrique-study.preview.emergentagent.com\";\n};\n\nconst BACKEND_URL = getBackendUrl();\nconst API_BASE = `${BACKEND_URL.replace(/\\/+$/g, \"\")}/api`;\n\n// Variables d'environnement configurées\n// BACKEND_URL et API_BASE sont prêts à utiliser\n\n// Style unifié pour tous les boutons de contrôle (même typographie que btn-validate)\nconst getButtonStyle = (gradientColors, shadowColor, isHovered = false) => ({\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  justifyContent: 'center',\n  padding: '12px 8px',\n  borderRadius: '14px',\n  minHeight: '75px',\n  fontSize: '12px',                    // Adapté de btn-validate (16px → 12px pour boutons plus petits)\n  fontWeight: '700',                   // Identique à btn-validate\n  fontFamily: \"'Montserrat', sans-serif\", // Identique à btn-validate\n  color: 'white',\n  border: 'none',\n  cursor: 'pointer',\n  background: `linear-gradient(135deg, ${gradientColors.start} 0%, ${gradientColors.end} 100%)`,\n  boxShadow: isHovered \n    ? `0 10px 35px ${shadowColor.replace('0.25', '0.35')}, 0 3px 18px rgba(0, 0, 0, 0.15)`\n    : `0 6px 20px ${shadowColor}, 0 2px 14px rgba(0, 0, 0, 0.1)`, // Adapté de btn-validate\n  transition: 'all 0.3s ease',         // Identique à btn-validate\n  transform: isHovered ? 'translateY(-2px) scale(1.02)' : 'translateY(0)',\n  textTransform: 'uppercase',          // Identique à btn-validate\n  letterSpacing: '0.8px',              // Adapté de btn-validate (1px → 0.8px)\n  position: 'relative',                // Identique à btn-validate\n  overflow: 'hidden'                   // Identique à btn-validate\n})\n\n// Fonction pour générer les couleurs des boutons basées sur le thème actuel\n// TOUS LES BOUTONS ont la même couleur basée sur le thème sélectionné\nconst getThemeButtonColors = (theme) => {\n  // Couleur unique basée sur le thème actuel\n  const themeColor = {\n    start: theme.primary,\n    end: theme.secondary, \n    shadow: `rgba(${hexToRgb(theme.primary)}, 0.25)`\n  };\n  \n  // Fonction helper pour convertir hex en rgb\n  function hexToRgb(hex) {\n    const r = parseInt(hex.slice(1, 3), 16);\n    const g = parseInt(hex.slice(3, 5), 16);\n    const b = parseInt(hex.slice(5, 7), 16);\n    return `${r}, ${g}, ${b}`;\n  }\n  \n  // Tous les boutons utilisent la même couleur thématique\n  return {\n    reset: themeColor,\n    mystique: themeColor, \n    genese: themeColor,\n    gemini: themeColor,\n    versets: themeColor,\n    generate: themeColor,\n    concordance: themeColor\n  };\n}\n\nfunction asString(x) {\n  if (x === undefined || x === null) return \"\";\n  if (typeof x === \"string\") return x;\n  try { return JSON.stringify(x, null, 2); } catch { return String(x); }\n}\n\nfunction postProcessMarkdown(t) {\n  const s = asString(t);\n  return s\n    .replace(/VERSET (\\d+)/g, \"**VERSET $1**\")\n    .replace(/TEXTE BIBLIQUE\\s*:/g, \"**TEXTE BIBLIQUE :**\")\n    .replace(/EXPLICATION THÉOLOGIQUE\\s*:/g, \"**EXPLICATION THÉOLOGIQUE :**\")\n    .replace(/Introduction au Chapitre/g, \"**Introduction au Chapitre**\")\n    .replace(/Synthèse Spirituelle/g, \"**Synthèse Spirituelle**\")\n    .replace(/Principe Herméneutique/g, \"**Principe Herméneutique**\");\n}\n\n/* =========================\n   Données statiques\n========================= */\n\nconst BOOKS = [\n  \"Genèse\", \"Exode\", \"Lévitique\", \"Nombres\", \"Deutéronome\",\n  \"Josué\", \"Juges\", \"Ruth\", \"1 Samuel\", \"2 Samuel\", \"1 Rois\", \"2 Rois\",\n  \"1 Chroniques\", \"2 Chroniques\", \"Esdras\", \"Néhémie\", \"Esther\",\n  \"Job\", \"Psaumes\", \"Proverbes\", \"Ecclésiaste\", \"Cantique des cantiques\",\n  \"Ésaïe\", \"Jérémie\", \"Lamentations\", \"Ézéchiel\", \"Daniel\",\n  \"Osée\", \"Joël\", \"Amos\", \"Abdias\", \"Jonas\", \"Michée\", \"Nahum\", \"Habacuc\",\n  \"Sophonie\", \"Aggée\", \"Zacharie\", \"Malachie\",\n  \"Matthieu\", \"Marc\", \"Luc\", \"Jean\", \"Actes\",\n  \"Romains\", \"1 Corinthiens\", \"2 Corinthiens\", \"Galates\", \"Éphésiens\",\n  \"Philippiens\", \"Colossiens\", \"1 Thessaloniciens\", \"2 Thessaloniciens\",\n  \"1 Timothée\", \"2 Timothée\", \"Tite\", \"Philémon\", \"Hébreux\",\n  \"Jacques\", \"1 Pierre\", \"2 Pierre\", \"1 Jean\", \"2 Jean\", \"3 Jean\", \"Jude\",\n  \"Apocalypse\"\n];\n\nconst BOOK_CHAPTERS = {\n  \"Genèse\": 50, \"Exode\": 40, \"Lévitique\": 27, \"Nombres\": 36, \"Deutéronome\": 34,\n  \"Josué\": 24, \"Juges\": 21, \"Ruth\": 4, \"1 Samuel\": 31, \"2 Samuel\": 24,\n  \"1 Rois\": 22, \"2 Rois\": 25, \"1 Chroniques\": 29, \"2 Chroniques\": 36,\n  \"Esdras\": 10, \"Néhémie\": 13, \"Esther\": 10, \"Job\": 42, \"Psaumes\": 150,\n  \"Proverbes\": 31, \"Ecclésiaste\": 12, \"Cantique des cantiques\": 8,\n  \"Ésaïe\": 66, \"Jérémie\": 52, \"Lamentations\": 5, \"Ézéchiel\": 48, \"Daniel\": 12,\n  \"Osée\": 14, \"Joël\": 3, \"Amos\": 9, \"Abdias\": 1, \"Jonas\": 4, \"Michée\": 7,\n  \"Nahum\": 3, \"Habacuc\": 3, \"Sophonie\": 3, \"Aggée\": 2, \"Zacharie\": 14, \"Malachie\": 4,\n  \"Matthieu\": 28, \"Marc\": 16, \"Luc\": 24, \"Jean\": 21, \"Actes\": 28,\n  \"Romains\": 16, \"1 Corinthiens\": 16, \"2 Corinthiens\": 13, \"Galates\": 6,\n  \"Éphésiens\": 6, \"Philippiens\": 4, \"Colossiens\": 4, \"1 Thessaloniciens\": 5,\n  \"2 Thessaloniciens\": 3, \"1 Timothée\": 6, \"2 Timothée\": 4, \"Tite\": 3,\n  \"Philémon\": 1, \"Hébreux\": 13, \"Jacques\": 5, \"1 Pierre\": 5, \"2 Pierre\": 3,\n  \"1 Jean\": 5, \"2 Jean\": 1, \"3 Jean\": 1, \"Jude\": 1, \"Apocalypse\": 22\n};\n\nconst BASE_RUBRIQUES = [\n  \"Étude verset par verset\",\n  \"Prière d'ouverture\",\n  \"Structure littéraire\", \n  \"Questions du chapitre précédent\",\n  \"Thème doctrinal\",\n  \"Fondements théologiques\",\n  \"Contexte historique\",\n  \"Contexte culturel\", \n  \"Contexte géographique\",\n  \"Analyse lexicale\",\n  \"Parallèles bibliques\",\n  \"Prophétie et accomplissement\",\n  \"Personnages\",\n  \"Structure rhétorique\",\n  \"Théologie trinitaire\",\n  \"Christ au centre\",\n  \"Évangile et grâce\",\n  \"Application personnelle\", \n  \"Application communautaire\",\n  \"Prière de réponse\",\n  \"Questions d'étude\",\n  \"Points de vigilance\",\n  \"Objections et réponses\",\n  \"Perspective missionnelle\",\n  \"Éthique chrétienne\", \n  \"Louange / liturgie\",\n  \"Méditation guidée\",\n  \"Mémoire / versets clés\",\n  \"Plan d'action\"\n];\n\n/* =========================\n   Utilitaires fetch (fallbacks)\n========================= */\n\n// mapping endpoints (nouveau → legacy)\nconst ENDPOINTS = {\n  verseProgressive: [\n    \"/generate-verse-by-verse-progressive\",\n    \"/g_verse_progressive\",\n  ],\n  verse: [\n    \"/generate-verse-by-verse\",\n    \"/g_te-verse-by-verse\",\n  ],\n  study: [\n    \"/generate-study\",\n    \"/g_study_28\",\n  ],\n  verseGemini: [\n    \"/generate-verse-by-verse-gemini\",\n    \"/generate-verse-by-verse\",\n    \"/g_te-verse-by-verse\",\n  ],\n  studyGemini: [\n    \"/generate-study-gemini\",\n    \"/generate-study\",\n    \"/g_study_28\",\n  ],\n};\n\nasync function smartPost(pathList, payload) {\n  let lastErr = null;\n  for (const p of pathList) {\n    const url = `${API_BASE}${p}`;\n    try {\n      console.log(\"[API] POST →\", url);\n      const r = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload || {}),\n      });\n      if (r.ok) {\n        const ct = r.headers.get(\"content-type\") || \"\";\n        if (ct.includes(\"application/json\")) {\n          return { data: await r.json(), url };\n        }\n        return { data: { raw: await r.text() }, url };\n      }\n      if (r.status === 404) { lastErr = new Error(`404 @ ${url}`); continue; }\n      const bodyText = await r.text().catch(() => \"\");\n      throw new Error(`HTTP ${r.status} @ ${url}${bodyText ? \" – \" + bodyText.slice(0, 300) : \"\"}`);\n    } catch (e) {\n      lastErr = e;\n    }\n  }\n  throw lastErr || new Error(\"Tous les endpoints ont échoué\");\n}\n\n/* =========================\n   Composant Principal App\n========================= */\n\nfunction App() {\n  // Thèmes (définis en premier pour éviter erreur d'initialisation)\n  const colorThemes = [\n    { name: \"Violet Mystique\", primary: \"#667eea\", secondary: \"#764ba2\", accent: \"#667eea\",\n      background: \"linear-gradient(135deg, #667eea 0%, #764ba2 100%)\",\n      headerBg: \"linear-gradient(90deg, #3b4371 0%, #f093fb 50%, #f5576c 100%)\" },\n    { name: \"Océan Profond\", primary: \"#0891b2\", secondary: \"#0284c7\", accent: \"#0891b2\",\n      background: \"linear-gradient(135deg, #0891b2 0%, #0284c7 100%)\",\n      headerBg: \"linear-gradient(90deg, #075985 0%, #0ea5e9 50%, #38bdf8 100%)\" },\n    { name: \"Émeraude Vert\", primary: \"#10b981\", secondary: \"#059669\", accent: \"#10b981\",\n      background: \"linear-gradient(135deg, #10b981 0%, #059669 100%)\",\n      headerBg: \"linear-gradient(90deg, #064e3b 0%, #34d399 50%, #6ee7b7 100%)\" },\n    { name: \"Rose Passion\", primary: \"#ec4899\", secondary: \"#db2777\", accent: \"#ec4899\",\n      background: \"linear-gradient(135deg, #ec4899 0%, #db2777 100%)\",\n      headerBg: \"linear-gradient(90deg, #831843 0%, #f472b6 50%, #f9a8d4 100%)\" },\n    { name: \"Orange Sunset\", primary: \"#f59e0b\", secondary: \"#d97706\", accent: \"#f59e0b\",\n      background: \"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",\n      headerBg: \"linear-gradient(90deg, #92400e 0%, #fbbf24 50%, #fcd34d 100%)\" },\n    { name: \"Indigo Royal\", primary: \"#6366f1\", secondary: \"#4f46e5\", accent: \"#6366f1\",\n      background: \"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)\",\n      headerBg: \"linear-gradient(90deg, #312e81 0%, #818cf8 50%, #a5b4fc 100%)\" }\n  ];\n\n  // États principaux\n  const [currentTheme, setCurrentTheme] = useState(0);\n  \n  // Couleurs dynamiques basées sur le thème actuel (après colorThemes et currentTheme)\n  const currentButtonColors = getThemeButtonColors(colorThemes[currentTheme]);\n  \n  const [selectedBook, setSelectedBook] = useState(\"Genèse\");\n  const [selectedChapter, setSelectedChapter] = useState(\"1\");\n  const [selectedVerse, setSelectedVerse] = useState(\"--\");\n  const [selectedVersion, setSelectedVersion] = useState(\"LSG\");\n  const [selectedLength, setSelectedLength] = useState(500);\n  const [activeRubrique, setActiveRubrique] = useState(0);\n  const [content, setContent] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [generatedRubriques, setGeneratedRubriques] = useState({}); // Stockage du contenu généré\n  const [rubriquesStatus, setRubriquesStatus] = useState({});\n  const [lastStudy, setLastStudy] = useState(null);\n  const [progressPercent, setProgressPercent] = useState(0);\n  const [searchQuery, setSearchQuery] = useState(\"\"); // ← unique déclaration\n\n  // États génération progressive\n  const [isProgressiveLoading, setIsProgressiveLoading] = useState(false);\n  const [currentBatchVerse, setCurrentBatchVerse] = useState(1);\n  const [progressiveStats, setProgressiveStats] = useState(null);\n  const [isVersetsProgContent, setIsVersetsProgContent] = useState(false);\n  const [currentVerseCount, setCurrentVerseCount] = useState(5);\n  const [canContinueVerses, setCanContinueVerses] = useState(true);\n  \n  // États pour les notes persistantes - SUPPRIMÉES (remplacées par page dédiée)\n  // const [personalNotes, setPersonalNotes] = useState(...)\n  // const [showNotesModal, setShowNotesModal] = useState(false)\n\n  // État pour la navigation\n  const [currentPage, setCurrentPage] = useState('main'); // 'main', 'concordance', 'versets', 'notes', ou 'rubrique'\n  const [versetPageContent, setVersetPageContent] = useState('');\n  const [currentBookInfo, setCurrentBookInfo] = useState('');\n  const [currentRubriqueNumber, setCurrentRubriqueNumber] = useState(1);\n  const [currentRubriqueContent, setCurrentRubriqueContent] = useState('');\n  \n  // États pour la navigation entre les pages dédiées\n  const [selectedTheme, setSelectedTheme] = useState(null);\n  const [selectedCharacterForHistory, setSelectedCharacterForHistory] = useState(null);\n  const [currentTab, setCurrentTab] = useState('concordance');\n\n  // Thèmes déplacés en début de fonction\n\n  // Options de chapitres\n  const availableChapters = useMemo(() => {\n    if (selectedBook === \"--\" || !BOOK_CHAPTERS[selectedBook]) return [\"--\"];\n    const max = BOOK_CHAPTERS[selectedBook] || 1;\n    return [\"--\", ...Array.from({ length: max }, (_, i) => i + 1)];\n  }, [selectedBook]);\n\n  // Charger/sauver dernière étude et initialiser couleurs\n  useEffect(() => {\n    const saved = localStorage.getItem(\"lastBibleStudy\");\n    if (saved) { try { setLastStudy(JSON.parse(saved)); } catch(e){ console.error(e);} }\n    const beforeUnload = () => saveCurrentStudy();\n    window.addEventListener(\"beforeunload\", beforeUnload);\n    \n    // Initialiser les couleurs du thème par défaut\n    const theme = colorThemes[currentTheme];\n    document.documentElement.style.setProperty('--theme-primary', `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`);\n    document.documentElement.style.setProperty('--theme-secondary', `linear-gradient(135deg, ${theme.secondary}, ${theme.primary})`);\n    document.documentElement.style.setProperty('--theme-accent', `linear-gradient(135deg, ${theme.accent}, ${theme.secondary})`);\n    \n    const hexToRgba = (hex, alpha) => {\n      const r = parseInt(hex.slice(1, 3), 16);\n      const g = parseInt(hex.slice(3, 5), 16);\n      const b = parseInt(hex.slice(5, 7), 16);\n      return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n    };\n    \n    document.documentElement.style.setProperty('--theme-accent-shadow', hexToRgba(theme.accent, 0.3));\n    document.documentElement.style.setProperty('--theme-accent-shadow-hover', hexToRgba(theme.accent, 0.4));\n    \n    return () => window.removeEventListener(\"beforeunload\", beforeUnload);\n  }, [currentTheme]);\n\n  // Appliquer thème au chargement\n  useEffect(() => {\n    setTimeout(() => { changePalette(); setCurrentTheme(0); }, 100);\n  }, []);\n  // Test immédiat de sauvegarde quand sélection change\n  useEffect(() => {\n    if (selectedBook !== \"--\" && selectedChapter !== \"--\") {\n      console.log(\"[TEST SAUVEGARDE] Sélection valide détectée:\", selectedBook, selectedChapter);\n      saveCurrentStudy();\n    }\n  }, [selectedBook, selectedChapter]);\n\n  // Initialiser la rubrique 0 au chargement avec le livre et chapitre sélectionnés\n  useEffect(() => {\n    if (selectedBook !== \"--\" && selectedChapter !== \"--\" && activeRubrique === 0) {\n      console.log(\"[INIT RUBRIQUE] Initialisation rubrique 0 pour:\", selectedBook, selectedChapter);\n      handleRubriqueSelect(0);\n    }\n  }, [selectedBook, selectedChapter]);\n\n  const saveCurrentStudy = () => {\n    console.log(\"[DEBUG SAUVEGARDE] Tentative sauvegarde:\", {\n      selectedBook,\n      selectedChapter,\n      selectedVerse,\n      content_length: content ? content.length : 0\n    });\n    \n    if (selectedBook !== \"--\" && selectedChapter !== \"--\") {\n      const currentStudy = {\n        book: selectedBook, chapter: selectedChapter, verse: selectedVerse,\n        version: selectedVersion, length: selectedLength, activeRubrique,\n        content, rubriquesStatus, timestamp: new Date().toISOString(),\n        displayTitle: `${selectedBook} ${selectedChapter}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`\n      };\n      localStorage.setItem(\"lastBibleStudy\", JSON.stringify(currentStudy));\n      setLastStudy(currentStudy);\n      console.log(\"[SAUVEGARDE SUCCESS] Étude sauvegardée:\", currentStudy.displayTitle);\n    } else {\n      console.log(\"[SAUVEGARDE SKIP] Conditions non remplies - livre ou chapitre = '--'\");\n    }\n  };\n\n  const restoreLastStudy = () => {\n    if (!lastStudy) return;\n    setSelectedBook(lastStudy.book);\n    setSelectedChapter(lastStudy.chapter);\n    setSelectedVerse(lastStudy.verse || \"--\");\n    setSelectedVersion(lastStudy.version || \"LSG\");\n    setSelectedLength(lastStudy.length || 500);\n    setActiveRubrique(lastStudy.activeRubrique || 0);\n    setContent(lastStudy.content || \"\");\n    setRubriquesStatus(lastStudy.rubriquesStatus || {});\n  };\n\n  const rubriquesItems = BASE_RUBRIQUES.map((title, index) => ({ id: index, title }));\n\n  /* =========================\n     Gestionnaires\n  ========================= */\n\n  const handleBookChange = (e) => {\n    saveCurrentStudy();\n    const book = e.target.value;\n    setSelectedBook(book);\n    setSelectedChapter(book === \"--\" ? \"--\" : 1);\n    setSelectedVerse(\"--\");\n  };\n\n  const handleChapterChange = (e) => {\n    saveCurrentStudy();\n    const chapter = e.target.value;\n    setSelectedChapter(chapter === \"--\" ? \"--\" : Number(chapter));\n    setSelectedVerse(\"--\");\n  };\n\n  const handleVerseChange = (e) => setSelectedVerse(e.target.value);\n  const handleVersionChange = (e) => setSelectedVersion(e.target.value);\n  const handleLengthChange = (e) => setSelectedLength(Number(e.target.value));\n\n  // Recherche intelligente\n  const parseSearchQuery = (query) => {\n    if (!query.trim()) return null;\n    const normalized = query.trim();\n    const patterns = [/^(.+?)\\s+(\\d+):(\\d+)$/, /^(.+?)\\s+(\\d+)$/, /^(.+)$/];\n    for (const pat of patterns) {\n      const m = normalized.match(pat);\n      if (m) {\n        const bookName = m[1].trim();\n        const chapter = m[2] ? parseInt(m[2]) : null;\n        const verse = m[3] ? parseInt(m[3]) : null;\n        const found = BOOKS.find(b =>\n          b.toLowerCase() === bookName.toLowerCase() ||\n          b.toLowerCase().includes(bookName.toLowerCase()) ||\n          bookName.toLowerCase().includes(b.toLowerCase())\n        );\n        if (found) return { book: found, chapter: chapter || 1, verse: verse || \"--\" };\n      }\n    }\n    return null;\n  };\n\n  const handleSearchChange = (e) => {\n    const q = e.target.value;\n    setSearchQuery(q);\n    const parsed = parseSearchQuery(q);\n    if (parsed) {\n      saveCurrentStudy();\n      setSelectedBook(parsed.book);\n      setSelectedChapter(parsed.chapter);\n      setSelectedVerse(parsed.verse);\n    }\n  };\n\n  // Gestionnaires supprimés - définis plus bas\n\n  // Fonction pour détecter et transformer les références bibliques en liens YouVersion\n  const transformBibleReferences = (text) => {\n    if (!text) return text;\n    \n    // Sauvegarder les balises HTML existantes pour les restaurer après\n    const htmlTags = [];\n    let tempText = text.replace(/<[^>]*>/g, (match) => {\n      const placeholder = `__HTML_TAG_${htmlTags.length}__`;\n      htmlTags.push(match);\n      return placeholder;\n    });\n    \n    // Set pour éviter les doublons\n    const processedRefs = new Set();\n    \n    // Regex améliorée pour détecter les références bibliques (seulement dans le texte brut)\n    const bibleRefRegex = /(\\d?\\s*[A-ZÀ-ÿ][a-zà-ÿ]*(?:\\s+\\d*\\s*[A-ZÀ-ÿ][a-zà-ÿ]*)*)\\s+(\\d+)(?::(\\d+)(?:[-–](\\d+))?)?(?!\\d)/g;\n    \n    // Traiter les références dans le texte temporaire (sans HTML)\n    tempText = tempText.replace(bibleRefRegex, (match, book, chapter, verse1, verse2) => {\n      const cleanMatch = match.trim();\n      \n      // Vérifier si cette référence a déjà été traitée (éviter les doublons)\n      if (processedRefs.has(cleanMatch)) {\n        return cleanMatch; // Retourner le texte sans lien si c'est un doublon\n      }\n      \n      processedRefs.add(cleanMatch);\n      \n      // Construire l'URL YouVersion avec recherche directe\n      const youVersionUrl = `https://www.bible.com/search/bible?q=${encodeURIComponent(cleanMatch)}`;\n      \n      // Créer le lien HTML avec styles\n      return `<a href=\"${youVersionUrl}\" target=\"_blank\" class=\"bible-reference\" title=\"${cleanMatch}\">${cleanMatch}</a>`;\n    });\n    \n    // Restaurer les balises HTML originales\n    htmlTags.forEach((tag, index) => {\n      tempText = tempText.replace(`__HTML_TAG_${index}__`, tag);\n    });\n    \n    return tempText;\n  };\n\n  // Progress bar\n  const wait = (ms) => new Promise(r => setTimeout(r, ms));\n\n  // Fonction pour parser le contenu des 28 rubriques retourné par l'API\n  const parseRubriquesContent = (fullContent) => {\n    const rubriques = {};\n    \n    console.log(\"[PARSING DEBUG] Contenu reçu:\", fullContent.length, \"caractères\");\n    console.log(\"[PARSING DEBUG] Début du contenu:\", fullContent.substring(0, 200));\n    \n    // Diviser le contenu par les titres de rubriques (## Rubrique 1: , ## Rubrique 2: , etc.)\n    const sections = fullContent.split(/##\\s*Rubrique\\s*(\\d+):\\s*/i);\n    \n    console.log(\"[PARSING DEBUG] Sections trouvées:\", sections.length);\n    \n    for (let i = 1; i < sections.length; i += 2) {\n      const rubriqueNumber = parseInt(sections[i]); // Garder l'index 1-based pour correspondre aux rubriques\n      let rubriqueContent = sections[i + 1] ? sections[i + 1].trim() : \"\";\n      \n      console.log(`[PARSING DEBUG] Rubrique ${rubriqueNumber}:`, rubriqueContent.length, \"caractères\");\n      \n      // Nettoyer le contenu - enlever le titre suivant s'il existe\n      if (rubriqueContent) {\n        // Enlever une éventuelle rubrique suivante qui serait incluse\n        rubriqueContent = rubriqueContent.split('## Rubrique')[0].trim();\n        \n        // Nettoyer les sauts de ligne multiples\n        rubriqueContent = rubriqueContent.replace(/\\n{3,}/g, '\\n\\n').trim();\n        \n        if (rubriqueContent.length > 0) {\n          rubriques[rubriqueNumber] = rubriqueContent;\n          console.log(`[PARSING SUCCESS] Rubrique ${rubriqueNumber} parsée:`, rubriqueContent.substring(0, 100) + \"...\");\n        }\n      }\n    }\n    \n    console.log(\"[PARSING FINAL] Rubriques parsées:\", Object.keys(rubriques).length);\n    return rubriques;\n  };\n\n  // Configuration des longueurs par rubrique\n  const getRubriqueLength = (rubriqueNum) => {\n    const lengthConfig = {\n      1: 500,   // Prière d'ouverture\n      2: 500,   // Structure littéraire\n      3: 500,   // Questions du chapitre précédent\n      4: 500,   // Thème doctrinal\n      5: 1500,  // Fondements théologiques\n      6: 1500,  // Contexte historique\n      7: 1500,  // Contexte culturel\n      8: 1500,  // Contexte géographique\n      9: 1500,  // Analyse lexicale\n      10: 1500, // Parallèles bibliques\n      11: 1500, // Prophétie et accomplissement\n      12: 1500, // Personnages\n      13: 1500, // Structure rhétorique\n      14: 1500, // Théologie trinitaire\n      15: 2000, // Christ au centre\n      16: 2000, // Évangile et grâce\n      17: 2000, // Application personnelle\n      18: 2000, // Application communautaire\n      19: 2000, // Prière de réponse\n      20: 2000, // Questions d'étude\n      21: 2000, // Points de vigilance\n      22: 2000, // Objections et réponses\n      23: 2000, // Perspective missionnelle\n      24: 2000, // Éthique chrétienne\n      25: 2000, // Louange / liturgie\n      26: 2000, // Méditation guidée\n      27: 2000, // Mémoire / versets clés\n      28: 2000  // Plan d'action\n    };\n    return lengthConfig[rubriqueNum] || 500;\n  };\n\n  // Fonction pour générer du contenu narratif théologique spécifique\n  // Nouvelle fonction pour générer le contenu des rubriques via API\n  const generateRubriqueContentViaAPI = async (rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength) => {\n    try {\n      console.log(`[API RUBRIQUE ${rubriqueNum}] Génération via API: ${rubriqueTitle} pour ${book} ${chapter}`);\n      \n      const response = await fetch(`${getBackendUrl()}/api/generate-rubrique-content`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          rubrique_number: rubriqueNum,\n          rubrique_title: rubriqueTitle,\n          book: book,\n          chapter: parseInt(chapter),\n          passage: passage,\n          target_length: targetLength,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Erreur API: ${response.status}`);\n      }\n\n      const result = await response.json();\n      \n      if (result.status === 'success') {\n        console.log(`[API RUBRIQUE ${rubriqueNum}] Succès - ${result.word_count} mots - API: ${result.api_used}`);\n        return result.content;\n      } else {\n        throw new Error('Erreur lors de la génération du contenu');\n      }\n\n    } catch (error) {\n      console.error(`[ERROR RUBRIQUE ${rubriqueNum}]`, error);\n      \n      // Fallback vers le contenu statique en cas d'erreur API\n      return generateRubriqueContentStatic(rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength);\n    }\n  };\n\n  // Renommer l'ancienne fonction pour le fallback\n  const generateRubriqueContentStatic = (rubriqueNum, rubriqueTitle, passage, book, chapter, userSelectedLength = null) => {\n    // Utiliser la longueur choisie par l'utilisateur ou la longueur par défaut de la rubrique\n    const targetLength = userSelectedLength || getRubriqueLength(rubriqueNum);\n    \n    const contenuParRubrique = {\n      1: generatePrayerContent(passage, targetLength),\n      2: generateStructureContent(passage, book, chapter, targetLength),\n      3: generatePreviousChapterContent(passage, book, chapter, targetLength),\n      4: generateDoctrinalThemeContent(passage, book, chapter, targetLength),\n      5: generateTheologicalFoundationsContent(passage, book, chapter, targetLength),\n      6: generateHistoricalContextContent(passage, book, chapter, targetLength),\n      7: generateCulturalContextContent(passage, book, chapter, targetLength),\n      8: generateGeographicalContextContent(passage, book, chapter, targetLength),\n      9: generateLexicalAnalysisContent(passage, book, chapter, targetLength),\n      10: generateBiblicalParallelsContent(passage, book, chapter, targetLength),\n      11: generateProphecyContent(passage, book, chapter, targetLength),\n      12: generateCharactersContent(passage, book, chapter, targetLength),\n      13: generateRhetoricalStructureContent(passage, book, chapter, targetLength),\n      14: generateTrinityTheologyContent(passage, book, chapter, targetLength),\n      15: generateChristCenteredContent(passage, book, chapter, targetLength),\n      16: generateGospelGraceContent(passage, book, chapter, targetLength),\n      17: generatePersonalApplicationContent(passage, book, chapter, targetLength),\n      18: generateCommunityApplicationContent(passage, book, chapter, targetLength),\n      19: generateResponsePrayerContent(passage, book, chapter, targetLength),\n      20: generateStudyQuestionsContent(passage, book, chapter, targetLength),\n      21: generateVigilancePointsContent(passage, book, chapter, targetLength),\n      22: generateObjectionsResponsesContent(passage, book, chapter, targetLength),\n      23: generateMissionalPerspectiveContent(passage, book, chapter, targetLength),\n      24: generateChristianEthicsContent(passage, book, chapter, targetLength),\n      25: generateWorshipLiturgyContent(passage, book, chapter, targetLength),\n      26: generateGuidedMeditationContent(passage, book, chapter, targetLength),\n      27: generateMemoryVersesContent(passage, book, chapter, targetLength),\n      28: generateActionPlanContent(passage, book, chapter, targetLength)\n    };\n\n    return contenuParRubrique[rubriqueNum] || \n      generateDefaultContent(rubriqueTitle, passage, book, chapter, targetLength);\n  };\n\n  // Fonction pour la prière d'ouverture avec progression narrative théologique\n  const generatePrayerContent = (passage, targetLength) => {\n    const baseContent = `**Adoration :** Seigneur Dieu, Créateur du ciel et de la terre, nous reconnaissons ta grandeur manifestée dans ${passage}. Tu es celui qui appelle à l'existence ce qui n'était pas.\n\n**Confession :** Père, nous confessons notre petitesse face à ta majesté créatrice révélée dans ${passage}. Pardonne-nous nos manquements.\n\n**Demande :** Esprit Saint, éclaire notre compréhension de ${passage}.`;\n\n    if (targetLength >= 500) {\n      return baseContent + `\n\nDans cette prière d'ouverture, nous nous approchons du trône de la grâce avec une révérence qui sied à la majesté divine révélée dans ${passage}. L'adoration authentique naît de la contemplation des perfections divines manifestées dans l'Écriture sainte.`;\n    }\n\n    if (targetLength >= 1000) {\n      return baseContent + `\n\nDans cette prière d'ouverture, nous nous approchons du trône de la grâce avec une révérence qui sied à la majesté divine révélée dans ${passage}. L'adoration authentique naît de la contemplation des perfections divines manifestées dans l'Écriture sainte.\n\nLa tradition patristique et réformée nous enseigne que la lectio divina doit débuter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le péché. Comme l'affirme Jean Chrysostome : \"Les Écritures sont une lettre que Dieu nous a envoyée d'en haut.\" Cette lettre divine nécessite l'illumination céleste pour être comprise dans toute sa profondeur sotériologique.\n\nNotre confession s'enracine dans la reconnaissance de notre finitude créaturelle face à l'infinité divine. L'humilité herméneutique constitue le préalable indispensable à toute exégèse fidèle.`;\n    }\n\n    if (targetLength >= 2000) {\n      return baseContent + `\n\nDans cette prière d'ouverture, nous nous approchons du trône de la grâce avec une révérence qui sied à la majesté divine révélée dans ${passage}. L'adoration authentique naît de la contemplation des perfections divines manifestées dans l'Écriture sainte.\n\nLa tradition patristique et réformée nous enseigne que la lectio divina doit débuter par l'invocation du Saint-Esprit, seul capable d'illuminer l'entendement humain obscurci par le péché. Comme l'affirme Jean Chrysostome : \"Les Écritures sont une lettre que Dieu nous a envoyée d'en haut.\" Cette lettre divine nécessite l'illumination céleste pour être comprise dans toute sa profondeur sotériologique.\n\nNotre confession s'enracine dans la reconnaissance de notre finitude créaturelle face à l'infinité divine. L'humilité herméneutique constitue le préalable indispensable à toute exégèse fidèle.\n\nL'École d'Antioche et l'École d'Alexandrie, malgré leurs divergences herméneutiques, s'accordaient sur cette vérité fondamentale : l'Écriture ne se dévoile pleinement qu'à celui qui s'approche d'elle dans la prière et la dépendance de l'Esprit. Origène écrivait : \"La parole de Dieu est comme un grain de froment : si tu n'en broies pas l'écorce par la méditation et la prière, tu ne peux en goûter la moelle.\"\n\nCette démarche spirituelle s'inscrit dans la lignée de la Sola Scriptura réformée, qui affirme non seulement l'autorité suprême de l'Écriture, mais aussi la nécessité de l'illumination divine pour sa juste compréhension. Calvin soulignait que \"l'Écriture est son propre interprète\", mais sous la conduite du Saint-Esprit qui en est l'auteur principal.\n\nAinsi, notre prière d'ouverture devant ${passage} n'est pas une simple formalité liturgique, mais l'expression de notre théologie de la révélation : Dieu se révèle, l'homme reçoit par grâce, et l'Esprit rend témoignage à la vérité divine dans le cœur du croyant régénéré.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour structure littéraire (500 caractères)\n  const generateStructureContent = (passage, book, chapter, targetLength) => {\n    return `L'architecture littéraire de ${passage} révèle l'ordre divin dans la création. Cette structure en sept jours manifeste la perfection divine : trois jours de séparation (lumière/ténèbres, eaux/eaux, terre/mer) suivis de trois jours de peuplement (luminaires, animaux aquatiques et volants, animaux terrestres et l'homme). Le septième jour couronne l'œuvre par le repos divin, établissant le principe du sabbat. Cette progression méthodique \"Dieu dit... et cela fut... Dieu vit que cela était bon\" démontre la souveraineté divine.`;\n  };\n\n  // Fonction pour questions du chapitre précédent (500 caractères)\n  const generatePreviousChapterContent = (passage, book, chapter, targetLength) => {\n    if (chapter === \"1\") {\n      return `${passage} ouvre le récit biblique sans prologue humain, plongeant directement dans l'acte créateur divin. Cette ouverture majestueuse établit Dieu comme l'acteur principal de l'histoire. L'absence de contexte préalable souligne l'éternité et la primauté divines. Cette introduction théologique prépare tout le développement biblique ultérieur, posant les fondements de l'alliance, de la révélation progressive et du plan de salut qui se déploieront dans toute l'Écriture.`;\n    }\n    return `L'étude de ${passage} s'inscrit dans la continuité du récit biblique. Les événements précédents éclairent la compréhension de ce passage et préparent les développements théologiques qui suivront.`;\n  };\n\n  // Fonction pour thème doctrinal (500 caractères)\n  const generateDoctrinalThemeContent = (passage, book, chapter, targetLength) => {\n    return `Le thème doctrinal central de ${passage} proclame la souveraineté créatrice de Dieu. Trois vérités fondamentales émergent : l'existence éternelle de Dieu avant toute création, sa parole efficace qui appelle à l'existence ce qui n'était pas, et sa bonne volonté envers son œuvre. L'homme, créé à l'image divine, reçoit la dignité unique de représentant de Dieu sur terre. Le sabbat établit le rythme divin entre travail et repos, révélant la nature même de Dieu dans l'alternance activité/contemplation.`;\n  };\n\n  // Fonction pour fondements théologiques avec progression narrative selon longueur\n  const generateTheologicalFoundationsContent = (passage, book, chapter, targetLength) => {\n    const baseContent = `La narration de ${passage} établit les piliers théologiques de la foi chrétienne. L'Écriture révèle que Dieu, dans sa trinité éternelle, précède toute réalité créée.`;\n\n    if (targetLength >= 500) {\n      return baseContent + ` La création ex nihilo manifeste la toute-puissance divine. L'anthropologie biblique trouve ici ses racines : l'homme, créé à l'image de Dieu (imago Dei), reçoit une dignité unique dans la création.`;\n    }\n\n    if (targetLength >= 1000) {\n      return baseContent + ` La création ex nihilo manifeste la toute-puissance divine. Contrairement aux cosmogonies babyloniennes qui décrivent des théomachies primordiales, l'Écriture présente un Dieu souverain créant par sa seule parole.\n\nL'anthropologie biblique trouve ici ses fondements : l'homme, créé à l'image de Dieu (imago Dei), reçoit une dignité unique. Cette ressemblance divine ne réside pas dans la corporéité mais dans les facultés spirituelles : intelligence, volonté, capacité relationnelle et responsabilité morale. L'homme devient ainsi le vice-gérent de Dieu sur terre.\n\nLe sabbat révèle la pédagogie divine. En se reposant le septième jour, Dieu établit un modèle anthropologique : l'alternance entre activité créatrice et contemplation adoratrice. Cette institution sabbatique préfigure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sotériologique en Christ, notre repos sabbatique véritable selon l'épître aux Hébreux.`;\n    }\n\n    if (targetLength >= 2000) {\n      return baseContent + ` La création ex nihilo (à partir du néant) manifeste la toute-puissance divine et constitue un dogme fondamental distinguant radicalement la foi biblique de toute philosophie naturaliste ou panthéiste. Contrairement aux cosmogonies babyloniennes (Enuma Elish) qui décrivent des théomachies primordiales, l'Écriture présente un Dieu souverain créant par sa seule parole efficace.\n\nL'anthropologie biblique trouve ici ses fondements doctrinaux incontournables. L'homme, créé à l'image de Dieu (imago Dei selon Genèse 1:27), reçoit une dignité ontologique unique dans l'ordre créationnel. Cette ressemblance divine ne réside pas dans la corporéité (contra l'anthropomorphisme naïf) mais dans les facultés spirituelles : intellectus, voluntas, capacité relationnelle et responsabilité morale coram Deo. L'homme devient ainsi le vice-gérent divin sur terre, participant à la souveraineté divine par délégation gracieuse.\n\nLa théologie sabbatique révèle la pédagogie divine et établit les fondements de la sanctification du temps. En se reposant le septième jour, Dieu établit un paradigme anthropologique fondamental : l'alternance entre activité créatrice (opus Dei) et contemplation adoratrice (otium sanctum). Cette institution sabbatique préfigure le repos eschatologique promis au peuple de Dieu et trouve son accomplissement sotériologique en Christ, notre repos sabbatique véritable selon l'exégèse de l'épître aux Hébreux (chapitre 4).\n\nL'École de Westminster et les théologiens réformés orthodoxes (Turretin, Brakel, Owen) ont développé ces fondements avec une rigueur scolastique remarquable, établissant la théologie systématique sur ces bases scripturaires inébranlables. Ces vérités révélées constituent le socle doctrinal de la foi réformée et demeurent le rempart théologique face aux défis de la modernité séculière et du naturalisme méthodologique contemporain.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour contexte historique (1500 caractères) - Plus narratif et théologique\n  const generateHistoricalContextContent = (passage, book, chapter, targetLength) => {\n    return `L'étude du contexte historique de ${passage} nous plonge dans l'univers du Proche-Orient ancien, où les cosmogonies babyloniennes et égyptiennes dominaient la pensée religieuse. Dans ce milieu culturel saturé de mythologies, la révélation biblique émerge comme une voix prophétique unique et révolutionnaire.\n\nLes récits babyloniens comme l'Enuma Elish présentent la création comme le résultat de conflits titanesques entre divinités primordiales. Marduk vainc Tiamat, déesse du chaos, et de son cadavre forme le cosmos. Ces mythes reflètent une vision cyclique du temps et une compréhension polythéiste du divin. La révélation mosaïque s'oppose radicalement à ces conceptions.\n\nL'Écriture proclame un Dieu unique, éternel, qui crée par sa parole sans opposition ni combat. Cette vérité révélée corrige les erreurs théologiques de l'environnement culturel israélite. Le peuple de Dieu reçoit ainsi une compréhension purifiée de la divinité, libérée des superstitions et des craintes liées aux forces naturelles divinisées.\n\nL'historicité du récit, débattue dans les cercles académiques contemporains, ne diminue en rien sa portée théologique. Que l'on adopte une lecture littérale ou littéraire, l'enseignement doctrinal demeure inchangé : Dieu est le créateur souverain, l'homme porte son image, et la création révèle sa gloire.\n\nCette perspective historique enrichit notre compréhension et renforce notre foi en la véracité de la révélation divine face aux idéologies contemporaines qui tentent de réduire l'homme à un simple produit du hasard évolutif.`;\n  };\n\n  // Fonction générique pour contenu par défaut\n  const generateDefaultContent = (rubriqueTitle, passage, book, chapter, targetLength) => {\n    const baseContent = `**${rubriqueTitle}** dans le contexte de ${passage}\n\nCette rubrique examine ${passage} sous l'angle de \"${rubriqueTitle}\". L'analyse révèle des vérités importantes pour notre compréhension théologique et notre marche chrétienne.\n\n**Enseignement biblique :** ${passage} nous instruit sur la nature de Dieu et son œuvre dans l'histoire du salut.\n**Application pratique :** Ces vérités transforment notre relation avec le Créateur et notre vision du monde.`;\n\n    // Étendre le contenu selon la longueur cible\n    if (targetLength >= 1500) {\n      return baseContent + `\n\nLa narration scripturaire nous invite à une méditation approfondie sur les implications de ce passage. L'Esprit Saint, par sa grâce illuminatrice, nous révèle les richesses cachées de la Parole divine. Cette section de l'Écriture s'inscrit dans le grand dessein rédempteur de Dieu, préparant la venue du Messie et l'établissement de son royaume éternel.\n\n**Dimension théologique :** L'étude de ${passage} enrichit notre compréhension de la nature divine et de ses attributs.\n**Portée sotériologique :** Ce texte contribue à notre compréhension du salut par grâce au moyen de la foi.\n**Perspective eschatologique :** Les vérités révélées ici éclairent notre espérance en la consommation du royaume de Dieu.`;\n    }\n\n    return baseContent;\n  };\n\n  // Fonction pour Christ au centre (2000 caractères) - Très théologique et narratif\n  const generateChristCenteredContent = (passage, book, chapter, targetLength) => {\n    return `La lecture christocentrique de ${passage} révèle la présence du Fils éternel dès l'œuvre créatrice. L'Écriture nous enseigne que \"toutes choses ont été faites par lui, et rien de ce qui a été fait n'a été fait sans lui\" (Jean 1:3). Cette vérité transforme radicalement notre compréhension de la création.\n\nLe Logos divin, second membre de la Trinité sainte, participe activement à l'acte créateur. Quand Dieu dit \"Que la lumière soit\", c'est la Parole éternelle qui s'exprime. Cette lumière primordiale préfigure Christ, \"lumière du monde\" qui viendra éclairer les ténèbres spirituelles de l'humanité déchue.\n\nL'expression \"Faisons l'homme à notre image\" (Genèse 1:26) révèle la consultation trinitaire. Le Père, le Fils et le Saint-Esprit concourent à la création de l'homme. Cette image divine imprimée en Adam trouve son archétype parfait en Jésus-Christ, \"image du Dieu invisible\" (Colossiens 1:15). L'homme déchu sera restauré à cette image par l'œuvre rédemptrice du Fils incarné.\n\nLe sabbat créationnel annonce prophétiquement le repos que Christ procurera à son peuple. \"Venez à moi, vous tous qui êtes fatigués et chargés, et je vous donnerai du repos\" (Matthieu 11:28). Le sabbat temporel s'accomplit dans le repos éternel que le Sauveur assure à tous ceux qui croient en lui.\n\nLa domination accordée à l'homme sur la création préfigure la royauté universelle du Fils de l'homme. Christ, second Adam, restaurera cette domination perdue par la chute et l'exercera parfaitement dans son royaume millénaire et éternel.\n\nCette lecture christologique de la création enrichit notre adoration et affermit notre espérance en celui qui est \"l'Alpha et l'Oméga, le commencement et la fin\".`;\n  };\n\n  // Fonction pour évangile et grâce (2000 caractères) - Très théologique et narratif\n  const generateGospelGraceContent = (passage, book, chapter, targetLength) => {\n    return `Dans la magnificence de ${passage}, l'évangile de la grâce divine se dessine déjà en filigrane. Bien que l'humanité n'ait pas encore chuté, la prescience divine connaît déjà le plan rédempteur qui se déploiera à travers l'histoire sainte.\n\nLa création ex nihilo manifeste la grâce première de Dieu. Rien ne l'obligeait à créer ; aucun besoin ne le contraignait à donner l'existence à l'univers. Cette création gratuite révèle la nature généreuse et aimante du Créateur. Cette gratuité originelle préfigure la grâce salvatrice qui sera manifestée en Jésus-Christ.\n\nLa bénédiction divine sur l'humanité - \"Dieu les bénit\" - constitue la première effusion de grâce sur les créatures portant son image. Cette bénédiction créationnelle anticipe la bénédiction rédemptrice qui coulera du sacrifice de l'Agneau immolé dès la fondation du monde.\n\nL'établissement du sabbat révèle la pédagogie divine. Dieu enseigne à l'homme le rythme de la grâce : six jours de labeur suivis d'un jour de repos et de communion. Ce principe éducatif prépare l'humanité à comprendre que le salut ne s'obtient pas par les œuvres mais par la grâce, au moyen de la foi.\n\nL'environnement édénique - implicite dans ce chapitre et explicité au suivant - manifeste la bonté gratuite de Dieu envers ses créatures. Cette bonté originelle témoigne du désir divin de communion avec l'humanité, désir qui trouvera son accomplissement parfait dans l'incarnation du Fils.\n\nMême la capacité humaine de répondre à Dieu, de le connaître et de l'adorer, constitue un don de la grâce divine. L'imago Dei n'est pas un mérite humain mais un cadeau du Créateur aimant.\n\nCette perspective évangélique de la création nourrit notre gratitude et nous prépare à mieux saisir la grandeur de la grâce salvatrice manifestée en Christ Jésus notre Seigneur.`;\n  };\n\n  // Ajouter d'autres fonctions pour les rubriques restantes...\n  const generateCulturalContextContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Contexte culturel\", passage, book, chapter, targetLength);\n  };\n\n  const generateGeographicalContextContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Contexte géographique\", passage, book, chapter, targetLength);\n  };\n\n  const generateLexicalAnalysisContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Analyse lexicale\", passage, book, chapter, targetLength);\n  };\n\n  const generateBiblicalParallelsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Parallèles bibliques\", passage, book, chapter, targetLength);\n  };\n\n  const generateProphecyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Prophétie et accomplissement\", passage, book, chapter, targetLength);\n  };\n\n  const generateCharactersContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Personnages\", passage, book, chapter, targetLength);\n  };\n\n  const generateRhetoricalStructureContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Structure rhétorique\", passage, book, chapter, targetLength);\n  };\n\n  const generateTrinityTheologyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Théologie trinitaire\", passage, book, chapter, targetLength);\n  };\n\n  const generatePersonalApplicationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Application personnelle\", passage, book, chapter, targetLength);\n  };\n\n  const generateCommunityApplicationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Application communautaire\", passage, book, chapter, targetLength);\n  };\n\n  const generateResponsePrayerContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Prière de réponse\", passage, book, chapter, targetLength);\n  };\n\n  const generateStudyQuestionsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Questions d'étude\", passage, book, chapter, targetLength);\n  };\n\n  const generateVigilancePointsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Points de vigilance\", passage, book, chapter, targetLength);\n  };\n\n  const generateObjectionsResponsesContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Objections et réponses\", passage, book, chapter, targetLength);\n  };\n\n  const generateMissionalPerspectiveContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Perspective missionnelle\", passage, book, chapter, targetLength);\n  };\n\n  const generateChristianEthicsContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Éthique chrétienne\", passage, book, chapter, targetLength);\n  };\n\n  const generateWorshipLiturgyContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Louange / liturgie\", passage, book, chapter, targetLength);\n  };\n\n  const generateGuidedMeditationContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Méditation guidée\", passage, book, chapter, targetLength);\n  };\n\n  const generateMemoryVersesContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Mémoire / versets clés\", passage, book, chapter, targetLength);\n  };\n\n  const generateActionPlanContent = (passage, book, chapter, targetLength) => {\n    return generateDefaultContent(\"Plan d'action\", passage, book, chapter, targetLength);\n  };\n\n  // Fonction pour générer un contenu fallback intelligent\n  const generateIntelligentFallback = (passage, book, chapter) => {\n    return `**ÉTUDE BIBLIQUE — 28 RUBRIQUES**\n**Passage :** ${passage} (LSG)\n\n## 1. Prière d'ouverture\nSeigneur, ouvre nos cœurs à la compréhension de ${passage}. Que ton Esprit nous guide dans ta vérité et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.\n\n## 2. Structure littéraire\nLe passage de ${passage} révèle une structure littéraire soigneusement orchestrée qui sert le propos théologique de l'auteur inspiré. Cette organisation guide le lecteur vers une compréhension progressive des vérités divines révélées.\n\n## 3. Questions du chapitre précédent\nL'étude de ${passage} doit être mise en relation avec le contexte qui précède. Quels thèmes et enseignements préparent le lecteur à comprendre ce passage dans sa continuité narrative et théologique ?\n\n## 4. Thème doctrinal\nLe thème doctrinal central de ${passage} manifeste des vérités fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la révélation progressive de Dieu.\n\n## 5. Fondements théologiques\n${passage} établit des fondements théologiques importants qui éclairent notre compréhension de l'œuvre de Dieu dans l'histoire et dans nos vies. Ces vérités fondamentales structurent la foi chrétienne.\n\n## 6. Contexte historique\nLe contexte historique de ${passage} éclaire la situation des premiers auditeurs et enrichit notre compréhension contemporaine. Connaître les circonstances originales aide à saisir l'intention divine.\n\n## 7. Contexte culturel\nLes éléments culturels présents dans ${passage} révèlent les coutumes et pratiques de l'époque, permettant une meilleure interprétation des enseignements bibliques dans leur cadre original.\n\n## 8. Contexte géographique\nLa géographie de ${passage} offre des clés d'interprétation importantes. Les lieux mentionnés portent souvent une signification symbolique et théologique qui enrichit le message.\n\n## 9. Analyse lexicale\nL'étude des termes clés dans ${passage} révèle la richesse du vocabulaire biblique et les nuances importantes pour une compréhension précise du texte inspiré.\n\n## 10. Parallèles bibliques\n${passage} trouve des échos dans d'autres parties de l'Écriture. Ces parallèles bibliques éclairent le sens et montrent l'unité de la révélation divine.\n\n## 11. Prophétie et accomplissement\nLes éléments prophétiques présents dans ${passage} s'inscrivent dans le plan rédempteur de Dieu et trouvent leur accomplissement ultime en Jésus-Christ.\n\n## 12. Personnages\nLes personnages mentionnés dans ${passage} offrent des modèles ou des avertissements pour notre marche chrétienne. Leur exemple instruit notre foi.\n\n## 13. Structure rhétorique\nLa rhétorique employée dans ${passage} révèle l'art divin de la communication. La structure argumentative guide le lecteur vers les vérités essentielles.\n\n## 14. Théologie trinitaire\n${passage} révèle des aspects de la nature trinitaire de Dieu : Père, Fils et Saint-Esprit œuvrent ensemble dans l'histoire du salut.\n\n## 15. Christ au centre\nChrist se révèle au centre de ${passage} comme accomplissement des promesses et clé d'interprétation de l'Écriture. L'herméneutique christocentrique éclaire ce texte.\n\n## 16. Évangile et grâce\n${passage} manifeste la grâce de Dieu et les vérités évangéliques fondamentales. Le salut par grâce au moyen de la foi transparaît dans ce texte.\n\n## 17. Application personnelle\nComment ${passage} transforme-t-il notre marche quotidienne avec Dieu ? Ce texte nous interpelle sur nos attitudes, nos priorités et notre relation avec le Seigneur.\n\n## 18. Application communautaire\n${passage} éclaire la vie de l'Église et les relations fraternelles. Les principes énoncés s'appliquent à la communauté des croyants.\n\n## 19. Prière de réponse\nEn réponse à l'étude de ${passage}, offrons à Dieu notre reconnaissance, notre confession et nos requêtes. Que sa Parole transforme nos cœurs.\n\n## 20. Questions d'étude\n- Que révèle ${passage} sur la nature de Dieu ?\n- Que nous enseigne ce texte sur la condition humaine ?\n- Quels changements ce passage appelle-t-il dans notre vie ?\n\n## 21. Points de vigilance\nQuelles sont les erreurs d'interprétation à éviter concernant ${passage} ? Quels écueils théologiques ce texte nous aide-t-il à contourner ?\n\n## 22. Objections et réponses\nComment répondre aux objections couramment soulevées contre les enseignements de ${passage} ? Quels arguments bibliques y répondent ?\n\n## 23. Perspective missionnelle\n${passage} éclaire-t-il notre mission d'évangélisation ? Comment ce texte motive-t-il et oriente-t-il l'œuvre missionnaire ?\n\n## 24. Éthique chrétienne\nQuels principes éthiques ${passage} établit-il ? Comment guide-t-il nos choix moraux et notre conduite chrétienne ?\n\n## 25. Louange / liturgie\nComment ${passage} nourrit-il notre adoration ? Quels éléments peuvent enrichir notre louange communautaire et personnelle ?\n\n## 26. Méditation guidée\nPrenons un moment pour méditer personnellement sur ${passage}. Que le Saint-Esprit grave ces vérités dans nos cœurs.\n\n## 27. Mémoire / versets clés\nVerset-clé suggéré : ${passage}:1\nMémorisons ce verset pour porter sa vérité dans notre quotidien.\n\n## 28. Plan d'action\n- Une action personnelle cette semaine en réponse à ${passage}\n- Une application communautaire ce mois-ci\n- Un témoignage à partager de l'impact de ce texte`;\n  };\n\n  // Fonction pour générer du contenu de fallback intelligent par rubrique\n  const generateFallbackRubriqueContent = (rubriqueNum, rubriqueTitle, passage) => {\n    const fallbacks = {\n      1: `Seigneur, ouvre nos cœurs à la compréhension de ${passage}. Que ton Esprit nous guide dans ta vérité et nous transforme par ta Parole. Accorde-nous la sagesse pour discerner tes enseignements et la force pour les appliquer dans notre vie quotidienne.`,\n      \n      2: `Le passage de ${passage} révèle une structure littéraire soigneusement orchestrée qui sert le propos théologique de l'auteur inspiré. Cette organisation n'est pas fortuite mais guide le lecteur vers une compréhension progressive des vérités divines révélées.`,\n      \n      4: `Le thème doctrinal central de ${passage} manifeste des vérités fondamentales sur la nature de Dieu, la condition humaine et le plan de salut. Ces enseignements s'inscrivent dans la révélation progressive de Dieu et trouvent leur accomplissement en Christ.`,\n      \n      6: `Le contexte historique de ${passage} éclaire la situation des premiers auditeurs et enrichit notre compréhension contemporaine. Connaître les circonstances originales nous aide à mieux saisir l'intention divine et l'application universelle du texte.`,\n      \n      15: `Christ se révèle au centre de ${passage} comme accomplissement des promesses et clé d'interprétation de l'Écriture. L'herméneutique christocentrique nous permet de découvrir comment ce passage témoigne de l'œuvre rédemptrice du Sauveur.`,\n      \n      17: `Application personnelle : comment ${passage} transforme-t-il notre marche quotidienne avec Dieu et notre croissance spirituelle ? Ce texte nous interpelle sur nos attitudes, nos priorités et notre relation avec le Seigneur.`\n    };\n\n    return fallbacks[rubriqueNum] || `**${rubriqueTitle}**\\n\\nCette section de ${passage} nous enseigne des vérités importantes selon la perspective de ${rubriqueTitle.toLowerCase()}. L'analyse de ce passage révèle des insights précieux pour notre compréhension biblique et notre application pratique.\\n\\n*Contenu généré automatiquement - ${rubriqueNum}/${BASE_RUBRIQUES.length} rubriques*`;\n  };\n  const animateProgress = async (duration = 3000) => {\n    setProgressPercent(0);\n    const steps = 100, step = duration / steps;\n    for (let i = 0; i <= steps; i++) { setProgressPercent(i); await wait(step); }\n  };\n\n  // YouVersion\n  const openYouVersion = () => {\n    if (selectedBook === \"--\") return alert(\"Veuillez d'abord sélectionner un livre de la Bible\");\n    const bookCodes = {\"Genèse\":\"GEN\",\"Exode\":\"EXO\",\"Lévitique\":\"LEV\",\"Nombres\":\"NUM\",\"Deutéronome\":\"DEU\",\"Josué\":\"JOS\",\"Juges\":\"JDG\",\"Ruth\":\"RUT\",\"1 Samuel\":\"1SA\",\"2 Samuel\":\"2SA\",\"1 Rois\":\"1KI\",\"2 Rois\":\"2KI\",\"1 Chroniques\":\"1CH\",\"2 Chroniques\":\"2CH\",\"Esdras\":\"EZR\",\"Néhémie\":\"NEH\",\"Esther\":\"EST\",\"Job\":\"JOB\",\"Psaumes\":\"PSA\",\"Proverbes\":\"PRO\",\"Ecclésiaste\":\"ECC\",\"Cantique des cantiques\":\"SNG\",\"Ésaïe\":\"ISA\",\"Jérémie\":\"JER\",\"Lamentations\":\"LAM\",\"Ézéchiel\":\"EZK\",\"Daniel\":\"DAN\",\"Osée\":\"HOS\",\"Joël\":\"JOL\",\"Amos\":\"AMO\",\"Abdias\":\"OBA\",\"Jonas\":\"JON\",\"Michée\":\"MIC\",\"Nahum\":\"NAM\",\"Habacuc\":\"HAB\",\"Sophonie\":\"ZEP\",\"Aggée\":\"HAG\",\"Zacharie\":\"ZEC\",\"Malachie\":\"MAL\",\"Matthieu\":\"MAT\",\"Marc\":\"MRK\",\"Luc\":\"LUK\",\"Jean\":\"JHN\",\"Actes\":\"ACT\",\"Romains\":\"ROM\",\"1 Corinthiens\":\"1CO\",\"2 Corinthiens\":\"2CO\",\"Galates\":\"GAL\",\"Éphésiens\":\"EPH\",\"Philippiens\":\"PHP\",\"Colossiens\":\"COL\",\"1 Thessaloniciens\":\"1TH\",\"2 Thessaloniciens\":\"2TH\",\"1 Timothée\":\"1TI\",\"2 Timothée\":\"2TI\",\"Tite\":\"TIT\",\"Philémon\":\"PHM\",\"Hébreux\":\"HEB\",\"Jacques\":\"JAS\",\"1 Pierre\":\"1PE\",\"2 Pierre\":\"2PE\",\"1 Jean\":\"1JN\",\"2 Jean\":\"2JN\",\"3 Jean\":\"3JN\",\"Jude\":\"JUD\",\"Apocalypse\":\"REV\"};\n    const code = bookCodes[selectedBook]; if (!code) return alert(\"Livre non reconnu pour YouVersion\");\n    let url = `https://www.bible.com/fr/bible/63/${code}`;\n    if (selectedChapter !== \"--\") { url += `.${selectedChapter}`; if (selectedVerse !== \"--\") url += `.${selectedVerse}`; }\n    window.open(url, \"_blank\");\n  };\n\n  // Rendre la fonction disponible globalement pour éviter les erreurs \"not defined\"\n  React.useEffect(() => {\n    window.openYouVersion = openYouVersion;\n    return () => {\n      delete window.openYouVersion;\n    };\n  }, [selectedBook, selectedChapter, selectedVerse]);\n\n  const handleReset = () => {\n    saveCurrentStudy();\n    setSelectedBook(\"--\"); setSelectedChapter(\"--\"); setSelectedVerse(\"--\");\n    setSelectedVersion(\"LSG\"); setSelectedLength(500); setActiveRubrique(0);\n    setContent(\"\"); setRubriquesStatus({});\n    setProgressiveStats(null);\n    // Note: Les notes personnelles ne sont jamais effacées lors du reset\n  };\n\n  // Fonctions pour les notes persistantes\n  const handleNotesClick = () => {\n    navigateToNotes();\n  };\n\n  // SUPPRIMÉ : showNotesModal et fonctions de modal - remplacées par page dédiée\n\n  // SUPPRIMÉ : handleCloseNotes - plus besoin avec page dédiée\n\n  // Fonctions pour la navigation\n  const navigateToConcordance = () => {\n    setCurrentPage('concordance');\n  };\n\n  const navigateToVersets = (content, bookInfo) => {\n    setVersetPageContent(content);\n    setCurrentBookInfo(bookInfo);\n    setCurrentPage('versets');\n  };\n\n  const navigateToNotes = () => {\n    setCurrentPage('notes');\n  };\n\n  const navigateToRubrique = (rubriqueNumber, content = '') => {\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Rubrique ${rubriqueNumber}:`);\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Content reçu:`, content ? content.length : 0, \"caractères\");\n    console.log(`[NAVIGATE RUBRIQUE DEBUG] Content preview:`, content ? content.slice(0, 100) + \"...\" : \"VIDE\");\n    \n    setCurrentRubriqueNumber(rubriqueNumber);\n    setCurrentRubriqueContent(content);\n    const bookInfo = `${selectedBook || 'Genèse'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n    setCurrentBookInfo(bookInfo);\n    setCurrentPage('rubrique');\n  };\n\n  const navigateToMain = () => {\n    setCurrentPage('main');\n  };\n\n  // Fonction pour revenir de la page d'histoire de personnage\n  const handleBackFromCharacter = () => {\n    setSelectedCharacterForHistory(null);\n  };\n\n  const continueVerses = async () => {\n    try {\n      setIsLoading(true);\n      \n      const book = selectedBook || 'Genèse';\n      const chapter = selectedChapter || '1';\n      const passage = `${book} ${chapter}`;\n      const startVerse = currentVerseCount + 1;\n      const endVerse = currentVerseCount + 5;\n      \n      console.log(`[CONTINUE VERSETS] Génération versets ${startVerse} à ${endVerse} pour ${passage}`);\n      \n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      \n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          passage: `${passage}:${startVerse}-${endVerse}`,\n          version: selectedVersion || 'LSG',\n          tokens: parseInt(selectedLength) || 500,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Erreur API: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.content) {\n        const currentContent = content;\n        const newContent = postProcessMarkdown(data.content);\n        const formattedNewContent = formatContent(newContent, 'versets-prog');\n        \n        // Ajouter le nouveau contenu au contenu existant\n        setContent(currentContent + '\\n\\n' + formattedNewContent);\n        setCurrentVerseCount(endVerse);\n        \n        // Vérifier s'il y a encore des versets à générer\n        if (endVerse >= 31) { // Genèse 1 a 31 versets\n          setCanContinueVerses(false);\n        }\n        \n        console.log(`[SUCCESS] Versets ${startVerse}-${endVerse} ajoutés avec succès`);\n      }\n      \n    } catch (error) {\n      console.error('[ERROR] Erreur continuation versets:', error);\n      setContent(prev => prev + '\\n\\n❌ Erreur lors de la génération des versets suivants');\n    }\n    \n    setIsLoading(false);\n  };\n\n  const handleRubriqueSelect = async (id) => {\n    setActiveRubrique(id);\n    \n    // Créer une clé unique pour cette combinaison livre/chapitre\n    const contentKey = `${selectedBook}_${selectedChapter}_${id}`;\n    \n    // Si la rubrique est déjà générée, afficher le contenu\n    if (rubriquesStatus[id] === \"completed\" && generatedRubriques[contentKey]) {\n      console.log(`[AFFICHAGE RUBRIQUE ${id}] Contenu sauvegardé trouvé - longueur: ${generatedRubriques[contentKey].length}`);\n      \n      // Si rubrique 0 et qu'il y a du contenu verset par verset, naviguer vers la page verset dédiée\n      if (id === 0 && (generatedRubriques[contentKey].includes('VERSET') || generatedRubriques[contentKey].includes('**TEXTE BIBLIQUE'))) {\n        const bookInfo = `${selectedBook || 'Genèse'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n        navigateToVersets(generatedRubriques[contentKey], bookInfo);\n      }\n      // Si rubrique 1-28, naviguer vers la page rubrique dédiée avec le contenu existant\n      else if (id >= 1 && id <= 28) {\n        console.log(`[NAVIGATION RUBRIQUE ${id}] Avec contenu existant`);\n        navigateToRubrique(id, generatedRubriques[contentKey]);\n      }\n      else {\n        setContent(generatedRubriques[contentKey]);\n      }\n    }\n\n    // Pour les rubriques 1-28, générer via API au lieu du contenu statique\n    if (id >= 1 && id <= 28) {\n      console.log(`[GÉNÉRATION API RUBRIQUE ${id}] Début génération via API pour ${selectedBook} ${selectedChapter}`);\n      \n      setIsLoading(true);\n      setRubriquesStatus(prev => ({ ...prev, [id]: \"loading\" }));\n      \n      try {\n        const rubriqueTitle = getRubTitle(id);\n        const passage = `${selectedBook || 'Genèse'} ${selectedChapter || '1'}`;\n        const targetLength = getRubriqueLength(id);\n        \n        // Appel API pour générer le contenu dynamique\n        const apiContent = await generateRubriqueContentViaAPI(\n          id, \n          rubriqueTitle, \n          passage, \n          selectedBook || 'Genèse', \n          selectedChapter || '1', \n          targetLength\n        );\n        \n        // Sauvegarder le contenu généré\n        setGeneratedRubriques(prev => ({\n          ...prev,\n          [contentKey]: apiContent\n        }));\n        \n        setRubriquesStatus(prev => ({ ...prev, [id]: \"completed\" }));\n        \n        console.log(`[SUCCÈS API RUBRIQUE ${id}] Contenu généré et sauvegardé - longueur: ${apiContent.length}`);\n        \n        // Naviguer vers la page rubrique dédiée avec le nouveau contenu\n        navigateToRubrique(id, apiContent);\n        \n      } catch (error) {\n        console.error(`[ERREUR API RUBRIQUE ${id}]`, error);\n        \n        setRubriquesStatus(prev => ({ ...prev, [id]: \"error\" }));\n        setContent(`❌ Erreur lors de la génération de la rubrique ${id}: ${getRubTitle(id)}`);\n      }\n      \n      setIsLoading(false);\n      return;\n    }\n    \n    if (id === 0) {\n      // Rubrique 0 : Étude verset par verset - naviguer vers la page dédiée si du contenu existe\n      console.log(`[RUBRIQUE 0] Vérification contenu existant - clé: ${contentKey}`);\n      \n      if (generatedRubriques[contentKey] && (generatedRubriques[contentKey].includes('VERSET') || generatedRubriques[contentKey].includes('**TEXTE BIBLIQUE'))) {\n        console.log(`[RUBRIQUE 0] Contenu verset par verset trouvé, navigation vers page dédiée`);\n        const bookInfo = `${selectedBook || 'Genèse'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n        navigateToVersets(generatedRubriques[contentKey], bookInfo);\n      } else {\n        console.log(`[RUBRIQUE 0] Aucun contenu trouvé, affichage message d'instruction`);\n        setContent(\"Cliquez sur **Versets Prog** pour générer l'étude verset par verset de ce chapitre.\");\n        setIsVersetsProgContent(false);\n      }\n    } else {\n      setContent(\"\");\n    }\n  };\n\n  // Fonction pour générer une rubrique à la demande\n  const generateRubriqueOnDemand = async (rubriqueNum) => {\n    if (rubriqueNum === 0) return; // Rubrique 0 utilise VERSETS PROG\n    \n    const rubriqueTitle = BASE_RUBRIQUES[rubriqueNum];\n    const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n      ? `${selectedBook || 'Genèse'} ${selectedChapter || '1'}`\n      : `${selectedBook || 'Genèse'} ${selectedChapter || '1'}:${selectedVerse}`;\n    \n    try {\n      console.log(`[GÉNÉRATION À LA DEMANDE] Rubrique ${rubriqueNum}: ${rubriqueTitle}`);\n      \n      setIsLoading(true);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"in-progress\" }));\n      \n      // Afficher le contenu en cours de génération\n      const contentEnCours = `# Étude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n🔄 Génération intelligente en cours...`;\n      setContent(formatContent(contentEnCours));\n      \n      // Générer le contenu intelligent pour cette rubrique\n      const rubriqueContent = await generateRubriqueContentViaAPI(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      \n      // Délai pour effet visuel\n      await wait(1000);\n      \n      // Afficher le contenu final\n      const contentFinal = `# Étude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n${rubriqueContent}`;\n      const formattedContent = formatContent(contentFinal);\n      setContent(formattedContent);\n      \n      // Sauvegarder le contenu dans l'état (plus fiable que localStorage)\n      const contentKey = `${selectedBook}_${selectedChapter}_${rubriqueNum}`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: formattedContent\n      }));\n      \n      // Marquer comme terminé\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"completed\" }));\n      \n      console.log(`[RUBRIQUE ${rubriqueNum} GÉNÉRÉE] ${rubriqueContent.length} caractères`);\n      \n    } catch (error) {\n      console.error(`[ERREUR GÉNÉRATION RUBRIQUE ${rubriqueNum}]`, error);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"error\" }));\n      setContent(`# Erreur\\n\\nErreur lors de la génération de la rubrique ${rubriqueNum}: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Palette (reprend ta logique initiale)\n  const changePalette = () => {\n    const nextTheme = (currentTheme + 1) % colorThemes.length;\n    setCurrentTheme(nextTheme);\n    const theme = colorThemes[nextTheme];\n\n    const app = document.querySelector('.App');\n    if (app) app.style.background = 'transparent'; // Garder arrière-plan transparent\n\n    const header = document.querySelector('.header-banner');\n    if (header) header.style.background = theme.headerBg;\n\n    document.documentElement.style.setProperty('--theme-primary', `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`);\n    document.documentElement.style.setProperty('--theme-secondary', `linear-gradient(135deg, ${theme.secondary}, ${theme.primary})`);\n    document.documentElement.style.setProperty('--theme-accent', `linear-gradient(135deg, ${theme.accent}, ${theme.secondary})`);\n    \n    // Couleurs pour les ombres\n    const hexToRgba = (hex, alpha) => {\n      const r = parseInt(hex.slice(1, 3), 16);\n      const g = parseInt(hex.slice(3, 5), 16);\n      const b = parseInt(hex.slice(5, 7), 16);\n      return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n    };\n    \n    document.documentElement.style.setProperty('--theme-accent-shadow', hexToRgba(theme.accent, 0.3));\n    document.documentElement.style.setProperty('--theme-accent-shadow-hover', hexToRgba(theme.accent, 0.4));\n\n    const progressPill = document.querySelector('.progress-pill');\n    if (progressPill) progressPill.style.background = theme.primary;\n\n    const contentHeader = document.querySelector('.content-header');\n    if (contentHeader)\n      contentHeader.style.background = `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`;\n\n    const btnReset = document.querySelector('.btn-reset');\n    if (btnReset) { btnReset.style.background = theme.secondary; btnReset.style.color = 'white'; btnReset.style.border = 'none'; }\n\n    const btnPalette = document.querySelector('.btn-palette');\n    if (btnPalette) { btnPalette.style.background = theme.primary; btnPalette.style.color = 'white'; btnPalette.style.border = 'none'; }\n\n    const btnLastStudy = document.querySelector('.btn-last-study');\n    if (btnLastStudy) {\n      btnLastStudy.style.background = `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})`;\n      btnLastStudy.style.color = 'white'; btnLastStudy.style.border = 'none';\n    }\n\n    const btnGemini = document.querySelector('.btn-gemini');\n    if (btnGemini) { btnGemini.style.background = `linear-gradient(90deg, ${theme.secondary}, ${theme.accent})`; btnGemini.style.color = 'white'; btnGemini.style.border = 'none'; }\n\n    const btnVersets = document.querySelector('.btn-versets-prog');\n    if (btnVersets) { btnVersets.style.background = theme.accent; btnVersets.style.color = 'white'; btnVersets.style.border = 'none'; }\n\n    const btnGenerate = document.querySelector('.btn-generate');\n    if (btnGenerate) { btnGenerate.style.background = `linear-gradient(45deg, ${theme.primary}, ${theme.secondary})`; btnGenerate.style.color = 'white'; btnGenerate.style.border = 'none'; }\n\n    const btnValidate = document.querySelector('.btn-validate');\n    if (btnValidate) { btnValidate.style.background = theme.primary; btnValidate.style.color = 'white'; btnValidate.style.border = 'none'; }\n  };\n\n  /* =========================\n     Génération (avec fallbacks)\n  ========================= */\n\n  const generateVerseByVerseProgressive = async () => {\n    console.log(\"[DEBUG] generateVerseByVerseProgressive function called!\");\n    \n    try {\n      setIsLoading(true); setIsProgressiveLoading(true);\n      setContent(\"\"); setProgressPercent(0);\n      setIsVersetsProgContent(true); // Marquer que c'est du contenu VERSETS PROG\n      setRubriquesStatus(p => ({ ...p, 0: \"in-progress\" }));\n      \n      // Format exact requis par l'API Railway\n      const book = selectedBook || 'Genèse';\n      const chapter = selectedChapter || '1';\n      const passage = `${book} ${chapter}`;\n      console.log(\"[VERSETS PROG] Génération progressive pour:\", passage);\n\n      // 🔹 UTILISER VOTRE BACKEND avec votre clé Gemini GRATUITE\n      console.log(\"[VERSETS PROG] Utilisation de votre backend avec clé Gemini gratuite\");\n      \n      // CORRECTION: Utiliser la variable d'environnement pour l'endpoint\n      const apiUrl = `${API_BASE}/generate-verse-by-verse`;\n      console.log(\"[VERSETS PROG] URL backend utilisée:\", apiUrl);\n      \n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          passage: passage,\n          version: selectedVersion || 'LSG',\n          tokens: parseInt(selectedLength) || 500,\n          use_gemini: true,\n          enriched: true\n        })\n      });\n      \n      if (!response.ok) {\n        console.error(`[VERSETS PROG] Erreur API Railway: ${response.status}`);\n        throw new Error(`API Railway Error ${response.status}`);\n      }\n      \n      const data = await response.json();\n      console.log(\"[API RAILWAY OK] Contenu reçu:\", data.content ? data.content.length : 0, \"caractères\");\n      \n      // Afficher des informations sur la source du contenu\n      const sourceInfo = data.source || \"API\";\n      const fromCache = data.from_cache || false;\n      const cost = data.cost || \"Traitement\";\n      \n      console.log(`[SOURCE] ${sourceInfo} ${fromCache ? '(Cache)' : '(Nouveau)'} - ${cost}`);\n      \n      // Afficher un message informatif selon la source\n      if (fromCache) {\n        console.log(\"📋 Contenu récupéré du cache - réponse instantanée\");\n      } else if (sourceInfo.includes(\"Fallback\") || sourceInfo.includes(\"théologique\")) {\n        console.log(\"🔄 Quota Gemini atteint - utilisation du système de fallback intelligent\");\n      } else if (sourceInfo.includes(\"Gemini\")) {\n        console.log(\"🤖 Contenu généré par Gemini avec votre clé personnelle\");\n      }\n      \n      // Utiliser le contenu de l'API (correction du bug d'affichage)\n      if (!data.content) {\n        throw new Error(\"Aucun contenu reçu de l'API\");\n      }\n      \n      const fullContent = data.content;\n      \n      // Initialiser les états de continuation\n      setCurrentVerseCount(5); // Par défaut, on génère 5 versets\n      setCanContinueVerses(true); // Permettre la continuation\n      \n      // Affichage immédiat du contenu optimisé avec boutons Gemini\n      const finalContent = postProcessMarkdown(fullContent);\n      setContent(formatContent(finalContent, 'versets-prog'));\n      setProgressPercent(100);\n      setRubriquesStatus(p => ({ ...p, 0: \"completed\" }));\n      setIsVersetsProgContent(true); // IMPORTANT : activer l'état VERSETS PROG\n      console.log(\"[SUCCESS] Contenu VERSETS PROG affiché correctement\");\n      \n      // Sauvegarder l'étude après génération réussie\n      saveCurrentStudy();\n      console.log(\"[SAUVEGARDE] Étude verset par verset sauvegardée\");\n      \n      // Sauvegarder le contenu dans generatedRubriques pour la navigation\n      const contentKey = `${selectedBook || 'Genèse'}_${selectedChapter || '1'}_0`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: fullContent\n      }));\n      \n      // Naviguer automatiquement vers la page dédiée \"Verset par Verset\"\n      const bookInfo = `${selectedBook || 'Genèse'} ${selectedChapter || '1'}${selectedVerse !== \"--\" ? \":\" + selectedVerse : \"\"}`;\n      console.log(\"[NAVIGATION] Préparation navigation vers page Verset par Verset:\", bookInfo);\n      setTimeout(() => {\n        console.log(\"[NAVIGATION] Navigation vers la page dédiée Verset par Verset\");\n        navigateToVersets(fullContent, bookInfo);\n      }, 500); // Petit délai pour l'effet visuel\n      \n    } catch (err) {\n      console.error(\"Erreur génération VERSETS PROG:\", err);\n      setContent(`Erreur lors de la génération progressive: ${err.message}`);\n      setRubriquesStatus(p => ({ ...p, 0: \"error\" }));\n    } finally {\n      setIsLoading(false); setIsProgressiveLoading(false);\n      setProgressPercent(100);\n    }\n  };\n\n  const generateWithGemini = async () => {\n    try {\n      setIsLoading(true); \n      setContent(\"Enrichissement théologique avec votre Gemini gratuit en cours...\");\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"in-progress\" }));\n\n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook} ${selectedChapter}`\n        : `${selectedBook} ${selectedChapter}:${selectedVerse}`;\n\n      // Enrichir théologiquement avec votre clé Gemini gratuite\n      if (activeRubrique >= 1 && activeRubrique <= 28) {\n        const rubriqueTitle = BASE_RUBRIQUES[activeRubrique];\n        \n        // Générer un enrichissement théologique avec longueur augmentée\n        const enrichedLength = Math.min(2000, parseInt(selectedLength) + 500);\n        console.log(`[ENRICHISSEMENT GEMINI GRATUIT] Rubrique ${activeRubrique} - Longueur enrichie: ${enrichedLength} caractères`);\n        \n        // Appeler votre backend avec votre clé Gemini gratuite\n        const response = await fetch(`${API_BASE}/generate-verse-by-verse`, {\n          method: 'POST',\n          headers: { \n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            passage: passage,\n            version: selectedVersion || 'LSG',\n            tokens: enrichedLength,\n            use_gemini: true,\n            enriched: true,\n            rubric_type: rubriqueTitle\n          })\n        });\n\n        if (!response.ok) {\n          throw new Error(`Erreur API: ${response.status}`);\n        }\n\n        const data = await response.json();\n        console.log(\"[GEMINI GRATUIT] Enrichissement reçu:\", data.content ? data.content.length : 0, \"caractères\");\n\n        if (data.content) {\n          // Afficher le contenu enrichi avec votre Gemini gratuit\n          const finalContent = `# Étude Enrichie avec Gemini Gratuit - ${passage}\\n\\n## ${activeRubrique}. ${rubriqueTitle}\\n\\n${data.content}`;\n          setContent(formatContent(finalContent));\n          \n          // Sauvegarder le contenu enrichi\n          const contentKey = `${selectedBook}_${selectedChapter}_${activeRubrique}`;\n          setGeneratedRubriques(prev => ({\n            ...prev,\n            [contentKey]: formatContent(finalContent)\n          }));\n          \n          console.log(\"[SUCCESS] Enrichissement Gemini gratuit affiché correctement\");\n          \n          // Sauvegarder l'étude après enrichissement réussi\n          saveCurrentStudy();\n          console.log(\"[SAUVEGARDE] Étude enrichie Gemini sauvegardée\");\n        } else {\n          throw new Error(\"Pas de contenu reçu de votre Gemini gratuit\");\n        }\n        \n      } else if (activeRubrique === 0) {\n        // Pour la rubrique 0, utiliser VERSETS PROG qui utilise déjà votre Gemini\n        setContent(\"⚠️ Pour la rubrique 0, utilisez le bouton 'VERSETS PROG' qui utilise déjà votre Gemini gratuit.\");\n      } else {\n        setContent(\"⚠️ Rubrique non supportée pour l'enrichissement Gemini.\");\n      }\n\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"completed\" }));\n    } catch (err) {\n      console.error(\"Erreur enrichissement Gemini gratuit:\", err);\n      setContent(`Erreur enrichissement avec votre Gemini gratuit: ${err.message}`);\n      setRubriquesStatus(p => ({ ...p, [activeRubrique]: \"error\" }));\n    } finally { \n      setIsLoading(false); \n    }\n  };\n\n  // Fonction pour enrichissement théologique contextuel et intelligent\n  const generateTheologicalEnrichment = async (rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength) => {\n    const baseContent = await generateRubriqueContentViaAPI(rubriqueNum, rubriqueTitle, passage, book, chapter, targetLength);\n    \n    // Enrichissement spécifique selon le livre biblique\n    const bookEnrichment = getBookSpecificEnrichment(book, chapter);\n    \n    // Enrichissement spécifique selon la rubrique\n    const rubriqueEnrichment = getRubriqueSpecificEnrichment(rubriqueNum, rubriqueTitle);\n    \n    // Enrichissement contextuel combiné\n    const contextualEnrichment = getCombinedContextualEnrichment(book, chapter, rubriqueNum, passage);\n    \n    const enrichmentSuffix = `\n\n**🤖 ENRICHISSEMENT CONTEXTUEL - ${passage}**\n\n${bookEnrichment}\n\n${rubriqueEnrichment}\n\n${contextualEnrichment}\n\n*Enrichissement généré par analyse contextuelle approfondie*`;\n\n    return baseContent + enrichmentSuffix.substring(0, Math.max(0, targetLength - baseContent.length));\n  };\n\n  // Enrichissement spécifique par livre biblique\n  const getBookSpecificEnrichment = (book, chapter) => {\n    const bookEnrichments = {\n      'Genèse': `**Perspective créationnelle :** ${book} ${chapter} s'inscrit dans le cadre de la théologie de la création. Les commentateurs patristiques, notamment Basile de Césarée dans ses Homélies sur l'Hexaméron, ont développé une exégèse remarquable de ces passages fondateurs.`,\n      \n      'Exode': `**Perspective libératrice :** ${book} ${chapter} révèle la pédagogie divine de la rédemption. Philon d'Alexandrie et plus tard l'École de théologie d'Antioche ont souligné les dimensions typologiques de ce récit qui préfigure la libération spirituelle en Christ.`,\n      \n      'Lévitique': `**Perspective sacrificielle :** ${book} ${chapter} développe la théologie cultuelle et sacrificielle. Les théologiens de l'Alliance (Cocceius, Witsius) ont magistralement démontré comment ces prescriptions rituelles trouvent leur accomplissement dans l'œuvre sacerdotale du Christ.`,\n      \n      'Nombres': `**Perspective pèlerine :** ${book} ${chapter} illustre la marche du peuple de Dieu vers la Terre Promise. John Bunyan dans \"The Pilgrim's Progress\" s'inspire de ces récits pour décrire le pèlerinage spirituel du chrétien.`,\n      \n      'Deutéronome': `**Perspective testamentaire :** ${book} ${chapter} constitue le testament mosaïque. Les théologiens de l'École de Saumur (Amyraut, Cappel) ont analysé la structure alliance-bénédiction-malédiction qui structure ce livre.`,\n      \n      'Matthieu': `**Perspective messianique :** ${book} ${chapter} révèle l'accomplissement des promesses vétérotestamentaires. Chrysostome dans ses Homélies sur Matthieu développe une christologie remarquable basée sur ce texte évangélique.`,\n      \n      'Marc': `**Perspective kérygmatique :** ${book} ${chapter} présente le Christ en action. L'exégèse moderne (Dodd, Jeremias) a souligné la dimension kérygmatique primitive de ce récit évangélique.`,\n      \n      'Luc': `**Perspective historico-salvifique :** ${book} ${chapter} s'inscrit dans l'histoire du salut. Conzelmann et l'École de Tübingen ont développé une théologie lucanienne de l'histoire sainte particulièrement éclairante.`,\n      \n      'Jean': `**Perspective théologique :** ${book} ${chapter} révèle la divinité du Christ. Les Pères cappadociens (Basile, Grégoire de Nazianze, Grégoire de Nysse) ont utilisé ce corpus johannique pour développer la théologie trinitaire.`,\n      \n      'Romains': `**Perspective sotériologique :** ${book} ${chapter} développe la doctrine du salut par grâce. Augustin, Luther, et Calvin ont fondé leur théologie de la justification sur cette épître magistrale.`,\n      \n      'Hébreux': `**Perspective sacerdotale :** ${book} ${chapter} présente le sacerdoce parfait du Christ. Owen dans son commentaire monumental a développé une théologie sacrificielle d'une profondeur inégalée.`\n    };\n    \n    return bookEnrichments[book] || `**Perspective biblique :** Ce passage de ${book} ${chapter} révèle des dimensions théologiques que les commentateurs anciens et modernes ont explorées avec profit.`;\n  };\n\n  // Enrichissement spécifique par rubrique\n  const getRubriqueSpecificEnrichment = (rubriqueNum, rubriqueTitle) => {\n    const rubriqueEnrichments = {\n      1: `**Enrichissement liturgique :** La tradition de la \"prière d'ouverture\" remonte aux Pères du désert. Jean Cassien dans ses Conférences spirituelles enseigne l'importance de l'invocation préalable pour toute lectio divina authentique.`,\n      \n      2: `**Enrichissement littéraire :** L'analyse structurelle moderne (rhétorique sémitique, Meynet) révèle des patterns sophistiqués que l'exégèse ancienne pressentait intuitivement. Cette approche enrichit considérablement la compréhension du texte.`,\n      \n      5: `**Enrichissement dogmatique :** Les fondements théologiques établis ici nourrissent la théologie systématique. Turretin dans ses Institutes of Elenctic Theology développe ces vérités avec une rigueur scolastique remarquable.`,\n      \n      15: `**Enrichissement christologique :** La lecture christocentrique trouve ici ses fondements herméneutiques. Vos dans sa Biblical Theology développe une approche christotélique qui éclaire remarquablement ce passage.`,\n      \n      16: `**Enrichissement sotériologique :** La doctrine de la grâce révélée ici constitue le cœur de l'Évangile. Les théologiens de Dordrecht ont systematisé ces vérités dans les Canons qui demeurent normatifs.`\n    };\n    \n    return rubriqueEnrichments[rubriqueNum] || `**Enrichissement thématique :** Cette rubrique \"${rubriqueTitle}\" ouvre des perspectives théologiques que la tradition exégétique a particulièrement développées.`;\n  };\n\n  // Enrichissement contextuel combiné\n  const getCombinedContextualEnrichment = (book, chapter, rubriqueNum, passage) => {\n    // Logique contextuelle sophistiquée combinant livre + rubrique\n    if (book === 'Genèse' && rubriqueNum === 1) {\n      return `**Synthèse contextuelle :** La prière d'ouverture sur Genèse ${chapter} nous place dans la contemplation de l'œuvre créatrice primordiale. Basile le Grand souligne que cette méditation doit commencer par l'adoration du Créateur avant l'analyse de la création.`;\n    }\n    \n    if (book === 'Genèse' && rubriqueNum === 15) {\n      return `**Synthèse christologique :** Christ présent dès Genèse ${chapter} selon l'exégèse patristique. Justin Martyr dans son Dialogue avec Tryphon identifie le Logos aux théophanies primitives, perspective reprise par la tradition réformée.`;\n    }\n    \n    if (book === 'Matthieu' && rubriqueNum === 16) {\n      return `**Synthèse évangélique :** L'évangile de la grâce révélé en Matthieu ${chapter} accomplit les promesses vétérotestamentaires. Cette continuité rédemptrice structure toute la théologie de l'alliance selon la tradition réformée (Westminster Confession).`;\n    }\n    \n    if ((book === 'Lévitique' || book === 'Hébreux') && rubriqueNum === 15) {\n      return `**Synthèse typologique :** Le système sacrificiel de ${book} ${chapter} trouve son accomplissement parfait dans l'œuvre sacerdotale du Christ. Cette typologie biblique, développée par l'École d'Antioche, révèle l'unité de l'histoire sainte.`;\n    }\n    \n    return `**Synthèse théologique :** L'intersection entre ${book} ${chapter} et cette dimension théologique révèle des vérités que l'exégèse traditionnelle a particulièrement valorisées dans l'édification de l'Église.`;\n  };\n\n  const generate28Points = async () => {\n    try {\n      setIsLoading(true);\n      setIsVersetsProgContent(false); // Désactiver le style VERSETS PROG\n      \n      // 🔹 ÉTAPE 1: Vider la rubrique 0 et passer sa LED au gris\n      setRubriquesStatus(p => ({ ...p, 0: \"inactive\" })); // LED grise pour rubrique 0\n      setContent(\"\"); // Vider le contenu affiché\n      \n      console.log(\"[GÉNÉRATION RUBRIQUE PAR RUBRIQUE] Début avec Prière d'ouverture\");\n      \n      const passage = (selectedVerse === \"--\" || selectedVerse === \"vide\")\n        ? `${selectedBook || 'Genèse'} ${selectedChapter || '1'}`\n        : `${selectedBook || 'Genèse'} ${selectedChapter || '1'}:${selectedVerse}`;\n\n      // 🔹 STRATÉGIE OPTIMISÉE: Rubrique 1 d'abord, puis les autres\n      console.log(\"[GÉNÉRATION OPTIMISÉE] Génération immédiate de la Rubrique 1, puis les autres en arrière-plan\");\n      \n      // 🎯 PHASE 1: Générer et naviguer vers Rubrique 1 immédiatement\n      console.log(\"[PHASE 1] Génération et navigation immédiate vers Rubrique 1 - Prière d'ouverture\");\n      \n      try {\n        // Générer la Rubrique 1 avec un appel API direct plus rapide\n        const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/generate-rubrique-content`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            rubrique_number: 1,\n            rubrique_title: \"Prière d'ouverture\",\n            book: selectedBook || \"Genèse\",\n            chapter: selectedChapter || \"1\",\n            passage: passage,\n            target_length: 500\n          })\n        });\n        \n        if (response.ok) {\n          const data = await response.json();\n          if (data.status === \"success\" || data.status === \"fallback\") {\n            const rubrique1Content = data.content || '';\n            \n            console.log(`[NAVIGATION IMMÉDIATE] Rubrique 1 générée: ${rubrique1Content.length} caractères - API: ${data.api_used}`);\n            console.log(`[CONTENU PREVIEW]`, rubrique1Content.slice(0, 100) + \"...\");\n            \n            // Sauvegarder le contenu dans l'état\n            const contentKey = `${selectedBook}_${selectedChapter}_1`;\n            setGeneratedRubriques(prev => ({ ...prev, [contentKey]: rubrique1Content }));\n            setRubriquesStatus(p => ({ ...p, 1: \"completed\" }));\n            \n            // Navigation immédiate avec le contenu frais\n            navigateToRubrique(1, rubrique1Content);\n            setProgressPercent(4); // 1/28 ≈ 4%\n          } else {\n            console.error(\"[API ERREUR] Impossible de générer la Rubrique 1\");\n            throw new Error(\"API call failed\");\n          }\n        } else {\n          console.error(\"[API ERREUR] Réponse non OK:\", response.status);\n          throw new Error(\"API call failed\");\n        }\n        \n      } catch (error) {\n        console.error(\"[ERREUR PHASE 1]\", error);\n        // Fallback: utiliser la génération normale\n        const rubrique1Content = await generateSingleRubrique(1, BASE_RUBRIQUES[1], passage);\n        if (rubrique1Content) {\n          navigateToRubrique(1, rubrique1Content);\n          setProgressPercent(4);\n        }\n      }\n      \n      // 🎯 PHASE 2: Générer les 27 autres rubriques en arrière-plan\n      console.log(\"[PHASE 2] Génération des 27 autres rubriques en arrière-plan\");\n      \n      // Générer les rubriques restantes par lots de 5\n      const generateRemainingRubriques = async () => {\n        const batchSize = 5;\n        for (let i = 2; i <= 28; i += batchSize) {\n          const batch = [];\n          const endIndex = Math.min(i + batchSize - 1, 28);\n          \n          console.log(`[ARRIÈRE-PLAN] Génération rubriques ${i} à ${endIndex}`);\n          \n          for (let j = i; j <= endIndex; j++) {\n            if (j <= BASE_RUBRIQUES.length - 1) {\n              const rubriqueTitle = BASE_RUBRIQUES[j];\n              batch.push(generateSingleRubrique(j, rubriqueTitle, passage));\n            }\n          }\n          \n          await Promise.all(batch);\n          \n          // Mettre à jour le progrès\n          const progress = Math.floor((endIndex / 28) * 100);\n          setProgressPercent(progress);\n          console.log(`[ARRIÈRE-PLAN] ${endIndex}/28 rubriques générées (${progress}%)`);\n          \n          // Petit délai entre les batches\n          if (endIndex < 28) {\n            await new Promise(resolve => setTimeout(resolve, 1000));\n          }\n        }\n      };\n      \n      // Lancer la génération en arrière-plan (non-bloquante)\n      generateRemainingRubriques().then(() => {\n        console.log(\"[ARRIÈRE-PLAN] Toutes les rubriques terminées!\");\n        setProgressPercent(100);\n      }).catch((error) => {\n        console.error(\"[ARRIÈRE-PLAN] Erreur:\", error);\n      });\n      \n      console.log(\"[GÉNÉRATION AUTOMATIQUE] Toutes les 28 rubriques générées!\");\n      \n      // Sauvegarder l'étude après génération réussie\n      saveCurrentStudy();\n      console.log(\"[SAUVEGARDE] Étude complète des 28 rubriques sauvegardée\");\n      \n    } catch (error) {\n      console.error(\"[ERREUR GÉNÉRATION]\", error);\n      setContent(formatContent(`# Erreur\\n\\nUne erreur est survenue lors de la génération : ${error.message}`));\n    } finally {\n      setIsLoading(false);\n      setProgressPercent(100);\n    }\n  };\n\n  // Nouvelle fonction pour générer UNE SEULE rubrique\n  const generateSingleRubrique = async (rubriqueNum, rubriqueTitle, passage) => {\n    try {\n      console.log(`[GÉNÉRATION RUBRIQUE ${rubriqueNum}] DEMANDÉE: \"${rubriqueTitle}\" pour ${passage}`);\n      console.log(`[DEBUG PARAMS] rubriqueNum=${rubriqueNum}, rubriqueTitle=\"${rubriqueTitle}\", passage=\"${passage}\"`);\n      \n      // Marquer la rubrique en cours\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"in-progress\" }));\n      setProgressPercent(20);\n      \n      // Afficher le titre en attente\n      const contentEnCours = `# Étude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n🔄 Génération intelligente en cours...`;\n      setContent(formatContent(contentEnCours));\n      \n      // Appel API pour CETTE rubrique avec notre système Gemini intelligent\n      const apiUrl = `${API_BASE}/api/generate-rubrique-content`;\n      \n      let rubriqueContent;\n      \n      try {\n        setProgressPercent(50);\n        \n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            rubrique_number: rubriqueNum,\n            rubrique_title: rubriqueTitle,\n            book: selectedBook || \"Genèse\",\n            chapter: selectedChapter || \"1\",\n            passage: passage,\n            target_length: parseInt(selectedLength) || 500\n          })\n        });\n        \n        if (!response.ok) {\n          throw new Error(`API Error: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        console.log(`[API SUCCESS RUBRIQUE ${rubriqueNum}]`, data.content ? data.content.length : 0, \"caractères\");\n        console.log(`[API DATA]`, data);\n        \n        if (data.status === \"success\" || data.status === \"fallback\") {\n          rubriqueContent = data.content;\n          console.log(`[RUBRIQUE ${rubriqueNum}] Contenu généré avec succès:`, rubriqueContent.slice(0, 100) + \"...\");\n        } else {\n          throw new Error(\"Réponse API invalide\");\n        }\n        \n      } catch (apiError) {\n        console.error(`[API ÉCHEC RUBRIQUE ${rubriqueNum}] ${apiError.message}`, apiError);\n        console.warn(`[FALLBACK] Génération de contenu de base pour rubrique ${rubriqueNum}`);\n        // Fallback avec contenu statique\n        rubriqueContent = generateRubriqueContentStatic(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      }\n      \n      setProgressPercent(80);\n      \n      // Si pas de contenu spécifique, utiliser le générateur intelligent\n      if (!rubriqueContent || rubriqueContent.length < 50) {\n        rubriqueContent = generateRubriqueContent(rubriqueNum, rubriqueTitle, passage, selectedBook, selectedChapter, parseInt(selectedLength));\n      }\n      \n      // Afficher le contenu final\n      const contentFinal = `# Étude - ${passage}\\n\\n## ${rubriqueNum}. ${rubriqueTitle}\\n\\n${rubriqueContent}`;\n      const formattedContent = formatContent(contentFinal);\n      setContent(formattedContent);\n      \n      // Sauvegarder dans l'état pour la fonction generateSingleRubrique aussi\n      const contentKey = `${selectedBook}_${selectedChapter}_${rubriqueNum}`;\n      setGeneratedRubriques(prev => ({\n        ...prev,\n        [contentKey]: formattedContent\n      }));\n      \n      // Marquer comme terminé\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"completed\" }));\n      setProgressPercent(100);\n      \n      console.log(`[RUBRIQUE ${rubriqueNum} TERMINÉE] ${rubriqueContent.length} caractères générés`);\n      \n      // Debug: Vérifier le contenu avant de le retourner\n      console.log(`[GENERATE SINGLE DEBUG] Rubrique ${rubriqueNum} contenu final:`, formattedContent ? formattedContent.length : 0, \"caractères\");\n      console.log(`[GENERATE SINGLE DEBUG] Contenu preview:`, formattedContent ? formattedContent.slice(0, 200) + \"...\" : \"VIDE\");\n      \n      // Retourner le contenu formaté pour utilisation ultérieure\n      return formattedContent;\n      \n    } catch (error) {\n      console.error(`[ERREUR RUBRIQUE ${rubriqueNum}]`, error);\n      setRubriquesStatus(p => ({ ...p, [rubriqueNum]: \"error\" }));\n      throw error;\n    }\n  };\n\n  /* =========================\n     Formatage du contenu\n  ========================= */\n\n  const formatContent = (text, context = 'default') => {\n    if (!text) return \"\";\n    \n    // Formatage avec contexte pour VERSETS PROG\n    let formattedText = text\n      // D'abord transformer les labels spécifiques - REGEX ÉLARGIES pour matcher différents formats\n      .replace(/^\\*\\*VERSET (\\d+)\\*\\*$/gim, \"<h2 class='verset-header'>📖 VERSET $1</h2>\")\n      .replace(/^VERSE\\s*T(\\d+)$/gim, \"<h2 class='verset-header'>📖 VERSET $1</h2>\")  // Format preview\n      .replace(/^VERSET\\s*(\\d+)$/gim, \"<h2 class='verset-header'>📖 VERSET $1</h2>\")    // Format alternatif\n      .replace(/^\\*\\*TEXTE BIBLIQUE\\s*:\\*\\*$/gim, \"<h4 class='texte-biblique-label'>📜 TEXTE BIBLIQUE :</h4>\")\n      .replace(/^TEXTE BIBLIQUE\\s*:?$/gim, \"<h4 class='texte-biblique-label'>📜 TEXTE BIBLIQUE :</h4>\")  // Format preview\n      .replace(/^\\*\\*EXPLICATION THÉOLOGIQUE\\s*:\\*\\*$/gim, \"<h4 class='explication-label'>🎓 EXPLICATION THÉOLOGIQUE :</h4>\")\n      .replace(/^EXPLICATION THÉOLOGIQUE\\s*:?$/gim, \"<h4 class='explication-label'>🎓 EXPLICATION THÉOLOGIQUE :</h4>\")  // Format preview\n      // Puis transformer les autres éléments en gras génériques\n      .replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\")\n      .replace(/^\\# (.*$)/gim, \"<h1>$1</h1>\")\n      .replace(/^\\## (.*$)/gim, \"<h2>$1</h2>\")\n      .replace(/^\\### (.*$)/gim, \"<h3>$1</h3>\")\n      .split(\"\\n\\n\")\n      .map(p => (p.trim() ? `<p>${p.replace(/\\n/g, \"<br>\")}</p>` : \"\"))\n      .join(\"\");\n\n    // Appliquer la transformation des références bibliques\n    formattedText = transformBibleReferences(formattedText);\n\n    // Wrapper spécial pour le contexte VERSETS PROG\n    if (context === 'versets-prog') {\n      return `<div class=\"versets-prog-content\">${formattedText}</div>`;\n    }\n    \n    return formattedText;\n  };\n\n  const formatVerseByVerseContent = (text) => {\n    const sections = text.split(/VERSET (\\d+)/);\n    let html = '<div class=\"verse-study-container\">';\n\n    if (sections[0]) {\n      const intro = sections[0]\n        .replace(/\\*\\*(.*?)\\*\\*/g, \"<strong>$1</strong>\")\n        .replace(/^\\### (.*$)/gim, \"<h3>$1</h3>\")\n        .replace(/^\\## (.*$)/gim, \"<h2>$1</h2>\")\n        .replace(/^\\# (.*$)/gim, \"<h1>$1</h1>\");\n      html += `<div style=\"margin-bottom: 30px;\">${intro.replace(/\\n/g, \"<br>\")}</div>`;\n    }\n\n    for (let i = 1; i < sections.length; i += 2) {\n      const verseNumber = sections[i];\n      const block = sections[i + 1];\n\n      if (block) {\n        html += `<div class=\"verse-block\">\n          <div class=\"verse-header\">VERSET ${verseNumber}</div>`;\n\n        const parts = block.split(/TEXTE BIBLIQUE\\s*:/);\n        if (parts.length > 1) {\n          const afterBiblical = parts[1].split(/EXPLICATION THÉOLOGIQUE\\s*:/);\n          const biblicalText = (afterBiblical[0] || \"\").trim();\n          const theologicalExplanation = afterBiblical[1] ? afterBiblical[1].trim() : \"\";\n\n          html += `\n            <div class=\"section-label biblical-label\">📖 TEXTE BIBLIQUE</div>\n            <div class=\"biblical-text\">${biblicalText.replace(/\\n/g, \"<br>\")}</div>`;\n\n          if (theologicalExplanation) {\n            html += `\n              <div class=\"section-label theological-label\">🎓 EXPLICATION THÉOLOGIQUE</div>\n              <div class=\"theological-explanation\">${theologicalExplanation.replace(/\\n/g, \"<br>\")}</div>`;\n          }\n        }\n\n        html += \"</div>\";\n      }\n    }\n\n    html += \"</div>\";\n    return html;\n  };\n\n  /* =========================\n     Rendu (UI intacte)\n  ========================= */\n\n  return (\n    <div className=\"App\">\n      {currentPage === 'concordance' ? (\n        <BibleConcordancePage onGoBack={navigateToMain} />\n      ) : currentPage === 'versets' ? (\n        <VersetParVersetPage \n          onGoBack={navigateToMain} \n          content={versetPageContent}\n          bookInfo={currentBookInfo}\n        />\n      ) : currentPage === 'notes' ? (\n        <NotesPage onGoBack={navigateToMain} />\n      ) : currentPage === 'rubrique' ? (\n        <RubriquePage \n          onGoBack={navigateToMain}\n          rubriqueNumber={currentRubriqueNumber}\n          rubriqueTitle={getRubTitle(currentRubriqueNumber)}\n          content={currentRubriqueContent}\n          bookInfo={currentBookInfo}\n          onNavigateToRubrique={(newRubriqueNumber) => {\n            // Navigation entre rubriques depuis la page de rubrique\n            const contentKey = `${selectedBook}_${selectedChapter}_${newRubriqueNumber}`;\n            const content = generatedRubriques[contentKey] || '';\n            navigateToRubrique(newRubriqueNumber, content);\n          }}\n          // Nouvelles props pour les boutons fonctionnels\n          selectedBook={selectedBook}\n          selectedChapter={selectedChapter}\n          selectedVerse={selectedVerse}\n          selectedLength={selectedLength}\n          setCurrentPage={setCurrentPage}\n          API_BASE={API_BASE}\n          setContent={setContent}\n          setRubriquesStatus={setRubriquesStatus}\n          setIsLoading={setIsLoading}\n          isLoading={isLoading}\n          BASE_RUBRIQUES={BASE_RUBRIQUES}\n        />\n      ) : (\n        <>\n          {/* Header avec texte défilant */}\n          <header className=\"header-banner\">\n            <div className=\"scroll-text\">\n              ✨ MÉDITATION BIBLIQUE ✨ ÉTUDE SPIRITUELLE ✨ SAGESSE DIVINE ✨ MÉDITATION THÉOLOGIQUE ✨ CONTEMPLATION SACRÉE ✨ RÉFLEXION INSPIRÉE ✨\n            </div>\n          </header>\n\n          {/* Indicateur de progression centré */}\n          <div className=\"centered-progress-wrapper\">\n            <div className=\"progress-container\">\n            <div className=\"progress-pill\">\n              {progressPercent}%\n              {isProgressiveLoading && progressiveStats && (\n                <span className=\"progressive-indicator\">\n                  ⚡ {progressiveStats.speed} - {progressiveStats.current_batch} ({progressiveStats.processed}/{progressiveStats.total})\n                </span>\n              )}\n            </div>\n            \n            {/* API Control Panel directement sous le pourcentage */}\n            <div className=\"api-below-progress\">\n              <ApiControlPanel backendUrl={process.env.REACT_APP_BACKEND_URL || \"https://rubrique-study.preview.emergentagent.com\"} />\n            </div>\n            </div>\n          </div>\n\n          {/* Interface principale */}\n          <div className=\"main-container\">\n            {/* Section de recherche */}\n            <div className=\"search-section\">\n              <div className=\"search-input\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Rechercher (ex : Marc 5:1, 1 Jean 2, Genèse 1:1-5)\"\n                  className=\"search-field\"\n                  value={searchQuery}\n                  onChange={handleSearchChange}\n                />\n              </div>\n\n              <div className=\"controls-row\">\n                <SelectPill label=\"Livre\" value={selectedBook} options={[\"--\", ...BOOKS]} onChange={handleBookChange} />\n                <SelectPill label=\"Chapitre\" value={selectedChapter} options={availableChapters} onChange={handleChapterChange} />\n                <SelectPill label=\"Verset\" value={selectedVerse} options={[\"--\", ...Array.from({ length: 50 }, (_, i) => i + 1)]} onChange={handleVerseChange} />\n                <SelectPill label=\"Version\" value={selectedVersion} options={[\"LSG\", \"Darby\", \"NEG\"]} onChange={handleVersionChange} />\n                <button className=\"btn-validate\" disabled={isLoading}>Valider</button>\n                <SelectPill label=\"Longueur\" value={selectedLength} options={[300, 500, 1000, 2000]} onChange={handleLengthChange} />\n                <button className=\"btn-read\" onClick={openYouVersion}>Lire la Bible</button>\n                <button className=\"btn-chat\" onClick={() => window.open('https://chatgpt.com/', '_blank')}>ChatGPT</button>\n                <button className=\"btn-notes\" onClick={handleNotesClick}>📝 Prise de Note</button>\n              </div>\n\n              {/* Boutons d'action - Design équilibré et soigné */}\n              <div className=\"balanced-controls-container\" style={{\n                width: '100%',\n                maxWidth: '1600px',\n                margin: '0 auto',\n                padding: '0 25px',\n                boxSizing: 'border-box'\n              }}>\n                <div className=\"balanced-buttons-grid\" style={{\n                  display: 'grid',\n                  gap: '16px',\n                  marginBottom: '24px',\n                  padding: '20px 20px',\n                  width: '100%',\n                  boxSizing: 'border-box',\n                  alignItems: 'center',\n                  background: 'rgba(255, 255, 255, 0.08)',\n                  backdropFilter: 'blur(10px)',\n                  borderRadius: '20px',\n                  border: '1px solid rgba(255, 255, 255, 0.12)'\n                }}>\n                  <button className=\"btn-control\" style={getButtonStyle(currentButtonColors.reset, currentButtonColors.reset.shadow)} onClick={handleReset}>\n                    <span className=\"control-icon\">🔄</span>\n                    <span className=\"control-label\">Reset</span>\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(currentButtonColors.mystique, currentButtonColors.mystique.shadow)} onClick={changePalette}>\n                    <span className=\"control-icon\">🎨</span>\n                    <span className=\"control-label\">{colorThemes[currentTheme].name}</span>\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(currentButtonColors.genese, currentButtonColors.genese.shadow)} onClick={restoreLastStudy} disabled={!lastStudy}>\n                    <span className=\"control-icon\">📚</span>\n                    <span className=\"control-label\">{lastStudy ? `${lastStudy.book} ${lastStudy.chapter}` : \"Genèse 1\"}</span>\n                  </button>\n                  \n                  <button className={`btn-control ${isLoading ? \"loading\" : \"\"}`} style={getButtonStyle(currentButtonColors.gemini, currentButtonColors.gemini.shadow)} onClick={generateWithGemini} disabled={isLoading}>\n                    <span className=\"control-icon\">🤖</span>\n                    <span className=\"control-label\">Gemini Gratuit</span>\n                    {isLoading && <div className=\"btn-mini-loader\"></div>}\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(currentButtonColors.versets, currentButtonColors.versets.shadow)} onClick={generateVerseByVerseProgressive}>\n                    <span className=\"control-icon\">⚡</span>\n                    <span className=\"control-label\">Versets Prog</span>\n                  </button>\n                  \n                  <button className={`btn-control btn-primary ${isLoading ? \"loading\" : \"\"}`} style={getButtonStyle(currentButtonColors.generate, currentButtonColors.generate.shadow)} onClick={generate28Points} disabled={isLoading}>\n                    <span className=\"control-icon\">✨</span>\n                    <span className=\"control-label\">Générer</span>\n                    {isLoading && <div className=\"btn-mini-loader\"></div>}\n                  </button>\n                  \n                  <button className=\"btn-control\" style={getButtonStyle(currentButtonColors.concordance, currentButtonColors.concordance.shadow)} onClick={navigateToConcordance}>\n                    <span className=\"control-icon\">📖</span>\n                    <span className=\"control-label\">Bible Concordance</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Layout responsive */}\n            <div className=\"three-column-layout\">\n              {/* Colonne gauche - Rubriques */}\n              <div className=\"left-column\">\n                <h3>Rubriques (29)</h3>\n                <RubriquesInline items={rubriquesItems} activeId={activeRubrique} onSelect={handleRubriqueSelect} rubriquesStatus={rubriquesStatus} />\n              </div>\n\n              {/* Colonne centrale - Contenu */}\n              <div className=\"center-column\">\n                <div className=\"content-header\">\n                  <h2>{`${activeRubrique}. ${getRubTitle(activeRubrique)}`}</h2>\n                  <div className=\"nav-buttons\">\n                    <button onClick={() => handleRubriqueSelect(Math.max(0, activeRubrique - 1))} disabled={activeRubrique === 0}>◀ Précédent</button>\n                    <button onClick={() => handleRubriqueSelect(Math.min(BASE_RUBRIQUES.length - 1, activeRubrique + 1))} disabled={activeRubrique === BASE_RUBRIQUES.length - 1}>Suivant ▶</button>\n                  </div>\n                </div>\n\n                <div className=\"content-area\">\n                  {isLoading ? (\n                    <div className=\"loading-container\">\n                      <div className=\"loading-spinner\"></div>\n                      <p>Génération en cours...</p>\n                      {progressiveStats && (\n                        <div className=\"progressive-stats\">\n                          <p>📊 Versets traités: {progressiveStats.processed}/{progressiveStats.total}</p>\n                          <p>🎯 Batch actuel: {progressiveStats.current_batch}</p>\n                          <p>⚡ Mode: {progressiveStats.speed}</p>\n                        </div>\n                      )}\n                    </div>\n                  ) : content ? (\n                    <div>\n                      <div className=\"content-text\" dangerouslySetInnerHTML={{ __html: formatContent(content, isVersetsProgContent ? 'versets-prog' : 'default') }} />\n                      {(isVersetsProgContent || content.includes('VERSET')) && canContinueVerses && (\n                        <div className=\"continue-verses-section\">\n                          <button \n                            className=\"btn-continue-verses\" \n                            onClick={continueVerses} \n                            disabled={isLoading}\n                            title={`Générer les versets ${currentVerseCount + 1} à ${currentVerseCount + 5}`}\n                          >\n                            📖 Continuer les versets ({currentVerseCount + 1}-{currentVerseCount + 5})\n                          </button>\n                          <p className=\"continue-verses-info\">\n                            Versets actuels : 1-{currentVerseCount} • Cliquez pour continuer la lecture\n                          </p>\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div className=\"empty-content-message\">\n                      <p>Sélectionnez une rubrique pour voir son contenu.</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n          {/* SUPPRIMÉ : Modal Notes - remplacée par page dédiée */}\n        </>\n      )}\n    </div>\n  );\n}\n\n/* =========================\n   Composants auxiliaires\n========================= */\n\nfunction getRubTitle(index) {\n  return BASE_RUBRIQUES[index] || `Rubrique ${index}`;\n}\n\nfunction SelectPill({ label, value, options, onChange }) {\n  return (\n    <div className=\"select-pill\">\n      <label>{label}</label>\n      <select value={value} onChange={onChange}>\n        {options.map((o) => <option key={o} value={o}>{o}</option>)}\n      </select>\n    </div>\n  );\n}\n\nfunction NotesModal({ isOpen, notes, onNotesChange, onSave, onClose }) {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"notes-modal-overlay\" onClick={onClose}>\n      <div className=\"notes-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"notes-modal-header\">\n          <h3>📝 Mes Notes d'Étude Biblique</h3>\n          <button className=\"notes-close-btn\" onClick={onClose}>×</button>\n        </div>\n        <div className=\"notes-modal-content\">\n          <textarea\n            className=\"notes-textarea\"\n            value={notes}\n            onChange={(e) => onNotesChange(e.target.value)}\n            placeholder=\"Écrivez vos réflexions, questions, et insights spirituels ici...\n\nExemples :\n• Versets qui m'ont marqué\n• Questions pour approfondir\n• Applications personnelles\n• Prières inspirées par l'étude\"\n            rows={15}\n          />\n        </div>\n        <div className=\"notes-modal-footer\">\n          <button className=\"notes-save-btn\" onClick={onSave}>\n            💾 Sauvegarder\n          </button>\n          <button className=\"notes-cancel-btn\" onClick={onClose}>\n            Annuler\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}